[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ENCODE Project: Functional characterization of regulatory regions using genome-wide functional screens and chromatin interactions",
    "section": "",
    "text": "Introduction\nEstablishing non-coding mechanisms for disease remains a major goal in human genetics. Identifying the genomic mechanisms that contribute to gene regulation is critical to achieving that goal. Two promising technologies for identifying those mechanisms are high-throughput reporter assays and CRISPR screens.\n\n\n\nObjectives\nThis site documents a segment of the analyses conducted by the ENCODE Functional Characterization Center (FCC) working group. In this series of analyses, we have integrated data from STARR/MPRA/CRISPRi/Hi-C assays with genomic annotations of chromatin states (cCREs/ChromHMM) and transcription factor (TF) binding sites to:\nThis site documents a part of analyses in the ENCODE FCC working group. In this series of analyses, we integrated the STARR/MPRA/CRISPRi/Hi-C assays with genomic annotations of chromatin states (cCREs/ChromHMM) and TF binding sites in order to:\n\nQualitatively summarize the regulatory regions identified through STARR/MPRA/CRISPRi assays.\nQuantitative compare the regulatory effects measured in STARR/MPRA/CRISPRi assays\nInvestigate the physical interactions of the regulatory regions using the Hi-C assay\n\n Figure. The ENCODE resource of functional characterization assays and functional genomic data in K562. Phase 4 of the ENCODE project included a coordinated effort across eight labs to functionally characterize human gene regulatory elements using high-throughput reporter assay screens (ATAC-STARR-seq, WHG-STARR-seq, Tiling-MPRA, and Lenti-MPRA) and high-throughput CRISPR perturbational screens (CRISPRi HCR-FlowFISH and CRISPRi growth screen).\nRead more about the ENCODE FCC project and working group\n\n\nSummary\n\nCompared the effects of STARR-seq, MPRA, CRISPRi, and Hi-C assays across the FCC coordinated target regions (GATA1/MYC, LMO2, GATA1, Globin, MYB, and FADS). To do so, we compared Z-score and ranked normalized effects from all of the assays across the regions. Overall, we found common enrichment of strong effects, but also many examples where the assays give different results.\nMeasured enrichment in regulatory states for a combined set of FCC-defined elements. To do so, we took the union of the significant effects from STARR-seq and MPRA (Junke’s peak calls), CRISPRi-FF (CASA peaks), CRISPR-growth (Alex’s DESeq analysis). We then calculated enrichment for cCREs and ChromHMM states in those call sets. We found several chromatin states that were enriched in FCC-identified elements. We also found some cCRE states vary across the assays. We are currently investigating if that variation is biological or due to technical issues about how peaks are called for the different assays.\nDeveloped an analysis pipeline to summarize and compare regulatory effects across accessible regions. Specifically, for each site of chromatin accessibility defined by ATAC-seq, we compiled the estimated effects for ATAC-STARR-seq (Keith, Alex), WG-STARR-seq (Kari, Alex), Tiling MPRA (Hannah), Lenti-MPRA (Vikram), and CRISPRi (Jin-Woo). That resulted in a master table of effects for each assay across all ATAC-seq regions. We then estimated effect size distributions and correlated effects across open chromatin sites using that matrix. We also did across different chromatin states (e.g., cCREs, ChromHMM) assigned to the open chromatin sites. We again found that activity of the assays was positively enriched in many chromatin states associated with active gene regulation. We also found some states had repressed activity for ATAC-STARR-seq but activation in other assays. We are currently investigating if that is a biological finding or due to biases in the analysis.\nExamined the relationship between functional genomic and chromatin 3D organization. This idea is based on the TAD analysis by Jin-Woo and discussions with Gurkan. To do so, we examined loop coverage at regulatory regions across different assays and found that the frequency of loop calls in regulatory regions are higher than background for regulatory regions. We further performed aggregate region analysis to provide a general overview of the 3D genomic structure around the significant regions identified by CRISPRi-HCR FlowFISH assays. From the average contact map, we observed an enrichment of Hi-C signal at TSS-Peak location for regulatory elements identified by the assays. We are currently designing and performing aggregate region analysis for regulatory elements identified in STARR/MPRA and CRISPRi-Growth assays.\nWe are investigating if there is evidence of different classes of enhancers in the FCC datasets. Specifically, we are investigating if there are some enhancers that have activity on their own, and others whose activity depends on nearby physical interacting enhancers. This idea is based on a previous analysis from the ReddyLab using ChIP-STARR-seq (Vockley et al., 2016). Currently, we are classifying which elements are isolated in the genome, and which are potentially interacting. We will then compare regulatory effects across the FCC assays for those classes.\n\nRead the main report of the analyses\n\n\nAcknowledgement\nThe analytical work presented in this document was primarily conducted by Kuei-Yueh Ko under the guidance and supervision of Tim Reddy (Advisor) and Alex Barrera. The direction of the analyses was also guided by Keith Siklenka and Gürkan Yardimci. We express our sincere appreciation to the research teams and individuals involved in conducting, processing, and sharing the experiments and data that underpin our analyses. For further details, please refer to the data dictionary.\n\n\nMore information\n\nAbout the ENCODE FCC project and working group\nMain report of the analyses\nData used and computational environment setup in the anlayses\nMethods and steps of the analyses\nList of figures and tables generated in the anlayses"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html",
    "href": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html",
    "title": "ENCODE ATAC/DNase Peaks",
    "section": "",
    "text": "Set environment\n\n\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_CombEffect_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_CombEffect_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_CombEffect_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_CombEffect_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_CombEffect_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_CombEffect_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_CombEffect_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_CombEffect_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_CombEffect_ENCODE_FCC/references \n\n\n\n\n\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_REF, \"encode_open_chromatin\")\ntxt_fname = \"ENCODE_K562_hg38_ATAC_DNase.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata = dat\nIRdisplay::display(dat)\n\n\n\nA spec_tbl_df: 6 × 12\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_File\nFile_Type\nOutput_Type\nisogenic_replicate\nGenome\nNumber_Peaks\nFile_Name_Keyword\nFile_URL_Summary\nFile_URL_Download\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nATAC\nK562\nENCSR868FGK\nENCFF333TAT\nbed narrowPeak\npseudoreplicated peaks\n1, 2, 3\nhg38\n269800\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF333TAT/\nhttps://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\nATAC\nK562\nENCSR868FGK\nENCFF948AFM\nbed narrowPeak\nIDR thresholded peaks\n1, 2, 3\nhg38\n181340\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF948AFM/\nhttps://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nATAC\nK562\nENCSR483RKN\nENCFF558BLC\nbed narrowPeak\npseudoreplicated peaks\n1, 2\nhg38\n203874\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF558BLC/\nhttps://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nATAC\nK562\nENCSR483RKN\nENCFF925CYR\nbed narrowPeak\nIDR thresholded peaks\n1, 2\nhg38\n123009\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF925CYR/\nhttps://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nDNase\nK562\nENCSR000EKS\nENCFF274YGF\nbed narrowPeak\npeaks\n1\nhg38\n118721\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nhttps://www.encodeproject.org/files/ENCFF274YGF/\nhttps://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nDNase\nK562\nENCSR000EOT\nENCFF185XRG\nbed narrowPeak\npeaks\n1\nhg38\n159277\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nhttps://www.encodeproject.org/files/ENCFF185XRG/\nhttps://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\n\n\n\n\n\n\n\n\nwget -O FILE URL\n\n\nCode\n### init\ndat = dat_metadata\n\n### setup download file name and wget command\ndat = dat %&gt;%\n    dplyr::mutate(\n        File_Name = paste(\n            Biosample, \n            Genome, \n            Index_Experiment, \n            Index_File,\n            Assay,\n            \"bed.gz\", \n            sep=\".\")\n    ) %&gt;%\n    dplyr::mutate(\n        CMD = paste(\"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL_Download)\n    )\n#dat = dat %&gt;% dplyr::select(Assay, Biosample, Index_Experiment, Index_File, File_Name, CMD)\ndat = dat %&gt;% dplyr::select(CMD)\n\n### assign and show\ndat_cmd = dat\nIRdisplay::display(dat)\n\n\n\nA tibble: 6 × 1\n\n\nCMD\n\n\n&lt;chr&gt;\n\n\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz https://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz https://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\n\n\n\n\n\n\n\n\n\n\nCode\n### set output path\ntxt_fdiry = file.path(FD_DAT, \"external\", \"encode_open_chromatin\")\ntxt_fname = \"run_download.sh\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### arrange table\ndat = dat_cmd\ncolnames(dat) = \"#!/bin/bash\"\n\n### save table\ndir.create(txt_fdiry, showWarnings = FALSE)\nwrite_tsv(dat, txt_fpath)\n    #header    = FALSE,\n    #row.names = FALSE)"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#import-metadata",
    "href": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#import-metadata",
    "title": "ENCODE ATAC/DNase Peaks",
    "section": "",
    "text": "Code\n### set file path\ntxt_fdiry = file.path(FD_REF, \"encode_open_chromatin\")\ntxt_fname = \"ENCODE_K562_hg38_ATAC_DNase.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata = dat\nIRdisplay::display(dat)\n\n\n\nA spec_tbl_df: 6 × 12\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_File\nFile_Type\nOutput_Type\nisogenic_replicate\nGenome\nNumber_Peaks\nFile_Name_Keyword\nFile_URL_Summary\nFile_URL_Download\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nATAC\nK562\nENCSR868FGK\nENCFF333TAT\nbed narrowPeak\npseudoreplicated peaks\n1, 2, 3\nhg38\n269800\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF333TAT/\nhttps://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\nATAC\nK562\nENCSR868FGK\nENCFF948AFM\nbed narrowPeak\nIDR thresholded peaks\n1, 2, 3\nhg38\n181340\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF948AFM/\nhttps://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nATAC\nK562\nENCSR483RKN\nENCFF558BLC\nbed narrowPeak\npseudoreplicated peaks\n1, 2\nhg38\n203874\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF558BLC/\nhttps://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nATAC\nK562\nENCSR483RKN\nENCFF925CYR\nbed narrowPeak\nIDR thresholded peaks\n1, 2\nhg38\n123009\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nhttps://www.encodeproject.org/files/ENCFF925CYR/\nhttps://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nDNase\nK562\nENCSR000EKS\nENCFF274YGF\nbed narrowPeak\npeaks\n1\nhg38\n118721\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nhttps://www.encodeproject.org/files/ENCFF274YGF/\nhttps://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nDNase\nK562\nENCSR000EOT\nENCFF185XRG\nbed narrowPeak\npeaks\n1\nhg38\n159277\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nhttps://www.encodeproject.org/files/ENCFF185XRG/\nhttps://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#generate-download-script",
    "href": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#generate-download-script",
    "title": "ENCODE ATAC/DNase Peaks",
    "section": "",
    "text": "wget -O FILE URL\n\n\nCode\n### init\ndat = dat_metadata\n\n### setup download file name and wget command\ndat = dat %&gt;%\n    dplyr::mutate(\n        File_Name = paste(\n            Biosample, \n            Genome, \n            Index_Experiment, \n            Index_File,\n            Assay,\n            \"bed.gz\", \n            sep=\".\")\n    ) %&gt;%\n    dplyr::mutate(\n        CMD = paste(\"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL_Download)\n    )\n#dat = dat %&gt;% dplyr::select(Assay, Biosample, Index_Experiment, Index_File, File_Name, CMD)\ndat = dat %&gt;% dplyr::select(CMD)\n\n### assign and show\ndat_cmd = dat\nIRdisplay::display(dat)\n\n\n\nA tibble: 6 × 1\n\n\nCMD\n\n\n&lt;chr&gt;\n\n\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz https://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz https://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#save-to-script",
    "href": "notebooks/01_data_download/region_ocr_01_create_download_script_R.html#save-to-script",
    "title": "ENCODE ATAC/DNase Peaks",
    "section": "",
    "text": "Code\n### set output path\ntxt_fdiry = file.path(FD_DAT, \"external\", \"encode_open_chromatin\")\ntxt_fname = \"run_download.sh\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### arrange table\ndat = dat_cmd\ncolnames(dat) = \"#!/bin/bash\"\n\n### save table\ndir.create(txt_fdiry, showWarnings = FALSE)\nwrite_tsv(dat, txt_fpath)\n    #header    = FALSE,\n    #row.names = FALSE)"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "",
    "text": "Set environment\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_CombEffect_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_CombEffect_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_CombEffect_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_CombEffect_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_CombEffect_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_CombEffect_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_CombEffect_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_CombEffect_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_CombEffect_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#import-data",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#import-data",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "Import data",
    "text": "Import data\nOL13 (FADS)\nOL43 (GATA/MYC)\nOL45 (HBE1/LMO2/RBM38/HBA2/BCL11A)\nCheck data file paths\n\nfdiry = file.path(FD_DAT, \"processed\")\nprint(dir(fdiry))\n\n[1] \"A001_K562_hg38_WSTARRseq\"          \"A001_K562_hg38_WSTARRseq_jamboree\"\n[3] \"KS91_K562_hg38_ASTARRseq_210401\"   \"KS91_K562_hg38_ASTARRseq_jamboree\"\n[5] \"MPRA_Tiling_K562_Tewhey_hannah\"   \n\n\n\nfdiry = file.path(FD_DAT, \"processed\", \"MPRA_Tiling_K562_Tewhey_hannah\", \"tiling_counts\")\nprint(dir(fdiry))\n\n [1] \"FADS_tile_snp.20190214.attributes\"       \n [2] \"OL13_20220512_counts.out\"                \n [3] \"OL13_20220512_normalized_counts.out\"     \n [4] \"OL43_20211228_counts.out\"                \n [5] \"OL43_20211228_normalized_counts.out\"     \n [6] \"OL43_20221003_counts.out\"                \n [7] \"OL43_20221003_K562_normalized_counts.out\"\n [8] \"OL43_K562.bed\"                           \n [9] \"OL43.attributes\"                         \n[10] \"OL45_20220927_counts.out\"                \n[11] \"OL45_20220927_K562_normalized_counts.out\"\n[12] \"OL45_K562.bed\"                           \n[13] \"OL45.attributes\"                         \n[14] \"UKBB_GTEx\"                               \n\n\n\nfdiry = file.path(FD_DAT, \"processed\", \"MPRA_Tiling_K562_Tewhey_hannah\", \"tiling_counts\")\nfpaths = dir(fdiry)\nprint(grep(\"out\", fpaths, value=TRUE))\n\n[1] \"OL13_20220512_counts.out\"                \n[2] \"OL13_20220512_normalized_counts.out\"     \n[3] \"OL43_20211228_counts.out\"                \n[4] \"OL43_20211228_normalized_counts.out\"     \n[5] \"OL43_20221003_counts.out\"                \n[6] \"OL43_20221003_K562_normalized_counts.out\"\n[7] \"OL45_20220927_counts.out\"                \n[8] \"OL45_20220927_K562_normalized_counts.out\"\n\n\nSetup metadata\n\ndat_meta = data.frame(\n    Dataset = c(\n        \"OL13_20220512\", \"OL13_20220512\", \n        \"OL43_20221003\", \"OL43_20221003\", \n        \"OL45_20220927\", \"OL45_20220927\"),\n    Process = c(\"raw\", \"norm\", \"raw\", \"norm\", \"raw\", \"norm\"),\n    Genome  = c(\"hg19\", \"hg19\", \"hg38\", \"hg38\", \"hg38\", \"hg38\"),\n    N_Rep_Input  = c(4, 4, 6, 6, 4, 4),  \n    N_Rep_Output = c(4, 4, 5, 5, 4, 4), \n    FName = c(\n        \"OL13_20220512_counts.out\",\n        \"OL13_20220512_normalized_counts.out\",\n        \"OL43_20221003_counts.out\",\n        \"OL43_20221003_K562_normalized_counts.out\",\n        \"OL45_20220927_counts.out\",\n        \"OL45_20220927_K562_normalized_counts.out\")\n)\ndat_meta\n\n\nA data.frame: 6 × 6\n\n\nDataset\nProcess\nGenome\nN_Rep_Input\nN_Rep_Output\nFName\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n\n\n\n\nOL13_20220512\nraw\nhg19\n4\n4\nOL13_20220512_counts.out\n\n\nOL13_20220512\nnorm\nhg19\n4\n4\nOL13_20220512_normalized_counts.out\n\n\nOL43_20221003\nraw\nhg38\n6\n5\nOL43_20221003_counts.out\n\n\nOL43_20221003\nnorm\nhg38\n6\n5\nOL43_20221003_K562_normalized_counts.out\n\n\nOL45_20220927\nraw\nhg38\n4\n4\nOL45_20220927_counts.out\n\n\nOL45_20220927\nnorm\nhg38\n4\n4\nOL45_20220927_K562_normalized_counts.out\n\n\n\n\n\nRead data\n\nlst_dat_read = lapply(1:nrow(dat_meta), function(idx){\n\n    ### Extract data info from the metadata table\n    xrow  = dat_meta[idx,]\n    fname = xrow$FName\n    n_rep_input  = xrow$N_Rep_Input\n    n_rep_output = xrow$N_Rep_Output\n    \n    ### Set file directory\n    fdiry = file.path(FD_DAT, \"processed\", \"MPRA_Tiling_K562_Tewhey_hannah\", \"tiling_counts\")\n    fpath = file.path(fdiry, fname)\n          \n    ### import data\n    dat = read.table(fpath, row.names=1)\n    dat = dat %&gt;% rownames_to_column(var = \"Name\")\n\n    ### rename columns & assign\n    cnames = c(\n        \"Name\", \n        paste0(\"Input.rep\",  1:n_rep_input), \n        paste0(\"Output.rep\", 1:n_rep_output)\n    )\n    colnames(dat) = cnames\n    \n    ### show progress and return\n    cat(\"\\n=======================\\n\")\n    cat(fname, \"\\n\")\n    cat(\"Shape:\", dim(dat), \"\\n\")\n    print(head(dat, 3))\n    flush.console()\n    return(dat)\n})\n\nnames(lst_dat_read) = paste(\n    paste(\"TMPRA_K562\", dat_meta$Dataset, sep=\"_\"), \n    dat_meta$Genome, \n    dat_meta$Process, sep=\".\")\n\n\n=======================\nOL13_20220512_counts.out \nShape: 55229 9 \n                                               Name Input.rep1 Input.rep2\n1       (11:61555216-61555415;11:61555315:T:C_A_wC)       1609       1221\n2 (11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)       1179        582\n3 (11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)       1066        643\n  Input.rep3 Input.rep4 Output.rep1 Output.rep2 Output.rep3 Output.rep4\n1       1396        798         845         283         574        1223\n2       1225        721         476         416         912         956\n3       1206        681         470         846         540         847\n\n=======================\nOL13_20220512_normalized_counts.out \nShape: 55229 9 \n                                               Name Input.rep1 Input.rep2\n1       (11:61555216-61555415;11:61555315:T:C_A_wC)   881.8510  1196.3976\n2 (11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   646.1792   570.2730\n3 (11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   584.2468   630.0439\n  Input.rep3 Input.rep4 Output.rep1 Output.rep2 Output.rep3 Output.rep4\n1   855.5317   774.9257    1807.947    569.6449    730.4747    1493.445\n2   750.7352   700.1522    1018.441    837.3579   1160.6148    1167.403\n3   739.0912   661.3088    1005.604   1702.8961    687.2061    1034.299\n\n=======================\nOL43_20221003_counts.out \nShape: 99307 12 \n                                                     Name Input.rep1 Input.rep2\n1           (8:127381651-127381850;8:127320401-127320600)       1318       1810\n2 (8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC)        634        730\n3 (8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC)        416        432\n  Input.rep3 Input.rep4 Input.rep5 Input.rep6 Output.rep1 Output.rep2\n1       1477       1505        738        687         620         636\n2        698        761        316        343         158         194\n3        418        409        181        211       11164        6818\n  Output.rep3 Output.rep4 Output.rep5\n1         781         520         538\n2         268         141         251\n3       12118        9512       10450\n\n=======================\nOL43_20221003_K562_normalized_counts.out \nShape: 99307 12 \n                                                     Name Input.rep1 Input.rep2\n1           (8:127381651-127381850;8:127320401-127320600)   887.4466  1078.7715\n2 (8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC)   426.8901   435.0846\n3 (8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC)   280.1045   257.4747\n  Input.rep3 Input.rep4 Input.rep5 Input.rep6 Output.rep1 Output.rep2\n1   946.8314   945.7219   962.3235   893.9085    961.7725   1136.6673\n2   447.4531   478.2022   412.0518   446.3037    245.0969    346.7193\n3   267.9590   257.0101   236.0170   274.5483  17318.1102  12185.2169\n  Output.rep3 Output.rep4 Output.rep5\n1    842.9706    896.6654    760.1443\n2    289.2652    243.1343    354.6398\n3  13079.5358  16402.0789  14764.8855\n\n=======================\nOL45_20220927_counts.out \nShape: 94381 9 \n                                                                  Name\n1 (Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270\n2                                                  1:10437778:C:T:R:wC\n3                                                  1:10451799:C:T:R:wC\n  Input.rep1 Input.rep2 Input.rep3 Input.rep4 Output.rep1 Output.rep2\n1        897        717        761        724       56816       37391\n2        645        437        491        493        2239        1698\n3        603        584        512        429         336         280\n  Output.rep3 Output.rep4\n1       36946       52349\n2        1202        2532\n3         321         333\n\n=======================\nOL45_20220927_K562_normalized_counts.out \nShape: 94381 9 \n                                                                  Name\n1 (Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270\n2                                                  1:10437778:C:T:R:wC\n3                                                  1:10451799:C:T:R:wC\n  Input.rep1 Input.rep2 Input.rep3 Input.rep4 Output.rep1 Output.rep2\n1   660.3527   622.9447   644.2283   623.2888  69961.0133  56175.0918\n2   474.8355   379.6748   415.6585   424.4218   2757.0175   2551.0231\n3   443.9160   507.3915   433.4361   369.3244    413.7373    420.6634\n  Output.rep3 Output.rep4\n1  62517.7362  58457.7541\n2   2033.9501   2827.4663\n3    543.1763    371.8587"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#preprocess-the-table-extract-only-tiling-regions",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#preprocess-the-table-extract-only-tiling-regions",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "Preprocess the table: Extract only tiling regions",
    "text": "Preprocess the table: Extract only tiling regions\nDefine helper functions for data processing\n\nget_strand = function(x){ifelse(is.na(x), \"+\", \"-\")}\nadd_chrom  = function(x){ifelse(str_detect(x, \"chr\"), x, paste0(\"chr\", x))}\n\nfun_extract = function(dat) {\n    ### Input:  dataframe\n    ### Output: dataframe\n    ### Description:\n    ###     Preprocess the raw dataframe\n    ###     - expand duplicates\n    ###     - filter and extract only tiling oligos\n    ###     - get location information\n    ### ===========================================\n    ### init regex pattern\n    pattern = \"^[chr|1-9|X]+:[0-9]*-[0-9]*\"\n    \n    ### preprocess\n    res = dat %&gt;% \n        dplyr::mutate(Name = gsub(\"\\\\(|\\\\)\", \"\", Name)) %&gt;% \n        tidyr::separate_rows(Name, sep=\";\") %&gt;%\n        dplyr::filter(!grepl(pattern = \"Nadav\", Name)) %&gt;%\n        dplyr::filter(str_detect(string=Name, pattern=pattern)) %&gt;%\n        tidyr::separate(Name, c(\"Chrom\", \"Start\", \"End\", \"Strand\"), remove=FALSE, fill=\"right\") %&gt;%\n        dplyr::mutate(\n            Chrom  = add_chrom(Chrom),\n            Start  = as.integer(Start),\n            End    = as.integer(End),\n            Name   = add_chrom(Name),\n            Strand = get_strand(Strand))\n    return(res)\n}\n\nApply processing functions\n\n### init\nlst = lst_dat_read\n\n### before preprocessed\nprint(lapply(lst, dim))\ncat(\"++++++++++++++++++++++++++++++++++++++++\\n\")\n\n### after proprocessed\nlst = lapply(lst, fun_extract)\nlst_dat_extract = lst\nprint(lapply(lst, dim))\n\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 55229     9\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 55229     9\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 99307    12\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 99307    12\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 94381     9\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 94381     9\n\n++++++++++++++++++++++++++++++++++++++++\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43907    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43907    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96108    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96108    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 71213    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 71213    13\n\n\n\nShow results\n\nset.seed(123)\nlst = lst_dat_extract\nlapply(lst, slice_sample, n=3)\n\n\n    $TMPRA_K562_OL13_20220512.hg19.raw\n        \n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61559376-61559575_RC\nchr11\n61559376\n61559575\n-\n363\n256\n368\n252\n0\n32\n0\n37\n\n\nchr11:61628981-61629180_RC\nchr11\n61628981\n61629180\n-\n823\n497\n638\n344\n78\n300\n263\n298\n\n\nchr11:61628421-61628620\nchr11\n61628421\n61628620\n+\n400\n378\n637\n250\n138\n165\n295\n236\n\n\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:61648876-61649075_RC\nchr11\n61648876\n61649075\n-\n303.0849\n283.1768\n304.58401\n238.8869\n179.7249\n181.1592\n0.0000\n363.8974\n\n\nchr11:61558796-61558995\nchr11\n61558796\n61558995\n+\n488.8819\n550.6760\n591.39550\n539.9232\n842.9954\n215.3781\n674.4801\n461.5880\n\n\nchr11:61652526-61652725\nchr11\n61652526\n61652725\n+\n118.9320\n117.5821\n86.41116\n140.8073\n0.0000\n255.6357\n442.8662\n124.5555\n\n\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n\nA tibble: 3 × 16\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr8:127212351-127212550\nchr8\n127212351\n127212550\n+\n498\n576\n544\n596\n231\n270\n228\n201\n369\n182\n251\n\n\nchrX:48539581-48539780\nchrX\n48539581\n48539780\n+\n271\n290\n221\n253\n108\n139\n15877\n10329\n17175\n14124\n14530\n\n\nchrX:48294251-48294450\nchrX\n48294251\n48294450\n+\n181\n221\n277\n253\n96\n106\n38\n73\n128\n74\n105\n\n\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n\nA tibble: 3 × 16\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr8:127441201-127441400\nchr8\n127441201\n127441400\n+\n233.6449\n222.3104\n171.1604\n221.1921\n215.1536\n252.4283\n228.0332\n121.5305\n212.6315\n184.5061\n156.8328\n\n\nchr8:127491151-127491350\nchr8\n127491151\n127491350\n+\n438.3367\n409.4564\n412.1954\n390.8565\n355.9815\n352.6189\n642.2158\n616.5884\n457.6434\n496.6147\n508.6468\n\n\nchr8:128028501-128028700\nchr8\n128028501\n128028700\n+\n1120.4181\n1169.3644\n1135.3002\n1182.6237\n1090.1117\n1122.9157\n1002.1049\n886.4576\n943.3499\n1046.6844\n916.9771\n\n\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:33783701-33783900\nchr11\n33783701\n33783900\n+\n786\n596\n647\n773\n2050\n1933\n1917\n2263\n\n\nchr11:5570301-5570500\nchr11\n5570301\n5570500\n+\n294\n254\n226\n187\n158\n137\n110\n250\n\n\nchr2:60047901-60048100\nchr2\n60047901\n60048100\n+\n863\n780\n827\n797\n363\n254\n248\n451\n\n\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:33672501-33672700\nchr11\n33672501\n33672700\n+\n711.1490\n671.5987\n617.9851\n668.9163\n507.3208\n438.6918\n417.9581\n714.68343\n\n\nchr11:34229601-34229800\nchr11\n34229601\n34229800\n+\n128.8313\n118.1597\n126.1367\n141.1870\n155.1515\n174.2748\n135.3711\n92.68551\n\n\nchr11:33493901-33494100\nchr11\n33493901\n33494100\n+\n524.8957\n536.0626\n465.6052\n633.6195\n417.4314\n327.5165\n297.8163\n546.06280"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#filter-out-the-fragments-oligos-where-mean-input-is-zero",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#filter-out-the-fragments-oligos-where-mean-input-is-zero",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "Filter out the fragments (Oligos) where mean input is zero",
    "text": "Filter out the fragments (Oligos) where mean input is zero\nDefine helper functions\n\nfun_filter = function(dat){\n    ### Input:  dataframe\n    ### Output: dataframe\n    ### Description:\n    ###     calculate the mean of input for each fragment and \n    ###     filter out the fragment w/ plasmid mean is zero\n    ###     - convert wide matrix to long matrix\n    ###     - group by the input and output to calculate the mean\n    ###     - get the non-zero fragments from the input dataframe\n    \n    ### calculate the mean of input for each fragment and \n    tmp = dat %&gt;% \n        tidyr::gather(Sample, Value, -Chrom, -Start, -End, -Name, -Strand) %&gt;% \n        tidyr::separate(Sample, c(\"Group\", \"Rep\"), sep=\"\\\\.\", remove=FALSE) %&gt;%\n        dplyr::filter(Group == \"Input\") %&gt;%\n        dplyr::group_by(Chrom, Start, End, Name, Strand, Group) %&gt;%\n        dplyr::summarise(Value = mean(Value), .groups=\"drop\")\n    \n    ### filter out the fragment w/ plasmid mean is zero\n    tmp = tmp %&gt;% dplyr::filter(Value &gt; 0)\n    idx = unique(tmp$Name)\n    res = dat %&gt;% dplyr::filter(Name %in% idx)\n    return(res)\n}\n\nFilter fragments\n\n### init\nlst = lst_dat_extract\n\n### show info before processing\nprint(lapply(lst, dim))\ncat(\"++++++++++++++++++++++++++++++++++++++++\\n\")\n\n### processing\nlst = lapply(lst, fun_filter)\n\n### assign and show info\nlst_dat_filter = lst\nprint(lapply(lst, dim))\n\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43907    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43907    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96108    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96108    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 71213    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 71213    13\n\n++++++++++++++++++++++++++++++++++++++++\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43871    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43871    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96087    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96087    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 71200    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 71200    13\n\n\n\nShow results\n\nlst = lst_dat_filter\ndat = lst[[1]]\nhead(dat, 3)\n\n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n1609\n1221\n1396\n798\n845\n283\n574\n1223\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n1179\n582\n1225\n721\n476\n416\n912\n956\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n1066\n643\n1206\n681\n470\n846\n540\n847"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#calculate-mean-for-normalized-count-table",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#calculate-mean-for-normalized-count-table",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "Calculate mean for normalized count table",
    "text": "Calculate mean for normalized count table\nDefine helper functions\n\nfun_add_mean_column = function(dat){\n    ### get input and output to calculate log2FC\n    x_inp = dat %&gt;% dplyr::select(starts_with(\"Input\"))  %&gt;% apply(., 1, mean)\n    x_out = dat %&gt;% dplyr::select(starts_with(\"Output\")) %&gt;% apply(., 1, mean)\n    x_lfc = log2(x_out) - log2(x_inp)\n    \n    ### add columns\n    dat$Input.mean  = x_inp\n    dat$Output.mean = x_out\n    dat$Log2FC.mean = x_lfc\n \n    return(dat)\n}\n\nCalculate mean and add it as an additional column for normalized count\n\nlst = lst_dat_filter\nprint(names(lst))\ncat(\"=======================\\n\")\nsid = grep(\"norm\", names(lst), value=TRUE)\nprint(sid)\n\n[1] \"TMPRA_K562_OL13_20220512.hg19.raw\"  \"TMPRA_K562_OL13_20220512.hg19.norm\"\n[3] \"TMPRA_K562_OL43_20221003.hg38.raw\"  \"TMPRA_K562_OL43_20221003.hg38.norm\"\n[5] \"TMPRA_K562_OL45_20220927.hg38.raw\"  \"TMPRA_K562_OL45_20220927.hg38.norm\"\n=======================\n[1] \"TMPRA_K562_OL13_20220512.hg19.norm\" \"TMPRA_K562_OL43_20221003.hg38.norm\"\n[3] \"TMPRA_K562_OL45_20220927.hg38.norm\"\n\n\n\n### init\nlst  = lst_dat_filter\nidxs = grep(\"norm\", names(lst), value=TRUE)\n\n### add mean for normalization count\nfor (idx in idxs){\n    cat(idx, \"\\n\")\n    lst[[idx]] = fun_add_mean_column(lst[[idx]])\n}\n\n### assigned\nlst_dat_prep = lst\n\nTMPRA_K562_OL13_20220512.hg19.norm \nTMPRA_K562_OL43_20221003.hg38.norm \nTMPRA_K562_OL45_20220927.hg38.norm \n\n\nShow results\n\nlst = lst_dat_prep\nidx = names(lst)[1]\ndat = lst_dat_prep[[1]]\n\ncat(idx)\nhead(dat, 3)\n\nTMPRA_K562_OL13_20220512.hg19.raw\n\n\n\nA tibble: 3 × 13\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n1609\n1221\n1396\n798\n845\n283\n574\n1223\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n1179\n582\n1225\n721\n476\n416\n912\n956\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n1066\n643\n1206\n681\n470\n846\n540\n847\n\n\n\n\n\n\nlst = lst_dat_prep\nidx = names(lst)[2]\ndat = lst_dat_prep[[2]]\n\ncat(idx)\nhead(dat, 3)\n\nTMPRA_K562_OL13_20220512.hg19.norm\n\n\n\nA tibble: 3 × 16\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nInput.mean\nOutput.mean\nLog2FC.mean\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n881.8510\n1196.3976\n855.5317\n774.9257\n1807.947\n569.6449\n730.4747\n1493.445\n927.1765\n1150.378\n0.3111919\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n646.1792\n570.2730\n750.7352\n700.1522\n1018.441\n837.3579\n1160.6148\n1167.403\n666.8349\n1045.954\n0.6494180\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n584.2468\n630.0439\n739.0912\n661.3088\n1005.604\n1702.8961\n687.2061\n1034.299\n653.6727\n1107.501\n0.7606680\n\n\n\n\n\n\nlst = lst_dat_prep\nidx = names(lst)[3]\ndat = lst_dat_prep[[3]]\n\ncat(idx)\nhead(dat, 3)\n\nTMPRA_K562_OL43_20221003.hg38.raw\n\n\n\nA tibble: 3 × 16\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr8:127381651-127381850\nchr8\n127381651\n127381850\n+\n1318\n1810\n1477\n1505\n738\n687\n620\n636\n781\n520\n538\n\n\nchr8:127320401-127320600\nchr8\n127320401\n127320600\n+\n1318\n1810\n1477\n1505\n738\n687\n620\n636\n781\n520\n538\n\n\nchr8:127742001-127742200\nchr8\n127742001\n127742200\n+\n634\n730\n698\n761\n316\n343\n158\n194\n268\n141\n251\n\n\n\n\n\n\nlst = lst_dat_prep\nidx = names(lst)[4]\ndat = lst_dat_prep[[4]]\n\ncat(idx)\nhead(dat, 3)\n\nTMPRA_K562_OL43_20221003.hg38.norm\n\n\n\nA tibble: 3 × 19\n\n\nName\nChrom\nStart\nEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\nInput.mean\nOutput.mean\nLog2FC.mean\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr8:127381651-127381850\nchr8\n127381651\n127381850\n+\n887.4466\n1078.7715\n946.8314\n945.7219\n962.3235\n893.9085\n961.7725\n1136.6673\n842.9706\n896.6654\n760.1443\n952.5006\n919.6440\n-0.0506444\n\n\nchr8:127320401-127320600\nchr8\n127320401\n127320600\n+\n887.4466\n1078.7715\n946.8314\n945.7219\n962.3235\n893.9085\n961.7725\n1136.6673\n842.9706\n896.6654\n760.1443\n952.5006\n919.6440\n-0.0506444\n\n\nchr8:127742001-127742200\nchr8\n127742001\n127742200\n+\n426.8901\n435.0846\n447.4531\n478.2022\n412.0518\n446.3037\n245.0969\n346.7193\n289.2652\n243.1343\n354.6398\n440.9976\n295.7711\n-0.5762898"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#store-the-fragments-and-counts",
    "href": "notebooks/01_data_download/fcc_starrmpra_13_extract_fragment_counts_R.html#store-the-fragments-and-counts",
    "title": "Extract fragment counts from Tiling MPRA data",
    "section": "Store the fragments and counts",
    "text": "Store the fragments and counts\n* OL13 (FADS)\n* OL43 (GATA/MYC)\n* OL45 (HBE1/LMO2/RBM38/HBA2/BCL11A)\n\n- OL13_20220512_counts.out\n- OL13_20220512_normalized_counts.out\n- OL43_20211228_counts.out      \n- OL43_20211228_normalized_counts.out\n- OL43_20221003_counts.out \n- OL43_20221003_K562_normalized_counts.out\n- OL45_20220927_counts.out \n- OL45_20220927_K562_normalized_counts.out\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nFragments\n\nOL13_20220512.hg19.stranded_pos.bed\nOL43_20221003.hg38.stranded_pos.bed\nOL45_20221003.hg38.stranded_pos.bed\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL13_20220512\n\nOL13_20220512.hg19.raw.Input .rep[1-4].stranded_pos.bed\nOL13_20220512.hg19.raw.Output.rep[1-4].stranded_pos.bed\n\nOL13_20220512.hg19.norm.Input .mean.stranded_pos.bed\nOL13_20220512.hg19.norm.Output.mean.stranded_pos.bed\nOL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL43_20221003\n\nOL43_20221003.hg38.raw.Input .rep[1-6].stranded_pos.bed\nOL43_20221003.hg38.raw.Output.rep[1-5].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .rep[1-6].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-5].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL45_20220927\n\nOL43_20221003.hg38.raw. Input .rep[1-4].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-4].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .rep[1-4].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-4].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n\nSetup output directory\n\n### init\nTXT_GROUP   = \"assay_fcc\"\nTXT_ASSAY   = \"MPRA_Tiling_K562_Tewhey_hannah\"\n\n### create fragment folder\ntxt_folder = \"fragment\"\ntxt_fdiry = file.path(FD_RES, TXT_GROUP, TXT_ASSAY, txt_folder)\ncat(txt_fdiry, \"\\n\")\n\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### create fragment count folders\ntxt_folder = \"fragment_counts/summary\"\ntxt_fdiry = file.path(FD_RES, TXT_GROUP, TXT_ASSAY, txt_folder)\ncat(txt_fdiry, \"\\n\")\n\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n/mount/repo/Proj_CombEffect_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_hannah/fragment \n/mount/repo/Proj_CombEffect_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_hannah/fragment_count/summary \n\n\n\n\nStore fragments\n\nlst  = lst_dat_prep\nidxs = grep(\"raw\", names(lst), value=TRUE)\nfor (idx in idxs) {cat(idx, \"\\n\")}\n\nTMPRA_K562_OL13_20220512.hg19.raw \nTMPRA_K562_OL43_20221003.hg38.raw \nTMPRA_K562_OL45_20220927.hg38.raw \n\n\n\ntxt_group  = TXT_GROUP\ntxt_assay  = TXT_ASSAY\ntxt_folder = \"fragment\"\ntxt_strand = \"stranded_pos\"\n\nlst  = lst_dat_prep\nidxs = grep(\"raw\", names(lst), value=TRUE)\n\ntxt_fdiry = file.path(FD_RES, txt_group, txt_assay, txt_folder)\ncat(\"Output directory:\", \"\\n\")\ncat(txt_fdiry, \"\\n\")\n\nfor (idx in idxs){\n    ### show progres\n    cat(\"\\n=======================\")\n    cat(\"\\nSample:\", idx, \"\\n\")\n    \n    ### init\n    dat = lst[[idx]]\n    \n    ### extract positive trands and order by positions\n    dat = dat %&gt;% \n        dplyr::filter(Strand == \"+\") %&gt;% \n        dplyr::arrange(Chrom, Start, End)\n    \n    ### arrange the column into bed file format\n    dat = dat %&gt;%\n        dplyr::mutate(Score = \".\") %&gt;%\n        dplyr::select(Chrom, Start, End, Name, Score, Strand)\n    \n    ### save table\n    txt_fname = paste(idx, txt_strand, \"bed.gz\", sep=\".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    write_tsv(dat, txt_fpath, col_names=FALSE)\n    \n    ### show progress\n    #print(fpath)\n    print(head(dat))\n    cat(\"\\nSaved Table:\", txt_fname, \"\\n\")\n}\n\nOutput directory: \n/mount/repo/Proj_CombEffect_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_hannah/fragment \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.raw \n# A tibble: 6 × 6\n  Chrom    Start      End Name                    Score Strand\n  &lt;chr&gt;    &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt; \n1 chr11 61554801 61555000 chr11:61554801-61555000 .     +     \n2 chr11 61554806 61555005 chr11:61554806-61555005 .     +     \n3 chr11 61554811 61555010 chr11:61554811-61555010 .     +     \n4 chr11 61554816 61555015 chr11:61554816-61555015 .     +     \n5 chr11 61554821 61555020 chr11:61554821-61555020 .     +     \n6 chr11 61554826 61555025 chr11:61554826-61555025 .     +     \n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.raw \n# A tibble: 6 × 6\n  Chrom     Start       End Name                     Score Strand\n  &lt;chr&gt;     &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt; \n1 chr8  126735901 126736100 chr8:126735901-126736100 .     +     \n2 chr8  126735951 126736150 chr8:126735951-126736150 .     +     \n3 chr8  126736001 126736200 chr8:126736001-126736200 .     +     \n4 chr8  126736051 126736250 chr8:126736051-126736250 .     +     \n5 chr8  126736101 126736300 chr8:126736101-126736300 .     +     \n6 chr8  126736151 126736350 chr8:126736151-126736350 .     +     \n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.raw \n# A tibble: 6 × 6\n  Chrom   Start     End Name                  Score Strand\n  &lt;chr&gt;   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt; &lt;chr&gt; \n1 chr11 4505501 4505700 chr11:4505501-4505700 .     +     \n2 chr11 4505601 4505800 chr11:4505601-4505800 .     +     \n3 chr11 4505701 4505900 chr11:4505701-4505900 .     +     \n4 chr11 4505801 4506000 chr11:4505801-4506000 .     +     \n5 chr11 4505901 4506100 chr11:4505901-4506100 .     +     \n6 chr11 4506001 4506200 chr11:4506001-4506200 .     +     \n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz \n\n\n\n\nStore table of counts\n\nfdiry = file.path(FD_RES, assay, folder, \"summary\")\nprint(fdiry)\n\n[1] \"/mount/repo/Proj_CombEffect_ENCODE_FCC/results/Tewhey_K562_TileMPRA/fragment/summary\"\n\n\n\ntxt_group  = TXT_GROUP\ntxt_assay  = TXT_ASSAY\ntxt_folder = \"fragment_counts/summary\"\ntxt_strand = \"stranded_pos\"\n\nlst  = lst_dat_prep\nidxs = names(lst)\n\ntxt_fdiry = file.path(FD_RES, txt_group, txt_assay, txt_folder)\ncat(\"Output directory:\", \"\\n\")\ncat(txt_fdiry, \"\\n\")\n\nfor (idx in idxs){\n    ### show progres\n    cat(\"\\n=======================\")\n    cat(\"\\nSample:\", idx, \"\\n\")\n    \n    ### init\n    dat = lst[[idx]]\n    \n    ### extract positive trands and order by positions\n    dat = dat %&gt;% \n       dplyr::filter(Strand == \"+\") %&gt;% \n       dplyr::arrange(Chrom, Start, End)\n    \n    ### save table\n    txt_fname = paste(idx, txt_strand, \"tsv\", sep=\".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    write_tsv(dat, txt_fpath)\n\n    ### show progress\n    print(head(dat))\n    cat(\"\\nSaved Table:\", txt_fname, \"\\n\")\n}\n\nOutput directory: \n/mount/repo/Proj_CombEffect_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_hannah/fragment_counts/summary \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.raw \n# A tibble: 6 × 13\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr11:… chr11 6.16e7 6.16e7 +             971        542        785        640\n2 chr11:… chr11 6.16e7 6.16e7 +            1267        562       1059        564\n3 chr11:… chr11 6.16e7 6.16e7 +            1183        641       1118        655\n4 chr11:… chr11 6.16e7 6.16e7 +            1020        476       1086        584\n5 chr11:… chr11 6.16e7 6.16e7 +            1138        580        894        565\n6 chr11:… chr11 6.16e7 6.16e7 +             702        406        745        318\n# ℹ 4 more variables: Output.rep1 &lt;int&gt;, Output.rep2 &lt;int&gt;, Output.rep3 &lt;int&gt;,\n#   Output.rep4 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.norm \n# A tibble: 6 × 16\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr11:… chr11 6.16e7 6.16e7 +            532.       531.       481.       621.\n2 chr11:… chr11 6.16e7 6.16e7 +            694.       551.       649.       548.\n3 chr11:… chr11 6.16e7 6.16e7 +            648.       628.       685.       636.\n4 chr11:… chr11 6.16e7 6.16e7 +            559.       466.       666.       567.\n5 chr11:… chr11 6.16e7 6.16e7 +            624.       568.       548.       549.\n6 chr11:… chr11 6.16e7 6.16e7 +            385.       398.       457.       309.\n# ℹ 7 more variables: Output.rep1 &lt;dbl&gt;, Output.rep2 &lt;dbl&gt;, Output.rep3 &lt;dbl&gt;,\n#   Output.rep4 &lt;dbl&gt;, Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;, Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.raw \n# A tibble: 6 × 16\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr8:1… chr8  1.27e8 1.27e8 +            1190       1409       1259       1179\n2 chr8:1… chr8  1.27e8 1.27e8 +             194        161        161        208\n3 chr8:1… chr8  1.27e8 1.27e8 +             746        757        708        704\n4 chr8:1… chr8  1.27e8 1.27e8 +             934       1056        988        985\n5 chr8:1… chr8  1.27e8 1.27e8 +             697        887        772        796\n6 chr8:1… chr8  1.27e8 1.27e8 +            1225       1454       1264       1256\n# ℹ 7 more variables: Input.rep5 &lt;int&gt;, Input.rep6 &lt;int&gt;, Output.rep1 &lt;int&gt;,\n#   Output.rep2 &lt;int&gt;, Output.rep3 &lt;int&gt;, Output.rep4 &lt;int&gt;, Output.rep5 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.norm \n# A tibble: 6 × 19\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr8:1… chr8  1.27e8 1.27e8 +            801.      840.        807.       741.\n2 chr8:1… chr8  1.27e8 1.27e8 +            131.       96.0       103.       131.\n3 chr8:1… chr8  1.27e8 1.27e8 +            502.      451.        454.       442.\n4 chr8:1… chr8  1.27e8 1.27e8 +            629.      629.        633.       619.\n5 chr8:1… chr8  1.27e8 1.27e8 +            469.      529.        495.       500.\n6 chr8:1… chr8  1.27e8 1.27e8 +            825.      867.        810.       789.\n# ℹ 10 more variables: Input.rep5 &lt;dbl&gt;, Input.rep6 &lt;dbl&gt;, Output.rep1 &lt;dbl&gt;,\n#   Output.rep2 &lt;dbl&gt;, Output.rep3 &lt;dbl&gt;, Output.rep4 &lt;dbl&gt;, Output.rep5 &lt;dbl&gt;,\n#   Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;, Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.raw \n# A tibble: 6 × 13\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr11:… chr11 4.51e6 4.51e6 +             811        664        917        815\n2 chr11:… chr11 4.51e6 4.51e6 +             693        552        607        551\n3 chr11:… chr11 4.51e6 4.51e6 +             577        414        448        371\n4 chr11:… chr11 4.51e6 4.51e6 +             855        754        688        812\n5 chr11:… chr11 4.51e6 4.51e6 +             317        217        313        280\n6 chr11:… chr11 4.51e6 4.51e6 +             444        422        454        473\n# ℹ 4 more variables: Output.rep1 &lt;int&gt;, Output.rep2 &lt;int&gt;, Output.rep3 &lt;int&gt;,\n#   Output.rep4 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.norm \n# A tibble: 6 × 16\n  Name    Chrom  Start    End Strand Input.rep1 Input.rep2 Input.rep3 Input.rep4\n  &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr11:… chr11 4.51e6 4.51e6 +            597.       577.       776.       702.\n2 chr11:… chr11 4.51e6 4.51e6 +            510.       480.       514.       474.\n3 chr11:… chr11 4.51e6 4.51e6 +            425.       360.       379.       319.\n4 chr11:… chr11 4.51e6 4.51e6 +            629.       655.       582.       699.\n5 chr11:… chr11 4.51e6 4.51e6 +            233.       189.       265.       241.\n6 chr11:… chr11 4.51e6 4.51e6 +            327.       367.       384.       407.\n# ℹ 7 more variables: Output.rep1 &lt;dbl&gt;, Output.rep2 &lt;dbl&gt;, Output.rep3 &lt;dbl&gt;,\n#   Output.rep4 &lt;dbl&gt;, Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;, Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_02_run_download_data_SH.html",
    "href": "notebooks/01_data_download/region_ocr_02_run_download_data_SH.html",
    "title": "ENCODE ATAC/DNase Peaks: Download the peak data",
    "section": "",
    "text": "set environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_02_run_download_data_SH.html#run-download-script",
    "href": "notebooks/01_data_download/region_ocr_02_run_download_data_SH.html#run-download-script",
    "title": "ENCODE ATAC/DNase Peaks: Download the peak data",
    "section": "Run download script",
    "text": "Run download script\n\nFD_OUT=${FD_DAT}/external/encode_open_chromatin\n\ncd ${FD_OUT}\nchmod +x ./run_download.sh\n\n./run_download.sh"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html",
    "title": "Get K562 STARR-seq data from Reddy lab",
    "section": "",
    "text": "In this analysis, we are using the fragment counts data processed and shared by Alex from the Reddy lab.\nSet environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html#check-existence-of-starr-data",
    "href": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html#check-existence-of-starr-data",
    "title": "Get K562 STARR-seq data from Reddy lab",
    "section": "Check existence of STARR data",
    "text": "Check existence of STARR data\n### WSTARR\nFD_WGS_WSTARR=${FD_ALEX}/encode4_duke/data/starr_seq\nFP_WGS_WSTARR=($(ls ${FD_WGS_WSTARR}/fragments/*.fragments.counts.txt.gz))\n\n### ASTARR\nFP_WGS_ASTARR_INP=($(ls ${FD_WGS_ASTARR_INP}/merged2/*counts.txt.gz))\nFP_WGS_ASTARR_OUT=($(ls ${FD_WGS_ASTARR_OUT}/*f3q10.fragments.counts.txt.gz))\nFP_WGS_ASTARR=(\"${FP_WGS_ASTARR_INP[@]}\" \"${FP_WGS_ASTARR_OUT[@]}\")\n\nFN_WGS_ASTARR_INP_PEAKS=(\n    \n    ### MACS peak set (union)\n    KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n    \n    ### MACS peak set (intersect; overlap)\n    KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n)\n\nls ${FD_WGS_WSTARR}\n\nfragments  metadata  motifs  peaks  processed_raw_reads  qc  raw_reads\n\n\n\nfor FPATH in ${FP_WGS_WSTARR[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\nfor FPATH in ${FP_WGS_ASTARR[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\n\nfor FPATH in ${FP_WGS_ASTARR_INP_PEAKS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html#set-data-directories-and-copy-the-data-files",
    "href": "notebooks/01_data_download/fcc_starrmpra_01_acquire_STARR_data_alex_SH.html#set-data-directories-and-copy-the-data-files",
    "title": "Get K562 STARR-seq data from Reddy lab",
    "section": "Set data directories and copy the data files",
    "text": "Set data directories and copy the data files\nCreate data directories\n\nmkdir -p ${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\nmkdir -p ${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nmkdir -p ${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\n\nCopy data files\n\nFD_OUT=${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\n\nfor FPATH in ${FP_WGS_WSTARR[@]}; do\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    echo ${FPATH}\n    echo ${FNAME}\n    echo\ndone\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments/A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\n\nFD_OUT=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\n\nfor FPATH in ${FP_WGS_ASTARR[@]}; do\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    echo ${FPATH}\n    echo ${FNAME}\n    echo\ndone\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\n\n\nFD_OUT=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\n\nfor FPATH in ${FP_WGS_ASTARR_INP_PEAKS[@]}; do\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    echo ${FPATH}\n    echo ${FNAME}\n    echo\ndone\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\nCheck results\n\nls ${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\n\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\nls ${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/*\n\n/data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments:\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/peaks:\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\ndu -sh ${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\n\n9.8G    /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments\n\n\n\ndu -sh ${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401\n\n24G /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html",
    "title": "Prepare K562 STARR-seq data from Reddy lab",
    "section": "",
    "text": "Link from KS91_K562_hg38_ASTARRseq_210401 to STARR_ATAC_K562_Reddy_KS91\nLink from A001_K562_hg38_WSTARRseq to STARR_WHG_K562_Reddy_A001\nSet environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\nmkdir -p ${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nmkdir -p ${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nmkdir -p ${FD_RES}/region/starr_macs"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#link-fragment-counts-of-astarr",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#link-fragment-counts-of-astarr",
    "title": "Prepare K562 STARR-seq data from Reddy lab",
    "section": "Link fragment counts of ASTARR",
    "text": "Link fragment counts of ASTARR\nData: Original files\nPROJECT/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n\nASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\nCheck data\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nls -lh ${FD_INP}\n\ntotal 24G\n-rw-r--r-- 1 kk319 reddylab 3.0G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.8G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 4.0G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.8G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.7G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.4G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 306M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 569M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 642M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 1.1G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\nList file names and links\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nFN_INPS=(\n    KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n)\n\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUTS=(\n    ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\n)\n\nLoop and Link\n\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ ! -e ${LINK} ]]; then\n        ln -s ${FILE} ${LINK}\n    fi\ndone\n\nCheck results\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nls -l ${FD_OUT}\n\ntotal 10\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\nExplore file and check\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head\n\nchr1    10001   10143   chr1_10001_10143    1   .\nchr1    10002   10118   chr1_10002_10118    1   .\nchr1    10002   10131   chr1_10002_10131    1   .\nchr1    10002   10203   chr1_10002_10203    1   .\nchr1    10002   10209   chr1_10002_10209    1   .\nchr1    10002   10227   chr1_10002_10227    1   .\nchr1    10002   10436   chr1_10002_10436    1   .\nchr1    10003   10113   chr1_10003_10113    1   .\nchr1    10003   10118   chr1_10003_10118    1   .\nchr1    10003   10119   chr1_10003_10119    1   ."
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#link-fragment-counts-of-wstarr",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#link-fragment-counts-of-wstarr",
    "title": "Prepare K562 STARR-seq data from Reddy lab",
    "section": "Link fragment counts of WSTARR",
    "text": "Link fragment counts of WSTARR\nData: Original files\nPROJECT/data/processed/A001_K562_hg38_WSTARRseq/fragments\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nCheck data\n\nFD_INP=${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\nls -lh ${FD_INP}\n\ntotal 9.8G\n-rw-r--r-- 1 kk319 reddylab  284M Feb 23 10:03 A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 1022M Feb 23 10:03 A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Feb 23 10:03 A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Feb 23 10:03 A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Feb 23 10:03 A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Feb 23 10:03 A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  3.2G Feb 23 10:03 A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\nList file names and links\n\nFD_INP=${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\nFN_INPS=(\n    A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n)\n\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUTS=(\n    WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\n)\n\nLoop and Link\n\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ ! -e ${LINK} ]]; then\n        ln -s ${FILE} ${LINK}\n    fi\ndone\n\nCheck results\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nls -lh ${FD_OUT}\n\ntotal 7.0K\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\nExplore file and check\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUT=WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head\n\nchr1    10335   10549   chr1_10335_10549    1   .\nchr1    16983   17500   chr1_16983_17500    1   .\nchr1    16985   17499   chr1_16985_17499    1   .\nchr1    17004   17500   chr1_17004_17500    1   .\nchr1    17483   17898   chr1_17483_17898    1   .\nchr1    17487   17941   chr1_17487_17941    1   .\nchr1    33606   33997   chr1_33606_33997    1   .\nchr1    33617   33997   chr1_33617_33997    1   .\nchr1    38785   39226   chr1_38785_39226    1   .\nchr1    46328   46678   chr1_46328_46678    1   ."
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#prepare-regions",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_STARR_data_alex_SH.html#prepare-regions",
    "title": "Prepare K562 STARR-seq data from Reddy lab",
    "section": "Prepare regions",
    "text": "Prepare regions\nData: Original files\nPROJECT/data/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nResults: SymLinks\nPROJECT/results/region/starr_macs\nASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nCheck data\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nls -lh ${FD_INP}\n\ntotal 9.5M\n-rw-r--r-- 1 kk319 reddylab 5.7M Feb 26 17:43 KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n-rw-r--r-- 1 kk319 reddylab 3.8M Feb 26 17:43 KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\nchr1    10038   10405   6\nchr1    14282   14614   6\nchr1    16025   16338   6\nchr1    17288   17689   6\nchr1    28934   29499   6\nchr1    115429  115969  6\nchr1    136201  137353  6\nchr1    137748  138049  6\nchr1    138321  139517  6\nchr1    181005  181854  6\n\n\nLink: union peak file\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nif [[ ! -e ${FP_OUT} ]]; then\n    ln -s ${FP_INP} ${FP_OUT}\nfi\n\nUpdate: overlap peak file\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_INP} | cut -f1-3 &gt; ${FP_OUT}\n\nCreate metadata\n\nTAB=\"$(printf '\\t')\"\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=description.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat &gt; ${FP_OUT} &lt;&lt; EOF\nName${TAB}Note\nChrom${TAB}Name of the chromosome\nChromStart${TAB}The starting position of the feature in the chromosome\nChromEnd${TAB}The ending position of the feature in the chromosome\nEOF\n\nCheck results\n\nFD_OUT=${FD_RES}/region/starr_macs\nls -lh ${FD_OUT}\n\ntotal 3.6M\n-rw-rw-r-- 1 kk319 reddylab 3.5M Feb 26 17:47 ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nlrwxrwxrwx 1 kk319 reddylab  175 Feb 26 17:44 ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/peaks/KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n-rw-rw-r-- 1 kk319 reddylab  183 Feb 26 17:55 description.tsv\n\n\nExplore file and check\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT} | head\n\nchr1    10038   10405\nchr1    14282   14614\nchr1    16025   16338\nchr1    17288   17689\nchr1    28934   29499\nchr1    115429  115969\nchr1    136201  137353\nchr1    137748  138049\nchr1    138321  139517\nchr1    181005  181854\n\n\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT} | head\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=description.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT}\n\nName    Note\nChrom   Name of the chromosome\nChromStart  The starting position of the feature in the chromosome\nChromEnd    The ending position of the feature in the chromosome"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_04_create_metadata_R.html",
    "href": "notebooks/01_data_download/region_ocr_04_create_metadata_R.html",
    "title": "Define metadata",
    "section": "",
    "text": "Set environment\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_CombEffect_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_CombEffect_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_CombEffect_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_CombEffect_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_CombEffect_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_CombEffect_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_CombEffect_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_CombEffect_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_CombEffect_ENCODE_FCC/references\n### ENCODE narrowPeak: Narrow (or Point-Source) Peaks format\ndat = tribble(\n    ~Name, ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Name given to a region; Use '.' if no name is assigned.\",\n    \"Score\",      \"Indicates how dark the peak will be displayed in the browser (0-1000).\",\n    \"Strand\",     \"+/- to denote strand or orientation. Use '.' if no orientation is assigned.\",\n    \"SignalValue\",\"Measurement of overall (usually, average) enrichment for the region.\",\n    \"PValue\",     \"Measurement of statistical significance (-log10). Use -1 if no pValue is assigned.\",\n    \"QValue\",     \"Measurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\",\n    \"Peak\",       \"Point-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called.\"\n    \n)\n\n### assign and show\ndat_cnames = dat\nIRdisplay::display(dat)\n\n\nA tibble: 10 × 2\n\n\nName\nNote\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nIndicates how dark the peak will be displayed in the browser (0-1000).\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\nSignalValue\nMeasurement of overall (usually, average) enrichment for the region.\n\n\nPValue\nMeasurement of statistical significance (-log10). Use -1 if no pValue is assigned.\n\n\nQValue\nMeasurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\n\n\nPeak\nPoint-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called."
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_04_create_metadata_R.html#save-results",
    "href": "notebooks/01_data_download/region_ocr_04_create_metadata_R.html#save-results",
    "title": "Define metadata",
    "section": "Save results",
    "text": "Save results\n\nfdiry = file.path(FD_DAT, \"external\", \"encode_open_chromatin\")\nfname = \"description.tsv\"\nfpath = file.path(fdiry, fname)\n\nwrite_tsv(dat_cnames, fpath)"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_11_acquire_TMPRA_data_hannah_SH.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_11_acquire_TMPRA_data_hannah_SH.html",
    "title": "Get K562 MPRA data from Tewhey’s lab",
    "section": "",
    "text": "ENCODE FCC K562 Tiling MPRA from Tewhey’s lab\n\nENCODE MPRA K562 OL43-GATA/MYC region\n\nHomo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci\n\n[ENCODE MPRA]\n\nhttps://www.encodeproject.org/search/?type=File&searchTerm=OL43&file_format=bed\nIn this analysis, we are using the unnormalized and normalized data processed and shared by Hannah from the Tewhey lab.\nMPRA of multiple loci in K562 Homo sapiens K562, 48 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: FEN1, FADS1, FADS2, FADS3 Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR394HXI\nryan-tewhey:mpra-OL13-fads-k562\nMPRA of multiple loci in K562 Homo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: GATA1, MYC Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR917SFD\nryan-tewhey:mpra-OL43-gata_myc_ctrl-k562\nMPRA of multiple loci in K562 Homo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: LMO2, HBE1, RBM38, HBA2, BCL11A Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR363XER\nryan-tewhey:mpra-OL45-common_ctrl-k562\nSet environment\n\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\n\n\n\n\nls ${FD_WORK}/proj_combeffect_encode_fcc/source\n\nA001_K562_wstarrseq_fragments\nA001_K562_wstarrseq_fragments_wgs\nannotation_cCREs\nannotation_chipseq_histone\nannotation_chipseq_tf\nannotation_chromHMM\nannotation_enhancer_junke\nannotation_enhancer_junke_zscore\nannotation_enhancer_junke_zscore_prev\nannotation_gencode\nannotation_gene\nannotation_remap2022\nannotation_starrseq_negative_control_junke\nchrom.sizes.hg19\nchrom.sizes.hg38\nCRISPRi_FlowFISH\nCRISPRi_growth\nENCODE_E2G\nhic_insitu_GM12878\nhic_intact_K562_deep\nhic_intact_K562_ENCSR479XDG\nKS91_K562_astarrseq_fragments_220510\nKS91_K562_astarrseq_fragments_wgs\nKS91_K562_astarrseq_peak_macs\nMPRA\nReadme.md\nRNAseq\nTF_modules\ntmp\n\n\n\nls ${FD_WORK}/proj_combeffect_encode_fcc/source/MPRA\n\nENCFF460YVY.bed.gz         MPRA_TilingMPRA_K562_Tewhey  syn26435687\nMPRA_LentiMPRA_K562_Nadav  syn22348180\n\n\n\nFDIRY=${FD_WORK}/proj_combeffect_encode_fcc/source\nFDIRY=${FDIRY}/MPRA\nFDIRY=${FDIRY}/MPRA_TilingMPRA_K562_Tewhey\n\nls ${FDIRY}/tiling_counts\n\nFADS_tile_snp.20190214.attributes\nOL13_20220512_counts.out\nOL13_20220512_normalized_counts.out\nOL43_20211228_counts.out\nOL43_20211228_normalized_counts.out\nOL43_20221003_counts.out\nOL43_20221003_K562_normalized_counts.out\nOL43.attributes\nOL43_K562.bed\nOL45_20220927_counts.out\nOL45_20220927_K562_normalized_counts.out\nOL45.attributes\nOL45_K562.bed\n\n\n\nls ${FD_DAT}/processed\n\nA001_K562_hg38_WSTARRseq           KS91_K562_hg38_ASTARRseq_Jamboree\nA001_K562_hg38_WSTARRseq_Jamboree  MPRA_Tiling_K562_Tewhey_hannah\nKS91_K562_hg38_ASTARRseq_210401\n\n\n\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah\n\ntiling_counts.tar.gz\n\n\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah\nFNAME=tiling_counts.tar.gz\nFPATH=${FDIRY}/${FNAME}\n\ntar -xf ${FPATH} -C ${FDIRY}\n\n\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah\n\ntiling_counts  tiling_counts.tar.gz\n\n\n\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\n\nFADS_tile_snp.20190214.attributes\nOL13_20220512_counts.out\nOL13_20220512_normalized_counts.out\nOL43_20211228_counts.out\nOL43_20211228_normalized_counts.out\nOL43_20221003_counts.out\nOL43_20221003_K562_normalized_counts.out\nOL43.attributes\nOL43_K562.bed\nOL45_20220927_counts.out\nOL45_20220927_K562_normalized_counts.out\nOL45.attributes\nOL45_K562.bed\nUKBB_GTEx"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the ENCODE FCC project and working group",
    "section": "",
    "text": "The ENCODE consortium has identified millions of elements with regulatory potential throughout the human genome. These technologies have been utilized to evaluate the functionality of these elements by systematically measuring their regulatory effects. Together, tens of billions of DNA fragments were assayed in high-throughput reporter assays and millions of locations were perturbed in CRISPR screens.\nThe compilation and analysis of data and results involve joint effort spanning multiple laboratories and collaboration across various ENCODE working groups. Among them, the ENCODE Functional Characterization Center (FCC) working group has systematically studied the regulatory regions and their effects as identified and quantified by these functional assays. The group developed analysis methods and sequence models to identify similarities and differences among those identified regulatory elements, based on their regulatory activities and sequence features. Furthermore, the group has integrated multiple genomic annotations, ChIP-seq data, and physical interactions from ENCODE, providing a comprehensive characterization of these regulatory regions."
  },
  {
    "objectID": "notebooks/test/test_notebook.html",
    "href": "notebooks/test/test_notebook.html",
    "title": "Test ipynb for documentation",
    "section": "",
    "text": "Code\nsuppressMessages(suppressWarnings(library(\"tidyverse\")))\n\n\n\n\nCode\nset.seed(123)\ndat = data.frame(\n    x = rnorm(1000),\n    y = rnorm(1000),\n    z = sample(c(\"a\", \"b\"), size = 1000, replace = TRUE)\n)\n\n\n\n\nCode\ngpt = ggplot(dat, aes(x=x, y=y, color=z)) + geom_point() + theme_bw()\n\noptions(repr.plot.height=5, repr.plot.width=6)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_02_execute_download_data_SH.html",
    "href": "notebooks/01_data_download/region_ocr_02_execute_download_data_SH.html",
    "title": "ENCODE ATAC/DNase Peaks: Download the peak data",
    "section": "",
    "text": "set environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_02_execute_download_data_SH.html#run-download-script",
    "href": "notebooks/01_data_download/region_ocr_02_execute_download_data_SH.html#run-download-script",
    "title": "ENCODE ATAC/DNase Peaks: Download the peak data",
    "section": "Run download script",
    "text": "Run download script\n\nFD_OUT=${FD_DAT}/external/encode_open_chromatin\n\ncd ${FD_OUT}\nchmod +x ./run_download.sh\n\n./run_download.sh"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html",
    "title": "Explore files of Tiling MPRA data",
    "section": "",
    "text": "Set environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah\n\ntiling_counts  tiling_counts.tar.gz\nFDIRY=${FD_DAT}\nFDIRY=${FDIRY}/processed/MPRA_Tiling_K562_Tewhey_hannah\nFDIRY=${FDIRY}/tiling_counts\n\nls ${FDIRY}\n\nFADS_tile_snp.20190214.attributes\nOL13_20220512_counts.out\nOL13_20220512_normalized_counts.out\nOL43_20211228_counts.out\nOL43_20211228_normalized_counts.out\nOL43_20221003_counts.out\nOL43_20221003_K562_normalized_counts.out\nOL43.attributes\nOL43_K562.bed\nOL45_20220927_counts.out\nOL45_20220927_K562_normalized_counts.out\nOL45.attributes\nOL45_K562.bed\nUKBB_GTEx"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol13",
    "href": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol13",
    "title": "Explore files of Tiling MPRA data",
    "section": "Raw and normalized barcode count matrix for OL13",
    "text": "Raw and normalized barcode count matrix for OL13\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL13_20220512_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  k562_r1 k562_r2 k562_r3 k562_r4\n(11:61555216-61555415;11:61555315:T:C_A_wC) 1609    1221    1396    798 845 283 574 1223\n(11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   1179    582 1225    721 476 416 912 956\n(11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   1066    643 1206    681 470 846 540 847\n(11:61555330:T:C_A_wC;11:61555231-61555430) 1063    701 786 416 357 568 599 518\n(11:61555366-61555565_RC;11:61555465:A:G_A_wC_RC)   1239    722 1341    682 311 421 604 556\n(11:61555366-61555565;11:61555465:A:G_A_wC) 1362    885 1213    856 407 49  519 344\n(11:61555581-61555780;11:61555680:G:A_A_wC) 673 290 468 362 193 173 378 378\n(11:61555666-61555865_RC;11:61555765:C:T_A_wC_RC)   1361    767 1204    737 3814    3572    4659    4902\n(11:61555666-61555865;11:61555765:C:T_A_wC) 452 336 416 251 628 831 847 1035\n\n\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL13_20220512_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  k562_r1 k562_r2 k562_r3 k562_r4\n(11:61555216-61555415;11:61555315:T:C_A_wC) 881.850959258118    1196.39755882377    855.53173555782 774.925715691881    1807.94704620301    569.644913020602    730.47466819187 1493.44488237891\n(11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   646.179167784538    570.273037866859    750.735226402815    700.152181721611    1018.44117632264    837.357893344772    1160.61480381705    1167.40254092742\n(11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   584.246813281015    630.043923279021    739.091169830036    661.308787451342    1005.60368250345    1702.89610040788    687.206133839042    1034.29911314386\n(11:61555330:T:C_A_wC;11:61555231-61555430) 582.602591480037    686.875256949601    481.696235063357    403.971300410805    763.830882241981    1143.31558514382    762.289766980715    632.546565063185\n(11:61555366-61555565_RC;11:61555465:A:G_A_wC_RC)   679.063603804107    707.452119140674    821.82525600504 662.279872308098    665.410096294835    847.42229110132 768.652786738484    678.949594932685\n(11:61555366-61555565;11:61555465:A:G_A_wC) 746.476697644224    867.167763766615    743.381085409481    831.248637383772    870.809997401922    98.6310980141679    660.481450856412    420.069533555474\n(11:61555581-61555780;11:61555680:G:A_A_wC) 368.853757352836    284.156668352902    286.811498740014    351.532718145941    412.939384517373    348.228162376552    481.044293687329    461.588033965027\n(11:61555666-61555865_RC;11:61555765:C:T_A_wC_RC)   745.928623710565    751.5453952644  737.865479664481    715.689539429719    8160.36690440032    7190.00575727771    5929.06181028907    5985.99085316551\n(11:61555666-61555865;11:61555765:C:T_A_wC) 247.729418014089    329.229795057156    254.943554435568    243.742299045942    1343.65768640886    1672.70290713824    1077.89554696605    1263.87199776138"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol43",
    "href": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol43",
    "title": "Explore files of Tiling MPRA data",
    "section": "Raw and normalized barcode count matrix for OL43",
    "text": "Raw and normalized barcode count matrix for OL43\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL43_20221003_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  plasmid_r5  plasmid_r6  K562_r1 K562_r2 K562_r3 K562_r4 K562_r5\n(8:127381651-127381850;8:127320401-127320600)   1318    1810    1477    1505    738 687 620 636 781 520 538\n(8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC) 634 730 698 761 316 343 158 194 268 141 251\n(8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC) 416 432 418 409 181 211 11164   6818    12118   9512    10450\n(8:128176951-128177150;Nadav:negCtrl:seq31802.neg5.MYC) 1150    1271    1325    1255    597 580 14919   9299    28832   15790   19501\n(X:48782961-48783160;Nadav:posCtrl:ENSG00000102317.270  345 370 389 373 211 187 17116   10370   22126   16725   18361\n(X:48800591-48800790;Nadav:posCtrl:pos2.GATA1)  1008    1075    1137    1049    531 528 9987    7807    13192   9978    11306\n(X:48801781-48801980;Nadav:negCtrl:neg1.GATA1)  334 390 383 391 145 164 4853    2861    4438    3504    3545\n(X:49154578:NA:NA;X:49298001-49298200)  2194    2534    2366    2443    1117    1166    1322    823 1698    1174    1148\n(X:49322601-49322800;X:49551851-49552050)   2164    2372    2184    2371    1181    1087    4503    3182    5161    3330    3702\n\n\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL43_20221003_K562_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  plasmid_r5  plasmid_r6  K562_r1 K562_r2 K562_r3 K562_r4 K562_r5\n(8:127381651-127381850;8:127320401-127320600)   887.446571765428    1078.77146597825    946.831377196138    945.721918068606    962.323494733561    893.908535925291    961.772509595888    1136.66734809629    842.970579975295    896.665375538462    760.144341851228\n(8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC) 426.890080803703    435.084624400067    447.453149142115    478.202245614757    412.051794492961    446.303679508552    245.096865348629    346.719285425598    289.265192616363    243.134265290237    354.639832350666\n(8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC) 280.104532514733    257.474736631273    267.959049199719    257.010142518312    236.017008870968    274.54832762771 17318.1101566589    12185.2169486171    13079.5358362876    16402.0789463882    14764.885450456\n(8:128176951-128177150;Nadav:negCtrl:seq31802.neg5.MYC) 774.327433634478    757.524051523953    849.391722941695    788.625253937608    778.464940861702    754.682606749154    23143.0388236469    16619.2919338796    31119.7538563991    27227.5889995237    27553.1130305591\n(X:48782961-48783160;Nadav:posCtrl:ENSG00000102317.270  232.298230090343    220.522343874007    249.368588848543    234.388222883448    275.1358501203  243.320081831193    26551.1262487794    18533.3968549662    23881.6479545882    28839.8623190015    25942.3982541457\n(X:48800591-48800790;Nadav:posCtrl:pos2.GATA1)  678.714828785699    640.706809904209    728.874255837515    659.177602693666    692.403490113172    687.021407523368    15492.2936344099    13952.7704191631    14238.7553022204    17205.62907139  15974.3344404646\n(X:48801781-48801980;Nadav:negCtrl:neg1.GATA1)  224.891619855579    232.442470569899    245.52228670692 245.69918270088 189.07439937177 213.393012942864    7528.19675656265    5113.21585362183    4790.14524190827    6042.1451459361 5008.75779156618\n(X:49154578:NA:NA;X:49298001-49298200)  1477.28207773395    1510.28005236955    1516.72514451324    1535.14860188811    1456.52485585012    1517.17227494744    2050.74718981575    1470.87614384158    1832.73245172606    2024.39452092722    1622.01803800225\n(X:49322601-49322800;X:49551851-49552050)   1457.08223163914    1413.72702613282    1400.05397955069    1489.90476261838    1539.97838384869    1414.37929920057    6985.26066243594    5686.9111661044 5570.51365333226    5742.107116429  5230.58430024767"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol45",
    "href": "notebooks/01_data_download/fcc_starrmpra_12_explore_TMPRA_data_hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol45",
    "title": "Explore files of Tiling MPRA data",
    "section": "Raw and normalized barcode count matrix for OL45",
    "text": "Raw and normalized barcode count matrix for OL45\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL45_20220927_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  K562_r1 K562_r2 K562_r3 K562_r4\n(Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270    897 717 761 724 56816   37391   36946   52349\n1:10437778:C:T:R:wC 645 437 491 493 2239    1698    1202    2532\n1:10451799:C:T:R:wC 603 584 512 429 336 280 321 333\n1:110198727:C:G:R:wC    681 589 628 550 46046   37138   33992   53823\n1:110881742:NA:NA   930 795 874 765 24701   18211   17386   29053\n1:111838694:C:T:R:wC    834 579 755 763 34228   34188   32379   37480\n1:113047064:NA:NA   635 500 560 550 390 326 243 574\n1:119063648:C:T:R:wC    539 483 512 471 338 200 139 172\n1:171893999:A:T:R:wC    848 660 722 725 705 694 668 801\n\n\n\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_hannah/tiling_counts\nFNAME=OL45_20220927_K562_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  K562_r1 K562_r2 K562_r3 K562_r4\n(Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270    660.352667442521    622.944710266239    644.22828252883 623.288796155809    69961.0133424845    56175.0918266184    62517.7361729988    58457.7541026999\n1:10437778:C:T:R:wC 474.83553010081 379.674809464918    415.658458241335    424.421790752505    2757.01754565303    2551.02313181242    2033.95005900354    2827.46630094245\n1:10451799:C:T:R:wC 443.916007210524    507.391507385611    433.436111241473    369.324438606135    413.737336015819    420.663413962001    543.176346871992    371.85871967371\n1:110198727:C:G:R:wC    501.337978292483    511.735612757064    531.636480194619    473.492870007866    56699.2540898346    55794.9923847171    57519.1600712547    60103.7593663607\n1:110881742:NA:NA   684.646578284888    690.712754060892    739.888986767671    658.585537374577    30415.8510027582    27359.6479702214    29419.5139150045    32443.2774254664\n1:111838694:C:T:R:wC    613.973383107093    503.047402014159    639.148953100219    656.863745120003    42147.0283843734    51363.0028447603    54789.7412316768    41853.6480882002\n1:113047064:NA:NA   467.473738936456    434.410537145215    474.070746670361    473.492870007866    480.230836446933    489.772403398615    411.189570996555    640.981696975104\n1:119063648:C:T:R:wC    396.800543758661    419.640578882278    433.436111241473    405.48207595219 416.200058254009    300.473867115715    235.207203162638    192.071170522157\n1:171893999:A:T:R:wC    624.279890737188    573.421909031684    611.212641242859    624.149692283096    868.109588961764    1042.64431889153    1130.34828570246    894.470974350276"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_14_convert_table_to_bed_R.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_14_convert_table_to_bed_R.html",
    "title": "Covert count matrix to bed format",
    "section": "",
    "text": "Set environment\n\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_CombEffect_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_CombEffect_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_CombEffect_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_CombEffect_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_CombEffect_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_CombEffect_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_CombEffect_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_CombEffect_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_CombEffect_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html",
    "title": "Link fragment counts of ASTARR",
    "section": "",
    "text": "Link from KS91_K562_hg38_ASTARRseq_210401 to STARR_ATAC_K562_Reddy_KS91\nLink from A001_K562_hg38_WSTARRseq to STARR_WHG_K562_Reddy_A001\nSet environment\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\nmkdir -p ${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nmkdir -p ${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nmkdir -p ${FD_RES}/region/starr_macs\nData: Original files\nPROJECT/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nCheck data\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nls -lh ${FD_INP}\n\ntotal 24G\n-rw-r--r-- 1 kk319 reddylab 3.0G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.8G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 4.0G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.8G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.7G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 3.4G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 306M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 569M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 642M Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 1.1G Feb 23 10:03 KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nList file names and links\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/fragments\nFN_INPS=(\n    KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n)\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUTS=(\n    ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\n)\nLoop and Link\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ ! -e ${LINK} ]]; then\n        ln -s ${FILE} ${LINK}\n    fi\ndone\nCheck results\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nls -l ${FD_OUT}\n\ntotal 10\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 181 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 175 Feb 25 13:49 ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nExplore file and check\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head\n\nchr1    10001   10143   chr1_10001_10143    1   .\nchr1    10002   10118   chr1_10002_10118    1   .\nchr1    10002   10131   chr1_10002_10131    1   .\nchr1    10002   10203   chr1_10002_10203    1   .\nchr1    10002   10209   chr1_10002_10209    1   .\nchr1    10002   10227   chr1_10002_10227    1   .\nchr1    10002   10436   chr1_10002_10436    1   .\nchr1    10003   10113   chr1_10003_10113    1   .\nchr1    10003   10118   chr1_10003_10118    1   .\nchr1    10003   10119   chr1_10003_10119    1   ."
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html#link-fragment-counts-of-wstarr",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html#link-fragment-counts-of-wstarr",
    "title": "Link fragment counts of ASTARR",
    "section": "Link fragment counts of WSTARR",
    "text": "Link fragment counts of WSTARR\nData: Original files\nPROJECT/data/processed/A001_K562_hg38_WSTARRseq/fragments\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nCheck data\n\nFD_INP=${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\nls -lh ${FD_INP}\n\ntotal 9.8G\n-rw-r--r-- 1 kk319 reddylab  284M Feb 23 10:03 A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 1022M Feb 23 10:03 A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Feb 23 10:03 A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Feb 23 10:03 A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Feb 23 10:03 A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Feb 23 10:03 A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  3.2G Feb 23 10:03 A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\nList file names and links\n\nFD_INP=${FD_DAT}/processed/A001_K562_hg38_WSTARRseq/fragments\nFN_INPS=(\n    A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n)\n\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUTS=(\n    WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\n)\n\nLoop and Link\n\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ ! -e ${LINK} ]]; then\n        ln -s ${FILE} ${LINK}\n    fi\ndone\n\nCheck results\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nls -lh ${FD_OUT}\n\ntotal 7.0K\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 159 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 153 Feb 25 13:53 WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/A001_K562_hg38_WSTARRseq/fragments/A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\nExplore file and check\n\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUT=WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head\n\nchr1    10335   10549   chr1_10335_10549    1   .\nchr1    16983   17500   chr1_16983_17500    1   .\nchr1    16985   17499   chr1_16985_17499    1   .\nchr1    17004   17500   chr1_17004_17500    1   .\nchr1    17483   17898   chr1_17483_17898    1   .\nchr1    17487   17941   chr1_17487_17941    1   .\nchr1    33606   33997   chr1_33606_33997    1   .\nchr1    33617   33997   chr1_33617_33997    1   .\nchr1    38785   39226   chr1_38785_39226    1   .\nchr1    46328   46678   chr1_46328_46678    1   ."
  },
  {
    "objectID": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html#prepare-regions",
    "href": "notebooks/01_data_download/fcc_starrmpra_03_prepare_fragment_counts_SH.html#prepare-regions",
    "title": "Link fragment counts of ASTARR",
    "section": "Prepare regions",
    "text": "Prepare regions\nData: Original files\nPROJECT/data/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nResults: SymLinks\nPROJECT/results/region/starr_macs\nASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nCheck data\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nls -lh ${FD_INP}\n\ntotal 9.5M\n-rw-r--r-- 1 kk319 reddylab 5.7M Feb 26 17:43 KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n-rw-r--r-- 1 kk319 reddylab 3.8M Feb 26 17:43 KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\nchr1    10038   10405   6\nchr1    14282   14614   6\nchr1    16025   16338   6\nchr1    17288   17689   6\nchr1    28934   29499   6\nchr1    115429  115969  6\nchr1    136201  137353  6\nchr1    137748  138049  6\nchr1    138321  139517  6\nchr1    181005  181854  6\n\n\nLink: union peak file\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nif [[ ! -e ${FP_OUT} ]]; then\n    ln -s ${FP_INP} ${FP_OUT}\nfi\n\nUpdate: overlap peak file\n\nFD_INP=${FD_DAT}/processed/KS91_K562_hg38_ASTARRseq_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_INP} | cut -f1-3 &gt; ${FP_OUT}\n\nCreate metadata\n\nTAB=\"$(printf '\\t')\"\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=description.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat &gt; ${FP_OUT} &lt;&lt; EOF\nName${TAB}Note\nChrom${TAB}Name of the chromosome\nChromStart${TAB}The starting position of the feature in the chromosome\nChromEnd${TAB}The ending position of the feature in the chromosome\nEOF\n\nCheck results\n\nFD_OUT=${FD_RES}/region/starr_macs\nls -lh ${FD_OUT}\n\ntotal 3.6M\n-rw-rw-r-- 1 kk319 reddylab 3.5M Feb 26 17:47 ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nlrwxrwxrwx 1 kk319 reddylab  175 Feb 26 17:44 ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed -&gt; /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data/processed/KS91_K562_hg38_ASTARRseq_210401/peaks/KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n-rw-rw-r-- 1 kk319 reddylab  183 Feb 26 17:55 description.tsv\n\n\nExplore file and check\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT} | head\n\nchr1    10038   10405\nchr1    14282   14614\nchr1    16025   16338\nchr1    17288   17689\nchr1    28934   29499\nchr1    115429  115969\nchr1    136201  137353\nchr1    137748  138049\nchr1    138321  139517\nchr1    181005  181854\n\n\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT} | head\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\n\nFD_OUT=${FD_RES}/region/starr_macs\nFN_OUT=description.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT}\n\nName    Note\nChrom   Name of the chromosome\nChromStart  The starting position of the feature in the chromosome\nChromEnd    The ending position of the feature in the chromosome"
  },
  {
    "objectID": "notebooks/01_data_download/region_ocr_03_explore_download_data_SH.html",
    "href": "notebooks/01_data_download/region_ocr_03_explore_download_data_SH.html",
    "title": "ENCODE FCC Project",
    "section": "",
    "text": "ln -s file link\nSet environment\n\nsource ../run_config_project.sh\nshow_env\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\n\n\n\n\nmkdir -p ${FD_RES}/region/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nmkdir -p ${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nmkdir -p ${FD_RES}/region/starr_macs\n\n\nls ${FD_DAT}/external/encode_open_chromatin\n\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\nrun_download.log.txt\nrun_download.sh\n\n\n\nFDIRY=${FD_DAT}/external/encode_open_chromatin\nFNAME=K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nFPATH=${FDIRY}/${FNAME}\nzcat ${FPATH} | head\n\nchr1    181400  181530  .   0   .   0.299874    -1  -1  75\nchr1    778660  778800  .   0   .   14.1383 -1  -1  75\nchr1    779137  779200  .   0   .   0.33144 -1  -1  75\nchr1    827460  827554  .   0   .   3.38384 -1  -1  75\nchr1    842880  843060  .   0   .   1.64457 -1  -1  75\nchr1    869800  869980  .   0   .   2.23485 -1  -1  75\nchr1    875760  875920  .   0   .   0.356692    -1  -1  75\nchr1    898828  899004  .   0   .   0.363005    -1  -1  75\nchr1    900030  900100  .   0   .   0.249369    -1  -1  75\nchr1    901580  901645  .   0   .   0.217803    -1  -1  75"
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Data and Working Environment",
    "section": "",
    "text": "Below are the main data used in the analyses. We express our sincere appreciation to the research teams and individuals involved in conducting, processing, and sharing the experiments and data that underpin our analyses.\n\n\n\nATAC-STARR (ASTARR): sequenced fragments (proccessed by Alex; experiment done by Keith)\nWHG-STARR (WSTARR): sequenced fragments (proccessed by Alex; experiment done by Kari)\nTiling MPRA (TMPRA): raw barcode count table (proccessed by Hannah)\nLenti-MPRA (LMPRA): log2 fold change of each element (shared by Vikram from the Lenti-MPRA study)\nCRISPRi-HCR FlowFISH (CRISPRi-HCRFF): z scores (proccessed by Jin Woo)\nCRISPRi-Growth screen (CRISPRi-Growth): z scores (proccessed by Jin Woo)\nATAC peaks: MACS peaks called of the ASTARR input libraries (procccessed by Alex)\n\n\n\n\n\n\n\n\nENCODE candidate cis-regulatory elements (cCREs)\nENCODE ChromHMM"
  },
  {
    "objectID": "data.html#fcc-assays-done-in-k562",
    "href": "data.html#fcc-assays-done-in-k562",
    "title": "Data and Working Environment",
    "section": "",
    "text": "ATAC-STARR (ASTARR): sequenced fragments (proccessed by Alex; experiment done by Keith)\nWHG-STARR (WSTARR): sequenced fragments (proccessed by Alex; experiment done by Kari)\nTiling MPRA (TMPRA): raw barcode count table (proccessed by Hannah)\nLenti-MPRA (LMPRA): log2 fold change of each element (shared by Vikram from the Lenti-MPRA study)\nCRISPRi-HCR FlowFISH (CRISPRi-HCRFF): z scores (proccessed by Jin Woo)\nCRISPRi-Growth screen (CRISPRi-Growth): z scores (proccessed by Jin Woo)\nATAC peaks: MACS peaks called of the ASTARR input libraries (procccessed by Alex)"
  },
  {
    "objectID": "data.html#chromatin-states-of-k562",
    "href": "data.html#chromatin-states-of-k562",
    "title": "Data and Working Environment",
    "section": "",
    "text": "ENCODE candidate cis-regulatory elements (cCREs)\nENCODE ChromHMM"
  }
]