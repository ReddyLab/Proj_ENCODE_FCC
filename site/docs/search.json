[
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "List of Figures and Tables",
    "section": "",
    "text": "This page is still under construction."
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html",
    "title": "Prepare CRISPRi HCRFF data 05",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_crispri_hcrff\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#import-data",
    "title": "Prepare CRISPRi HCRFF data 05",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.CRISPRi_HCRFF.CASA.bed.gz \nK562.hg38.CRISPRi_HCRFF.CASA.tsv \nsummary \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"description.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_cname     = dat\nvec_txt_cname = dat$Name\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nRegion location\n\n\nScore\nCASA peak score\n\n\nStrand\nDefines the strand. Either '.' (=no strand) or '+' or '-'.\n\n\nGene_Symbol\nGene symbol; Gene that is screened for CRISPRi-FlowFish\n\n\nGene_Ensembl\nGene Ensembl ID; Gene that is screened for CRISPRi-FlowFish\n\n\nGroup\nAssay Name\n\n\nLabel\nRegion Label; {Assay Name}:{Tested Gene Name}\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.CRISPRi_HCRFF.CASA.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_casa = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nGene_Symbol\nGene_Ensembl\nGroup\nLabel\n\n\n\n\nchr11\n5248847\n5249047\nchr11:5248847-5249047\n1.0686240\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5248847\n5249047\nchr11:5248847-5249047\n0.9357701\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2\n\n\nchr11\n5249847\n5250847\nchr11:5249847-5250847\n1.8908899\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5249847\n5250847\nchr11:5249847-5250847\n1.9229558\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2\n\n\nchr11\n5253147\n5253547\nchr11:5253147-5253547\n1.3303423\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5253147\n5253547\nchr11:5253147-5253547\n1.3232571\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#explore-data",
    "title": "Prepare CRISPRi HCRFF data 05",
    "section": "Explore data",
    "text": "Explore data\n\nDistribution of CASA scores\n\n\nCode\n### init\ndat = dat_region_casa\n\n### order gene by median\ntmp = dat\ntmp = tmp %&gt;%\n    dplyr::group_by(Gene_Symbol) %&gt;%\n    dplyr::summarise(\n        Score_Mean   = mean(Score),\n        Score_Median = median(Score),\n        .groups = \"drop\"\n    ) %&gt;%\n    dplyr::arrange(Score_Median)\nvec = tmp$Gene_Symbol\ndat = dat %&gt;% dplyr::mutate(Gene_Symbol = factor(Gene_Symbol, levels = vec))\n\n### create plot\nset.seed(123)\ngpt = ggplot(dat, aes(x=Score, y=Gene_Symbol)) + \n    geom_boxplot(outlier.shape = NA) +\n    geom_jitter(color=\"black\", width=0.0, height=0.1, size=2, alpha=0.7) +\n    theme_cowplot() +\n    background_grid()\n\n### show plot\noptions(repr.plot.height=10, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nDistribution of peak size\nSummary\n\n\nCode\ndat = dat_region_casa\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\ncat(\"#{Region} =\", nrow(dat), \"\\n\")\ncat(\"\\n\")\ncat(\"Length:\\n\")\nsummary(dat$Length)\n\n\n#{Region} = 113 \n\nLength:\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    200     600    1000    1343    2000    6500 \n\n\nPlot histogram\n\n\nCode\ndat = dat_region_casa\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\ngpt = ggplot(dat, aes(x = Length)) + \n    geom_histogram(bins = 50) + \n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nPlot density\n\n\nCode\ndat = dat_region_casa\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\ngpt = ggplot(dat, aes(x = Length)) + \n    geom_density() +\n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nQuestion: what is the one with 6kb\n\n\nCode\ndat = dat_region_casa\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\ndat %&gt;% dplyr::filter(Length &gt; 6000)\n\n\n\nA tibble: 1 × 11\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nGene_Symbol\nGene_Ensembl\nGroup\nLabel\nLength\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n\n\n\n\nchr4\n55634441\n55640941\nchr4:55634441-55640941\n2.268011\n.\nNMU\nENSG00000109255\nCRISPRi-HCRFF\nCRISPRi-HCRFF:NMU\n6500"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_05_explore_data_R.html#save-figures",
    "title": "Prepare CRISPRi HCRFF data 05",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\n\nDistribution of scores\n\n\nCode\n### init\ndat = dat_region_casa\n\n### order gene by median\ntmp = dat\ntmp = tmp %&gt;%\n    dplyr::group_by(Gene_Symbol) %&gt;%\n    dplyr::summarise(\n        Score_Mean   = mean(Score),\n        Score_Median = median(Score),\n        .groups = \"drop\"\n    ) %&gt;%\n    dplyr::arrange(Score_Median)\nvec = tmp$Gene_Symbol\ndat = dat %&gt;% dplyr::mutate(Gene_Symbol = factor(Gene_Symbol, levels = vec))\n\n### create plot\nset.seed(123)\ngpt = ggplot(dat, aes(x=Score, y=Gene_Symbol)) + \n    geom_boxplot(outlier.shape = NA) +\n    geom_jitter(color=\"black\", width=0.0, height=0.1, size=2, alpha=0.7) +\n    theme_cowplot() +\n    background_grid() +\n    theme_text +\n    labs(x=\"Score\", y=\"Gene\", title=\"CASA Peak calls on CRISPRi-HCRFF data\")\n\n### assign plot\ngpt_export_score = gpt\n\n### show plot\noptions(repr.plot.height=8, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nDistribution of region length\n\n\nCode\n### calculate region length\ndat = dat_region_casa\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\n### plot distribution\ngpt = ggplot(dat, aes(x = Length/1000)) + \n    geom_histogram(bins = 50) + \n    theme_cowplot() + \n    background_grid() +\n    theme_text +\n    labs(x = \"Length (kb)\", y = \"Count\", title = \"Distribution of Region Length\") +\n    scale_x_continuous(breaks = seq(0, 7, by = 1))\n\n### add annotation\ntxt = paste(\"N =\", scales::comma(nrow(dat)))\ngpt = gpt + annotate(\n    \"text\", \n    x = 5, \n    y = 12,\n    size  = 6,\n    label = txt)\n\n### assign plot\ngpt_export_length = gpt\n\n### show plot\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nSave plots\n\n\nCode\n### save plot: score distribution\nplt_export = gpt_export_score\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_hcrff.distribution.score.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 7, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_hcrff.distribution.score.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 7, units = \"in\")\n\n\n\n\nCode\n### save plot: length distribution\nplt_export = gpt_export_length\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_hcrff.distribution.region_length.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 4, width = 7, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_hcrff.distribution.region_length.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 4, width = 7, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html",
    "title": "Prepare CRISPRi HCRFF data 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_INP = \"encode_crispri_hcrff\"\nTXT_FOLDER_OUT = \"fcc_crispri_hcrff\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#import-data",
    "title": "Prepare CRISPRi HCRFF data 03",
    "section": "Import data",
    "text": "Import data\nCheck data\n\n\nCode\ntxt_folder = TXT_FOLDER_INP\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nchecksum_md5sum.txt \nchecksum_results.txt \nK562.hg38.ENCSR009KPS.ENCFF514PCW.CRISPRi_HCRFF.signal_R1.HDAC6.bw \nK562.hg38.ENCSR009KPS.ENCFF607OIW.CRISPRi_HCRFF.signal_R2.HDAC6.bw \nK562.hg38.ENCSR009KPS.ENCFF632PQY.CRISPRi_HCRFF.CASA.HDAC6.bed.gz \nK562.hg38.ENCSR157WAN.ENCFF186XBW.CRISPRi_HCRFF.signal_R1.CD164.bw \nK562.hg38.ENCSR157WAN.ENCFF270LYK.CRISPRi_HCRFF.CASA.CD164.bed.gz \nK562.hg38.ENCSR157WAN.ENCFF786CHF.CRISPRi_HCRFF.signal_R2.CD164.bw \nK562.hg38.ENCSR278YTB.ENCFF151MNC.CRISPRi_HCRFF.CASA.FEN1.bed.gz \nK562.hg38.ENCSR278YTB.ENCFF571LUW.CRISPRi_HCRFF.signal_R1.FEN1.bw \nK562.hg38.ENCSR278YTB.ENCFF666DNQ.CRISPRi_HCRFF.signal_R2.FEN1.bw \nK562.hg38.ENCSR321CEH.ENCFF114EMW.CRISPRi_HCRFF.signal_R2.LMO2.bw \nK562.hg38.ENCSR321CEH.ENCFF469FXP.CRISPRi_HCRFF.CASA.LMO2.bed.gz \nK562.hg38.ENCSR321CEH.ENCFF756AUB.CRISPRi_HCRFF.signal_R1.LMO2.bw \nK562.hg38.ENCSR382ZJS.ENCFF090IXH.CRISPRi_HCRFF.signal_R1.FADS1.bw \nK562.hg38.ENCSR382ZJS.ENCFF161WBO.CRISPRi_HCRFF.signal_R2.FADS1.bw \nK562.hg38.ENCSR382ZJS.ENCFF786ZPA.CRISPRi_HCRFF.CASA.FADS1.bed.gz \nK562.hg38.ENCSR393VDD.ENCFF270SWR.CRISPRi_HCRFF.signal_R2.NMU.bw \nK562.hg38.ENCSR393VDD.ENCFF270ZLE.CRISPRi_HCRFF.CASA.NMU.bed.gz \nK562.hg38.ENCSR393VDD.ENCFF865PZH.CRISPRi_HCRFF.signal_R1.NMU.bw \nK562.hg38.ENCSR408VHJ.ENCFF091IOP.CRISPRi_HCRFF.CASA.MYB.bed.gz \nK562.hg38.ENCSR408VHJ.ENCFF706HXQ.CRISPRi_HCRFF.signal_R1.MYB.bw \nK562.hg38.ENCSR408VHJ.ENCFF825RTL.CRISPRi_HCRFF.signal_R2.MYB.bw \nK562.hg38.ENCSR449NJV.ENCFF270GAZ.CRISPRi_HCRFF.signal_R1.HBG1.bw \nK562.hg38.ENCSR449NJV.ENCFF422LBX.CRISPRi_HCRFF.signal_R2.HBG1.bw \nK562.hg38.ENCSR449NJV.ENCFF811PPJ.CRISPRi_HCRFF.CASA.HBG1.bed.gz \nK562.hg38.ENCSR459QNY.ENCFF052MDO.CRISPRi_HCRFF.signal_R2.HBG2.bw \nK562.hg38.ENCSR459QNY.ENCFF110XZR.CRISPRi_HCRFF.signal_R1.HBG2.bw \nK562.hg38.ENCSR459QNY.ENCFF910PDZ.CRISPRi_HCRFF.CASA.HBG2.bed.gz \nK562.hg38.ENCSR496MZF.ENCFF005DTR.CRISPRi_HCRFF.CASA.PVT1.bed.gz \nK562.hg38.ENCSR496MZF.ENCFF191XOT.CRISPRi_HCRFF.signal_R2.PVT1.bw \nK562.hg38.ENCSR496MZF.ENCFF298GWM.CRISPRi_HCRFF.signal_R1.PVT1.bw \nK562.hg38.ENCSR564EPW.ENCFF283BAT.CRISPRi_HCRFF.signal_R2.HBE1.bw \nK562.hg38.ENCSR564EPW.ENCFF375NHR.CRISPRi_HCRFF.signal_R1.HBE1.bw \nK562.hg38.ENCSR564EPW.ENCFF845YHV.CRISPRi_HCRFF.CASA.HBE1.bed.gz \nK562.hg38.ENCSR630WLB.ENCFF186CEY.CRISPRi_HCRFF.signal_R2.FADS3.bw \nK562.hg38.ENCSR630WLB.ENCFF227DUX.CRISPRi_HCRFF.CASA.FADS3.bed.gz \nK562.hg38.ENCSR630WLB.ENCFF499QYP.CRISPRi_HCRFF.signal_R1.FADS3.bw \nK562.hg38.ENCSR759RSA.ENCFF130XRV.CRISPRi_HCRFF.signal_R1.HBS1L.bw \nK562.hg38.ENCSR759RSA.ENCFF279WUO.CRISPRi_HCRFF.signal_R2.HBS1L.bw \nK562.hg38.ENCSR759RSA.ENCFF337VVS.CRISPRi_HCRFF.CASA.HBS1L.bed.gz \nK562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw \nK562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz \nK562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw \nK562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz \nK562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw \nK562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw \nK562.hg38.ENCSR825SFH.ENCFF240IPT.CRISPRi_HCRFF.CASA.MYC.bed.gz \nK562.hg38.ENCSR825SFH.ENCFF309PDY.CRISPRi_HCRFF.signal_R2.MYC.bw \nK562.hg38.ENCSR825SFH.ENCFF336DNM.CRISPRi_HCRFF.signal_R1.MYC.bw \nK562.hg38.ENCSR917XEU.ENCFF413WYU.CRISPRi_HCRFF.CASA.GATA1.bed.gz \nK562.hg38.ENCSR917XEU.ENCFF596QFD.CRISPRi_HCRFF.signal_R2.GATA1.bw \nK562.hg38.ENCSR917XEU.ENCFF669ISH.CRISPRi_HCRFF.signal_R1.GATA1.bw \nK562.hg38.ENCSR940PYU.ENCFF146MPD.CRISPRi_HCRFF.signal_R2.MEF2C.bw \nK562.hg38.ENCSR940PYU.ENCFF683VQC.CRISPRi_HCRFF.signal_R1.MEF2C.bw \nK562.hg38.ENCSR940PYU.ENCFF894DJT.CRISPRi_HCRFF.CASA.MEF2C.bed.gz \nK562.hg38.ENCSR968CIN.ENCFF149IDL.CRISPRi_HCRFF.CASA.FADS2.bed.gz \nK562.hg38.ENCSR968CIN.ENCFF734CNO.CRISPRi_HCRFF.signal_R2.FADS2.bw \nK562.hg38.ENCSR968CIN.ENCFF923ZPB.CRISPRi_HCRFF.signal_R1.FADS2.bw \nK562.hg38.ENCSR979QQN.ENCFF079PDD.CRISPRi_HCRFF.signal_R1.ERP29.bw \nK562.hg38.ENCSR979QQN.ENCFF184LYJ.CRISPRi_HCRFF.signal_R2.ERP29.bw \nK562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz \nrun_download_files.sh \nrun_download.log.txt \n\n\nRead table\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_INP\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\ntxt_fname  = \"K562.hg38.*.bed.gz\"\ntxt_fglob  = file.path(txt_fdiry, txt_fname)\n\n### get file paths\nvec_txt_fpath = Sys.glob(txt_fglob)\n\n### read table\nlst = lapply(vec_txt_fpath, function(txt_fpath){\n    dat = read_tsv(txt_fpath, col_names = FALSE, show_col_types = FALSE)\n    return(dat)\n})\ndat = bind_rows(lst)\n\n### show and assign\ndat_region_import = dat\nfun_display_table(head(dat))\n\n\n\n\n\nX1\nX2\nX3\nX4\nX5\nX6\nX7\nX8\nX9\nX10\nX11\nX12\nX13\nX14\nX15\nX16\nX17\nX18\nX19\nX20\nX21\nX22\nX23\nX24\nX25\n\n\n\n\nchrX\n48786297\n48786997\nchrX:48786297-48786997:.\n-1.4253163\n.\nchrX:48786297-48786997:.\nchrX\n48802033\n48802034\n+\nNA\nNA\nHDAC6\nENSG00000094631\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA\n\n\nchrX\n48800297\n48801097\nchrX:48800297-48801097:.\n1.3966617\n.\nchrX:48800297-48801097:.\nchrX\n48802033\n48802034\n+\nNA\nNA\nHDAC6\nENSG00000094631\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA\n\n\nchrX\n48801697\n48802997\nchrX:48801697-48802997:.\n2.5875531\n.\nchrX:48801697-48802997:.\nchrX\n48802033\n48802034\n+\nNA\nNA\nHDAC6\nENSG00000094631\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA\n\n\nchr6\n109236645\n109237345\nchr6:109236645-109237345:.\n0.3466277\n.\nchr6:109236645-109237345:.\nchr6\n109382466\n109382467\n-\nNA\nNA\nCD164\nENSG00000135535\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA\n\n\nchr6\n109301445\n109302345\nchr6:109301445-109302345:.\n0.2394284\n.\nchr6:109301445-109302345:.\nchr6\n109382466\n109382467\n-\nNA\nNA\nCD164\nENSG00000135535\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA\n\n\nchr6\n109303145\n109306545\nchr6:109303145-109306545:.\n3.4797733\n.\nchr6:109303145-109306545:.\nchr6\n109382466\n109382467\n-\nNA\nNA\nCD164\nENSG00000135535\nNA\nNA\nTRUE\nNA\nNA\nNA\nNA\nNA\nTRUE\nNA"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#combine-and-arrange-the-table",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#combine-and-arrange-the-table",
    "title": "Prepare CRISPRi HCRFF data 03",
    "section": "Combine and arrange the table",
    "text": "Combine and arrange the table\n\n\nCode\n### init\ndat = dat_region_import\n\n### Select and rename columns\ndat = dat %&gt;% dplyr::select(X1, X2, X3, X5, X14, X15)\ncolnames(dat) = c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Score\", \"Gene_Symbol\", \"Gene_Ensembl\")\n\n### Arrange columns\ndat = dat %&gt;%\n    dplyr::mutate(\n        Name = paste0(Chrom, \":\", ChromStart, \"-\", ChromEnd),\n        Strand = \".\",\n        Group  = \"CRISPRi-HCRFF\",\n        Label  = paste0(\"CRISPRi-HCRFF\", \":\", Gene_Symbol)\n    ) %&gt;%\n    dplyr::select(\n        Chrom, ChromStart, ChromEnd, Name, Score, Strand, \n        Gene_Symbol, Gene_Ensembl,\n        Group, Label\n    ) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### show and assign\ndat_region_arrange = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nGene_Symbol\nGene_Ensembl\nGroup\nLabel\n\n\n\n\nchr11\n5248847\n5249047\nchr11:5248847-5249047\n1.0686240\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5248847\n5249047\nchr11:5248847-5249047\n0.9357701\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2\n\n\nchr11\n5249847\n5250847\nchr11:5249847-5250847\n1.8908899\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5249847\n5250847\nchr11:5249847-5250847\n1.9229558\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2\n\n\nchr11\n5253147\n5253547\nchr11:5253147-5253547\n1.3303423\n.\nHBG1\nENST00000330597.5\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG1\n\n\nchr11\n5253147\n5253547\nchr11:5253147-5253547\n1.3232571\n.\nHBG2\nENST00000336906.6\nCRISPRi-HCRFF\nCRISPRi-HCRFF:HBG2"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#define-column-description",
    "title": "Prepare CRISPRi HCRFF data 03",
    "section": "Define column description",
    "text": "Define column description\nChrom, ChromStart, ChromEnd, Name, Score, Strand,\nGene_Symbol, Gene_Ensembl,\nGroup, Label\n\n\nCode\n### set column name and description\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",        \"Name of the chromosome\",\n    \"ChromStart\",   \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",     \"The ending position of the feature in the chromosome\",\n    \"Name\",         \"Region location\",\n    \"Score\",        \"CASA peak score\",\n    \"Strand\",       \"Defines the strand. Either '.' (=no strand) or '+' or '-'.\",\n    \"Gene_Symbol\",  \"Gene symbol; Gene that is screened for CRISPRi-FlowFish\",\n    \"Gene_Ensembl\", \"Gene Ensembl ID; Gene that is screened for CRISPRi-FlowFish\",\n    \"Group\",        \"Assay Name\",\n    \"Label\",        \"Region Label; {Assay Name}:{Tested Gene Name}\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nRegion location\n\n\nScore\nCASA peak score\n\n\nStrand\nDefines the strand. Either '.' (=no strand) or '+' or '-'.\n\n\nGene_Symbol\nGene symbol; Gene that is screened for CRISPRi-FlowFish\n\n\nGene_Ensembl\nGene Ensembl ID; Gene that is screened for CRISPRi-FlowFish\n\n\nGroup\nAssay Name\n\n\nLabel\nRegion Label; {Assay Name}:{Tested Gene Name}"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_03_export_data_R.html#save-results",
    "title": "Prepare CRISPRi HCRFF data 03",
    "section": "Save results",
    "text": "Save results\nWrite column description\n\n\nCode\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nWrite bed file\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry = file.path(FD_RES, \"region\", txt_folder)\ntxt_cmd   = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table: cCREs\ntxt_fname = \"K562.hg38.CRISPRi_HCRFF.CASA.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region_arrange\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\nWrite table file\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry = file.path(FD_RES, \"region\", txt_folder)\ntxt_cmd   = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table: cCREs\ntxt_fname = \"K562.hg38.CRISPRi_HCRFF.CASA.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region_arrange\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nsuppressMessages(suppressWarnings(library(\"httr\")))\nsuppressMessages(suppressWarnings(library(\"jsonlite\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#import-metadata-from-reference-file",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#import-metadata-from-reference-file",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "Import metadata from reference file",
    "text": "Import metadata from reference file\nRead the table with the file accession numbers of CRISPRi HCR FlowFISH data\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_REF, \"encode_crispri_hcrff\")\ntxt_fname = \"ENCODE_K562_hg38_CRISPRi_HCRFF.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata_import = dat\nfun_display_table(head(dat))\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nTarget\nFile_Summary\nLab\n\n\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF863AVQ\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAPRIN1\nCAPRIN1_peakwise_file\nPardis Sabeti, Broad\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF444UXP\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R1\nPardis Sabeti, Broad\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF994KKV\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R2\nPardis Sabeti, Broad\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF619FXH\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAT\nCAT_peakwise_file\nPardis Sabeti, Broad\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF918VCM\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R1\nPardis Sabeti, Broad\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF965PMF\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R2\nPardis Sabeti, Broad"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#get-md5-checksums-for-each-file",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#get-md5-checksums-for-each-file",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "Get MD5 checksums for each file",
    "text": "Get MD5 checksums for each file\nHelper function\n\n\nCode\nfun_get_md5sum = function(txt_accession) {\n    ### fetch webpage info from ENCODE\n    txt_url = paste0(\"https://www.encodeproject.org/files/\", txt_accession, \"/?format=json\")\n    res = GET(txt_url, user_agent(\"encode-client/1.0\"), accept(\"application/json\"))\n    stop_for_status(res)\n\n    ### parse the page to json format\n    obj = fromJSON(content(res, \"text\", encoding=\"UTF-8\"))\n    \n    ### get the md5sum field\n    txt_md5sum = obj$md5sum\n\n    return(txt_md5sum)\n}\n\n\nAdd md5 checksum as a column\n\n\nCode\n### fetch MD5 checksum for each file\ndat = dat_metadata_import\ndat = dat %&gt;%\n    dplyr::rowwise() %&gt;%\n    dplyr::mutate(md5sum = fun_get_md5sum(Index_File))\n\n### assign and show\ndat_metadata_add_md5sum = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 60 12\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nTarget\nFile_Summary\nLab\nmd5sum\n\n\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF863AVQ\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAPRIN1\nCAPRIN1_peakwise_file\nPardis Sabeti, Broad\n379b4766e5c3be2e8a7065f17094c9be\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF444UXP\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R1\nPardis Sabeti, Broad\n74f33f50a1ba408db8c69bb6688fa29d\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF994KKV\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R2\nPardis Sabeti, Broad\n011955da3bae60136aac7f9288eb9062\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF619FXH\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAT\nCAT_peakwise_file\nPardis Sabeti, Broad\ndc50f8f98d6f866d7d253de0c9eef24d\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF918VCM\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R1\nPardis Sabeti, Broad\n580302d8d8b0754c941131f8cb9b139f\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF965PMF\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R2\nPardis Sabeti, Broad\nb4869d1b87be7e7b566d356077d38ee6"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#generate-download-commands",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#generate-download-commands",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "Generate download commands",
    "text": "Generate download commands\nwget -O FILE URL\nHelper function\n\n\nCode\n### define helper function: inner function\nfun_str_map_inner = function(txt){\n    vec1 = c(\"peak\", \"signal_R1\", \"signal_R2\")\n    vec2 = c(\"CASA\", \"signal_R1\", \"signal_R2\")\n    \n    idx = str_detect(string  = txt, pattern = vec1)\n    vec = vec2[idx]\n    return(vec)\n}\n\n### define helper function: wrapper function\nfun_str_map_label = function(vec_txt_input){\n    vec_txt_output = sapply(vec_txt_input, fun_str_map_inner)\n    return(vec_txt_output)\n}\n\n### test function\nvec = c(\"CAPRIN1_peakwise_file\", \"CAPRIN1_perturb_signal_R1\", \"CAPRIN1_perturb_signal_R2\")\nres = fun_str_map_label(vec)\nprint(res)\n\n\n    CAPRIN1_peakwise_file CAPRIN1_perturb_signal_R1 CAPRIN1_perturb_signal_R2 \n                   \"CASA\"               \"signal_R1\"               \"signal_R2\" \n\n\nArrange table\n\n\nCode\n### init\ndat = dat_metadata_add_md5sum\n\n### setup download file name and wget command\ndat = dat %&gt;%\n    dplyr::mutate(\n        File_Ext1 = ifelse(str_detect(File_Type, \"bed\"), \"bed.gz\", \"bw\"),\n        File_Ext2 = ifelse(str_detect(File_Type, \"bed\"), \"bed.gz\", \"bigWig\")\n    )  %&gt;% \n    dplyr::mutate(File_Label = fun_str_map_label(File_Summary)) %&gt;%\n    dplyr::mutate(\n        File_Name = paste(\n            Biosample, \n            Genome, \n            Index_Experiment, \n            Index_File,\n            \"CRISPRi_HCRFF\",\n            File_Label,\n            Target,\n            File_Ext1, \n            sep=\".\")\n    ) %&gt;%\n    dplyr::mutate(\n        File_URL = file.path(\n            \"https://www.encodeproject.org/files\",\n            Index_File,\n            \"@@download\",\n            paste(Index_File, File_Ext2, sep = \".\")\n        )\n    ) %&gt;%\n    dplyr::mutate(\n        CMD = paste(\"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL)\n    )\n\n### assign and show\ndat_metadata_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 60 18\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nTarget\nFile_Summary\nLab\nmd5sum\nFile_Ext1\nFile_Ext2\nFile_Label\nFile_Name\nFile_URL\nCMD\n\n\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF863AVQ\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAPRIN1\nCAPRIN1_peakwise_file\nPardis Sabeti, Broad\n379b4766e5c3be2e8a7065f17094c9be\nbed.gz\nbed.gz\nCASA\nK562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz\nhttps://www.encodeproject.org/files/ENCFF863AVQ/@@download/ENCFF863AVQ.bed.gz\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz https://www.encodeproject.org/files/ENCFF863AVQ/@@download/ENCFF863AVQ.bed.gz\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF444UXP\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R1\nPardis Sabeti, Broad\n74f33f50a1ba408db8c69bb6688fa29d\nbw\nbigWig\nsignal_R1\nK562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw\nhttps://www.encodeproject.org/files/ENCFF444UXP/@@download/ENCFF444UXP.bigWig\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw https://www.encodeproject.org/files/ENCFF444UXP/@@download/ENCFF444UXP.bigWig\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR793WTM\nLab custom GRCh38 (ENCAN194INC)\nENCFF994KKV\nbigWig\nperturbation signal\nhg38\nCAPRIN1\nCAPRIN1_perturb_signal_R2\nPardis Sabeti, Broad\n011955da3bae60136aac7f9288eb9062\nbw\nbigWig\nsignal_R2\nK562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw\nhttps://www.encodeproject.org/files/ENCFF994KKV/@@download/ENCFF994KKV.bigWig\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw https://www.encodeproject.org/files/ENCFF994KKV/@@download/ENCFF994KKV.bigWig\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF619FXH\nbed CRISPR element quantifications\nelement quantifications\nhg38\nCAT\nCAT_peakwise_file\nPardis Sabeti, Broad\ndc50f8f98d6f866d7d253de0c9eef24d\nbed.gz\nbed.gz\nCASA\nK562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz\nhttps://www.encodeproject.org/files/ENCFF619FXH/@@download/ENCFF619FXH.bed.gz\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz https://www.encodeproject.org/files/ENCFF619FXH/@@download/ENCFF619FXH.bed.gz\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF918VCM\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R1\nPardis Sabeti, Broad\n580302d8d8b0754c941131f8cb9b139f\nbw\nbigWig\nsignal_R1\nK562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw\nhttps://www.encodeproject.org/files/ENCFF918VCM/@@download/ENCFF918VCM.bigWig\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw https://www.encodeproject.org/files/ENCFF918VCM/@@download/ENCFF918VCM.bigWig\n\n\nFlow-FISH CRISPR screen\nK562\nENCSR794SPV\nLab custom GRCh38 (ENCAN095VUQ)\nENCFF965PMF\nbigWig\nperturbation signal\nhg38\nCAT\nCAT_perturb_signal_R2\nPardis Sabeti, Broad\nb4869d1b87be7e7b566d356077d38ee6\nbw\nbigWig\nsignal_R2\nK562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw\nhttps://www.encodeproject.org/files/ENCFF965PMF/@@download/ENCFF965PMF.bigWig\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw https://www.encodeproject.org/files/ENCFF965PMF/@@download/ENCFF965PMF.bigWig\n\n\n\n\n\nPrepare download script\n\n\nCode\n### init\ndat = dat_metadata_arrange\n\n### add Shebang and initial commands\n#dat = dat %&gt;% dplyr::select(Assay, Biosample, Index_Experiment, Index_File, File_Name, CMD)\ndat = dat %&gt;% dplyr::select(CMD)\ndat = rbind('echo -n \"\" &gt; run_download.log.txt', dat)\ncolnames(dat) = \"#!/bin/bash\"\n\n### assign and show\ndat_download_script = dat\nfun_display_table(dat)\n\n\n\n\n\n#!/bin/bash\n\n\n\n\necho -n \"\" &gt; run_download.log.txt\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz https://www.encodeproject.org/files/ENCFF863AVQ/@@download/ENCFF863AVQ.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw https://www.encodeproject.org/files/ENCFF444UXP/@@download/ENCFF444UXP.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw https://www.encodeproject.org/files/ENCFF994KKV/@@download/ENCFF994KKV.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz https://www.encodeproject.org/files/ENCFF619FXH/@@download/ENCFF619FXH.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw https://www.encodeproject.org/files/ENCFF918VCM/@@download/ENCFF918VCM.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw https://www.encodeproject.org/files/ENCFF965PMF/@@download/ENCFF965PMF.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR157WAN.ENCFF270LYK.CRISPRi_HCRFF.CASA.CD164.bed.gz https://www.encodeproject.org/files/ENCFF270LYK/@@download/ENCFF270LYK.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR157WAN.ENCFF186XBW.CRISPRi_HCRFF.signal_R1.CD164.bw https://www.encodeproject.org/files/ENCFF186XBW/@@download/ENCFF186XBW.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR157WAN.ENCFF786CHF.CRISPRi_HCRFF.signal_R2.CD164.bw https://www.encodeproject.org/files/ENCFF786CHF/@@download/ENCFF786CHF.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz https://www.encodeproject.org/files/ENCFF813GCK/@@download/ENCFF813GCK.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR979QQN.ENCFF079PDD.CRISPRi_HCRFF.signal_R1.ERP29.bw https://www.encodeproject.org/files/ENCFF079PDD/@@download/ENCFF079PDD.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR979QQN.ENCFF184LYJ.CRISPRi_HCRFF.signal_R2.ERP29.bw https://www.encodeproject.org/files/ENCFF184LYJ/@@download/ENCFF184LYJ.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR382ZJS.ENCFF786ZPA.CRISPRi_HCRFF.CASA.FADS1.bed.gz https://www.encodeproject.org/files/ENCFF786ZPA/@@download/ENCFF786ZPA.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR382ZJS.ENCFF090IXH.CRISPRi_HCRFF.signal_R1.FADS1.bw https://www.encodeproject.org/files/ENCFF090IXH/@@download/ENCFF090IXH.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR382ZJS.ENCFF161WBO.CRISPRi_HCRFF.signal_R2.FADS1.bw https://www.encodeproject.org/files/ENCFF161WBO/@@download/ENCFF161WBO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR968CIN.ENCFF149IDL.CRISPRi_HCRFF.CASA.FADS2.bed.gz https://www.encodeproject.org/files/ENCFF149IDL/@@download/ENCFF149IDL.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR968CIN.ENCFF923ZPB.CRISPRi_HCRFF.signal_R1.FADS2.bw https://www.encodeproject.org/files/ENCFF923ZPB/@@download/ENCFF923ZPB.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR968CIN.ENCFF734CNO.CRISPRi_HCRFF.signal_R2.FADS2.bw https://www.encodeproject.org/files/ENCFF734CNO/@@download/ENCFF734CNO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR630WLB.ENCFF227DUX.CRISPRi_HCRFF.CASA.FADS3.bed.gz https://www.encodeproject.org/files/ENCFF227DUX/@@download/ENCFF227DUX.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR630WLB.ENCFF499QYP.CRISPRi_HCRFF.signal_R1.FADS3.bw https://www.encodeproject.org/files/ENCFF499QYP/@@download/ENCFF499QYP.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR630WLB.ENCFF186CEY.CRISPRi_HCRFF.signal_R2.FADS3.bw https://www.encodeproject.org/files/ENCFF186CEY/@@download/ENCFF186CEY.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR278YTB.ENCFF151MNC.CRISPRi_HCRFF.CASA.FEN1.bed.gz https://www.encodeproject.org/files/ENCFF151MNC/@@download/ENCFF151MNC.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR278YTB.ENCFF571LUW.CRISPRi_HCRFF.signal_R1.FEN1.bw https://www.encodeproject.org/files/ENCFF571LUW/@@download/ENCFF571LUW.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR278YTB.ENCFF666DNQ.CRISPRi_HCRFF.signal_R2.FEN1.bw https://www.encodeproject.org/files/ENCFF666DNQ/@@download/ENCFF666DNQ.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR917XEU.ENCFF413WYU.CRISPRi_HCRFF.CASA.GATA1.bed.gz https://www.encodeproject.org/files/ENCFF413WYU/@@download/ENCFF413WYU.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR917XEU.ENCFF669ISH.CRISPRi_HCRFF.signal_R1.GATA1.bw https://www.encodeproject.org/files/ENCFF669ISH/@@download/ENCFF669ISH.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR917XEU.ENCFF596QFD.CRISPRi_HCRFF.signal_R2.GATA1.bw https://www.encodeproject.org/files/ENCFF596QFD/@@download/ENCFF596QFD.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR564EPW.ENCFF845YHV.CRISPRi_HCRFF.CASA.HBE1.bed.gz https://www.encodeproject.org/files/ENCFF845YHV/@@download/ENCFF845YHV.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR564EPW.ENCFF375NHR.CRISPRi_HCRFF.signal_R1.HBE1.bw https://www.encodeproject.org/files/ENCFF375NHR/@@download/ENCFF375NHR.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR564EPW.ENCFF283BAT.CRISPRi_HCRFF.signal_R2.HBE1.bw https://www.encodeproject.org/files/ENCFF283BAT/@@download/ENCFF283BAT.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR449NJV.ENCFF811PPJ.CRISPRi_HCRFF.CASA.HBG1.bed.gz https://www.encodeproject.org/files/ENCFF811PPJ/@@download/ENCFF811PPJ.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR449NJV.ENCFF270GAZ.CRISPRi_HCRFF.signal_R1.HBG1.bw https://www.encodeproject.org/files/ENCFF270GAZ/@@download/ENCFF270GAZ.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR449NJV.ENCFF422LBX.CRISPRi_HCRFF.signal_R2.HBG1.bw https://www.encodeproject.org/files/ENCFF422LBX/@@download/ENCFF422LBX.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR459QNY.ENCFF910PDZ.CRISPRi_HCRFF.CASA.HBG2.bed.gz https://www.encodeproject.org/files/ENCFF910PDZ/@@download/ENCFF910PDZ.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR459QNY.ENCFF110XZR.CRISPRi_HCRFF.signal_R1.HBG2.bw https://www.encodeproject.org/files/ENCFF110XZR/@@download/ENCFF110XZR.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR459QNY.ENCFF052MDO.CRISPRi_HCRFF.signal_R2.HBG2.bw https://www.encodeproject.org/files/ENCFF052MDO/@@download/ENCFF052MDO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR759RSA.ENCFF337VVS.CRISPRi_HCRFF.CASA.HBS1L.bed.gz https://www.encodeproject.org/files/ENCFF337VVS/@@download/ENCFF337VVS.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR759RSA.ENCFF130XRV.CRISPRi_HCRFF.signal_R1.HBS1L.bw https://www.encodeproject.org/files/ENCFF130XRV/@@download/ENCFF130XRV.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR759RSA.ENCFF279WUO.CRISPRi_HCRFF.signal_R2.HBS1L.bw https://www.encodeproject.org/files/ENCFF279WUO/@@download/ENCFF279WUO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR009KPS.ENCFF632PQY.CRISPRi_HCRFF.CASA.HDAC6.bed.gz https://www.encodeproject.org/files/ENCFF632PQY/@@download/ENCFF632PQY.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR009KPS.ENCFF514PCW.CRISPRi_HCRFF.signal_R1.HDAC6.bw https://www.encodeproject.org/files/ENCFF514PCW/@@download/ENCFF514PCW.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR009KPS.ENCFF607OIW.CRISPRi_HCRFF.signal_R2.HDAC6.bw https://www.encodeproject.org/files/ENCFF607OIW/@@download/ENCFF607OIW.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR321CEH.ENCFF469FXP.CRISPRi_HCRFF.CASA.LMO2.bed.gz https://www.encodeproject.org/files/ENCFF469FXP/@@download/ENCFF469FXP.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR321CEH.ENCFF756AUB.CRISPRi_HCRFF.signal_R1.LMO2.bw https://www.encodeproject.org/files/ENCFF756AUB/@@download/ENCFF756AUB.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR321CEH.ENCFF114EMW.CRISPRi_HCRFF.signal_R2.LMO2.bw https://www.encodeproject.org/files/ENCFF114EMW/@@download/ENCFF114EMW.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR940PYU.ENCFF894DJT.CRISPRi_HCRFF.CASA.MEF2C.bed.gz https://www.encodeproject.org/files/ENCFF894DJT/@@download/ENCFF894DJT.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR940PYU.ENCFF683VQC.CRISPRi_HCRFF.signal_R1.MEF2C.bw https://www.encodeproject.org/files/ENCFF683VQC/@@download/ENCFF683VQC.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR940PYU.ENCFF146MPD.CRISPRi_HCRFF.signal_R2.MEF2C.bw https://www.encodeproject.org/files/ENCFF146MPD/@@download/ENCFF146MPD.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR408VHJ.ENCFF091IOP.CRISPRi_HCRFF.CASA.MYB.bed.gz https://www.encodeproject.org/files/ENCFF091IOP/@@download/ENCFF091IOP.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR408VHJ.ENCFF706HXQ.CRISPRi_HCRFF.signal_R1.MYB.bw https://www.encodeproject.org/files/ENCFF706HXQ/@@download/ENCFF706HXQ.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR408VHJ.ENCFF825RTL.CRISPRi_HCRFF.signal_R2.MYB.bw https://www.encodeproject.org/files/ENCFF825RTL/@@download/ENCFF825RTL.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR825SFH.ENCFF240IPT.CRISPRi_HCRFF.CASA.MYC.bed.gz https://www.encodeproject.org/files/ENCFF240IPT/@@download/ENCFF240IPT.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR825SFH.ENCFF336DNM.CRISPRi_HCRFF.signal_R1.MYC.bw https://www.encodeproject.org/files/ENCFF336DNM/@@download/ENCFF336DNM.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR825SFH.ENCFF309PDY.CRISPRi_HCRFF.signal_R2.MYC.bw https://www.encodeproject.org/files/ENCFF309PDY/@@download/ENCFF309PDY.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR393VDD.ENCFF270ZLE.CRISPRi_HCRFF.CASA.NMU.bed.gz https://www.encodeproject.org/files/ENCFF270ZLE/@@download/ENCFF270ZLE.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR393VDD.ENCFF865PZH.CRISPRi_HCRFF.signal_R1.NMU.bw https://www.encodeproject.org/files/ENCFF865PZH/@@download/ENCFF865PZH.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR393VDD.ENCFF270SWR.CRISPRi_HCRFF.signal_R2.NMU.bw https://www.encodeproject.org/files/ENCFF270SWR/@@download/ENCFF270SWR.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR496MZF.ENCFF005DTR.CRISPRi_HCRFF.CASA.PVT1.bed.gz https://www.encodeproject.org/files/ENCFF005DTR/@@download/ENCFF005DTR.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR496MZF.ENCFF298GWM.CRISPRi_HCRFF.signal_R1.PVT1.bw https://www.encodeproject.org/files/ENCFF298GWM/@@download/ENCFF298GWM.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR496MZF.ENCFF191XOT.CRISPRi_HCRFF.signal_R2.PVT1.bw https://www.encodeproject.org/files/ENCFF191XOT/@@download/ENCFF191XOT.bigWig"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#prepare-checksum-table",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#prepare-checksum-table",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "Prepare Checksum table",
    "text": "Prepare Checksum table\n\n\nCode\n### init\ndat = dat_metadata_arrange\n\n### md5sum and file name\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(md5sum, File_Name)\n\n### assign and show\ndat_download_checksum = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 60  2\n\n\n\n\n\nmd5sum\nFile_Name\n\n\n\n\n379b4766e5c3be2e8a7065f17094c9be\nK562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz\n\n\n74f33f50a1ba408db8c69bb6688fa29d\nK562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw\n\n\n011955da3bae60136aac7f9288eb9062\nK562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw\n\n\ndc50f8f98d6f866d7d253de0c9eef24d\nK562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz\n\n\n580302d8d8b0754c941131f8cb9b139f\nK562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw\n\n\nb4869d1b87be7e7b566d356077d38ee6\nK562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#save-to-script",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_01_create_download_script_R.html#save-to-script",
    "title": "Prepare CRISPRi HCRFF data 01",
    "section": "Save to script",
    "text": "Save to script\nSave the command lines for each row into a bash script\n\n\nCode\n### set output path\ntxt_folder = \"encode_crispri_hcrff\"\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\n### create directory if not exist\ndir.create(txt_fdiry, showWarnings = FALSE)\n\n### write checksum file\ntxt_fname  = \"run_download_files.sh\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_script\nwrite_tsv(dat, txt_fpath)\n\n### save table\ntxt_fname  = \"checksum_md5sum.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_checksum\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html",
    "title": "Prepare CRISPRi Growth data 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_crispri_growth\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html#define-file-labeling",
    "title": "Prepare CRISPRi Growth data 02",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\ndat$Label = c(\"fcc_crispri_growth_signif\", \"fcc_crispri_growth_total\")\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nfcc_crispri_growth\nK562.hg38.CRISPRi_Growth.signif.bed.gz\nfcc_crispri_growth_signif\n\n\nfcc_crispri_growth\nK562.hg38.CRISPRi_Growth.total.bed.gz\nfcc_crispri_growth_total"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_crispri_growth_02_export_metadata_R.html#save-results",
    "title": "Prepare CRISPRi Growth data 02",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html",
    "title": "Prepare Junke peak call region 05",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_starrmpra_junke\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#import-data",
    "title": "Prepare Junke peak call region 05",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.ASTARR.junke.bed.gz \nK562.hg38.eSTARR.junke.bed.gz \nK562.hg38.LMPRA.junke.bed.gz \nK562.hg38.Merge.junke.tsv \nK562.hg38.TMPRA.junke.bed.gz \nK562.hg38.WSTARR.junke.bed.gz \nsummary \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.Merge.junke.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 447521      9\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nGroup\nLabel\nDataset\n\n\n\n\nchr1\n115570\n115730\npeak_both_1\n2.188151\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n778660\n778890\npeak_both_2\n2.458460\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1012990\n1013680\npeak_both_3\n2.903266\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1064240\n1064540\npeak_both_4\n2.740197\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1344850\n1345150\npeak_both_5\n2.521903\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1574880\n1575170\npeak_both_6\n2.217028\n.\nASTARR\nASTARR_AB\nASTARR_TR"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#explore-data",
    "title": "Prepare Junke peak call region 05",
    "section": "Explore data",
    "text": "Explore data\n\nCount table\nHelper function\n\n\nCode\nfun_lab2assay = function(vec_txt_input){\n    vec_txt_pattern = c(\"ASTARR\", \"WSTARR\", \"LMPRA\", \"TMPRA\", \"eSTARR\")\n    vec_txt_replace = c(\n        \"ATAC-STARR-seq\", \"WHG-STARR-seq\", \n        \"Lenti-MPRA\",     \"Tiling-MPRA\", \n        \"eSTARR-seq\")\n    vec_txt_output = fun_str_map_match(\n        vec_txt_input, \n        vec_txt_pattern, \n        vec_txt_replace)\n    return(vec_txt_output)\n}\n\nfun_lab2direct = function(vec_txt_input){\n    vec_txt_pattern = c(\"A\", \"AB\", \"R\", \"RB\")\n    vec_txt_replace = c(\n        \"Active (either direction)\", \n        \"Active (both direction)\", \n        \"Repressive (either direction)\",     \n        \"Repressive (both direction)\")\n    vec_txt_output = fun_str_map_match(\n        vec_txt_input, \n        vec_txt_pattern, \n        vec_txt_replace)\n    return(vec_txt_output)\n}\n\n\nSummarize count table\n\n\nCode\n### count table\ndat = dat_region_import\ndat = as.data.frame(table(dat$Label))\ncolnames(dat) = c(\"Label\", \"Count\")\n\n### arrange info\ndat = dat %&gt;% \n    tidyr::separate(\n        Label, \n        into=c(\"Assay\", \"Direction\"), \n        remove = FALSE\n    ) %&gt;% \n    dplyr::mutate(\n        Assay     = fun_lab2assay(Assay), \n        Direction = fun_lab2direct(Direction),\n        Count     = scales::comma(Count)\n    ) %&gt;%\n    dplyr::select(Label, Assay, Direction, Count)\n\n### assign and show\ndat_meta_count = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1] 19  4\n\n\n\n\n\nLabel\nAssay\nDirection\nCount\n\n\n\n\nASTARR_A\nATAC-STARR-seq\nActive (either direction)\n35,505\n\n\nASTARR_AB\nATAC-STARR-seq\nActive (both direction)\n11,680\n\n\nASTARR_R\nATAC-STARR-seq\nRepressive (either direction)\n154,337\n\n\nASTARR_RB\nATAC-STARR-seq\nRepressive (both direction)\n28,775\n\n\neSTARR_A\neSTARR-seq\nActive (either direction)\n150\n\n\neSTARR_AB\neSTARR-seq\nActive (both direction)\n31\n\n\neSTARR_R\neSTARR-seq\nRepressive (either direction)\n341\n\n\neSTARR_RB\neSTARR-seq\nRepressive (both direction)\n65\n\n\nLMPRA_A\nLenti-MPRA\nActive (either direction)\n25,648\n\n\nLMPRA_AB\nLenti-MPRA\nActive (both direction)\n16,603\n\n\nLMPRA_R\nLenti-MPRA\nRepressive (either direction)\n485\n\n\nLMPRA_RB\nLenti-MPRA\nRepressive (both direction)\n128\n\n\nTMPRA_A\nTiling-MPRA\nActive (either direction)\n6,017\n\n\nTMPRA_AB\nTiling-MPRA\nActive (both direction)\n57\n\n\nTMPRA_R\nTiling-MPRA\nRepressive (either direction)\n254\n\n\nTMPRA_RB\nTiling-MPRA\nRepressive (both direction)\n1\n\n\nWSTARR_A\nWHG-STARR-seq\nActive (either direction)\n79,738\n\n\nWSTARR_AB\nWHG-STARR-seq\nActive (both direction)\n25,505\n\n\nWSTARR_R\nWHG-STARR-seq\nRepressive (either direction)\n62,201\n\n\n\n\n\n\n\nDistribution of length\n\n\nCode\n### arrange table for plot\ndat = dat_region_import\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart) \n\n### create plot\ngpt = ggplot(dat, aes(x = Length)) + \n    geom_histogram(bins = 50) +\n    theme_cowplot() + \n    background_grid() +\n    facet_wrap(~Label, ncol=4, scales=\"free\")\n\n### show plot\noptions(repr.plot.height=15, repr.plot.width=15)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#save-figures",
    "title": "Prepare Junke peak call region 05",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\n\n\nCode\n### arrange table for plot\ndat = dat_region_import\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart) \n\n### create plot\ngpt = ggplot(dat, aes(x = Length)) + \n    geom_histogram(bins = 50) +\n    theme_cowplot() + \n    background_grid() +\n    theme_text +\n    facet_wrap(~Label, ncol=4, scales=\"free\") +\n    labs(x = \"Length (bp)\", y = \"Count\", title = \"Distribution of Region Length\")\n\n### assign plot\ngpt_export = gpt\n\n### show plot\noptions(repr.plot.height=15, repr.plot.width=15)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_starrmpra_junke.distribution.region_length.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 15, width = 15, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_starrmpra_junke.distribution.region_length.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 15, width = 15, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#save-tables",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_05_explore_data_R.html#save-tables",
    "title": "Prepare Junke peak call region 05",
    "section": "Save tables",
    "text": "Save tables\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.count.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_meta_count\nwrite_tsv(dat, txt_fpath)\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname  = \"table.region.fcc_starrmpra_junke.count.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_meta_count\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html",
    "title": "Prepare Junke peak call region 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\ntxt_fdiry = file.path(FD_DAT, \"processed\", \"fcc_enhancer_Junke_zscore_240611\", \"decompressed\")\nvec = dir(txt_fdiry)\nfor(txt in vec){cat(txt, \"\\n\")}\n\n\nATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_ \neSTARR_seq \nLentiMPRA_DNA_filtering_avg_DNA_lib_count_10 \nTilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10 \nTilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10 \nTilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10 \nWHG_STARR_TR\nHelper function to map names\nCode\nVEC_TXT_REGION_NAME = c(\n    \"ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_\",\n    \"WHG_STARR_TR\",\n    \"TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10\",\n    \"TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10\",\n    \"TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10\",\n    \"LentiMPRA_DNA_filtering_avg_DNA_lib_count_10\",\n    \"eSTARR_seq\"\n)\n\nVEC_TXT_ASSAY_NAME = c(\n    \"ASTARR_TR\",\n    \"WSTARR_TR\",\n    \"TMPRA_OL45\",\n    \"TMPRA_OL13\",\n    \"TMPRA_OL43\",\n    \"LMPRA_Nadav\",\n    \"eSTARR\"\n)\n\nVEC_TXT_ASSAY_GROUP = c(\n    \"ASTARR\",\n    \"WSTARR\",\n    \"TMPRA\",\n    \"TMPRA\",\n    \"TMPRA\",\n    \"LMPRA\",\n    \"eSTARR\"\n)\n\nfun1 = function(txt){\n    vec1 = VEC_TXT_REGION_NAME\n    vec2 = VEC_TXT_ASSAY_NAME\n    res  = fun_str_map_detect(txt, vec1, vec2)\n    return(res)\n}\n\nfun2 = function(txt){\n    vec1 = VEC_TXT_REGION_NAME\n    vec2 = VEC_TXT_ASSAY_GROUP\n    res  = fun_str_map_detect(txt, vec1, vec2)\n    return(res)\n}\n\nfun3 = function(txt){\n    vec1 = c(\"enhancer\", \"repressor\")\n    vec2 = c(\"A\", \"R\")\n    res  = fun_str_map_detect(txt, vec1, vec2)\n    return(res)\n}\n\nfun4 = function(txt){\n    vec1 = c(\"orientation_independent\", \"in_either_orientation\")\n    vec2 = c(\"B\", \"\")\n    res  = fun_str_map_detect(txt, vec1, vec2)\n    return(res)\n}\ntest function\nCode\ntxt = \"merged_repressor_peak_orientation_independent.bed.gz\"\nfun3(txt)\n\n\n'R'"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#metadata",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#metadata",
    "title": "Prepare Junke peak call region 03",
    "section": "Metadata",
    "text": "Metadata\n\n\nCode\n### get all files\ntxt_fdiry = file.path(\n    FD_DAT, \"processed\", \n    \"fcc_enhancer_Junke_zscore_240611\", \n    \"decompressed\",\n    \"*\",\n    \"merged_peak\"\n)\ntxt_fname = \"*bed.gz\"\ntxt_fglob = file.path(txt_fdiry, txt_fname)\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### arrange files into dataframe\ndat = data.frame(\n    FPath = vec_txt_fpath,\n    FName = vec_txt_fname\n)\n\n### mapping file names to labels\ndat = dat %&gt;%\n    dplyr::mutate(\n        X1 = fun1(vec_txt_fpath),\n        X2 = fun2(vec_txt_fpath),\n        X3 = fun3(vec_txt_fname), \n        X4 = fun4(vec_txt_fname) \n    ) %&gt;% \n    na.omit\n\n### arrange labels\ndat = dat %&gt;% \n    dplyr::mutate(\n        Dataset = X1,\n        Group   = X2,\n        Label   = paste0(X2, \"_\", X3, X4)\n    ) %&gt;% \n    dplyr::select(\n        Dataset,\n        Group,\n        Label,\n        FName,\n        FPath)\n\n### asign and show\ndat_meta = dat\nfun_display_table(dat)\n\n\n\n\n\nDataset\nGroup\nLabel\nFName\nFPath\n\n\n\n\nASTARR_TR\nASTARR\nASTARR_AB\nmerged_enhancer_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz\n\n\nASTARR_TR\nASTARR\nASTARR_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nASTARR_TR\nASTARR\nASTARR_RB\nmerged_repressor_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_repressor_peak_orientation_independent.bed.gz\n\n\nASTARR_TR\nASTARR\nASTARR_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\neSTARR\neSTARR\neSTARR_AB\nmerged_enhancer_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz\n\n\neSTARR\neSTARR\neSTARR_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\neSTARR\neSTARR\neSTARR_RB\nmerged_repressor_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_repressor_peak_orientation_independent.bed.gz\n\n\neSTARR\neSTARR\neSTARR_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\nLMPRA_Nadav\nLMPRA\nLMPRA_AB\nmerged_enhancer_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz\n\n\nLMPRA_Nadav\nLMPRA\nLMPRA_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nLMPRA_Nadav\nLMPRA\nLMPRA_RB\nmerged_repressor_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peak_orientation_independent.bed.gz\n\n\nLMPRA_Nadav\nLMPRA\nLMPRA_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL45\nTMPRA\nTMPRA_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL45\nTMPRA\nTMPRA_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL13\nTMPRA\nTMPRA_AB\nmerged_enhancer_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz\n\n\nTMPRA_OL13\nTMPRA\nTMPRA_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL13\nTMPRA\nTMPRA_RB\nmerged_repressor_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peak_orientation_independent.bed.gz\n\n\nTMPRA_OL13\nTMPRA\nTMPRA_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL43\nTMPRA\nTMPRA_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nTMPRA_OL43\nTMPRA\nTMPRA_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz\n\n\nWSTARR_TR\nWSTARR\nWSTARR_AB\nmerged_enhancer_peak_orientation_independent.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz\n\n\nWSTARR_TR\nWSTARR\nWSTARR_A\nmerged_enhancer_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz\n\n\nWSTARR_TR\nWSTARR\nWSTARR_R\nmerged_repressor_peaks_in_either_orientation.bed.gz\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#import-data-and-arrange",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#import-data-and-arrange",
    "title": "Prepare Junke peak call region 03",
    "section": "Import data and arrange",
    "text": "Import data and arrange\n\n\nCode\n### get file directory\ntxt_fdiry = file.path(\n    FD_DAT, \"processed\", \n    \"fcc_enhancer_Junke_zscore_240611\", \n    \"decompressed\",\n    \"*\",\n    \"merged_peak\"\n)\ntxt_fname = \"*bed.gz\"\ntxt_fglob = file.path(txt_fdiry, txt_fname)\nvec_txt_fpath = Sys.glob(txt_fglob)\n\n### column names according to the readme document\nvec_txt_cname = c(\n    \"Seqnames\",\n    \"Start\",\n    \"End\",\n    \"Name\",\n    \"Mean logFC across all the bins\",\n    \"Strand\",\n    \"Z_score based on mean logFC\",\n    \"List of all logFCs\",\n    \"Summit seqnames\",\n    \"Summit start\",\n    \"Summit end\",\n    \"Summit logFC\",\n    \"Summit z-score\",\n    \"Peak size\"\n)\n\n### loop to import each file and arrange\nlst = lapply(vec_txt_fpath, function(txt_fpath){\n    ### file name\n    txt_fname = basename(txt_fpath)\n\n    ### read table\n    dat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n    ### arrange columns\n    dat = dat %&gt;% \n        dplyr::mutate(\n            X1 = fun1(txt_fpath),\n            X2 = fun2(txt_fpath),\n            X3 = fun3(txt_fname), \n            X4 = fun4(txt_fname) \n        ) %&gt;% \n        dplyr::mutate(\n            Dataset = X1,\n            Group   = X2,\n            Label   = paste0(X2, \"_\", X3, X4)\n        ) %&gt;% \n        dplyr::select(\n            Seqnames, \n            Start, \n            End, \n            Name,\n            `Z_score based on mean logFC`,\n            Strand,\n            Group,\n            Label,\n            Dataset\n        )\n    return(dat)\n})\n\n### merge table and rename columns\ndat = bind_rows(lst)\ncolnames(dat) = c(\n    \"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\", \"Score\", \"Strand\", \n    \"Group\", \n    \"Label\", \n    \"Dataset\"\n)\nlst = split(dat, dat$Group)\n\n### assign and show\ndat_region_merge = dat\nlst_dat_region = lst\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 447521      9\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nGroup\nLabel\nDataset\n\n\n\n\nchr1\n115570\n115730\npeak_both_1\n2.188151\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n778660\n778890\npeak_both_2\n2.458460\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1012990\n1013680\npeak_both_3\n2.903266\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1064240\n1064540\npeak_both_4\n2.740197\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1344850\n1345150\npeak_both_5\n2.521903\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\nchr1\n1574880\n1575170\npeak_both_6\n2.217028\n.\nASTARR\nASTARR_AB\nASTARR_TR\n\n\n\n\n\nCheck data\n\n\nCode\nlst = lst_dat_region\nnames(lst)\n\n\n\n'ASTARR''eSTARR''LMPRA''TMPRA''WSTARR'\n\n\n\n\nCode\ndat = dat_region_merge\ntable(dat$Label)\n\n\n\n ASTARR_A ASTARR_AB  ASTARR_R ASTARR_RB  eSTARR_A eSTARR_AB  eSTARR_R eSTARR_RB \n    35505     11680    154337     28775       150        31       341        65 \n  LMPRA_A  LMPRA_AB   LMPRA_R  LMPRA_RB   TMPRA_A  TMPRA_AB   TMPRA_R  TMPRA_RB \n    25648     16603       485       128      6017        57       254         1 \n WSTARR_A WSTARR_AB  WSTARR_R \n    79738     25505     62201 \n\n\n\n\nCode\nlst = lst_dat_region\nfor (dat in lst){\n    cat(\"\\n===========================\\n\")\n    vec = c(unique(dat$Label), unique(dat$Dataset))\n    txt = paste(vec, collapse = \";\")\n    cat(txt, \"\\n\")\n    print(table(dat$Chrom))\n}\n\n\n\n===========================\nASTARR_AB;ASTARR_A;ASTARR_RB;ASTARR_R;ASTARR_TR \n\n                   chr1  chr1_KI270706v1_random  chr1_KI270707v1_random \n                  27530                      80                       3 \n chr1_KI270708v1_random  chr1_KI270709v1_random  chr1_KI270711v1_random \n                      2                      21                      18 \n chr1_KI270712v1_random  chr1_KI270713v1_random  chr1_KI270714v1_random \n                      4                      31                      27 \n                  chr10                   chr11 chr11_KI270721v1_random \n                  10169                   11656                      10 \n                  chr12                   chr13                   chr14 \n                   9809                    3396                    4625 \nchr14_GL000009v2_random chr14_GL000194v1_random chr14_GL000225v1_random \n                     80                     105                      27 \nchr14_KI270722v1_random chr14_KI270723v1_random chr14_KI270724v1_random \n                     14                       7                      18 \nchr14_KI270726v1_random                   chr15 chr15_KI270727v1_random \n                      2                    7069                       8 \n                  chr16 chr16_KI270728v1_random                   chr17 \n                  10104                      59                   11058 \nchr17_GL000205v2_random                   chr18                   chr19 \n                     89                    3916                   12567 \n                   chr2                   chr20                   chr21 \n                  15575                    6377                    4309 \n                  chr22 chr22_KI270731v1_random chr22_KI270732v1_random \n                   5944                      17                      10 \nchr22_KI270733v1_random chr22_KI270734v1_random chr22_KI270735v1_random \n                     36                      13                       3 \nchr22_KI270736v1_random chr22_KI270737v1_random chr22_KI270738v1_random \n                      1                      14                      26 \n                   chr3  chr3_GL000221v1_random                    chr4 \n                  12159                      16                    8387 \n chr4_GL000008v2_random                    chr5  chr5_GL000208v1_random \n                     28                   10849                       2 \n                   chr6                    chr7                    chr8 \n                  14603                   17559                    8379 \n                   chr9  chr9_KI270719v1_random  chr9_KI270720v1_random \n                   8523                      28                      12 \n                   chrM        chrUn_GL000195v1        chrUn_GL000214v1 \n                     16                      83                      38 \n       chrUn_GL000216v2        chrUn_GL000218v1        chrUn_GL000219v1 \n                      2                      76                     103 \n       chrUn_GL000220v1        chrUn_GL000224v1        chrUn_KI270310v1 \n                     20                      71                       2 \n       chrUn_KI270311v1        chrUn_KI270330v1        chrUn_KI270337v1 \n                      1                       2                       1 \n       chrUn_KI270438v1        chrUn_KI270442v1        chrUn_KI270466v1 \n                     13                      47                       2 \n       chrUn_KI270467v1        chrUn_KI270538v1        chrUn_KI270741v1 \n                      3                      14                       2 \n       chrUn_KI270742v1        chrUn_KI270743v1        chrUn_KI270744v1 \n                    119                      18                      81 \n       chrUn_KI270745v1        chrUn_KI270746v1        chrUn_KI270750v1 \n                      6                      12                      11 \n       chrUn_KI270751v1        chrUn_KI270754v1                    chrX \n                     52                      21                    4105 \n                   chrY \n                      2 \n\n===========================\neSTARR_AB;eSTARR_A;eSTARR_RB;eSTARR_R;eSTARR \n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n   69    34    46    28    12     9    18    21    37     9    21    33    24 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9 \n    2    16    39    20    25    45    22    27    30 \n\n===========================\nLMPRA_AB;LMPRA_A;LMPRA_RB;LMPRA_R;LMPRA_Nadav \n\n                chr1                chr10                chr11 \n                3655                 1896                 2368 \n               chr12                chr13                chr14 \n                2202                  753                 1184 \n               chr15 chr15_KI270850v1_alt                chr16 \n                1349                    2                 2051 \n               chr17                chr18                chr19 \n                2221                  637                 2862 \n                chr2                chr20                chr21 \n                3077                 1352                  527 \n               chr22                 chr3                 chr4 \n                1057                 2395                 1666 \n                chr5                 chr6                 chr7 \n                1864                 2479                 2237 \n chr7_KI270803v1_alt                 chr8                 chr9 \n                   5                 1705                 1684 \n                chrX                 chrY \n                1613                   23 \n\n===========================\nTMPRA_A;TMPRA_R;TMPRA_AB;TMPRA_RB;TMPRA_OL45;TMPRA_OL13;TMPRA_OL43 \n\n chr1 chr11 chr15 chr16  chr2 chr20  chr8  chrX \n    1  1762     1   775   703   873  1045  1169 \n\n===========================\nWSTARR_AB;WSTARR_A;WSTARR_R;WSTARR_TR \n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n14682  7965  8507  7944  4112  5149  5231  6652  7578  3689  7695 12249  5041 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrM  chrX \n 2086  3877  9684  7670  8567  8870  8556  7737  6978    24  6901"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#define-column-description",
    "title": "Prepare Junke peak call region 03",
    "section": "Define column description",
    "text": "Define column description\n\n\nCode\n### create metadata: column information\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Name\",\n    \"Score\",      \"Z score based on mean(logFC of all the bins)\",\n    \"Strand\",     \"Strand\",\n    \"Group\",      \"Assay name\",\n    \"Label\",      \"Assay name + direction\",\n    \"Dataset\",    \"Assay dataset\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName\n\n\nScore\nZ score based on mean(logFC of all the bins)\n\n\nStrand\nStrand\n\n\nGroup\nAssay name\n\n\nLabel\nAssay name + direction\n\n\nDataset\nAssay dataset"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_03_export_data_R.html#save-results",
    "title": "Prepare Junke peak call region 03",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### set directory\ntxt_fdiry = file.path(FD_RES, \"region\", \"fcc_starrmpra_junke\")\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\ntxt_fdiry = file.path(FD_RES, \"region\", \"fcc_starrmpra_junke\", \"summary\")\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n\nSave column names\n\n\nCode\ntxt_folder = \"fcc_starrmpra_junke\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nSave bed files\n\n\nCode\n### set file directory\ntxt_folder = \"fcc_starrmpra_junke\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n                       \n### loop and store each peak set\nlst = lst_dat_region\nfor (dat in lst){\n    ### set directory\n    txt_fname = paste(\"K562.hg38\", unique(dat$Group), \"junke\", \"bed.gz\", sep = \".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    print(txt_fname)\n\n    ### write table\n    dat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n    write_tsv(dat, txt_fpath, col_names = FALSE)\n}\n\n\n[1] \"K562.hg38.ASTARR.junke.bed.gz\"\n[1] \"K562.hg38.eSTARR.junke.bed.gz\"\n[1] \"K562.hg38.LMPRA.junke.bed.gz\"\n[1] \"K562.hg38.TMPRA.junke.bed.gz\"\n[1] \"K562.hg38.WSTARR.junke.bed.gz\"\n\n\nSave table\n\n\nCode\n### set directory\ntxt_folder = \"fcc_starrmpra_junke\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = paste(\"K562.hg38\", \"Merge\", \"junke\", \"tsv\", sep = \".\")\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nprint(txt_fname)\n\n### write table\ndat = dat_region_merge\nwrite_tsv(dat, txt_fpath)  \n\n\n[1] \"K562.hg38.Merge.junke.tsv\"\n\n\nSave metatable\n\n\nCode\n### set directory\ntxt_folder = \"fcc_starrmpra_junke\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### write metadata table\ndat = dat_meta\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_01_view_data_SH.html",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_01_view_data_SH.html",
    "title": "Prepare Junke peak call region 01",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_01_view_data_SH.html#view-files",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_01_view_data_SH.html#view-files",
    "title": "Prepare Junke peak call region 01",
    "section": "View files",
    "text": "View files\n\n\nCode\nls -d ${FD_DAT}/processed/fcc_enhancer_Junke*\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240415\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240513_astarr_filter\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611\n\n\n\n\nCode\nFD_INP=${FD_DAT}/processed/fcc_enhancer_Junke_zscore_240611\nls ${FD_INP}/*zip | xargs -n 1 basename\n\n\nATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib.zip\neSTARR_seq.zip\nLentiMPRA_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10.zip\nWHG_STARR_TR.zip"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html",
    "title": "Prepare TF Modules 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"module_tf_shannon\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html#define-file-labeling",
    "title": "Prepare TF Modules 02",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\n\n### assign and show\ndat_region = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\n\n\n\n\nmodule_tf_shannon\nK562.hg38.TF_Module.bed.gz\n\n\n\n\n\n\n\nCode\ndat = dat_region\ndat = dat %&gt;% dplyr::mutate(\n    Label = c(\n        \"module_tf_shannon\"\n    )\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nmodule_tf_shannon\nK562.hg38.TF_Module.bed.gz\nmodule_tf_shannon"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_tfmodule_02_export_metadata_R.html#save-results",
    "title": "Prepare TF Modules 02",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html",
    "title": "Prepare ENCODE Chromatin State 05",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"encode_chromatin_states\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#import-data",
    "title": "Prepare ENCODE Chromatin State 05",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.cCREs.silencer_rest.bed.gz \nK562.hg38.cCREs.silencer_starr.bed.gz \nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz \nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz \nsummary \n\n\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndescription.tsv \nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.bed.gz \nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.PLS_ELS.bed.gz \nmetadata.label.tsv \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"description.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_cname     = dat\nvec_txt_cname = dat$Name\nfun_display_table(head(dat))\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nGroup\nType of chromatin states annotaiton\n\n\nLabel\ncCREs/ChromHMM labels\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_ccres = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n10033\n10250\nEH38E2776516\ncCREs\nLow-DNase\n\n\nchr1\n10385\n10713\nEH38E2776517\ncCREs\nLow-DNase\n\n\nchr1\n16097\n16381\nEH38E3951272\ncCREs\nLow-DNase\n\n\nchr1\n17343\n17642\nEH38E3951273\ncCREs\nLow-DNase\n\n\nchr1\n29320\n29517\nEH38E3951274\ncCREs\nLow-DNase\n\n\nchr1\n66350\n66509\nEH38E3951275\ncCREs\nLow-DNase\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_chromhmm = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n0\n16000\nQuies\nChromHMM\nQuies\n\n\nchr1\n16000\n16200\nTxWk\nChromHMM\nTxWk\n\n\nchr1\n16200\n17400\nQuies\nChromHMM\nQuies\n\n\nchr1\n17400\n17600\nTxWk\nChromHMM\nTxWk\n\n\nchr1\n17600\n118400\nQuies\nChromHMM\nQuies\n\n\nchr1\n118400\n120200\nEnh1\nChromHMM\nEnh1"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#explore-data",
    "title": "Prepare ENCODE Chromatin State 05",
    "section": "Explore data",
    "text": "Explore data\nSummary of region length\n\n\nCode\ndat = dat_region_ccres\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\nvec = dat$Length\n\ncat(\"#{Region} =\", nrow(dat), \"\\n\")\nsummary(vec)\n\nnum = quantile(vec, probs=0.9, na.rm=TRUE)\ncat(\"90th percentile\", num, \"\\n\")\n\n\n#{Region} = 2348854 \n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  150.0   205.0   273.0   267.1   335.0   350.0 \n\n\n90th percentile 347 \n\n\n\n\nCode\ndat = dat_region_chromhmm\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\nvec = dat$Length\n\ncat(\"#{Region} =\", nrow(dat), \"\\n\")\nsummary(vec)\n\nnum = quantile(vec, probs=0.9, na.rm=TRUE)\ncat(\"90th percentile\", num, \"\\n\")\n\n\n#{Region} = 429105 \n\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n     200      400     1200     7197     4400 45489200 \n\n\n90th percentile 12600 \n\n\nDistribution of region length\n\n\nCode\nlst = list(\n    \"ChromState (cCREs)\"    = dat_region_ccres,\n    \"ChromState (ChromHMM)\" = dat_region_chromhmm\n)\n\ndat  = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 3000)\n\ngpt = ggplot(dat, aes(x = Length)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid() + \n    facet_wrap(~Label, scales = \"free\")\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_chromstate_05_explore_data_R.html#save-figures",
    "title": "Prepare ENCODE Chromatin State 05",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\n\n\nCode\n### get data\ndat = dat_region_ccres\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\n### order the label\nvec = c(\"PLS\", \"pELS\", \"dELS\", \"CA-H3K4me3\", \"CA-CTCF\", \"CA-TF\", \"CA-only\", \"Low-DNase\")\ndat = dat %&gt;% dplyr::mutate(Label = factor(Label, levels = vec))\n\n### compute summary\ntxt_title = \"Distribution of Region Length (cCREs)\\n\"\ntxt_title = paste0(txt_title, \"N = \", scales::comma(nrow(dat)))\ndat_text  = dat %&gt;%\n    dplyr::count(Label) %&gt;%\n    dplyr::mutate(label_text = paste0(\"N = \", scales::comma(n)))\n\n### gplot distribution\ngpt = ggplot(dat, aes(x = Length)) +\n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid() +\n    labs(x = \"Length (bp)\", y = \"Count\", title = txt_title) +\n    theme_text +\n    facet_wrap(~Label, scale = \"free_y\", nrow = 2)+\n    geom_text(\n        data    = dat_text,\n        aes(x = Inf, y = Inf, label = label_text),\n        hjust   = 1.7,\n        vjust   = 2.1,\n        size    = 4\n    )\n\n### assign plot\ngpt_export_ccres = gpt\n\noptions(repr.plot.height=5, repr.plot.width=12)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\n### get data\ndat = dat_region_chromhmm\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\n\n### order the label\n#vec = c(\"PLS\", \"pELS\", \"dELS\", \"CA-H3K4me3\", \"CA-CTCF\", \"CA-TF\", \"CA-only\", \"Low-DNase\")\n#dat = dat %&gt;% dplyr::mutate(Label = factor(Label, levels = vec))\n\n### compute summary\ntxt_title = \"Distribution of Region Length (ChromHMM)\\n\"\ntxt_title = paste0(txt_title, \"N = \", scales::comma(nrow(dat)))\ndat_text  = dat %&gt;%\n    dplyr::count(Label) %&gt;%\n    dplyr::mutate(label_text = paste0(\"N = \", scales::comma(n)))\n\n### gplot distribution\ndat = dat %&gt;% dplyr::filter(Length &lt; 10000)\ngpt = ggplot(dat, aes(x = Length/1000)) +\n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid() +\n    labs(x = \"Length (kb)\", y = \"Count\", title = txt_title) +\n    theme_text +\n    facet_wrap(~Label, scale = \"free\", nrow = 4)+\n    geom_text(\n        data    = dat_text,\n        aes(x = Inf, y = Inf, label = label_text),\n        hjust   = 1.7,\n        vjust   = 2.7,\n        size    = 4\n    )\n\n### assign plot\ngpt_export_chromhmm = gpt\n\noptions(repr.plot.height=10, repr.plot.width=12)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.chromstate_ccres.distribution.region_length.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export_ccres, height = 5, width = 12, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.chromstate_ccres.distribution.region_length.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export_ccres, height = 5, width = 12, units = \"in\")\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.chromstate_chromhmm.distribution.region_length.below10k.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export_chromhmm, height = 10, width = 12, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.chromstate_chromhmm.distribution.region_length.below10k.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export_chromhmm, height = 10, width = 12, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"encode_chromatin_states\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#import-data",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Import data",
    "text": "Import data\nCheck data\n\n\nCode\ntxt_fdiry = file.path(FD_DAT, \"external\", TXT_FOLDER_REGION)\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nccres_v4.silencer.rest.tsv \nccres_v4.silencer.starr.tsv \nchecksum_md5sum.txt \nchecksum_results.txt \nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz \nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz \nrun_download_files.sh \nrun_download.log.txt \n\n\nRead table: ENCODE cCREs v4\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_DAT, \"external\", TXT_FOLDER_REGION)\ntxt_fname = \"K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\nvec_txt_cname = c(\n    \"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\", \"Score\", \"Strand\", \n    \"ThickStart\", \"ThickEnd\", \"ItemRgb\", \n    \"Label\", \"Note\")\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### show and assign\ndat_region_ccres = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nThickStart\nThickEnd\nItemRgb\nLabel\nNote\n\n\n\n\nchr1\n10033\n10250\nEH38E2776516\n0\n.\n10033\n10250\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n10385\n10713\nEH38E2776517\n0\n.\n10385\n10713\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n16097\n16381\nEH38E3951272\n0\n.\n16097\n16381\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n17343\n17642\nEH38E3951273\n0\n.\n17343\n17642\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n29320\n29517\nEH38E3951274\n0\n.\n29320\n29517\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n66350\n66509\nEH38E3951275\n0\n.\n66350\n66509\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\n\n\n\nRead table: ChromHMM\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_DAT, \"external\", TXT_FOLDER_REGION)\ntxt_fname = \"K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\nvec_txt_cname = c(\n    \"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\", \"Score\", \"Strand\", \n    \"ThickStart\", \"ThickEnd\", \"ItemRgb\")\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### show and assign\ndat_region_chromhmm = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nThickStart\nThickEnd\nItemRgb\n\n\n\n\nchr1\n0\n16000\nQuies\n1\n.\n0\n16000\n220,220,220\n\n\nchr1\n16000\n16200\nTxWk\n1\n.\n16000\n16200\n63,154,80\n\n\nchr1\n16200\n17400\nQuies\n1\n.\n16200\n17400\n220,220,220\n\n\nchr1\n17400\n17600\nTxWk\n1\n.\n17400\n17600\n63,154,80\n\n\nchr1\n17600\n118400\nQuies\n1\n.\n17600\n118400\n220,220,220\n\n\nchr1\n118400\n120200\nEnh1\n1\n.\n118400\n120200\n255,223,0\n\n\n\n\n\nRead table: ENCODE cCREs v4 Silencer (REST)\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_DAT, \"external\", TXT_FOLDER_REGION)\ntxt_fname = \"ccres_v4.silencer.rest.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE, comment = \"#\")\n\n### show and assign\ndat_region_ccres_silencer_rest = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChr\nStart\nEnd\ncCRE accession\ncCRE class\nSilencer class\n\n\n\n\nchr10\n100680786\n100681128\nEH38E4018829\nCA-H3K4me3\nREST+ silencer\n\n\nchr10\n101081011\n101081271\nEH38E4018984\nCA-TF\nREST+ silencer\n\n\nchr10\n102361781\n102362038\nEH38E4019348\nCA-CTCF\nREST+ silencer\n\n\nchr10\n103265839\n103266036\nEH38E1495742\nCA-CTCF\nREST+ silencer\n\n\nchr10\n104548071\n104548416\nEH38E4019821\nCA-TF\nREST+ silencer\n\n\nchr10\n104750418\n104750581\nEH38E4019865\nCA-TF\nREST+ silencer\n\n\n\n\n\nRead table: ENCODE cCREs v4 Silencer (STARR)\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_DAT, \"external\", TXT_FOLDER_REGION)\ntxt_fname = \"ccres_v4.silencer.starr.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE, comment = \"#\")\n\n### show and assign\ndat_region_ccres_silencer_starr = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChr\nStart\nEnd\ncCRE accession\ncCRE class\nCAPRA quantification\nP-value\nThreshold\n\n\n\n\nchr13\n22970420\n22970595\nEH38E4082602\nCA\n-2.7481\n0.00e+00\nStringent\n\n\nchr1\n9356890\n9357240\nEH38E3954005\nTF\n-2.3927\n9.00e-07\nStringent\n\n\nchr14\n92678182\n92678371\nEH38E4113580\nTF\n-2.3075\n5.20e-06\nStringent\n\n\nchr6\n131563578\n131563769\nEH38E4417327\nCA\n-2.3047\n5.70e-06\nStringent\n\n\nchr9\n75977404\n75977605\nEH38E3886686\ndELS\n-2.2951\n6.60e-06\nStringent\n\n\nchr16\n26844012\n26844260\nEH38E4140223\nCA\n-2.2464\n1.03e-05\nStringent"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-ccres-and-chromhmm",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-ccres-and-chromhmm",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Prepare regions: cCREs and ChromHMM",
    "text": "Prepare regions: cCREs and ChromHMM\ncCREs\n\n\nCode\ndat = dat_region_ccres\ndat = dat %&gt;%\n    dplyr::mutate(Group = \"cCREs\") %&gt;%\n    dplyr::select(\n        Chrom, ChromStart, ChromEnd, Name,\n        Group, Label\n    ) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\ndat_region_ccres_arrange = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n10033\n10250\nEH38E2776516\ncCREs\nLow-DNase\n\n\nchr1\n10385\n10713\nEH38E2776517\ncCREs\nLow-DNase\n\n\nchr1\n16097\n16381\nEH38E3951272\ncCREs\nLow-DNase\n\n\nchr1\n17343\n17642\nEH38E3951273\ncCREs\nLow-DNase\n\n\nchr1\n29320\n29517\nEH38E3951274\ncCREs\nLow-DNase\n\n\nchr1\n66350\n66509\nEH38E3951275\ncCREs\nLow-DNase\n\n\n\n\n\nChromHMM\n\n\nCode\ndat = dat_region_chromhmm\ndat = dat %&gt;%\n    dplyr::mutate(\n        Group = \"ChromHMM\",\n        Label = Name\n    ) %&gt;%\n    dplyr::select(\n        Chrom, ChromStart, ChromEnd, Name,\n        Group, Label\n    ) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\ndat_region_chromhmm_arrange = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n0\n16000\nQuies\nChromHMM\nQuies\n\n\nchr1\n16000\n16200\nTxWk\nChromHMM\nTxWk\n\n\nchr1\n16200\n17400\nQuies\nChromHMM\nQuies\n\n\nchr1\n17400\n17600\nTxWk\nChromHMM\nTxWk\n\n\nchr1\n17600\n118400\nQuies\nChromHMM\nQuies\n\n\nchr1\n118400\n120200\nEnh1\nChromHMM\nEnh1"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-ccres-silencers",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-ccres-silencers",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Prepare regions: cCREs silencers",
    "text": "Prepare regions: cCREs silencers\n\n\nCode\ndat = dat_region_ccres_silencer_rest\ndat = dat %&gt;%\n    dplyr::mutate(\n        Chrom      = Chr, \n        ChromStart = Start, \n        ChromEnd   = End,\n        Name       = `cCRE accession`\n    ) %&gt;%\n    dplyr::left_join(\n        dat_region_ccres, \n        by = c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\")\n    ) %&gt;%\n    dplyr::mutate(Group = \"cCREs:REST+ silencer\") %&gt;%\n    dplyr::select(Chrom, ChromStart, ChromEnd, Name, Group, Label) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\ndat_region_ccres_silencer_rest_arrange = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n911951\n912144\nEH38E3951341\ncCREs:REST+ silencer\nLow-DNase\n\n\nchr1\n1298966\n1299316\nEH38E2777310\ncCREs:REST+ silencer\nCA-TF\n\n\nchr1\n1300420\n1300762\nEH38E2777313\ncCREs:REST+ silencer\nLow-DNase\n\n\nchr1\n1334920\n1335266\nEH38E2777380\ncCREs:REST+ silencer\nLow-DNase\n\n\nchr1\n1375250\n1375598\nEH38E2777455\ncCREs:REST+ silencer\npELS\n\n\nchr1\n1407146\n1407496\nEH38E2777492\ncCREs:REST+ silencer\nPLS\n\n\n\n\n\n\n\nCode\ndat = dat_region_ccres_silencer_starr\ndat = dat %&gt;%\n    dplyr::mutate(\n        Chrom      = Chr, \n        ChromStart = Start, \n        ChromEnd   = End,\n        Name       = `cCRE accession`\n    ) %&gt;%\n    dplyr::left_join(\n        dat_region_ccres, \n        by = c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\")\n    ) %&gt;%\n    dplyr::mutate(Group = \"cCREs:STARR silencer\") %&gt;%\n    dplyr::select(Chrom, ChromStart, ChromEnd, Name, Group, Label) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n\ndat_region_ccres_silencer_starr_arrange = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nGroup\nLabel\n\n\n\n\nchr1\n898458\n898659\nEH38E2776591\ncCREs:STARR silencer\nLow-DNase\n\n\nchr1\n1493739\n1493964\nEH38E3951581\ncCREs:STARR silencer\nLow-DNase\n\n\nchr1\n1777547\n1777889\nEH38E2777930\ncCREs:STARR silencer\npELS\n\n\nchr1\n2172722\n2173053\nEH38E2778456\ncCREs:STARR silencer\nLow-DNase\n\n\nchr1\n2468066\n2468391\nEH38E3951891\ncCREs:STARR silencer\nCA-TF\n\n\nchr1\n3065437\n3065776\nEH38E2779554\ncCREs:STARR silencer\nLow-DNase"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-for-genome-track-plots",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#prepare-regions-for-genome-track-plots",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Prepare regions for genome track plots",
    "text": "Prepare regions for genome track plots\nSet label to name\n\n\nCode\ndat = dat_region_ccres\ndat = dat %&gt;% \n    dplyr::mutate(Name = Label) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\ndat_region_ccres_label2name = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nThickStart\nThickEnd\nItemRgb\nLabel\nNote\n\n\n\n\nchr1\n10033\n10250\nLow-DNase\n0\n.\n10033\n10250\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n10385\n10713\nLow-DNase\n0\n.\n10385\n10713\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n16097\n16381\nLow-DNase\n0\n.\n16097\n16381\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n17343\n17642\nLow-DNase\n0\n.\n17343\n17642\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n29320\n29517\nLow-DNase\n0\n.\n29320\n29517\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\nchr1\n66350\n66509\nLow-DNase\n0\n.\n66350\n66509\n225,225,225\nLow-DNase\nAll-data/Full-classification\n\n\n\n\n\nExtract PLS/ELS only\n\n\nCode\ndat = dat_region_ccres_label2name\nvec = c(\"PLS\", \"pELS\", \"dELS\")\ndat = dat %&gt;% \n    dplyr::filter(Label %in% vec) %&gt;%\n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\ndat_region_ccres_label2name_subset = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nThickStart\nThickEnd\nItemRgb\nLabel\nNote\n\n\n\n\nchr1\n138917\n139112\npELS\n0\n.\n138917\n139112\n255,167,0\npELS\nAll-data/Full-classification\n\n\nchr1\n778570\n778919\nPLS\n0\n.\n778570\n778919\n255,0,0\nPLS\nAll-data/Full-classification\n\n\nchr1\n779023\n779182\nPLS\n0\n.\n779023\n779182\n255,0,0\nPLS\nAll-data/Full-classification\n\n\nchr1\n825846\n826068\npELS\n0\n.\n825846\n826068\n255,167,0\npELS\nAll-data/Full-classification\n\n\nchr1\n826734\n826887\nPLS\n0\n.\n826734\n826887\n255,0,0\nPLS\nAll-data/Full-classification\n\n\nchr1\n827417\n827767\nPLS\n0\n.\n827417\n827767\n255,0,0\nPLS\nAll-data/Full-classification"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#define-column-description",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Define column description",
    "text": "Define column description\nThe peak file is in narrowPeak format, which is a standard six field bed with four additional fields (BED6+4 format)\n\n\nCode\n### create metadata: column information\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Name given to a region; Use '.' if no name is assigned.\",\n    \"Group\",      \"Type of chromatin states annotaiton\",\n    \"Label\",      \"cCREs/ChromHMM labels\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nGroup\nType of chromatin states annotaiton\n\n\nLabel\ncCREs/ChromHMM labels"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_chromstate_03_export_data_R.html#save-results",
    "title": "Prepare ENCODE Chromatin State 03",
    "section": "Save results",
    "text": "Save results\nWrite description table of columns\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nWrite tables\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry = file.path(FD_RES, \"region\", txt_folder)\ntxt_cmd   = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table: cCREs\n#txt_fname = \"K562.hg38.cCREs.bed.gz\"\ntxt_fname = \"K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_ccres_arrange\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n### write table: ChromHMM\n#txt_fname = \"K562.hg38.ChromHMM.bed.gz\"\ntxt_fname = \"K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_chromhmm_arrange\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n### write table: cCREs Silencer (REST)\ntxt_fname = \"K562.hg38.cCREs.silencer_rest.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_ccres_silencer_rest_arrange\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n### write table: cCREs Silencer (STARR)\ntxt_fname = \"K562.hg38.cCREs.silencer_starr.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_ccres_silencer_starr_arrange\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_cmd   = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table: cCREs (total; for genome plot)\ntxt_fname = \"K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_ccres_label2name\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n### write table: cCREs (subset; for genome plot)\ntxt_fname = \"K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.PLS_ELS.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region_ccres_label2name_subset\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REF = \"encode_chromatin_states\"\nTXT_FOLDER_OUT = \"encode_chromatin_states\"\nCode\ntxt_fdiry  = file.path(FD_REF, TXT_FOLDER_REF)\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nccres_v4.silencer.rest.tsv \nccres_v4.silencer.starr.tsv \nENCODE_K562_hg38_chromatin_states.tsv \nHuman epigenomes with ChromHMM state (DAC, Kaili Fan).xlsx \nK562.ENCSR365YNI.ENCAN395TNA.metadata.tsv \nK562.ENCSR913HQX.ENCAN130HDM.metadata.tsv"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#import-metadata-from-reference-file",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#import-metadata-from-reference-file",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Import metadata from reference file",
    "text": "Import metadata from reference file\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REF\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname = \"ENCODE_K562_hg38_chromatin_states.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata_selected = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1]  2 11\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nEncyclopedia version\nLab\nDescription\n\n\n\n\ncCREs\nK562\nENCSR913HQX\nLab custom GRCh38 (ENCAN130HDM) processed data\nENCFF286VQG\nbed bed9+\ncandidate Cis-Regulatory Elements\nhg38\nENCODE v4\nZhiping Weng, Umass\ncandidate regulatory elements for GRCh38 in K562\n\n\nChromHMM\nK562\nENCSR365YNI\nLab custom GRCh38 (ENCAN395TNA) processed data\nENCFF106BGJ\nbed bed9\nsemi-automated genome annotation\nhg38\nENCODE v4\nZhiping Weng, Umass\nChromHMM 15-state model of K562\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REF\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname = \"*metadata.tsv\"\ntxt_fglob = file.path(txt_fdiry, txt_fname)\nvec_txt_fpath = Sys.glob(txt_fglob)\n\n### read table\nlst = lapply(vec_txt_fpath, function(txt_fpath){\n    dat = read_tsv(txt_fpath, show_col_types = FALSE)\n    return(dat)\n})\ndat = bind_rows(lst)\n\n### show and assign\ndat_metadata_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1]  4 32\n\n\n\n\n\nFile accession\nFile format\nOutput type\nAssay term name\nDataset accession\nAnnotation type\nSoftware used\nEncyclopedia Version\nBiosample term id\nBiosample term name\nBiosample type\nLife stage\nAge\nAge units\nOrganism\nTargets\nDataset date released\nProject\nLab\nmd5sum\ndbxrefs\nFile download URL\nAssembly\nControlled by\nFile Status\nDerived from\nS3 URL\nAzure URL\nSize\nAudit WARNING\nAudit NOT_COMPLIANT\nAudit ERROR\n\n\n\n\nENCFF106BGJ\nbed bed9\nsemi-automated genome annotation\nNA\nENCSR365YNI\nchromatin state\nNA\nENCODE v4\nEFO:0002067\nK562\ncell line\nNA\nNA\nNA\nHomo sapiens\nNA\n2023-05-18\nENCODE\nZhiping Weng, UMass\n354acb4f74c90c666679706d7685d271\nNA\nhttps://www.encodeproject.org/files/ENCFF106BGJ/@@download/ENCFF106BGJ.bed.gz\nGRCh38\nNA\nreleased\n/files/ENCFF747HEB/, /files/ENCFF181ANT/, /files/ENCFF121RHF/, /files/ENCFF907MNY/, /files/ENCFF089KHK/, /files/ENCFF229LAF/, /files/ENCFF816ECC/, /files/ENCFF035SOZ/, /files/ENCFF652TXG/, /files/ENCFF508LLH/, /files/ENCFF155UQU/, /files/ENCFF104THG/\nhttps://encode-public.s3.amazonaws.com/2023/04/10/7afe8ded-9f34-45d5-9668-929479c00348/ENCFF106BGJ.bed.gz\nhttps://datasetencode.blob.core.windows.net/dataset/2023/04/10/7afe8ded-9f34-45d5-9668-929479c00348/ENCFF106BGJ.bed.gz?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\n4013023\nNA\nNA\nNA\n\n\nENCFF644IFL\nbigBed bed9\nsemi-automated genome annotation\nNA\nENCSR365YNI\nchromatin state\nNA\nENCODE v4\nEFO:0002067\nK562\ncell line\nNA\nNA\nNA\nHomo sapiens\nNA\n2023-05-18\nENCODE\nZhiping Weng, UMass\n25dbef1ad57395142d47714109a9f293\nNA\nhttps://www.encodeproject.org/files/ENCFF644IFL/@@download/ENCFF644IFL.bigBed\nGRCh38\nNA\nreleased\n/files/ENCFF106BGJ/\nhttps://encode-public.s3.amazonaws.com/2023/04/10/158df12e-e8e5-4e08-99a4-426715054cea/ENCFF644IFL.bigBed\nhttps://datasetencode.blob.core.windows.net/dataset/2023/04/10/158df12e-e8e5-4e08-99a4-426715054cea/ENCFF644IFL.bigBed?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\n6228846\nNA\nNA\nNA\n\n\nENCFF286VQG\nbed bed9+\ncandidate Cis-Regulatory Elements\nNA\nENCSR913HQX\ncandidate Cis-Regulatory Elements\nNA\nENCODE v4\nEFO:0002067\nK562\ncell line\nNA\nNA\nNA\nHomo sapiens\nNA\n2022-12-20\nENCODE\nZhiping Weng, UMass\n344a9e65f749a3e5703de96a3577101b\nNA\nhttps://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\nGRCh38\nNA\nreleased\n/files/ENCFF414OGC/, /files/ENCFF806YEZ/, /files/ENCFF849TDM/, /files/ENCFF736UDR/\nhttps://encode-public.s3.amazonaws.com/2022/11/23/179cba53-f3d4-47af-af56-c4e5a3cabeac/ENCFF286VQG.bed.gz\nhttps://datasetencode.blob.core.windows.net/dataset/2022/11/23/179cba53-f3d4-47af-af56-c4e5a3cabeac/ENCFF286VQG.bed.gz?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\n32698783\nNA\nNA\nNA\n\n\nENCFF144YZB\nbigBed bed9+\ncandidate Cis-Regulatory Elements\nNA\nENCSR913HQX\ncandidate Cis-Regulatory Elements\nNA\nENCODE v4\nEFO:0002067\nK562\ncell line\nNA\nNA\nNA\nHomo sapiens\nNA\n2022-12-20\nENCODE\nZhiping Weng, UMass\nd0d6e398da1d883418f6732869b86f9f\nNA\nhttps://www.encodeproject.org/files/ENCFF144YZB/@@download/ENCFF144YZB.bigBed\nGRCh38\nNA\nreleased\n/files/ENCFF286VQG/\nhttps://encode-public.s3.amazonaws.com/2022/11/23/03b1647b-8c32-4708-bcd0-3853d49fb395/ENCFF144YZB.bigBed\nhttps://datasetencode.blob.core.windows.net/dataset/2022/11/23/03b1647b-8c32-4708-bcd0-3853d49fb395/ENCFF144YZB.bigBed?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\n72324869\nNA\nNA\nNA"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#explore-table",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#explore-table",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Explore table",
    "text": "Explore table\nCheck genome assembly\n\n\nCode\ndat = dat_metadata_import\ntable(dat$Assembly)\n\n\n\nGRCh38 \n     4 \n\n\nCheck biosample\n\n\nCode\ndat = dat_metadata_import\ntable(dat$`Biosample term name`)\n\n\n\nK562 \n   4 \n\n\nCheck data\n\n\nCode\nvec1 = dat_metadata_selected$Index_File\nvec2 = dat_metadata_import$`File accession`\nall(vec1 %in% vec2)\n\n\nTRUE"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#arrange-metadata-tables",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#arrange-metadata-tables",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Arrange metadata tables",
    "text": "Arrange metadata tables\nHelper function\n\n\nCode\nfun_simplify_table = function(dat){\n    \n    ### rename some columns\n    dat = dat %&gt;% \n        dplyr::mutate(\n            #Index_Experiment = `Experiment accession`,\n            Index_Dataset    = `Dataset accession`, \n            Index_File       = `File accession`,\n            File_Format      = `File format`,\n            File_Type        = `File type`,\n            Output_Type      = `Output type`,\n            #Genome           = `File assembly`,\n            #Target           = str_remove(`Experiment target`, \"-human\"),\n            #Bio_Replicates   = `Biological replicate(s)`,\n            Analysis         = Index_Process, #`File analysis title`,\n            Derived_From     = `Derived from`,\n            File_Name        = basename(`File download URL`),\n            File_URL         = `File download URL`\n        )\n    \n    ### select the needed columns\n    dat = dat %&gt;%\n        dplyr::select(\n            Assay,\n            Index_Experiment,\n            Index_File,\n            File_Format,\n            File_Type,\n            Output_Type,\n            Genome,\n            #Target,\n            #Bio_Replicates,\n            Analysis,\n            Derived_From,\n            md5sum,\n            File_Name,\n            File_URL\n        )\n\n    ### return the simplified table\n    return(dat)\n}\n\n\n\n\nCode\nfun_simplify_table = function(dat){\n    \n    ### rename some columns\n    dat = dat %&gt;% \n        dplyr::mutate(\n            Index_Experiment = `Dataset accession`, \n            Index_File       = `File accession`,\n            Derived_From     = `Derived from`,\n            File_Name        = basename(`File download URL`),\n            File_URL         = `File download URL`\n        )\n    \n    ### select the needed columns\n    dat = dat %&gt;%\n        dplyr::select(\n            Index_Experiment,\n            Index_File,\n            Derived_From,\n            md5sum,\n            File_Name,\n            File_URL\n        )\n\n    ### return the simplified table\n    return(dat)\n}\n\n\nSimplify the metatable\n\n\nCode\n### arrange and simplify the table\ndat = dat_metadata_import\ndat = fun_simplify_table(dat)\nhead(dat)\n\n\n\nA tibble: 4 × 6\n\n\nIndex_Experiment\nIndex_File\nDerived_From\nmd5sum\nFile_Name\nFile_URL\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nENCSR365YNI\nENCFF106BGJ\n/files/ENCFF747HEB/, /files/ENCFF181ANT/, /files/ENCFF121RHF/, /files/ENCFF907MNY/, /files/ENCFF089KHK/, /files/ENCFF229LAF/, /files/ENCFF816ECC/, /files/ENCFF035SOZ/, /files/ENCFF652TXG/, /files/ENCFF508LLH/, /files/ENCFF155UQU/, /files/ENCFF104THG/\n354acb4f74c90c666679706d7685d271\nENCFF106BGJ.bed.gz\nhttps://www.encodeproject.org/files/ENCFF106BGJ/@@download/ENCFF106BGJ.bed.gz\n\n\nENCSR365YNI\nENCFF644IFL\n/files/ENCFF106BGJ/\n25dbef1ad57395142d47714109a9f293\nENCFF644IFL.bigBed\nhttps://www.encodeproject.org/files/ENCFF644IFL/@@download/ENCFF644IFL.bigBed\n\n\nENCSR913HQX\nENCFF286VQG\n/files/ENCFF414OGC/, /files/ENCFF806YEZ/, /files/ENCFF849TDM/, /files/ENCFF736UDR/\n344a9e65f749a3e5703de96a3577101b\nENCFF286VQG.bed.gz\nhttps://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\n\n\nENCSR913HQX\nENCFF144YZB\n/files/ENCFF286VQG/\nd0d6e398da1d883418f6732869b86f9f\nENCFF144YZB.bigBed\nhttps://www.encodeproject.org/files/ENCFF144YZB/@@download/ENCFF144YZB.bigBed\n\n\n\n\n\n\n\nCode\n### arrange and simplify the table\ndat = dat_metadata_import\ndat = fun_simplify_table(dat)\n\n### subset by selected files\nvec = c(\"Index_Experiment\", \"Index_File\")\ndat = dplyr::left_join(dat_metadata_selected, dat, by = vec)\n\n### assign and show\ndat_metadata_simplify = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1]  2 15\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nEncyclopedia version\nLab\nDescription\nDerived_From\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\ncCREs\nK562\nENCSR913HQX\nLab custom GRCh38 (ENCAN130HDM) processed data\nENCFF286VQG\nbed bed9+\ncandidate Cis-Regulatory Elements\nhg38\nENCODE v4\nZhiping Weng, Umass\ncandidate regulatory elements for GRCh38 in K562\n/files/ENCFF414OGC/, /files/ENCFF806YEZ/, /files/ENCFF849TDM/, /files/ENCFF736UDR/\n344a9e65f749a3e5703de96a3577101b\nENCFF286VQG.bed.gz\nhttps://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\n\n\nChromHMM\nK562\nENCSR365YNI\nLab custom GRCh38 (ENCAN395TNA) processed data\nENCFF106BGJ\nbed bed9\nsemi-automated genome annotation\nhg38\nENCODE v4\nZhiping Weng, Umass\nChromHMM 15-state model of K562\n/files/ENCFF747HEB/, /files/ENCFF181ANT/, /files/ENCFF121RHF/, /files/ENCFF907MNY/, /files/ENCFF089KHK/, /files/ENCFF229LAF/, /files/ENCFF816ECC/, /files/ENCFF035SOZ/, /files/ENCFF652TXG/, /files/ENCFF508LLH/, /files/ENCFF155UQU/, /files/ENCFF104THG/\n354acb4f74c90c666679706d7685d271\nENCFF106BGJ.bed.gz\nhttps://www.encodeproject.org/files/ENCFF106BGJ/@@download/ENCFF106BGJ.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#prepare-download-files",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#prepare-download-files",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Prepare download files",
    "text": "Prepare download files\nHelper function\n\n\nCode\nfun_map_assay_label = function(txt){\n    vec1 = c(\"ATAC-seq\", \"DNase-seq\")\n    vec2 = c(\"ATAC\",     \"DNase\")\n    res  = fun_str_map_detect(txt, vec1, vec2, .default=txt)\n    return(res)\n}\n\n\n\n\nCode\nfun_map_file_ext = function(txt){\n    vec1 = c(\"bigWig\", \"bed narrowPeak\")\n    vec2 = c(\"bw\",     \"bed.gz\")\n    res  = fun_str_map_detect(txt, vec1, vec2, .default=txt)\n    return(res)\n}\n\n\nRename filename\n\n\nCode\n### rename filename\ndat = dat_metadata_simplify\ndat = dat %&gt;% dplyr::mutate(\n    File_Name = paste(\n        \"K562\",\n        \"hg38\",\n        Index_Experiment,\n        Index_File,\n        Assay,\n        \"bed.gz\",\n    sep = \".\")\n)\n\n### assign and show\ndat_metadata_arrange = dat\nfun_display_table(dat)\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nGenome\nEncyclopedia version\nLab\nDescription\nDerived_From\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\ncCREs\nK562\nENCSR913HQX\nLab custom GRCh38 (ENCAN130HDM) processed data\nENCFF286VQG\nbed bed9+\ncandidate Cis-Regulatory Elements\nhg38\nENCODE v4\nZhiping Weng, Umass\ncandidate regulatory elements for GRCh38 in K562\n/files/ENCFF414OGC/, /files/ENCFF806YEZ/, /files/ENCFF849TDM/, /files/ENCFF736UDR/\n344a9e65f749a3e5703de96a3577101b\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\nhttps://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\n\n\nChromHMM\nK562\nENCSR365YNI\nLab custom GRCh38 (ENCAN395TNA) processed data\nENCFF106BGJ\nbed bed9\nsemi-automated genome annotation\nhg38\nENCODE v4\nZhiping Weng, Umass\nChromHMM 15-state model of K562\n/files/ENCFF747HEB/, /files/ENCFF181ANT/, /files/ENCFF121RHF/, /files/ENCFF907MNY/, /files/ENCFF089KHK/, /files/ENCFF229LAF/, /files/ENCFF816ECC/, /files/ENCFF035SOZ/, /files/ENCFF652TXG/, /files/ENCFF508LLH/, /files/ENCFF155UQU/, /files/ENCFF104THG/\n354acb4f74c90c666679706d7685d271\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz\nhttps://www.encodeproject.org/files/ENCFF106BGJ/@@download/ENCFF106BGJ.bed.gz\n\n\n\n\n\nCheck results\n\n\nCode\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(Index_Experiment, Index_File, File_Name)\nfun_display_table(dat)\n\n\n\n\n\nIndex_Experiment\nIndex_File\nFile_Name\n\n\n\n\nENCSR913HQX\nENCFF286VQG\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\n\n\nENCSR365YNI\nENCFF106BGJ\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz\n\n\n\n\n\nChecksum table\n\n\nCode\n### get md5sum for each file\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(md5sum, File_Name)\n\n### assign and show\ndat_download_checksum = dat\nfun_display_table(dat)\n\n\n\n\n\nmd5sum\nFile_Name\n\n\n\n\n344a9e65f749a3e5703de96a3577101b\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\n\n\n354acb4f74c90c666679706d7685d271\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#generate-download-scripts",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#generate-download-scripts",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Generate download scripts",
    "text": "Generate download scripts\nwget -O FILE URL\n\n\nCode\n### setup download file wget command\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::mutate(\n        CMD = paste(\n            \"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL\n        )\n    )\n\n### add Shebang and initial commands\ndat = dat %&gt;% dplyr::select(CMD)\ndat = rbind('echo -n \"\" &gt; run_download.log.txt', dat)\ncolnames(dat) = \"#!/bin/bash\"\n\n### assign and show\ndat_download_script = dat\nfun_display_table(dat)\n\n\n\n\n\n#!/bin/bash\n\n\n\n\necho -n \"\" &gt; run_download.log.txt\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz https://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz https://www.encodeproject.org/files/ENCFF106BGJ/@@download/ENCFF106BGJ.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_chromstate_01_create_download_script_R.html#save-results",
    "title": "Prepare ENCODE Chromatin State 01",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### set output path\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\n### create directory if not exist\ndir.create(txt_fdiry, showWarnings = FALSE)\n\n### write checksum file\ntxt_fname  = \"run_download_files.sh\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_script\nwrite_tsv(dat, txt_fpath)\n\n### save table\ntxt_fname  = \"checksum_md5sum.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_checksum\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 05",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_REGION_FOLDER = \"encode_open_chromatin\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#import-data",
    "title": "Prepare ENCODE ATAC/DNase Peaks 05",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz \nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz \nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz \nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz \nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz \nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz \nsummary \n\n\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndescription.tsv \nmetadata.label.tsv \n\n\nGet column names\n\n\nCode\n### set file path\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"description.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_cname     = dat\nvec_txt_cname = dat$Name\nfun_display_table(head(dat))\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nIndicates how dark the peak will be displayed in the browser (0-1000).\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\n\n\n\nGet metadata table\n\n\nCode\n### set file path\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"metadata.label.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_metadata = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1] 6 3\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\ndnase_ENCFF274YGF\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\ndnase_ENCFF185XRG\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\natac_ENCFF558BLC\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\natac_ENCFF925CYR\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\natac_ENCFF333TAT\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\natac_ENCFF948AFM\n\n\n\n\n\nImport data\n\n\nCode\nfun_str_map_file_label = function(txt_input){\n    ### setup mapping\n    dat  = dat_metadata\n    vec1 = dat$FName\n    vec2 = dat$Label\n\n    ### mapping string\n    txt_output = fun_str_map_match(txt_input, vec1, vec2, .default=txt)\n    txt_output = gsub(\"^dnase\", \"DNase\", txt_output)\n    txt_output = gsub(\"^atac\",  \"ATAC\",  txt_output)\n    \n    return(txt_output)\n}\n\n\n\n\nCode\n### set directory\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names and labels\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\nvec_txt_label = fun_str_map_file_label(vec_txt_fname)\n\n### read tables\nlst = lapply(vec_txt_fpath, function(txt_fpath){\n    dat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n    return(dat)\n})\nnames(lst) = vec_txt_label\n\n### assign and show\nlst_dat_import = lst\nprint(length(lst))\n\n\n[1] 6\n\n\nCheck data\n\n\nCode\nlst = lst_dat_import\nvec = names(lst)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nDNase_ENCFF274YGF \nDNase_ENCFF185XRG \nATAC_ENCFF558BLC \nATAC_ENCFF925CYR \nATAC_ENCFF333TAT \nATAC_ENCFF948AFM \n\n\n\n\nCode\nlst = lst_dat_import\ndat = lst[[1]]\nfun_display_table(head(dat, 3))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nSignalValue\nPValue\nQValue\nPeak\n\n\n\n\nchr1\n181400\n181530\n.\n0\n.\n0.299874\n-1\n-1\n75\n\n\nchr1\n778660\n778800\n.\n0\n.\n14.138300\n-1\n-1\n75\n\n\nchr1\n779137\n779200\n.\n0\n.\n0.331440\n-1\n-1\n75\n\n\n\n\n\n\n\nCode\nlst = lst_dat_import\ndat = lst[[2]]\nfun_display_table(head(dat, 3))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nSignalValue\nPValue\nQValue\nPeak\n\n\n\n\nchr1\n139369\n139421\n.\n0\n.\n0.0872467\n-1\n-1\n75\n\n\nchr1\n180800\n180871\n.\n0\n.\n0.1371020\n-1\n-1\n75\n\n\nchr1\n181108\n181200\n.\n0\n.\n0.1246380\n-1\n-1\n75\n\n\n\n\n\n\n\nCode\nlst = lst_dat_import\ndat = lst[[6]]\nfun_display_table(head(dat, 3))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nSignalValue\nPValue\nQValue\nPeak\n\n\n\n\nchr1\n42030\n42399\n.\n839\n.\n4.94006\n56.98604\n54.92928\n250\n\n\nchr1\n68963\n70035\n.\n1000\n.\n3.99240\n43.21727\n41.22760\n115\n\n\nchr1\n68963\n70035\n.\n1000\n.\n6.60048\n110.44444\n108.21621\n760"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#explore-data",
    "title": "Prepare ENCODE ATAC/DNase Peaks 05",
    "section": "Explore data",
    "text": "Explore data\nChromosome distribution (Bar plots)\n\n\nCode\n### count chromosomes\nlst = lst_dat_import\nlst = lapply(lst, function(dat){\n    dat = as.data.frame(table(dat$Chrom, dnn = \"Chrom\"))\n    return(dat)\n})\n\n### merge results\ndat = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% tidyr::spread(Chrom, Freq) %&gt;% replace(is.na(.), 0)\n\n### summarize counts to frequency\ndat = dat %&gt;%\n    tidyr::gather(Chrom, Count, -Label) %&gt;%\n    dplyr::group_by(Label) %&gt;%\n    dplyr::mutate(Total = sum(Count)) %&gt;%\n    dplyr::ungroup() %&gt;%\n    dplyr::mutate(Freq = Count / Total)\n\n### assign and show\ndat_stats_chrom = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 144   5\n\n\n\n\n\nLabel\nChrom\nCount\nTotal\nFreq\n\n\n\n\nATAC_ENCFF333TAT\nchr1\n31171\n269800\n0.1155337\n\n\nATAC_ENCFF558BLC\nchr1\n24045\n203874\n0.1179405\n\n\nATAC_ENCFF925CYR\nchr1\n14206\n123009\n0.1154875\n\n\nATAC_ENCFF948AFM\nchr1\n20798\n181340\n0.1146906\n\n\nDNase_ENCFF185XRG\nchr1\n16479\n159277\n0.1034613\n\n\nDNase_ENCFF274YGF\nchr1\n12452\n118721\n0.1048846\n\n\n\n\n\n\n\nCode\n### set chromosome names\nvec = c(1:22, \"X\", \"Y\")\nvec = paste0(\"chr\", vec)\nvec_txt_chrom = vec\n\n### set factor levels\ndat = dat_stats_chrom\ndat = dat %&gt;% dplyr::mutate(Chrom = factor(Chrom, levels = vec_txt_chrom))\n\n### plot chromosome distribution                            \ngp1 = ggplot(dat, aes(x=Count, y = Chrom, fill=Label)) + \n    geom_col() + \n    theme_cowplot() + \n    background_grid() +\n    theme(legend.position = \"none\")\n\n### plot chromosome distribution                            \ngp2 = ggplot(dat, aes(x=Freq, y = Chrom, fill=Label)) + \n    geom_col() + \n    theme_cowplot() + \n    background_grid()\n\n### combine plot\nplt = plot_grid(gp1, gp2, nrow = 1, rel_widths = c(2, 3.1))\n\n### show plot\noptions(repr.plot.height=7, repr.plot.width=12)\nprint(plt)\n\n\n\n\n\n\n\n\n\nDistribution of region length (Combine)\n\n\nCode\n### arrange table for plot\nlst = lst_dat_import\ndat  = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 1000)\n\n### create plot\ngpt = ggplot(dat, aes(x = Length, color = Label)) + \n    geom_density() +\n    theme_cowplot() + \n    background_grid()\n\n### show plot\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nDistribution of region length (Split by ATAC and DNase)\n\n\nCode\nlst = lst_dat_import\nvec = names(lst)\nfor(txt in vec){cat(txt, \"\\n\")}\n\n\nDNase_ENCFF274YGF \nDNase_ENCFF185XRG \nATAC_ENCFF558BLC \nATAC_ENCFF925CYR \nATAC_ENCFF333TAT \nATAC_ENCFF948AFM \n\n\n\n\nCode\n### split data frame into ATAC and DNase\nlst = lst_dat_import\ndf1 = bind_rows(lst[1:2], .id = \"Label\")\ndf2 = bind_rows(lst[3:6], .id = \"Label\")\ndf1 = df1 %&gt;% dplyr::mutate(Group = \"DNase\")\ndf2 = df2 %&gt;% dplyr::mutate(Group = \"ATAC\")\n\n### assign\ndat_region_dnase = df1\ndat_region_atac  = df2\n\n\n\n\nCode\n### arrange table for plot\ndat = dat_region_dnase\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 500)\n\n### create plot\ngpt = ggplot(dat, aes(x = Length, color = Label)) + \n    geom_density() +\n    theme_cowplot() + \n    background_grid()\n\n### show plot\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\n### arrange table for plot\ndat = dat_region_atac\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 3000)\n\n### create plot\ngpt = ggplot(dat, aes(x = Length, color = Label)) + \n    geom_density() +\n    theme_cowplot() + \n    background_grid()\n\n### show plot\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_ocr_05_explore_data_R.html#save-figures",
    "title": "Prepare ENCODE ATAC/DNase Peaks 05",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\nENCODE OCR (ATAC)\n\n\nCode\n### arrange table for plot\ndat = dat_region_atac\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 3000)\ndat_region_arrange = dat\n\n### summarize the number of regions (total)\ndat = dat_region_arrange\nvec = dat %&gt;%\n    group_by(Label) %&gt;%\n    summarise(Count = n(), .groups=\"drop\") %&gt;%\n    dplyr::mutate(\n        line1 = Label,\n        line2 = paste(\"Count =\", scales::comma(Count)),\n        combined = paste0(line1, \"\\n\", line2)\n    ) %&gt;%\n    { set_names(.$combined, .$Label) }\nvec_txt_label = vec\n\n### create plot\ndat = dat_region_arrange\ngpt = ggplot(dat, aes(x = Length/1000, colour = Label)) +\n    geom_density(linewidth = 1.5) +\n    scale_x_continuous(breaks = seq(0, 3, by = 0.5)) +\n    scale_y_continuous(breaks = c(0, 0.5, 1.0, 1.5)) +\n    scale_color_discrete(\n        ### replace each original level by our multi‐line version\n        labels = vec_txt_label\n    ) +\n    labs(x = \"Length (kb)\", y = \"Density\", title = \"Distribution of Region Length\") +\n    theme_cowplot() + \n    background_grid() +\n    theme_text +\n    theme(\n        legend.position = \"inside\", \n        legend.position.inside = c(0.6, 0.6),\n        legend.background = element_rect(fill = \"white\"),\n        legend.key.spacing.y = unit(0.3, 'cm')\n    )\n\n### assign plot\ngpt_density_length_atac = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nENCODE OCR (DNase)\n\n\nCode\n### arrange table for plot\ndat = dat_region_dnase\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 500)\ndat_region_arrange = dat\n\n### summarize the number of regions (total)\ndat = dat_region_arrange\nvec = dat %&gt;%\n    group_by(Label) %&gt;%\n    summarise(Count = n(), .groups=\"drop\") %&gt;%\n    dplyr::mutate(\n        line1 = Label,\n        line2 = paste(\"Count =\", scales::comma(Count)),\n        combined = paste0(line1, \"\\n\", line2)\n    ) %&gt;%\n    { set_names(.$combined, .$Label) }\nvec_txt_label = vec\n\n### create plot\ndat = dat_region_arrange\ngpt = ggplot(dat, aes(x = Length/1000, colour = Label)) +\n    geom_density(linewidth = 1.5) +\n    scale_x_continuous(breaks = seq(0, 0.5, by = 0.1)) +\n    #scale_y_continuous(breaks = c(0, 0.5, 1.0)) +\n    scale_color_discrete(\n        ### replace each original level by our multi‐line version\n        labels = vec_txt_label\n    ) +\n    labs(x = \"Length (kb)\", y = \"Density\", title = \"Distribution of Region Length\") +\n    theme_cowplot() + \n    background_grid() +\n    theme_text +\n    theme(\n        legend.position = \"inside\", \n        legend.position.inside = c(0.6, 0.6),\n        legend.background = element_rect(fill = \"white\"),\n        legend.key.spacing.y = unit(0.3, 'cm')\n    )\n\n### assign plot\ngpt_density_length_dnase = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\n### combine plot\nplt = plot_grid(\n    gpt_density_length_atac, \n    gpt_density_length_dnase,\n    nrow = 1\n)\nplt_export = plt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=14)\nprint(plt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.encode_ocr.distribution.region_length.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 5, width = 14, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.encode_ocr.distribution.region_length.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 5, width = 14, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html",
    "href": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#check-data",
    "href": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#check-data",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Check data",
    "text": "Check data\n\n\nCode\nFDIRY=${FD_DAT}/external/encode_open_chromatin\n\necho ${FDIRY}\nls   ${FDIRY}/*.bed.gz | wc -l\nls   ${FDIRY}/*.bed.gz | xargs -n 1 basename\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin\n6\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n\n\nCode\nFDIRY=${FD_DAT}/external/encode_open_chromatin\nFNAME=K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nFPATH=${FDIRY}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    181400  181530  .   0   .   0.299874    -1  -1  75\nchr1    778660  778800  .   0   .   14.1383 -1  -1  75\nchr1    779137  779200  .   0   .   0.33144 -1  -1  75\nchr1    827460  827554  .   0   .   3.38384 -1  -1  75\nchr1    842880  843060  .   0   .   1.64457 -1  -1  75\nchr1    869800  869980  .   0   .   2.23485 -1  -1  75\nchr1    875760  875920  .   0   .   0.356692    -1  -1  75\nchr1    898828  899004  .   0   .   0.363005    -1  -1  75\nchr1    900030  900100  .   0   .   0.249369    -1  -1  75\nchr1    901580  901645  .   0   .   0.217803    -1  -1  75"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#copy-and-sort-the-files",
    "href": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#copy-and-sort-the-files",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Copy and sort the files",
    "text": "Copy and sort the files\nln -s file link\nzcat ${FP_INP} | sort -k 1,1 -k2,2n | gzip -c &gt; ${FP_OUT}\n\n\nCode\n### set directory\nFD_INP=${FD_DAT}/external/encode_open_chromatin\nFD_OUT=${FD_RES}/region/encode_open_chromatin\nmkdir -p ${FD_OUT}\n\n### loop and link files\nFP_INPS=($(ls ${FD_INP}/*bed.gz))\nfor FP_INP in ${FP_INPS[@]}; do\n    ### get input file name\n    FN_INP=$(basename ${FP_INP})\n    echo ${FN_INP}\n    \n    ### set output file name\n    FN_OUT=${FN_INP}\n    FP_OUT=${FD_OUT}/${FN_OUT}\n    \n    ### sort and output to a new file\n    zcat ${FP_INP} | sort -k 1,1 -k2,2n | gzip -c &gt; ${FP_OUT}\ndone\n\n\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#review",
    "href": "notebooks/05_prepare_region/region_ocr_03_export_data_SH.html#review",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\n### set directory\nFD_INP=${FD_DAT}/external/encode_open_chromatin\nFD_OUT=${FD_RES}/region/encode_open_chromatin\n\nls ${FD_OUT}\n\n\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\nsummary\n\n\n\n\nCode\nFNAME=K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nFPATH=${FD_INP}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    100028923   100029241   Peak_202759 52  .   2.91347 5.24652 3.38358 74\nchr1    100037575   100038998   Peak_172664 68  .   1.83651 6.83702 4.90355 60\nchr1    100037575   100038998   Peak_30781  934 .   5.32597 93.45621    90.75060    988\nchr1    100037575   100038998   Peak_37596  722 .   4.66917 72.27560    69.66279    791\nchr1    100037575   100038998   Peak_38860  692 .   4.55797 69.21054    66.61273    1182\nchr1    100037575   100038998   Peak_7320   1000    .   12.39880    394.75714   391.35434   513\nchr1    100046904   100047187   Peak_125191 111 .   3.44067 11.11133    9.04548 94\nchr1    100048739   100048974   Peak_163268 74  .   2.90807 7.42227 5.46578 145\nchr1    100050176   100050470   Peak_153800 81  .   3.11401 8.14941 6.16809 117\nchr1    100090679   100091339   Peak_149202 84  .   3.47044 8.41934 6.42649 269\n\n\n\n\nCode\nFNAME=K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nFPATH=${FD_OUT}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    10509   10674   Peak_125662 110 .   4.29354 11.01368    8.94965 94\nchr1    41987   42385   Peak_116641 124 .   4.60022 12.47548    10.37921    281\nchr1    41987   42385   Peak_178161 63  .   3.22015 6.39968 4.47989 99\nchr1    46755   47025   Peak_217457 47  .   2.76013 4.70157 2.87144 182\nchr1    68969   69964   Peak_105604 147 .   5.06024 14.77241    12.63228    733\nchr1    68969   69964   Peak_203155 52  .   2.91347 5.24652 3.38358 77\nchr1    68969   69964   Peak_80922  232 .   6.59365 23.21283    20.95212    310\nchr1    78951   79407   Peak_150566 82  .   3.68018 8.27430 6.28501 335\nchr1    778328  779235  Peak_145438 89  .   2.37705 8.90270 6.89830 74\nchr1    778328  779235  Peak_2263   1000    .   28.93443    749.94922   745.95093   458"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REF = \"encode_open_chromatin\"\nTXT_FOLDER_OUT = \"encode_open_chromatin\"\nCode\ntxt_fdiry  = file.path(FD_REF, TXT_FOLDER_REF)\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nENCODE_K562_hg38_ATAC_DNase.tsv \nK562.ENCSR000EKS.ENCAN694OCK.metadata.tsv \nK562.ENCSR000EOT.ENCAN780RWD.metadata.tsv \nK562.ENCSR483RKN.ENCAN217QUL.metadata.tsv \nK562.ENCSR868FGK.ENCAN824UKX.metadata.tsv"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#import-metadata-from-reference-file",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#import-metadata-from-reference-file",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Import metadata from reference file",
    "text": "Import metadata from reference file\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REF\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname = \"ENCODE_K562_hg38_ATAC_DNase.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata_selected = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1] 10 11\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nisogenic_replicate\nGenome\nFile_Summary\nLab\n\n\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF357GNC\nbigWig\nsignal p-value\n1, 2, 3\nhg38\ncall-macs2_signal_track_pooled/rep.pooled.pval.signal.bigwig\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF333TAT\nbed narrowPeak\npseudoreplicated peaks\n1, 2, 3\nhg38\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF948AFM\nbed narrowPeak\nIDR thresholded peaks\n1, 2, 3\nhg38\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF600FDO\nbigWig\nsignal p-value\n1, 2\nhg38\ncall-macs2_signal_track_pooled/rep.pooled.pval.signal.bigwig\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF558BLC\nbed narrowPeak\npseudoreplicated peaks\n1, 2\nhg38\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF925CYR\nbed narrowPeak\nIDR thresholded peaks\n1, 2\nhg38\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nDNase\nK562\nENCSR000EKS\nENCODE4 v3.0.0 GRCh38 (ENCAN694OCK)\nENCFF972GVB\nbigWig\nread-depth normalized signal\n1\nhg38\ncall-starch_to_bigwig/normalized.nuclear.0.05.density.bw\nGregory Crawford, Duke\n\n\nDNase\nK562\nENCSR000EKS\nENCODE4 v3.0.0 GRCh38 (ENCAN694OCK)\nENCFF274YGF\nbed narrowPeak\npeaks\n1\nhg38\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nGregory Crawford, Duke\n\n\nDNase\nK562\nENCSR000EOT\nENCODE4 v3.0.0-alpha.2 GRCh38 (ENCAN780RWD)\nENCFF414OGC\nbigWig\nread-depth normalized signal\n1\nhg38\ncall-starch_to_bigwig/normalized.nuclear.0.05.density.bw\nJohn Stamatoyannopoulos, UW\n\n\nDNase\nK562\nENCSR000EOT\nENCODE4 v3.0.0-alpha.2 GRCh38 (ENCAN780RWD)\nENCFF185XRG\nbed narrowPeak\npeaks\n1\nhg38\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nJohn Stamatoyannopoulos, UW\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REF\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname = \"*metadata.tsv\"\ntxt_fglob = file.path(txt_fdiry, txt_fname)\nvec_txt_fpath = Sys.glob(txt_fglob)\n\n### read table\nlst = lapply(vec_txt_fpath, function(txt_fpath){\n    dat = read_tsv(\n        txt_fpath, \n        show_col_types = FALSE,\n        col_types = cols(\n            `Biological replicate(s)` = col_character(),\n            .default = col_guess()\n        )\n    )\n    return(dat)\n})\ndat = bind_rows(lst)\n\n### show and assign\ndat_metadata_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 85 59\n\n\n\n\n\nFile accession\nFile format\nFile type\nFile format type\nOutput type\nFile assembly\nExperiment accession\nAssay\nDonor(s)\nBiosample term id\nBiosample term name\nBiosample type\nBiosample organism\nBiosample treatments\nBiosample treatments amount\nBiosample treatments duration\nBiosample genetic modifications methods\nBiosample genetic modifications categories\nBiosample genetic modifications targets\nBiosample genetic modifications gene targets\nBiosample genetic modifications site coordinates\nBiosample genetic modifications zygosity\nExperiment target\nLibrary made from\nLibrary depleted in\nLibrary extraction method\nLibrary lysis method\nLibrary crosslinking method\nLibrary strand specific\nExperiment date released\nProject\nRBNS protein concentration\nLibrary fragmentation method\nLibrary size range\nBiological replicate(s)\nTechnical replicate(s)\nRead length\nMapped read length\nRun type\nPaired end\nPaired with\nIndex of\nDerived from\nSize\nLab\nmd5sum\ndbxrefs\nFile download URL\nGenome annotation\nPlatform\nControlled by\nFile Status\ns3_uri\nAzure URL\nFile analysis title\nFile analysis status\nAudit WARNING\nAudit NOT_COMPLIANT\nAudit ERROR\n\n\n\n\nENCFF070TML\nbigBed narrowPeak\nbigBed\nnarrowPeak\npeaks\nGRCh38\nENCSR000EKS\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2011-04-19\nENCODE\nNA\nsee document\nNA\n1\n1_1, 1_2, 1_3\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF274YGF/\n2141861\nENCODE Processing Pipeline\n9a8290ef2eec9deb327d002be3c1b224\nNA\nhttps://www.encodeproject.org/files/ENCFF070TML/@@download/ENCFF070TML.bigBed\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/22/9cad70d7-20c7-4f15-a615-86a97c6a85f6/ENCFF070TML.bigBed\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/22/9cad70d7-20c7-4f15-a615-86a97c6a85f6/ENCFF070TML.bigBed?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0 GRCh38\nreleased\nlow spot score, mixed read lengths\nNA\nNA\n\n\nENCFF972GVB\nbigWig\nbigWig\nNA\nread-depth normalized signal\nGRCh38\nENCSR000EKS\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2011-04-19\nENCODE\nNA\nsee document\nNA\n1\n1_1, 1_2, 1_3\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF635XTF/, /files/ENCFF257HEE/\n747881155\nENCODE Processing Pipeline\n1b0432087f9087c0a9e4f0f5a9d08deb\nNA\nhttps://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/22/953ca40d-376f-4043-8dc9-710dd64a5ea9/ENCFF972GVB.bigWig\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/22/953ca40d-376f-4043-8dc9-710dd64a5ea9/ENCFF972GVB.bigWig?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0 GRCh38\nreleased\nlow spot score, mixed read lengths\nNA\nNA\n\n\nENCFF274YGF\nbed narrowPeak\nbed\nnarrowPeak\npeaks\nGRCh38\nENCSR000EKS\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2011-04-19\nENCODE\nNA\nsee document\nNA\n1\n1_1, 1_2, 1_3\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF635XTF/, /files/ENCFF257HEE/\n1348006\nENCODE Processing Pipeline\n9262ab2b89cd60d05deb831cdd6b509e\nNA\nhttps://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/22/e2abbea1-48ca-4895-b2da-82c7e622fde9/ENCFF274YGF.bed.gz\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/22/e2abbea1-48ca-4895-b2da-82c7e622fde9/ENCFF274YGF.bed.gz?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0 GRCh38\nreleased\nlow spot score, mixed read lengths\nNA\nNA\n\n\nENCFF414OGC\nbigWig\nbigWig\nNA\nread-depth normalized signal\nGRCh38\nENCSR000EOT\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2018-05-09\nENCODE\nNA\nNA\nNA\n1\n1_1, 1_2\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF205FNC/, /files/ENCFF180EJG/\n703947460\nENCODE Processing Pipeline\nac6a28c1889b241d0f4f9ba28a1e514d\nNA\nhttps://www.encodeproject.org/files/ENCFF414OGC/@@download/ENCFF414OGC.bigWig\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/18/e5e1f67e-5af2-484a-b399-23bd39f2352d/ENCFF414OGC.bigWig\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/18/e5e1f67e-5af2-484a-b399-23bd39f2352d/ENCFF414OGC.bigWig?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0-alpha.2 GRCh38\nreleased\nNA\nNA\nextremely low read depth\n\n\nENCFF327DFG\nbigBed narrowPeak\nbigBed\nnarrowPeak\npeaks\nGRCh38\nENCSR000EOT\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2018-05-09\nENCODE\nNA\nNA\nNA\n1\n1_1, 1_2\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF185XRG/\n2742316\nENCODE Processing Pipeline\n4995a0e5fe97e15cfd57b9d3fe0b243b\nNA\nhttps://www.encodeproject.org/files/ENCFF327DFG/@@download/ENCFF327DFG.bigBed\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/18/0a02f295-c201-4022-b70d-f57e57883d92/ENCFF327DFG.bigBed\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/18/0a02f295-c201-4022-b70d-f57e57883d92/ENCFF327DFG.bigBed?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0-alpha.2 GRCh38\nreleased\nNA\nNA\nextremely low read depth\n\n\nENCFF185XRG\nbed narrowPeak\nbed\nnarrowPeak\npeaks\nGRCh38\nENCSR000EOT\nDNase-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nDNA\nNA\nNA\nNA\nNA\nNA\n2018-05-09\nENCODE\nNA\nNA\nNA\n1\n1_1, 1_2\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF205FNC/, /files/ENCFF180EJG/\n1821516\nENCODE Processing Pipeline\n04653af177917b3dda96b9454fd8f90e\nNA\nhttps://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\nNA\nNA\nNA\nreleased\ns3://encode-public/2020/11/18/977b8c4d-588a-47dc-9371-b702ce9715c2/ENCFF185XRG.bed.gz\nhttps://datasetencode.blob.core.windows.net/dataset/2020/11/18/977b8c4d-588a-47dc-9371-b702ce9715c2/ENCFF185XRG.bed.gz?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v3.0.0-alpha.2 GRCh38\nreleased\nNA\nNA\nextremely low read depth"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#explore-table",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#explore-table",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Explore table",
    "text": "Explore table\nCheck genome assembly\n\n\nCode\ndat = dat_metadata_import\ntable(dat$`File assembly`)\n\n\n\nGRCh38 \n    85 \n\n\nCheck biosample\n\n\nCode\ndat = dat_metadata_import\ntable(dat$`Biosample term name`)\n\n\n\nK562 \n  85 \n\n\nCheck data\n\n\nCode\nvec1 = dat_metadata_selected$Index_File\nvec2 = dat_metadata_import$`File accession`\nall(vec1 %in% vec2)\n\n\nTRUE"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#arrange-metadata-tables",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#arrange-metadata-tables",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Arrange metadata tables",
    "text": "Arrange metadata tables\nHelper function\n\n\nCode\nfun_simplify_table = function(dat){\n    \n    ### rename some columns\n    dat = dat %&gt;% \n        dplyr::mutate(\n            Index_Experiment = `Experiment accession`,\n            Index_File       = `File accession`,\n            File_Format      = `File format`,\n            File_Type        = `File type`,\n            Output_Type      = `Output type`,\n            Genome           = `File assembly`,\n            #Target           = str_remove(`Experiment target`, \"-human\"),\n            Bio_Replicates   = `Biological replicate(s)`,\n            Analysis         = `File analysis title`,\n            File_Name        = basename(`File download URL`),\n            File_URL         = `File download URL`\n        )\n    \n    ### select the needed columns\n    dat = dat %&gt;%\n        dplyr::select(\n            Assay,\n            Index_Experiment,\n            Index_File,\n            File_Format,\n            File_Type,\n            Output_Type,\n            Genome,\n            #Target,\n            Bio_Replicates,\n            Analysis,\n            md5sum,\n            File_Name,\n            File_URL\n        )\n\n    ### return the simplified table\n    return(dat)\n}\n\n\nSimplify the metatable\n\n\nCode\n### arrange and simplify the table\ndat = dat_metadata_import\ndat = fun_simplify_table(dat)\n\n### subset by selected files\nvec = dat_metadata_selected$Index_File\ndat = dat %&gt;% dplyr::filter(Index_File %in% vec)\n\n### assign and show\ndat_metadata_simplify = dat\nprint(dim(dat))\nfun_display_table(dat)\n\n\n[1] 10 12\n\n\n\n\n\nAssay\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Type\nOutput_Type\nGenome\nBio_Replicates\nAnalysis\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\nDNase-seq\nENCSR000EKS\nENCFF972GVB\nbigWig\nbigWig\nread-depth normalized signal\nGRCh38\n1\nENCODE4 v3.0.0 GRCh38\n1b0432087f9087c0a9e4f0f5a9d08deb\nENCFF972GVB.bigWig\nhttps://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\n\n\nDNase-seq\nENCSR000EKS\nENCFF274YGF\nbed narrowPeak\nbed\npeaks\nGRCh38\n1\nENCODE4 v3.0.0 GRCh38\n9262ab2b89cd60d05deb831cdd6b509e\nENCFF274YGF.bed.gz\nhttps://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nDNase-seq\nENCSR000EOT\nENCFF414OGC\nbigWig\nbigWig\nread-depth normalized signal\nGRCh38\n1\nENCODE4 v3.0.0-alpha.2 GRCh38\nac6a28c1889b241d0f4f9ba28a1e514d\nENCFF414OGC.bigWig\nhttps://www.encodeproject.org/files/ENCFF414OGC/@@download/ENCFF414OGC.bigWig\n\n\nDNase-seq\nENCSR000EOT\nENCFF185XRG\nbed narrowPeak\nbed\npeaks\nGRCh38\n1\nENCODE4 v3.0.0-alpha.2 GRCh38\n04653af177917b3dda96b9454fd8f90e\nENCFF185XRG.bed.gz\nhttps://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\n\n\nATAC-seq\nENCSR483RKN\nENCFF600FDO\nbigWig\nbigWig\nsignal p-value\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\n044f8568fb4c7735cf01e4f8d0d3e5b9\nENCFF600FDO.bigWig\nhttps://www.encodeproject.org/files/ENCFF600FDO/@@download/ENCFF600FDO.bigWig\n\n\nATAC-seq\nENCSR483RKN\nENCFF558BLC\nbed narrowPeak\nbed\npseudoreplicated peaks\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\n3cd5e262b185a5459cfeaa5a2f1a2f18\nENCFF558BLC.bed.gz\nhttps://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nATAC-seq\nENCSR483RKN\nENCFF925CYR\nbed narrowPeak\nbed\nIDR thresholded peaks\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\na2b384cec478736092661d14eef3cef9\nENCFF925CYR.bed.gz\nhttps://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nATAC-seq\nENCSR868FGK\nENCFF357GNC\nbigWig\nbigWig\nsignal p-value\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n00b10e391e8f2361990a9b4f94ac055c\nENCFF357GNC.bigWig\nhttps://www.encodeproject.org/files/ENCFF357GNC/@@download/ENCFF357GNC.bigWig\n\n\nATAC-seq\nENCSR868FGK\nENCFF948AFM\nbed narrowPeak\nbed\nIDR thresholded peaks\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n76bc2c332fd638d7cb45490d5404e352\nENCFF948AFM.bed.gz\nhttps://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nATAC-seq\nENCSR868FGK\nENCFF333TAT\nbed narrowPeak\nbed\npseudoreplicated peaks\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n0f7a6c13e23c2e3fc8716153a89ed481\nENCFF333TAT.bed.gz\nhttps://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#prepare-download-files",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#prepare-download-files",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Prepare download files",
    "text": "Prepare download files\nHelper function\n\n\nCode\nfun_map_assay_label = function(txt){\n    vec1 = c(\"ATAC-seq\", \"DNase-seq\")\n    vec2 = c(\"ATAC\",     \"DNase\")\n    res  = fun_str_map_detect(txt, vec1, vec2, .default=txt)\n    return(res)\n}\n\n\n\n\nCode\nfun_map_file_ext = function(txt){\n    vec1 = c(\"bigWig\", \"bed narrowPeak\")\n    vec2 = c(\"bw\",     \"bed.gz\")\n    res  = fun_str_map_detect(txt, vec1, vec2, .default=txt)\n    return(res)\n}\n\n\nRename filename\n\n\nCode\n### rename filename\ndat = dat_metadata_simplify\ndat = dat %&gt;% dplyr::mutate(\n    File_Name = paste(\n        \"K562\",\n        \"hg38\",\n        Index_Experiment,\n        Index_File,\n        fun_map_assay_label(Assay),\n        fun_map_file_ext(File_Format),\n    sep = \".\")\n)\n\n### assign and show\ndat_metadata_arrange = dat\nfun_display_table(dat)\n\n\n\n\n\nAssay\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Type\nOutput_Type\nGenome\nBio_Replicates\nAnalysis\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\nDNase-seq\nENCSR000EKS\nENCFF972GVB\nbigWig\nbigWig\nread-depth normalized signal\nGRCh38\n1\nENCODE4 v3.0.0 GRCh38\n1b0432087f9087c0a9e4f0f5a9d08deb\nK562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw\nhttps://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\n\n\nDNase-seq\nENCSR000EKS\nENCFF274YGF\nbed narrowPeak\nbed\npeaks\nGRCh38\n1\nENCODE4 v3.0.0 GRCh38\n9262ab2b89cd60d05deb831cdd6b509e\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nhttps://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nDNase-seq\nENCSR000EOT\nENCFF414OGC\nbigWig\nbigWig\nread-depth normalized signal\nGRCh38\n1\nENCODE4 v3.0.0-alpha.2 GRCh38\nac6a28c1889b241d0f4f9ba28a1e514d\nK562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw\nhttps://www.encodeproject.org/files/ENCFF414OGC/@@download/ENCFF414OGC.bigWig\n\n\nDNase-seq\nENCSR000EOT\nENCFF185XRG\nbed narrowPeak\nbed\npeaks\nGRCh38\n1\nENCODE4 v3.0.0-alpha.2 GRCh38\n04653af177917b3dda96b9454fd8f90e\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nhttps://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\n\n\nATAC-seq\nENCSR483RKN\nENCFF600FDO\nbigWig\nbigWig\nsignal p-value\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\n044f8568fb4c7735cf01e4f8d0d3e5b9\nK562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw\nhttps://www.encodeproject.org/files/ENCFF600FDO/@@download/ENCFF600FDO.bigWig\n\n\nATAC-seq\nENCSR483RKN\nENCFF558BLC\nbed narrowPeak\nbed\npseudoreplicated peaks\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\n3cd5e262b185a5459cfeaa5a2f1a2f18\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nhttps://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nATAC-seq\nENCSR483RKN\nENCFF925CYR\nbed narrowPeak\nbed\nIDR thresholded peaks\nGRCh38\n1, 2\nENCODE4 v1.9.1 GRCh38\na2b384cec478736092661d14eef3cef9\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nhttps://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nATAC-seq\nENCSR868FGK\nENCFF357GNC\nbigWig\nbigWig\nsignal p-value\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n00b10e391e8f2361990a9b4f94ac055c\nK562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw\nhttps://www.encodeproject.org/files/ENCFF357GNC/@@download/ENCFF357GNC.bigWig\n\n\nATAC-seq\nENCSR868FGK\nENCFF948AFM\nbed narrowPeak\nbed\nIDR thresholded peaks\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n76bc2c332fd638d7cb45490d5404e352\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\nhttps://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nATAC-seq\nENCSR868FGK\nENCFF333TAT\nbed narrowPeak\nbed\npseudoreplicated peaks\nGRCh38\n1, 2, 3\nENCODE4 v1.9.1 GRCh38\n0f7a6c13e23c2e3fc8716153a89ed481\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nhttps://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\n\n\n\nCheck results\n\n\nCode\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(Index_Experiment, Index_File, File_Format, File_Name)\nfun_display_table(dat)\n\n\n\n\n\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Name\n\n\n\n\nENCSR000EKS\nENCFF972GVB\nbigWig\nK562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw\n\n\nENCSR000EKS\nENCFF274YGF\nbed narrowPeak\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n\n\nENCSR000EOT\nENCFF414OGC\nbigWig\nK562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw\n\n\nENCSR000EOT\nENCFF185XRG\nbed narrowPeak\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n\n\nENCSR483RKN\nENCFF600FDO\nbigWig\nK562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw\n\n\nENCSR483RKN\nENCFF558BLC\nbed narrowPeak\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n\n\nENCSR483RKN\nENCFF925CYR\nbed narrowPeak\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n\n\nENCSR868FGK\nENCFF357GNC\nbigWig\nK562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw\n\n\nENCSR868FGK\nENCFF948AFM\nbed narrowPeak\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\nENCSR868FGK\nENCFF333TAT\nbed narrowPeak\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n\n\n\n\n\nChecksum table\n\n\nCode\n### get md5sum for each file\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(md5sum, File_Name)\n\n### assign and show\ndat_download_checksum = dat\nfun_display_table(dat)\n\n\n\n\n\nmd5sum\nFile_Name\n\n\n\n\n1b0432087f9087c0a9e4f0f5a9d08deb\nK562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw\n\n\n9262ab2b89cd60d05deb831cdd6b509e\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n\n\nac6a28c1889b241d0f4f9ba28a1e514d\nK562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw\n\n\n04653af177917b3dda96b9454fd8f90e\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n\n\n044f8568fb4c7735cf01e4f8d0d3e5b9\nK562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw\n\n\n3cd5e262b185a5459cfeaa5a2f1a2f18\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n\n\na2b384cec478736092661d14eef3cef9\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n\n\n00b10e391e8f2361990a9b4f94ac055c\nK562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw\n\n\n76bc2c332fd638d7cb45490d5404e352\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n0f7a6c13e23c2e3fc8716153a89ed481\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#generate-download-scripts",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#generate-download-scripts",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Generate download scripts",
    "text": "Generate download scripts\nwget -O FILE URL\n\n\nCode\n### setup download file wget command\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::mutate(\n        CMD = paste(\n            \"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL\n        )\n    )\n\n### add Shebang and initial commands\ndat = dat %&gt;% dplyr::select(CMD)\ndat = rbind('echo -n \"\" &gt; run_download.log.txt', dat)\ncolnames(dat) = \"#!/bin/bash\"\n\n### assign and show\ndat_download_script = dat\nfun_display_table(dat)\n\n\n\n\n\n#!/bin/bash\n\n\n\n\necho -n \"\" &gt; run_download.log.txt\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw https://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz https://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw https://www.encodeproject.org/files/ENCFF414OGC/@@download/ENCFF414OGC.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz https://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw https://www.encodeproject.org/files/ENCFF600FDO/@@download/ENCFF600FDO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw https://www.encodeproject.org/files/ENCFF357GNC/@@download/ENCFF357GNC.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_ocr_01_create_download_script_R.html#save-results",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### set output path\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\n### create directory if not exist\ndir.create(txt_fdiry, showWarnings = FALSE)\n\n### write checksum file\ntxt_fname  = \"run_download_files.sh\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_script\nwrite_tsv(dat, txt_fpath)\n\n### save table\ntxt_fname  = \"checksum_md5sum.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_checksum\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html",
    "title": "Prepare TSS annotation 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"genome_tss\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html#define-file-labeling",
    "title": "Prepare TSS annotation 02",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname,\n    \"Label\"  = c(\"genome_tss_pol2\", \"genome_tss_pol2_rnaseq\")\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\ngenome_tss\nK562.hg38.TSS.selected_by_highest_Pol2_signal.bed.gz\ngenome_tss_pol2\n\n\ngenome_tss\nK562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.bed.gz\ngenome_tss_pol2_rnaseq"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_tss_02_pol2_export_metadata_R.html#save-results",
    "title": "Prepare TSS annotation 02",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_csaw\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#import-data",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "Import data",
    "text": "Import data\nCheck data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.ASTARR.csaw.KS91.bed.gz \nK562.hg38.ASTARR.csaw.KSMerge.bed.gz \nsummary \n\n\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndescription.tsv \nmetadata.label.tsv \n\n\nRead column names\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"description.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_cname     = dat\nvec_txt_cname = dat$Name\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nScore assigned to a region.\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\nLog2FC\nFold change (normalized output/input ratio, in log2 space)\n\n\nInput_CPM\nInput CPM, mean across replicates\n\n\nOutput_CPM\nOutput CPM, mean across replicates\n\n\nMinusLog10PValue\n-log10 of P-value\n\n\nMinusLog10QValue\n-log10 of Q-value (FDR)\n\n\nDataset\nDataset\n\n\nGroup\nAssay name\n\n\nLabel\nRegion label\n\n\n\n\n\nRead tables\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.csaw.KS91.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_ks91 = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n62\n.\n-4.184\n0.204\n0.002\n7.358\n6.299\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n79\n.\n-6.187\n0.209\n0.000\n9.192\n7.917\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n42\n.\n-2.236\n0.196\n0.013\n5.062\n4.267\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n17201\n17800\nchr1:17201-17800\n64\n.\n-1.944\n0.790\n0.021\n7.506\n6.429\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n28876\n29650\nchr1:28876-29650\n76\n.\n-2.559\n0.691\n0.016\n8.940\n7.698\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n30776\n31100\nchr1:30776-31100\n40\n.\n-2.501\n0.252\n0.003\n4.826\n4.060\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.csaw.KSMerge.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_ksmerge = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n17201\n17800\nchr1:17201-17800\n84\n.\n-1.594\n0.658\n0.054\n10.069\n8.496\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n28876\n29650\nchr1:28876-29650\n98\n.\n-3.123\n0.897\n0.010\n11.867\n9.886\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n30776\n31100\nchr1:30776-31100\n59\n.\n-2.743\n0.298\n0.007\n7.057\n5.994\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#explore-data",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "Explore data",
    "text": "Explore data\n\nCompare the number of significant regions\n\n\nCode\n### combine two tables\nlst = list(\n    \"KSMerge (6Dna7Rna)\" = dat_region_ksmerge,\n    \"KS91 (6Dna4Rna)\"    = dat_region_ks91\n)\ndat = bind_rows(lst, .id = \"Label\")\n\n### label postive, negative, and total\ntmp = dat %&gt;% dplyr::mutate(Sign = \"Total\")\ndat = dat %&gt;% dplyr::mutate(\n    Sign = ifelse(\n        Log2FC &gt; 0, \n        \"Positive\",\n        \"Negative\"\n    )\n)\ndat = bind_rows(dat, tmp)\n\n### label by q-values\ndat = dat %&gt;% dplyr::mutate(\n    Signif0_3 = MinusLog10QValue &gt;= 0.3,\n    Signif0_4 = MinusLog10QValue &gt;= 0.4,\n    Signif0_5 = MinusLog10QValue &gt;= 0.5,\n    Signif1   = MinusLog10QValue &gt;= 1,\n    Signif2   = MinusLog10QValue &gt;= 2,\n    Signif3   = MinusLog10QValue &gt;= 3\n)\n\n### assign and show\ndat_region_arrange = dat\nfun_display_table(head(dat, 3))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\nSign\nSignif0_3\nSignif0_4\nSignif0_5\nSignif1\nSignif2\nSignif3\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nNegative\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nNegative\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nNegative\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\nTRUE\n\n\n\n\n\n\n\nCode\ndat = dat_region_arrange\ndat = dat %&gt;%\n    dplyr::group_by(Label, Sign) %&gt;%\n    dplyr::summarise(\n        Count          = n(),\n        `-log10Q &gt;= 2` = sum(Signif2),\n        `-log10Q &gt;= 3` = sum(Signif3),\n        .groups = \"drop\"\n    )\n\nfun_display_table(dat)\n\n\n\n\n\nLabel\nSign\nCount\n-log10Q &gt;= 2\n-log10Q &gt;= 3\n\n\n\n\nKS91 (6Dna4Rna)\nNegative\n185226\n60250\n34585\n\n\nKS91 (6Dna4Rna)\nPositive\n167718\n71574\n53110\n\n\nKS91 (6Dna4Rna)\nTotal\n352944\n131824\n87695\n\n\nKSMerge (6Dna7Rna)\nNegative\n196566\n71329\n44167\n\n\nKSMerge (6Dna7Rna)\nPositive\n162538\n67848\n49041\n\n\nKSMerge (6Dna7Rna)\nTotal\n359104\n139177\n93208\n\n\n\n\n\n\n\nCode\ndat = dat_region_arrange\ndat = dat %&gt;%\n    dplyr::filter(Signif3) %&gt;%\n    dplyr::group_by(Label, Sign) %&gt;%\n    dplyr::summarise(\n        Count = n(),\n        .groups = \"drop\"\n    ) %&gt;%\n    tidyr::spread(Sign, Count)\n\nfun_display_table(dat)\n\n\n\n\n\nLabel\nNegative\nPositive\nTotal\n\n\n\n\nKS91 (6Dna4Rna)\n34585\n53110\n87695\n\n\nKSMerge (6Dna7Rna)\n44167\n49041\n93208\n\n\n\n\n\n\n\nCode\ndat = dat_region_arrange\ndat = dat %&gt;%\n    dplyr::filter(Signif3) %&gt;%\n    dplyr::group_by(Label, Sign) %&gt;%\n    dplyr::summarise(\n        Count = n(),\n        .groups = \"drop\"\n    ) %&gt;%\n    tidyr::spread(Sign, Count) %&gt;%\n    dplyr::mutate(\n        Positive = round(Positive / Total, 2),\n        Negative = round(Negative / Total, 2)\n    )\n\nfun_display_table(dat)\n\n\n\n\n\nLabel\nNegative\nPositive\nTotal\n\n\n\n\nKS91 (6Dna4Rna)\n0.39\n0.61\n87695\n\n\nKSMerge (6Dna7Rna)\n0.47\n0.53\n93208\n\n\n\n\n\n6DNA4NRA -&gt; 6DNA7NRA\nNumber of significant regions increased. Negative regions increased more than positive regions.\n\n\nCompare score distribution (Log2FC)\n\n\nCode\n### combine table\nlst = list(\n    \"KSMerge (6Dna7Rna)\" = dat_region_ksmerge,\n    \"KS91 (6Dna4Rna)\"    = dat_region_ks91\n)\ndat = bind_rows(lst, .id = \"Label\")\n\n### assign and show\ndat_region_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 712048     14\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\n\n\n\n\n\n\n\nCode\n### label and set factor\ndat = dat_region_arrange\nvec = c(\"KSMerge (6Dna7Rna)\", \"KS91 (6Dna4Rna)\")\ndat = dat %&gt;% dplyr::mutate(Label = factor(Label, levels = vec))\n\n### plot the score distribution\ngpt = ggplot(dat, aes(x=Log2FC, fill=Label)) +\n    geom_density(alpha = 0.5) +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_04_explore_data_R.html#save-results",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "Save results",
    "text": "Save results\n\nFigure: Compare score distribution (Log2FC + Q-Value)\n\n\nCode\n### combine table\nlst = list(\n    \"KSMerge (6Dna7Rna)\" = dat_region_ksmerge,\n    \"KS91 (6Dna4Rna)\"    = dat_region_ks91\n)\ndat = bind_rows(lst, .id = \"Label\")\n\n### label by q-values\ndat = dat %&gt;% dplyr::mutate(Signif3 = MinusLog10QValue &gt;= 3)\n\n### assign and show\ndat_region_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 712048     15\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\nSignif3\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nTRUE\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nTRUE\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\nKSMerge\nASTARR\nKSMerge (6Dna7Rna)\nTRUE\n\n\n\n\n\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n### label and set factor\ndat = dat_region_arrange\nvec = c(\"KSMerge (6Dna7Rna)\", \"KS91 (6Dna4Rna)\")\ndat = dat %&gt;% dplyr::mutate(Label = factor(Label, levels = vec))\n\n### summarize the number of regions (total)\ntmp = dat\nvec = tmp %&gt;%\n    group_by(Label) %&gt;%\n    summarise(Count = n(), .groups=\"drop\") %&gt;%\n    dplyr::mutate(\n        line1 = Label,\n        line2 = paste(\"Count =\", scales::comma(Count)),\n        combined = paste0(line1, \"\\n\", line2)\n    ) %&gt;%\n    { set_names(.$combined, .$Label) }\nvec_txt_label = vec\n\n### plot the score distribution (total)\ngpt = ggplot(tmp, aes(x=Log2FC, color=Label)) +\n    geom_density(linewidth = 1, alpha = 0.5) +\n    scale_color_discrete(\n        ### replace each original level by our multi‐line version\n        labels = vec_txt_label\n    ) +\n    labs(x=\"Log2(fold-change)\", y=\"Density\", title=\"ASTARR CSAW Regions (Total)\")\ngpt1 = gpt\n\n\n### summarize the number of regions (significant)\ntmp = dat %&gt;% dplyr::filter(Signif3)\nvec = tmp %&gt;%\n    group_by(Label) %&gt;%\n    summarise(Count = n(), .groups=\"drop\") %&gt;%\n    dplyr::mutate(\n        line1 = Label,\n        line2 = paste(\"Count =\", scales::comma(Count)),\n        combined = paste0(line1, \"\\n\", line2)\n    ) %&gt;%\n    { set_names(.$combined, .$Label) }\nvec_txt_label = vec\n\n### plot the score distribution (significant)\ngpt = ggplot(tmp, aes(x=Log2FC, color=Label)) +\n    geom_density(linewidth = 1, alpha = 0.5) +\n    scale_color_discrete(\n        ### replace each original level by our multi‐line version\n        labels = vec_txt_label\n    ) +\n    labs(x=\"Log2(fold-change)\", y=\"Density\", title=\"ASTARR CSAW Regions (q-value &lt; 0.001)\")\ngpt2 = gpt\n\noptions(repr.plot.height=4, repr.plot.width=10)\nlst = list(gpt1, gpt2)\nlst = lapply(lst, function(gpt){\n    gpt = gpt +\n        theme_cowplot() +\n        background_grid() +\n        theme_text +\n        theme(\n            legend.position = \"inside\", \n            legend.position.inside = c(0.1, 0.6),\n            legend.background = element_rect(fill = \"white\"),\n            legend.key.spacing.y = unit(0.5, 'cm')\n        )\n    return(gpt)\n})\n\nplt = plot_grid(plotlist = lst, ncol = 1, align = \"v\")\nplt_export = plt\n\noptions(repr.plot.height=6, repr.plot.width=6)\nprint(plt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_astarr_csaw.distribution.log2fc.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 6, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_astarr_csaw.distribution.log2fc.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 6, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html",
    "title": "Prepare ASTARR CSAW Peaks 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_csaw\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#import-data",
    "title": "Prepare ASTARR CSAW Peaks 02",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\natacSTARR.ultra_deep.6dna7rna.csaw_tab_best.hg38.v10.tsv \natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.common_file_formatted.txt \natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.tsv \natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.bed \natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.txt \natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.down.bed \natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt \natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt.gz \natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.up.bed \natacSTARR.ultra_deep.corrected.csaw.hg38.v10.tsv \natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw_tab_best.hg38.v10.tsv \natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.tsv \natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.bed \natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.txt \n\n\n\n\nCode\n### set file directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname = \"atacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.common_file_formatted.txt\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_6dna7rna_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 359118     11\n\n\n\n\n\nseqnames\nstart\nend\nname\nscore\nstrand\nlogFC\ninput_avg_counts.cpm\noutput_avg_counts.cpm\nminusLog10PValue\nminusLog10QValue\n\n\n\n\nchr1\n9976\n10475\nchr1_9976_10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\n\n\nchr1\n14226\n14675\nchr1_14226_14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\n\n\nchr1\n15976\n16525\nchr1_15976_16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\n\n\nchr1\n17201\n17800\nchr1_17201_17800\n84\n.\n-1.594\n0.658\n0.054\n10.069\n8.496\n\n\nchr1\n28876\n29650\nchr1_28876_29650\n98\n.\n-3.123\n0.897\n0.010\n11.867\n9.886\n\n\nchr1\n30776\n31100\nchr1_30776_31100\n59\n.\n-2.743\n0.298\n0.007\n7.057\n5.994\n\n\n\n\n\n\n\nCode\n### set file directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname = \"atacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_corrected_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 352944     11\n\n\n\n\n\nseqnames\nstart\nend\nname\nscore\nstrand\nlogFC\ninput_avg_counts.cpm\noutput_avg_counts.cpm\nminusLog10PValue\nminusLog10QValue\n\n\n\n\nchr1\n9976\n10475\nchr1_9976_10475\n62\n.\n-4.184\n0.204\n0.002\n7.358\n6.299\n\n\nchr1\n14226\n14675\nchr1_14226_14675\n79\n.\n-6.187\n0.209\n0.000\n9.192\n7.917\n\n\nchr1\n15976\n16525\nchr1_15976_16525\n42\n.\n-2.236\n0.196\n0.013\n5.062\n4.267\n\n\nchr1\n17201\n17800\nchr1_17201_17800\n64\n.\n-1.944\n0.790\n0.021\n7.506\n6.429\n\n\nchr1\n28876\n29650\nchr1_28876_29650\n76\n.\n-2.559\n0.691\n0.016\n8.940\n7.698\n\n\nchr1\n30776\n31100\nchr1_30776_31100\n40\n.\n-2.501\n0.252\n0.003\n4.826\n4.060\n\n\n\n\n\nCheck chromosomes:\n\n\nCode\ndat = dat_region_6dna7rna_import\ntable(dat$seqnames)\n\n\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n45294 16767 17689 15505  4994  6314 11618 13218 15032  7363 12384 28011  8764 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrM  chrX \n 6310  7075 20643 14267 19439 26508 29510 14374 12270    14  5755 \n\n\n\n\nCode\ndat = dat_region_corrected_import\ntable(dat$seqnames)\n\n\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n44400 16448 17364 15209  4901  6266 11459 12834 14745  7192 12059 27722  8615 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrX \n 6198  6877 20388 14107 19125 26122 28951 14155 12044  5763"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#arrange-the-table",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#arrange-the-table",
    "title": "Prepare ASTARR CSAW Peaks 02",
    "section": "Arrange the table",
    "text": "Arrange the table\nSet column names\n\n\nCode\nvec_txt_cname1 = c(\n    \"Chrom\",\n    \"ChromStart\",\n    \"ChromEnd\",\n    \"Name\",\n    \"Score\",\n    \"Strand\", \n    \"Log2FC\",\n    \"Input_CPM\",\n    \"Output_CPM\",\n    \"MinusLog10PValue\",\n    \"MinusLog10QValue\"\n)\n\nvec_txt_cname2 = c(\n    vec_txt_cname1,\n    \"Dataset\",\n    \"Group\",\n    \"Label\"\n)\n\n\nArrange tables\n\n\nCode\n### init\nlst = list(\n    \"KSMerge\" = dat_region_6dna7rna_import,\n    \"KS91\"    = dat_region_corrected_import\n)\n\n### arrange data\nlst = lapply(lst, function(dat){\n    ### rename columns\n    colnames(dat) = vec_txt_cname1\n    \n    ### change format of region\n    dat = dat %&gt;% dplyr::mutate(Name = paste0(Chrom, \":\", ChromStart, \"-\", ChromEnd))\n\n    ### filter out mitochondrial regions\n    dat = dat %&gt;% dplyr::filter(Chrom != \"chrM\")\n    return(dat)\n})\n\n### add group and label\ndat = bind_rows(lst, .id = \"Dataset\")\ndat = dat %&gt;% \n    dplyr::mutate(\n        Group = \"ASTARR\",\n        Label = ifelse(\n            Log2FC &gt;= 0,\n            paste(\"ASTARR_A\", \"csaw\", Dataset, sep = \":\"),\n            paste(\"ASTARR_R\", \"csaw\", Dataset, sep = \":\")\n        )\n    ) %&gt;%\n    dplyr::select(!!!vec_txt_cname2)\nlst = split(dat, dat$Dataset)\n\n### assign\nlst_region_arrange = lst\n\n\nCheck\n\n\nCode\nlst = lst_region_arrange\ndat = lst[[\"KSMerge\"]]\ndat_region_6dna7rna_arrange = dat\n\nprint(table(dat$Chrom))\ncat(\"\\n\")\nprint(dim(dat))\ncat(\"\\n\")\nfun_display_table(head(dat, 3))\n\n\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n45294 16767 17689 15505  4994  6314 11618 13218 15032  7363 12384 28011  8764 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrX \n 6310  7075 20643 14267 19439 26508 29510 14374 12270  5755 \n\n[1] 359104     14\n\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n86\n.\n-4.604\n0.424\n0.001\n10.243\n8.634\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n100\n.\n-5.400\n0.273\n0.002\n12.021\n10.004\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n61\n.\n-2.227\n0.533\n0.012\n7.203\n6.119\nKSMerge\nASTARR\nASTARR_R:csaw:KSMerge\n\n\n\n\n\n\n\nCode\nlst = lst_region_arrange\ndat = lst[[\"KS91\"]]\ndat_region_corrected_arrange = dat\n\nprint(table(dat$Chrom))\ncat(\"\\n\")\nprint(dim(dat))\ncat(\"\\n\")\nfun_display_table(head(dat, 3))\n\n\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20 \n44400 16448 17364 15209  4901  6266 11459 12834 14745  7192 12059 27722  8615 \nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrX \n 6198  6877 20388 14107 19125 26122 28951 14155 12044  5763 \n\n[1] 352944     14\n\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nLog2FC\nInput_CPM\nOutput_CPM\nMinusLog10PValue\nMinusLog10QValue\nDataset\nGroup\nLabel\n\n\n\n\nchr1\n9976\n10475\nchr1:9976-10475\n62\n.\n-4.184\n0.204\n0.002\n7.358\n6.299\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n14226\n14675\nchr1:14226-14675\n79\n.\n-6.187\n0.209\n0.000\n9.192\n7.917\nKS91\nASTARR\nASTARR_R:csaw:KS91\n\n\nchr1\n15976\n16525\nchr1:15976-16525\n42\n.\n-2.236\n0.196\n0.013\n5.062\n4.267\nKS91\nASTARR\nASTARR_R:csaw:KS91"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#define-column-description",
    "title": "Prepare ASTARR CSAW Peaks 02",
    "section": "Define column description",
    "text": "Define column description\n\n\nCode\n### setup column description\ndat = tribble(\n    ~Name,              ~Note,\n    \"Chrom\",            \"Name of the chromosome\",\n    \"ChromStart\",       \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",         \"The ending position of the feature in the chromosome\",\n    \"Name\",             \"Name given to a region; Use '.' if no name is assigned.\",\n    \"Score\",            \"Score assigned to a region.\",\n    \"Strand\",           \"+/- to denote strand or orientation. Use '.' if no orientation is assigned.\",\n    \"Log2FC\",           \"Fold change (normalized output/input ratio, in log2 space)\",\n    \"Input_CPM\",        \"Input CPM, mean across replicates\",\n    \"Output_CPM\",       \"Output CPM, mean across replicates\",\n    \"MinusLog10PValue\", \"-log10 of P-value\",\n    \"MinusLog10QValue\", \"-log10 of Q-value (FDR)\",\n    \"Dataset\",          \"Dataset\",\n    \"Group\",            \"Assay name\",\n    \"Label\",            \"Region label\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nScore assigned to a region.\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\nLog2FC\nFold change (normalized output/input ratio, in log2 space)\n\n\nInput_CPM\nInput CPM, mean across replicates\n\n\nOutput_CPM\nOutput CPM, mean across replicates\n\n\nMinusLog10PValue\n-log10 of P-value\n\n\nMinusLog10QValue\n-log10 of Q-value (FDR)\n\n\nDataset\nDataset\n\n\nGroup\nAssay name\n\n\nLabel\nRegion label"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_02_export_data_R.html#save-results",
    "title": "Prepare ASTARR CSAW Peaks 02",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.csaw.KSMerge.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### get table\ndat = dat_region_6dna7rna_arrange\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### write tabel\ndir.create(txt_fdiry, showWarnings = FALSE)\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.csaw.KS91.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### get table\ndat = dat_region_corrected_arrange\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### write tabel\ndir.create(txt_fdiry, showWarnings = FALSE)\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html",
    "title": "Prepare ASTARR Input MACS Peaks 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_macs\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#import-data",
    "title": "Prepare ASTARR Input MACS Peaks 03",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz \nK562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz \nsummary \n\n\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndescription.tsv \nmetadata.label.tsv \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname = \"description.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_cname     = dat\nvec_txt_cname = dat$Name\nfun_display_table(head(dat))\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nRegion\nchr:start-end for each row\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_atac_union = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\n\n\n\n\nchr1\n10015\n10442\nchr1:10015-10442\n\n\nchr1\n14253\n14645\nchr1:14253-14645\n\n\nchr1\n16015\n16477\nchr1:16015-16477\n\n\nchr1\n17237\n17772\nchr1:17237-17772\n\n\nchr1\n28903\n29613\nchr1:28903-29613\n\n\nchr1\n30803\n31072\nchr1:30803-31072\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n\n### assign and show\ndat_region_atac_overlap = dat\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\n\n\n\n\nchr1\n10038\n10405\nchr1:10038-10405\n\n\nchr1\n14282\n14614\nchr1:14282-14614\n\n\nchr1\n16025\n16338\nchr1:16025-16338\n\n\nchr1\n17288\n17689\nchr1:17288-17689\n\n\nchr1\n28934\n29499\nchr1:28934-29499\n\n\nchr1\n115429\n115969\nchr1:115429-115969"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#explore-data",
    "title": "Prepare ASTARR Input MACS Peaks 03",
    "section": "Explore data",
    "text": "Explore data\nHelper function to get the mode of a continuous variable\n\n\nCode\nget_mode_continuous &lt;- function(x, ...) {\n    obj = density(x, ...)\n    num = obj$x[which.max(obj$y)]\n    return(num)\n}\n\n\nSummary of region length\n\n\nCode\ndat = dat_region_atac_union\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\nvec = dat$Length\n\ncat(\"#{Region} =\", nrow(dat), \"\\n\")\nsummary(vec)\n\nnum = quantile(vec, probs=0.9, na.rm=TRUE)\ncat(\"90th percentile\", num, \"\\n\")\n\nnum = get_mode_continuous(vec)\ncat(\"Mode:\", num, \"\\n\")\n\n\n#{Region} = 246852 \n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  218.0   435.0   665.0   800.2  1031.0  6251.0 \n\n\n90th percentile 1475 \nMode: 422.7296 \n\n\n\n\nCode\ndat = dat_region_atac_overlap\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\nvec = dat$Length\n\ncat(\"#{Region} =\", nrow(dat), \"\\n\")\nsummary(vec)\n\nnum = quantile(vec, probs=0.9, na.rm=TRUE)\ncat(\"90th percentile\", num, \"\\n\")\n\nnum = get_mode_continuous(vec)\ncat(\"Mode:\", num, \"\\n\")\n\n\n#{Region} = 150042 \n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    1.0   401.0   597.0   712.8   909.0  6172.0 \n\n\n90th percentile 1293 \nMode: 342.22 \n\n\nDistribution of region length\n\n\nCode\nlst = list(\n    \"ATAC (Union of all reps)\"   = dat_region_atac_union,\n    \"ATAC (Overlap of all reps)\" = dat_region_atac_overlap\n)\n\ndat  = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 3000)\n\ngpt = ggplot(dat, aes(x = Length, fill = Label)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\nlst = list(\n    \"ATAC (Union of all reps)\"   = dat_region_atac_union,\n    \"ATAC (Overlap of all reps)\" = dat_region_atac_overlap\n)\n\ndat  = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% \n    dplyr::mutate(Length = ChromEnd - ChromStart) %&gt;%\n    dplyr::filter(Length &lt; 3000)\n\ngpt = ggplot(dat, aes(x = Length, color = Label)) + \n    geom_density() +\n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_astarr_macs_03_explore_data_R.html#save-figures",
    "title": "Prepare ASTARR Input MACS Peaks 03",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\n\n\nCode\n### combine data\nlst = list(\n    \"ATAC (Union of all reps)\"   = dat_region_atac_union,\n    \"ATAC (Overlap of all reps)\" = dat_region_atac_overlap\n)\n\ndat  = bind_rows(lst, .id = \"Label\")\ndat = dat %&gt;% dplyr::mutate(Length = ChromEnd - ChromStart)\ndat_region_merge = dat\n\n### compute counts _after_ the same filtering\ndat = dat_region_merge\ndat = dat %&gt;%\n    group_by(Label) %&gt;%\n    summarise(\n        Count = n(), \n        Mode  = get_mode_continuous(Length),\n        .groups=\"drop\")\ndat_region_count = dat\n\n### build a named vector of new legend labels, each with two lines:\n###   original label\n###   Count = 12345\ndat = dat_region_count\nvec = dat %&gt;%\n    dplyr::mutate(\n        line1 = Label,\n        line2 = paste(\"Count =\", scales::comma(Count)),\n        line3 = paste(\"Mode =\", round(Mode), \"bp\"),\n        combined = paste0(line1, \"\\n\", line2, \"\\n\", line3)\n    ) %&gt;%\n    { set_names(.$combined, .$Label) }\nvec_txt_region_label = vec\n\nprint(vec_txt_region_label)\n\n\n                                  ATAC (Overlap of all reps) \n\"ATAC (Overlap of all reps)\\nCount = 150,042\\nMode = 342 bp\" \n                                    ATAC (Union of all reps) \n  \"ATAC (Union of all reps)\\nCount = 246,852\\nMode = 423 bp\" \n\n\n\n\nCode\n### set limit\ndat = dat_region_merge\ndat = dat %&gt;% dplyr::filter(Length &lt; 3000)\n\n### gplot distribution\ngpt = ggplot(dat, aes(x = Length/1000, colour = Label)) +\n    geom_density(linewidth = 2) +\n    scale_x_continuous(breaks = seq(0, 3, by = 0.5)) +\n    scale_y_continuous(breaks = c(0, 0.5, 1.0)) +\n    scale_color_discrete(\n        ### replace each original level by our multi‐line version\n        labels = vec_txt_region_label\n    ) +\n    labs(x = \"Length (kb)\", y = \"Density\", title = \"Distribution of Region Length\") +\n    theme_cowplot() + \n    background_grid() +\n    theme_text +\n    theme(\n        legend.position = \"inside\", \n        legend.position.inside = c(0.5, 0.7),\n        legend.background = element_rect(fill = \"white\"),\n        legend.key.spacing.y = unit(0.5, 'cm')\n    )\n\ngpt_export = gpt\noptions(repr.plot.height=4, repr.plot.width=6)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_astarr_macs_input.distribution.region_length.below3k.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 4, width = 6, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_astarr_macs_input.distribution.region_length.below3k.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 4, width = 6, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html",
    "title": "Prepare ASTARR Input MACS Peaks 01",
    "section": "",
    "text": "Data: Original files\nPROJECT/data/processed/ASTARRseq_K562_hg38_KS91_210401/peaks\nResults: SymLinks\nPROJECT/results/region/starr_macs\nNote: Differences between these two region set\nCode chunk used for getting the union region set (less stringent region set): merge the narrowPeak files by overlapped across all replicates in the input libraries.\nCode chunk used for getting the overlap region set\nSet environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variable\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_macs\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#import-data",
    "title": "Prepare ASTARR Input MACS Peaks 01",
    "section": "Import data",
    "text": "Import data\nSet the main chromosomes\n\n\nCode\ntxt_fdiry = file.path(FD_DAT, \"external\")\ntxt_fname = \"chrom.hg38.main.bed\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\nvec = c(\"Chrom\", \"ChromStart\", \"ChromEnd\")\ndat = read_tsv(txt_fpath, col_names = vec, show_col_types = FALSE)\nvec = dat$Chrom\n\n### assign and show\nvec_txt_chrom = vec\nprint(vec)\n\n\n [1] \"chr1\"  \"chr10\" \"chr11\" \"chr12\" \"chr13\" \"chr14\" \"chr15\" \"chr16\" \"chr17\"\n[10] \"chr18\" \"chr19\" \"chr2\"  \"chr20\" \"chr21\" \"chr22\" \"chr3\"  \"chr4\"  \"chr5\" \n[19] \"chr6\"  \"chr7\"  \"chr8\"  \"chr9\"  \"chrX\" \n\n\nImport ASTARR input MACS peaks\nThere are six replicates of input libraries.\n\n\nCode\ntxt_fdiry = file.path(FD_DAT, \"processed\", \"STARR_ATAC_K562_Reddy_KS91_210401/peaks\")\nvec = dir(txt_fdiry)\n\nvec_txt_fname = vec\nfor(txt in vec){cat(txt, \"\\n\")}\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dups_marked_peaks.narrowPeak \nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed \nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed \n\n\nPrepare names and read tables\n\n\nCode\n### Prepare names\nvec_txt_fname = c(\n    \"KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\",\n    \"KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\"\n)\nnames(vec_txt_fname) = c(\"union\", \"max_overlaps\")\n\n### Read tables into a list\nlst = lapply(vec_txt_fname, function(txt_fname){\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    dat = read_tsv(txt_fpath, col_names = FALSE, show_col_types = FALSE)\n    return(dat)\n})\n\n### assign and show\nlst_dat_import = lst\nprint(vec_txt_fname)\n\n\n                                                                   union \n\"KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\" \n                                                            max_overlaps \n             \"KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\" \n\n\n\n\nCode\nlst = lst_dat_import\ndat = lst[[1]]\nfun_display_table(head(dat, 3))\n\n\n\n\n\nX1\nX2\nX3\n\n\n\n\nchr1\n10015\n10442\n\n\nchr1\n14253\n14645\n\n\nchr1\n16015\n16477\n\n\n\n\n\n\n\nCode\nlst = lst_dat_import\ndat = lst[[2]]\nfun_display_table(head(dat, 3))\n\n\n\n\n\nX1\nX2\nX3\nX4\n\n\n\n\nchr1\n10038\n10405\n6\n\n\nchr1\n14282\n14614\n6\n\n\nchr1\n16025\n16338\n6\n\n\n\n\n\n\n\nCode\nlst = lst_dat_import\nlst = lapply(lst, function(dat){\n    dat = dat %&gt;% \n        dplyr::filter(X1 %in% vec_txt_chrom) %&gt;%\n        dplyr::select(X1:X3) %&gt;%\n        dplyr::mutate(X4 = fun_gen_region(X1, X2, X3)) %&gt;%\n        dplyr::arrange(X1, X2, X3)\n    return(dat)\n})\n\nlst_dat_arrange = lst\n\n\nDouble check the filtering process\n\n\nCode\nlst = lst_dat_import\ndat = lst[[1]]\ndat = as.data.frame(table(dat$X1))\nfun_display_table(head(dat, 3))\n\n\n\n\n\nVar1\nFreq\n\n\n\n\nchr1\n30534\n\n\nchr1_KI270706v1_random\n35\n\n\nchr1_KI270707v1_random\n1\n\n\n\n\n\n\n\nCode\nlst = lst_dat_arrange\ndat = lst[[1]]\ndat = as.data.frame(table(dat$X1))\nfun_display_table(head(dat, 3))\n\n\n\n\n\nVar1\nFreq\n\n\n\n\nchr1\n30534\n\n\nchr10\n11398\n\n\nchr11\n12010"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#define-column-description",
    "title": "Prepare ASTARR Input MACS Peaks 01",
    "section": "Define column description",
    "text": "Define column description\n\n\nCode\n### set column name and description\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Region\",     \"chr:start-end for each row\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nRegion\nchr:start-end for each row"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_astarr_macs_01_export_data_R.html#save-results",
    "title": "Prepare ASTARR Input MACS Peaks 01",
    "section": "Save results",
    "text": "Save results\nWrite description table of columns\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nTest loop\n\n\nCode\nlst = lst_dat_arrange\nfor (idx in names(lst)){\n    txt_fname = paste(\n        \"K562.hg38.ASTARR.macs.KS91.input.rep_all\",\n        idx,\n        \"q5.bed.gz\",\n        sep = \".\"\n    )\n    print(idx)\n    print(txt_fname)\n}\n\n\n[1] \"union\"\n[1] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\"\n[1] \"max_overlaps\"\n[1] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\"\n\n\nWrite tables\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ndir.create(txt_fdiry, showWarnings = FALSE)\n\nlst = lst_dat_arrange\nfor (idx in names(lst)){\n    ### set directory\n    txt_fname = paste(\n        \"K562.hg38.ASTARR.macs.KS91.input.rep_all\",\n        idx,\n        \"q5.bed.gz\",\n        sep = \".\"\n    )\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n\n    ### write table\n    dat = lst[[idx]]\n    write_tsv(dat, txt_fpath, col_names = FALSE)\n\n    ### show progress\n    print(idx)\n    print(txt_fname)\n    flush.console()\n}\n\n\n[1] \"union\"\n[1] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\"\n[1] \"max_overlaps\"\n[1] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\"\n\n\nSave a copy to the reference folder\n\n\nCode\nFD_REF\n\n\n'/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references'\n\n\n\n\nCode\n### set file path\ntxt_folder = \"fcc_peak_call_atac\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ndir.create(txt_fdiry, showWarnings = FALSE)\n\nlst = lst_dat_arrange\nfor (idx in names(lst)){\n    ### set directory\n    txt_fname = paste(\n        \"STARRseq_ATAC.K562.ReddyLab.hg38.Input.rep_all\",\n        idx,\n        \"q5.bed.gz\",\n        sep = \".\"\n    )\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n\n    ### write table\n    dat = lst[[idx]]\n    write_tsv(dat, txt_fpath, col_names = FALSE)\n\n    ### show progress\n    print(idx)\n    print(txt_fname)\n    flush.console()\n}\n\n\n[1] \"union\"\n[1] \"STARRseq_ATAC.K562.ReddyLab.hg38.Input.rep_all.union.q5.bed.gz\"\n[1] \"max_overlaps\"\n[1] \"STARRseq_ATAC.K562.ReddyLab.hg38.Input.rep_all.max_overlaps.q5.bed.gz\""
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html",
    "href": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html",
    "title": "Prepare ENCODE RNA-seq 02",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh\nSet global variables\nCode\nTXT_FOLDER=\"encode_rnaseq\""
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html#execute",
    "href": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html#execute",
    "title": "Prepare ENCODE RNA-seq 02",
    "section": "Execute",
    "text": "Execute\nRun download script\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nchmod +x ./run_download_files.sh\n\n./run_download_files.sh\n\n\nRun checksum\n\n\nCode\nFN_EXE=run_checksum_files.sh\nFP_EXE=${FD_EXE}/${FN_EXE}\n\n#FN_LOG=checksum.encode_rnaseq.txt\n#FP_LOG=${FD_LOG}/${FN_LOG}\n\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_INP=${FD_OUT}/checksum_md5sum.txt\nFP_OUT=${FD_OUT}/checksum_results.txt\n\n${FP_EXE} ${FP_CNF} ${FD_OUT} ${FP_INP} ${FP_OUT}\n\n\nHostname:           plp-rcc-node-25\nSlurm Array Index: \nTime Stamp:         04-24-25+17:55:29\n\nChange directory:\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_rnaseq\n\nChecksum files...\n\n\nDone!\nRun Time: 1 seconds"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html#review",
    "href": "notebooks/04_prepare_annotation/rnaseq_02_total_execute_download_script_SH.html#review",
    "title": "Prepare ENCODE RNA-seq 02",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nls -sh {*tsv,*.bw} | wc -l\nls -sh {*tsv,*.bw}\n\n\n3\n 11M K562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\n108M K562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw\n128M K562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw\n\n\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFN_OUT=K562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_OUT} | head -n 3\n\n\ngene_id transcript_id(s)    length  effective_length    expected_count  TPM FPKM    posterior_mean_count    posterior_standard_deviation_of_count   pme_TPM pme_FPKM    TPM_ci_lower_bound  TPM_ci_upper_bound  TPM_coefficient_of_quartile_variation   FPKM_ci_lower_bound FPKM_ci_upper_bound FPKM_coefficient_of_quartile_variation\n10904   10904   93.00   0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0   0   0   0   0   0\n12954   12954   94.00   0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0   0   0   0   0   0\n\n\nCheck checksum results\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_OUT=${FD_OUT}/checksum_results.txt\n\ncat ${FP_OUT}\ncat ${FP_OUT} | grep \"FAILED\" && echo \"FAILED\" || echo \"All PASSED\"\n\n\nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv: OK\nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw: OK\nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw: OK\nAll PASSED\n\n\nCheck execution log\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\nhead -n 10 ${FD_OUT}/run_download.log.txt\n\n\n--2025-04-24 17:55:18--  https://www.encodeproject.org/files/ENCFF421TJX/@@download/ENCFF421TJX.tsv\nResolving www.encodeproject.org (www.encodeproject.org)... 34.211.244.144\nConnecting to www.encodeproject.org (www.encodeproject.org)|34.211.244.144|:443... connected.\nHTTP request sent, awaiting response... 307 Temporary Redirect\nLocation: https://encode-public.s3.amazonaws.com/2020/10/30/2033273a-286f-4c94-a652-9d75098cdfb5/ENCFF421TJX.tsv?response-content-disposition=attachment%3B%20filename%3DENCFF421TJX.tsv&AWSAccessKeyId=ASIATGZNGCNX7SWO4ZQN&Signature=3Nq55kAiuNFA6kOwV5cpiBiu3As%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEIb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD%2F5ut0yD%2BA%2FNlCiDNj5MSOsul3igqARG3VQugvvsbIrwIhAKm567vigDQmDqdhizRca4dvZjITXDXdb08VJTSbFKVZKrMFCB8QABoMMjIwNzQ4NzE0ODYzIgz0cZB26wbGUGvh514qkAWTn7DQ6tOMUFhQE040K18mPYvtIlX1s8RYrKLRLXM9nM%2ByDvitV8cYV7NXfoRiI9EdfksnHVMjEu%2FDwvoeFGm7y9t6oamEekLWb%2Bc6zqxj7T0ReSXqOT0VJyblrhHLkiXw0xRgdnja0VU0j%2B%2FAb8TrU%2Fq3OZCdNicA5AdNIoNDwE%2FjMGFRrf22zC5DnloCMHKuzde%2FjMKdd5jxYEBj5sGm6vevIaoQ5d%2FoCcpWIlmtXqyrVA9ACQ3LxyfgRrFpvoxZwBWQlDc8ChcJJtU1USqLoy40MyfRfiXESF5jtgfodVRKENUK7FEP3R4w%2FOEnBsxF7LDU4piK4NzUCiifxXqKxKD5%2FUWCzE8JSXNMcGxCaH9bLqNy72poqQEqdlpUSZnIfUPN9QdEFblFKyM%2B7cATisFoDK4oxq840IxEc7gyfiriMpqdRdUY4HekwiHkzF3EsEC0oW6zIAXJxsPeIrj24WnphrbERq9Bz24hPlu1WDQu9%2F5ZOmaxYm5IqBfwwdW6m6AyBSRaSg5Jh1rO1NT%2FN%2B4y%2Br6zW46DiNQN7LVrPmrTtmWWm0kUqADn0N6CeUMXP5TF8p1xHC44IRY8Ye0jvIWOGnOqNMEu045o9vFF96qSpnDu%2FVuLDfGJINLoWCIjltnj2kLpYItYtzl%2BNhYWRUJEtGarKiNwM6lF47vAkI5fdLbQ7PGqEdTDxfwtFWpb4sVebHlfV6f8BZv2q%2BPcQiC5CQ%2BK0XNxB%2FxksNNOdF7jFj4H97PtNBzz9MSdu6IaciCYh4VlFBOJSI0Tfvo2gxmGj73R2g7Uq3a2gjZU2XcOGLXb%2ByXiroHzkOFisq3sJ4d7td1mhCxNXzeYlnF2f9mF5R6eu84olzFmdlmmXDDk3arABjqwAb9pQw7JoOLzcIzYC5ezMuqAUWXtRHbVcy0EZQcpZKVpGdtYYrzIGIbVo87Wtxl6%2Bq975OGBIQOTlRf2Pl76%2FQ02KDIW6znNnK%2F69TWj%2FIU0QY8acceFg5ohndY4ErmzQMOlZ6VtTHMVS%2FSAatHNiOZq%2B1aE86AW4B8VPQGvcTKpYSSlj0dKJMVt10bwRTkcRXjzMDqWYIjGs3%2B9vnOV%2BQ5VvcJDF%2FYuoR%2FpFLuBmxN%2B&Expires=1745661318 [following]\n--2025-04-24 17:55:18--  https://encode-public.s3.amazonaws.com/2020/10/30/2033273a-286f-4c94-a652-9d75098cdfb5/ENCFF421TJX.tsv?response-content-disposition=attachment%3B%20filename%3DENCFF421TJX.tsv&AWSAccessKeyId=ASIATGZNGCNX7SWO4ZQN&Signature=3Nq55kAiuNFA6kOwV5cpiBiu3As%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEIb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD%2F5ut0yD%2BA%2FNlCiDNj5MSOsul3igqARG3VQugvvsbIrwIhAKm567vigDQmDqdhizRca4dvZjITXDXdb08VJTSbFKVZKrMFCB8QABoMMjIwNzQ4NzE0ODYzIgz0cZB26wbGUGvh514qkAWTn7DQ6tOMUFhQE040K18mPYvtIlX1s8RYrKLRLXM9nM%2ByDvitV8cYV7NXfoRiI9EdfksnHVMjEu%2FDwvoeFGm7y9t6oamEekLWb%2Bc6zqxj7T0ReSXqOT0VJyblrhHLkiXw0xRgdnja0VU0j%2B%2FAb8TrU%2Fq3OZCdNicA5AdNIoNDwE%2FjMGFRrf22zC5DnloCMHKuzde%2FjMKdd5jxYEBj5sGm6vevIaoQ5d%2FoCcpWIlmtXqyrVA9ACQ3LxyfgRrFpvoxZwBWQlDc8ChcJJtU1USqLoy40MyfRfiXESF5jtgfodVRKENUK7FEP3R4w%2FOEnBsxF7LDU4piK4NzUCiifxXqKxKD5%2FUWCzE8JSXNMcGxCaH9bLqNy72poqQEqdlpUSZnIfUPN9QdEFblFKyM%2B7cATisFoDK4oxq840IxEc7gyfiriMpqdRdUY4HekwiHkzF3EsEC0oW6zIAXJxsPeIrj24WnphrbERq9Bz24hPlu1WDQu9%2F5ZOmaxYm5IqBfwwdW6m6AyBSRaSg5Jh1rO1NT%2FN%2B4y%2Br6zW46DiNQN7LVrPmrTtmWWm0kUqADn0N6CeUMXP5TF8p1xHC44IRY8Ye0jvIWOGnOqNMEu045o9vFF96qSpnDu%2FVuLDfGJINLoWCIjltnj2kLpYItYtzl%2BNhYWRUJEtGarKiNwM6lF47vAkI5fdLbQ7PGqEdTDxfwtFWpb4sVebHlfV6f8BZv2q%2BPcQiC5CQ%2BK0XNxB%2FxksNNOdF7jFj4H97PtNBzz9MSdu6IaciCYh4VlFBOJSI0Tfvo2gxmGj73R2g7Uq3a2gjZU2XcOGLXb%2ByXiroHzkOFisq3sJ4d7td1mhCxNXzeYlnF2f9mF5R6eu84olzFmdlmmXDDk3arABjqwAb9pQw7JoOLzcIzYC5ezMuqAUWXtRHbVcy0EZQcpZKVpGdtYYrzIGIbVo87Wtxl6%2Bq975OGBIQOTlRf2Pl76%2FQ02KDIW6znNnK%2F69TWj%2FIU0QY8acceFg5ohndY4ErmzQMOlZ6VtTHMVS%2FSAatHNiOZq%2B1aE86AW4B8VPQGvcTKpYSSlj0dKJMVt10bwRTkcRXjzMDqWYIjGs3%2B9vnOV%2BQ5VvcJDF%2FYuoR%2FpFLuBmxN%2B&Expires=1745661318\nResolving encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)... 52.92.139.57, 52.92.187.233, 52.92.249.1, ...\nConnecting to encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)|52.92.139.57|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11061127 (11M) [binary/octet-stream]"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html",
    "href": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_REGION_FOLDER = \"encode_open_chromatin\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#define-column-description",
    "href": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#define-column-description",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Define column description",
    "text": "Define column description\nThe peak file is in narrowPeak format, which is a standard six field bed with four additional fields (BED6+4 format)\n\n\nCode\n### ENCODE narrowPeak: Narrow (or Point-Source) Peaks format\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Name given to a region; Use '.' if no name is assigned.\",\n    \"Score\",      \"Indicates how dark the peak will be displayed in the browser (0-1000).\",\n    \"Strand\",     \"+/- to denote strand or orientation. Use '.' if no orientation is assigned.\",\n    \"SignalValue\",\"Measurement of overall (usually, average) enrichment for the region.\",\n    \"PValue\",     \"Measurement of statistical significance (-log10). Use -1 if no pValue is assigned.\",\n    \"QValue\",     \"Measurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\",\n    \"Peak\",       \"Point-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called.\"\n    \n)\n\n### assign and show\ndat_cnames = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nIndicates how dark the peak will be displayed in the browser (0-1000).\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\nSignalValue\nMeasurement of overall (usually, average) enrichment for the region.\n\n\nPValue\nMeasurement of statistical significance (-log10). Use -1 if no pValue is assigned.\n\n\nQValue\nMeasurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\n\n\nPeak\nPoint-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called."
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#define-file-labeling",
    "href": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#define-file-labeling",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\n\n### arrange table\ndat = dat %&gt;% tidyr::separate(\n        FName, \n        c(\"Biosample\", \"Genome\", \"Index_Experiment\", \"Index_File\", \"Assay\", \"File_Type\", \"File_Ext\"),\n        sep = \"\\\\.\",\n        remove = FALSE\n    ) %&gt;%\n    dplyr::mutate(Label = paste(tolower(Assay), Index_File, sep=\"_\")) %&gt;%\n    dplyr::select(Folder, FName, Label) \n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nDNase_ENCFF274YGF\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nDNase_ENCFF185XRG\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nATAC_ENCFF558BLC\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nATAC_ENCFF925CYR\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nATAC_ENCFF333TAT\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\nATAC_ENCFF948AFM"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#save-results",
    "href": "notebooks/01_prepare_fcc/region_ocr_04_create_metadata_R.html#save-results",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cnames\nwrite_tsv(dat, txt_fpath)\n\n\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata_region_label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html",
    "href": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html#run-the-download-script",
    "href": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html#run-the-download-script",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "Run the download script",
    "text": "Run the download script\nRun the script that was generated in the previous step\nExecute\n\n\nCode\nFD_OUT=${FD_DAT}/external/encode_open_chromatin\n\ncd ${FD_OUT}\nchmod +x ./run_download.sh\n\n./run_download.sh"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html#review",
    "href": "notebooks/01_prepare_fcc/region_ocr_02_execute_download_data_SH.html#review",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\nls ${FD_OUT}/*.bed.gz | wc -l\nls ${FD_OUT}/*.bed.gz | xargs -n 1 basename\n\n\n6\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n\n\nCode\nls -lh ${FD_OUT}/*.bed.gz\n\n\n-rw-rw-r-- 1 kk319 reddylab 1.3M Nov 24  2020 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 1.8M Nov 20  2020 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 4.8M Mar  2  2021 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 2.7M Mar  2  2021 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 6.8M Mar 19  2021 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 4.1M Mar 19  2021 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin/K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\nCheck execution log\n\n\nCode\nhead -n 10 ${FD_OUT}/run_download.log.txt\n\n\n--2024-04-29 14:42:28--  https://www.encodeproject.org/files/ENCFF357GNC/@@download/ENCFF357GNC.bigWig\nResolving www.encodeproject.org (www.encodeproject.org)... 34.211.244.144\nConnecting to www.encodeproject.org (www.encodeproject.org)|34.211.244.144|:443... connected.\nHTTP request sent, awaiting response... 307 Temporary Redirect\nLocation: https://encode-public.s3.amazonaws.com/2021/03/16/9ff8b5ae-10d6-4711-96ea-a3cbb44aaadb/ENCFF357GNC.bigWig?response-content-disposition=attachment%3B%20filename%3DENCFF357GNC.bigWig&AWSAccessKeyId=ASIATGZNGCNXZJNTIWVL&Signature=ZCH2OcwIvhMklR26IbdBHzNlrlc%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEMP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHfDoL%2FkyNuJSfE5e58XEMDFZL2ZrtcD43gS5SNwI%2FGSAiEAgSPEY8cYGjol9F6QCo0Rq21KNvLUEqipUEhKdg57hGIqswUIHBAAGgwyMjA3NDg3MTQ4NjMiDP%2FLRjV5%2BOB5Hl3DLSqQBRtgZo1MbccqvpJe0xY4AGcq34zs1w60Icvmy8xRACyuPIeBkBfr9f15LH3cRIJmftU0%2B29HnHnAUp%2B%2BhU7z4LmGmqN0AHSKpPythUmjxdaWQRuPVNS8dfofAZhu5ItTakjczM8IusAup1jjYRCBOOPK74X8uwAvXfndiz5ETO6fcxcG2TIaFDoRPWjX%2FW6jmjbS3NUK%2BlheUToUTLKqiC9tyVHSb0J5zFrU6Dcdgjua9h8dPyQfKOy4iTVltlrV3qPSCatSOmZcw4Km49vV0eOk%2FP7b6qNx027sJ3Rx7zZ9lOKLzG7Xq7TTflVlF1HmzYs3FZHtT8sgxR8Twaf8Tckafar9hTpaI6s3334FxSZwUPta2iQdEEMl1Pta10NElCuoHhUlA0QtEXBWZpZW%2BKjwqMvY5wOQq%2BaFlYM%2BXWVMMl%2FDY6Kky1VHfCgbM0aVIsdQIDKUsSczQX11bxr8%2BP4XSC38QXuRLAeMRFhvTOQLixCf00ywlYiZYqSppIEI5yzl1ZnkuMgo4Vy%2Bk6cXWNX0EungZleFRTSzaMhxtfJWSJOzhH0o44K6pV6xaFykbtgX3m6oJhf%2FyCkaLnWqdYwsrIbhky66OJED2%2F67I4959ToX3jem5Ji6u0Sebe2gvVU6XFSwwSa255EwBx6GegSDo74O10AKWGOToZXwqHRUlEaY3DS2fOgT4zT9QbF4d0vinpAhKUSCgpcs2t4coZRQdjmlbRLUXVQjmKqEOJPIT%2FiQFj2xvHHn2a4Cv%2BQBjLUfyebupDmeX3CsHDiB74RqMX8TYGYm4SztYNoHgZsEeQ3EAjgQFRNBH1%2FwcbrOGxIPSvI9z0ayj9F46a2r2XXyjAlTwj4aAo8K77IF8HDdMKHNv7EGOrEBbRlsSibEbVGS7a2bdYrlWpHv0pld%2B3AxRSf%2FYBl6fZ4dWfzQnlTH6wir5%2FkcVX4H6%2FKbxHjb7wAztGEOIgqC%2B2vl%2Fle4CjtsW4wuHODHYaIuaaHMjkVA1wCIW2qZ%2B8bt67q%2F41RwvXLWSzBcSkFt5l70x6Z7E1uZxSdr4xGLNVLLuvY%2FHsQj2bgCy8GSEQ57InO48TfSy3T6G7gDIZpoTO93m%2FSMvNTzUi2hgPC1zy4c&Expires=1714545748 [following]\n--2024-04-29 14:42:28--  https://encode-public.s3.amazonaws.com/2021/03/16/9ff8b5ae-10d6-4711-96ea-a3cbb44aaadb/ENCFF357GNC.bigWig?response-content-disposition=attachment%3B%20filename%3DENCFF357GNC.bigWig&AWSAccessKeyId=ASIATGZNGCNXZJNTIWVL&Signature=ZCH2OcwIvhMklR26IbdBHzNlrlc%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEMP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHfDoL%2FkyNuJSfE5e58XEMDFZL2ZrtcD43gS5SNwI%2FGSAiEAgSPEY8cYGjol9F6QCo0Rq21KNvLUEqipUEhKdg57hGIqswUIHBAAGgwyMjA3NDg3MTQ4NjMiDP%2FLRjV5%2BOB5Hl3DLSqQBRtgZo1MbccqvpJe0xY4AGcq34zs1w60Icvmy8xRACyuPIeBkBfr9f15LH3cRIJmftU0%2B29HnHnAUp%2B%2BhU7z4LmGmqN0AHSKpPythUmjxdaWQRuPVNS8dfofAZhu5ItTakjczM8IusAup1jjYRCBOOPK74X8uwAvXfndiz5ETO6fcxcG2TIaFDoRPWjX%2FW6jmjbS3NUK%2BlheUToUTLKqiC9tyVHSb0J5zFrU6Dcdgjua9h8dPyQfKOy4iTVltlrV3qPSCatSOmZcw4Km49vV0eOk%2FP7b6qNx027sJ3Rx7zZ9lOKLzG7Xq7TTflVlF1HmzYs3FZHtT8sgxR8Twaf8Tckafar9hTpaI6s3334FxSZwUPta2iQdEEMl1Pta10NElCuoHhUlA0QtEXBWZpZW%2BKjwqMvY5wOQq%2BaFlYM%2BXWVMMl%2FDY6Kky1VHfCgbM0aVIsdQIDKUsSczQX11bxr8%2BP4XSC38QXuRLAeMRFhvTOQLixCf00ywlYiZYqSppIEI5yzl1ZnkuMgo4Vy%2Bk6cXWNX0EungZleFRTSzaMhxtfJWSJOzhH0o44K6pV6xaFykbtgX3m6oJhf%2FyCkaLnWqdYwsrIbhky66OJED2%2F67I4959ToX3jem5Ji6u0Sebe2gvVU6XFSwwSa255EwBx6GegSDo74O10AKWGOToZXwqHRUlEaY3DS2fOgT4zT9QbF4d0vinpAhKUSCgpcs2t4coZRQdjmlbRLUXVQjmKqEOJPIT%2FiQFj2xvHHn2a4Cv%2BQBjLUfyebupDmeX3CsHDiB74RqMX8TYGYm4SztYNoHgZsEeQ3EAjgQFRNBH1%2FwcbrOGxIPSvI9z0ayj9F46a2r2XXyjAlTwj4aAo8K77IF8HDdMKHNv7EGOrEBbRlsSibEbVGS7a2bdYrlWpHv0pld%2B3AxRSf%2FYBl6fZ4dWfzQnlTH6wir5%2FkcVX4H6%2FKbxHjb7wAztGEOIgqC%2B2vl%2Fle4CjtsW4wuHODHYaIuaaHMjkVA1wCIW2qZ%2B8bt67q%2F41RwvXLWSzBcSkFt5l70x6Z7E1uZxSdr4xGLNVLLuvY%2FHsQj2bgCy8GSEQ57InO48TfSy3T6G7gDIZpoTO93m%2FSMvNTzUi2hgPC1zy4c&Expires=1714545748\nResolving encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)... 52.92.227.73, 52.218.237.131, 52.92.205.57, ...\nConnecting to encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)|52.92.227.73|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2118644361 (2.0G) [binary/octet-stream]"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html",
    "title": "Prepare Lenti-MPRA data 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#import-data",
    "href": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#import-data",
    "title": "Prepare Lenti-MPRA data 03",
    "section": "Import data",
    "text": "Import data\nImport library design\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram_230621\"\ntxt_fdiry = file.path(FD_DAT, \"processed\", txt_assay)\ntxt_fname = \"LentiMPRA.K562.Library_Design.csv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_csv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_lmpra_library = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 243780      7\n\n\n\n\n\nname\ncategory\nchr.hg38\nstart.hg38\nstop.hg38\nstr.hg38\n230nt sequence (15nt 5' adaptor - 200nt element - 15nt 3' adaptor)\n\n\n\n\npeak1\npotential enhancer\nchr1\n115631\n115831\n+\nAGGACCGGATCAACTGAGCCGGGTCATGAAAAAGGGGATCTTGTGTGTCTGTCCACGATAAGCACTATCACAAGGACTTTCTATAAACTCACAAGAAATTTCTGCCCACCCAGCACACAGTTTGTCCAGCTCATCCTGTAGGTGTCTCTATAATAGGACCTATCATAAAAAATTCCTCAAGACTGCAGCATTTCAGATAAGCCACCCTCACAAGACATTGCGTGAACCGA\n\n\npeak1_Reversed:\npotential enhancer\nchr1\n115631\n115831\n-\nAGGACCGGATCAACTTCTTGTGAGGGTGGCTTATCTGAAATGCTGCAGTCTTGAGGAATTTTTTATGATAGGTCCTATTATAGAGACACCTACAGGATGAGCTGGACAAACTGTGTGCTGGGTGGGCAGAAATTTCTTGTGAGTTTATAGAAAGTCCTTGTGATAGTGCTTATCGTGGACAGACACACAAGATCCCCTTTTTCATGACCCGGCTCCATTGCGTGAACCGA\n\n\npeak10\npotential enhancer\nchr1\n634309\n634509\n+\nAGGACCGGATCAACTTGTCGCCTTAATCCAAGCCTACGTTTTTACACTTCTAGTAAGCCTCTACCTGCACGACAACACATAATGACCCACCAATCACATGCCTATCATATAGTAAAACCCAGCCCATGGCCCCTAACAGGGGCCCTCTCAGCCCTCCTAATGACCTCCGGCCTAGCCATGTGATTTCACTTCCACTCCACAACCCTCCTCATACTCATTGCGTGAACCGA\n\n\npeak10_Reversed:\npotential enhancer\nchr1\n634309\n634509\n-\nAGGACCGGATCAACTAGTATGAGGAGGGTTGTGGAGTGGAAGTGAAATCACATGGCTAGGCCGGAGGTCATTAGGAGGGCTGAGAGGGCCCCTGTTAGGGGCCATGGGCTGGGTTTTACTATATGATAGGCATGTGATTGGTGGGTCATTATGTGTTGTCGTGCAGGTAGAGGCTTACTAGAAGTGTAAAAACGTAGGCTTGGATTAAGGCGACACATTGCGTGAACCGA\n\n\npeak100\npotential enhancer\nchr1\n2133494\n2133694\n+\nAGGACCGGATCAACTCCCCTCCCCAGCTGTGCGCCCGCCCCTTGGTTCCACCCCCCCCAGCTGTGCATCCGTCCCTTGGCTCCGCCCCGCACTGTGCGTCCATTTTTGACTCCGCCCCCGGCTGTGCGCTCATCCCTCGGCTCCGCCCCCGGCTGTGCGTCCGTCCCTCGGTTCCGCCCCCGGCTGCGCGTCTGTCCCTCGACTCGGCCCCTCAGCATTGCGTGAACCGA\n\n\npeak100_Reversed:\npotential enhancer\nchr1\n2133494\n2133694\n-\nAGGACCGGATCAACTCTGAGGGGCCGAGTCGAGGGACAGACGCGCAGCCGGGGGCGGAACCGAGGGACGGACGCACAGCCGGGGGCGGAGCCGAGGGATGAGCGCACAGCCGGGGGCGGAGTCAAAAATGGACGCACAGTGCGGGGCGGAGCCAAGGGACGGATGCACAGCTGGGGGGGGTGGAACCAAGGGGCGGGCGCACAGCTGGGGAGGGGCATTGCGTGAACCGA\n\n\n\n\n\nImport effect size\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram_230621\"\ntxt_fdiry = file.path(FD_DAT, \"processed\", txt_assay)\ntxt_fname = \"LentiMPRA.K562.Log2FC.matrix.csv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_csv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_lmpra_score_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 226254      5\n\n\n\n\n\nname\nreplicate 1 [log2(rna/dna)]\nreplicate 2 [log2(rna/dna)]\nreplicate 3 [log2(rna/dna)]\nmean\n\n\n\n\npeak29573_Reversed:\n-0.190\n0.225\n0.201\n0.079\n\n\npeak71109_Reversed:\n0.650\n0.454\n0.758\n0.620\n\n\nENSG00000123569\n-0.762\n-0.578\n-0.228\n-0.523\n\n\npeak25742_Reversed:\n-0.511\n-0.644\n-0.154\n-0.436\n\n\npeak83398\n-0.154\n-0.298\n0.103\n-0.116\n\n\npeak1037_Reversed:\n-0.056\n0.275\n0.008\n0.076"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#arrange-data-and-z-score-transformation",
    "href": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#arrange-data-and-z-score-transformation",
    "title": "Prepare Lenti-MPRA data 03",
    "section": "Arrange data and Z score transformation",
    "text": "Arrange data and Z score transformation\nJoin library design and score matrix\n\n\nCode\n### merge score by oligo's ID\ndat = dplyr::left_join(\n    dat_lmpra_score_matrix,\n    dat_lmpra_library,\n    by=\"name\"\n)\n\n### arrange table\ndat = dat %&gt;% \n    dplyr::select(\n        chr.hg38, \n        start.hg38, \n        stop.hg38, \n        name, \n        mean, \n        str.hg38, \n        category)\ncolnames(dat) = c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\", \"Score\", \"Strand\", \"Category\")\n\n### assign and show\ndat_lmpra_score_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 226254      7\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\n\n\n\n\nchr16\n3163448\n3163648\npeak29573_Reversed:\n0.079\n-\npotential enhancer\n\n\nchr6\n125083195\n125083395\npeak71109_Reversed:\n0.620\n-\npotential enhancer\n\n\nchrX\n104013573\n104013773\nENSG00000123569\n-0.523\n-\npromoter\n\n\nchr14\n76947662\n76947862\npeak25742_Reversed:\n-0.436\n-\npotential enhancer\n\n\nchr9\n98271532\n98271732\npeak83398\n-0.116\n+\npotential enhancer\n\n\nchr1\n17059727\n17059927\npeak1037_Reversed:\n0.076\n-\npotential enhancer\n\n\n\n\n\nExtract Log2FC of negative control (Shuffled sequences)\n\n\nCode\n### extract negative control\ndat = dat_lmpra_score_arrange\nlst = split(dat, dat$Category)\ndat = lst[[\"negative control, shuffled\"]]\n\n### calculate mean and sd\nvec = dat$Score\nnum_mu = mean(vec)\nnum_sd = sd(vec)\n\n### assign and show\ndat_lmpra_score_negative_shuffled = dat\nprint(dim(dat))\ncat(\"Mean =\",  num_mu, \"\\n\")\ncat(\"Std  = \", num_sd, \"\\n\")\nfun_display_table(head(dat))\n\n\n[1] 247   7\nMean = -0.5249433 \nStd  =  0.2754342 \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\n\n\n\n\nNA\nNA\nNA\nseq5206_shuffled_0\n-0.453\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq31328_shuffled_0\n-0.768\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq12212_shuffled_0\n-0.600\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq9803_shuffled_0\n-0.933\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq2756_shuffled_0\n-0.545\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq13776_shuffled_0\n-0.837\nNA\nnegative control, shuffled\n\n\n\n\n\nZ Score transformation\n\n\nCode\n### z score transformation\ndat = dat_lmpra_score_arrange\ndat = dat %&gt;% \n    dplyr::mutate(ZScore = (Score - num_mu) / num_sd) %&gt;% \n    dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### assign and show\ndat_lmpra_score_full = dat\ndat_lmpra_score_log2fc = dat %&gt;% dplyr::select(Chrom, ChromStart, ChromEnd, Name,  Score, Strand)\ndat_lmpra_score_zscore = dat %&gt;% dplyr::select(Chrom, ChromStart, ChromEnd, Name, ZScore, Strand)\nfun_display_table(head(dat))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\nZScore\n\n\n\n\nchr1\n115631\n115831\npeak1_Reversed:\n0.040\n-\npotential enhancer\n2.0511008\n\n\nchr1\n138940\n139140\npeak2_Reversed:\n-0.101\n-\npotential enhancer\n1.5391818\n\n\nchr1\n138940\n139140\npeak2\n-0.543\n+\npotential enhancer\n-0.0655571\n\n\nchr1\n203225\n203425\npeak3\n-0.186\n+\npotential enhancer\n1.2305781\n\n\nchr1\n203225\n203425\npeak3_Reversed:\n-0.281\n-\npotential enhancer\n0.8856682\n\n\nchr1\n267911\n268111\npeak4_Reversed:\n-0.967\n-\npotential enhancer\n-1.6049447"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#save-results",
    "href": "notebooks/01_prepare_fcc/fcc_23_export_data_LMPRA_Vikram_R.html#save-results",
    "title": "Prepare Lenti-MPRA data 03",
    "section": "Save results",
    "text": "Save results\nWrite table\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram\"\ntxt_folder = \"fragment_counts\"\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ntxt_fname  = \"LMPRA_K562.hg38.Log2FC.stranded.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### init\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table\ndat = dat_lmpra_score_log2fc\nwrite_tsv(dat, txt_fpath, col_names=FALSE)\n\n\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram\"\ntxt_folder = \"fragment_counts\"\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ntxt_fname  = \"LMPRA_K562.hg38.ZScore.stranded.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### init\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table\ndat = dat_lmpra_score_zscore\nwrite_tsv(dat, txt_fpath, col_names=FALSE)\n\n\nCheck results\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram\"\ntxt_folder = \"fragment_counts\"\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ntxt_fname  = \"LMPRA_K562.hg38.Log2FC.stranded.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### \ntxt_cmd = paste(\"zcat\", txt_fpath, \"| head\")\nvec     = system(txt_cmd, intern = TRUE)\nfor(txt in vec){cat(txt, \"\\n\")}\n\n\nchr1    115631  115831  peak1_Reversed: 0.04    - \nchr1    138940  139140  peak2_Reversed: -0.101  - \nchr1    138940  139140  peak2   -0.543  + \nchr1    203225  203425  peak3   -0.186  + \nchr1    203225  203425  peak3_Reversed: -0.281  - \nchr1    267911  268111  peak4_Reversed: -0.967  - \nchr1    267911  268111  peak4   0.225   + \nchr1    586093  586293  peak5   -0.441  + \nchr1    586093  586293  peak5_Reversed: -0.108  - \nchr1    629847  630047  peak6_Reversed: -0.923  - \n\n\n\n\nCode\n### set directory\ntxt_assay  = \"MPRA_Lenti_K562_Nadav_Vikram\"\ntxt_folder = \"fragment_counts\"\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ntxt_fname  = \"LMPRA_K562.hg38.ZScore.stranded.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### \ntxt_cmd = paste(\"zcat\", txt_fpath, \"| head\")\nvec     = system(txt_cmd, intern = TRUE)\nfor(txt in vec){cat(txt, \"\\n\")}\n\n\nchr1    115631  115831  peak1_Reversed: 2.0511007569226227  - \nchr1    138940  139140  peak2_Reversed: 1.5391817792648435  - \nchr1    138940  139140  peak2   -0.06555714360564233    + \nchr1    203225  203425  peak3   1.2305781402512883  + \nchr1    203225  203425  peak3_Reversed: 0.8856681907655505  - \nchr1    267911  268111  peak4_Reversed: -1.6049447076261982 - \nchr1    267911  268111  peak4   2.7227675006580068  + \nchr1    586093  586293  peak5   0.30476722321062366 + \nchr1    586093  586293  peak5_Reversed: 1.5137673619343153  - \nchr1    629847  630047  peak6_Reversed: -1.4451969415485937 -"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_21_acquire_data_LMPRA_Vikram_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_21_acquire_data_LMPRA_Vikram_SH.html",
    "title": "Prepare Lenti-MPRA data 01",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_21_acquire_data_LMPRA_Vikram_SH.html#check-data",
    "href": "notebooks/01_prepare_fcc/fcc_21_acquire_data_LMPRA_Vikram_SH.html#check-data",
    "title": "Prepare Lenti-MPRA data 01",
    "section": "Check data",
    "text": "Check data\n\n\nCode\nls -1 ${FD_DAT}/processed/MPRA_Lenti_K562_Nadav_Vikram_230621/*.csv | xargs -n 1 basename\n\n\nLentiMPRA.K562.Library_Design.csv\nLentiMPRA.K562.Log2FC.forward_reverse.csv\nLentiMPRA.K562.Log2FC.matrix.csv\nLentiMPRA.K562.Log2FC.replicates.csv"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html",
    "title": "Prepare Tiling MPRA data 06",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nsuppressWarnings(suppressMessages(library(\"GenomicRanges\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references\nCode\nTXT_ASSAY = \"MPRA_Tiling_K562_Tewhey_Hannah\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#import-data",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#import-data",
    "title": "Prepare Tiling MPRA data 06",
    "section": "Import data",
    "text": "Import data\n\n\nCode\nfdiry = file.path(FD_RES, \"assay_fcc\")\nprint(dir(fdiry))\n\n\n[1] \"MPRA_Tiling_K562_Tewhey_Hannah\" \"STARR_ATAC_K562_Reddy_KS274\"   \n[3] \"STARR_ATAC_K562_Reddy_KS91\"     \"STARR_WHG_K562_Reddy_A001\"     \n\n\n\n\nCode\nfdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, \"fragment\")\nprint(dir(fdiry))\n\n\n[1] \"TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz\"    \n[2] \"TMPRA_K562_OL13_20220512.hg38.raw.stranded_pos.bed.gz\"    \n[3] \"TMPRA_K562_OL13_20220512.unlifted.raw.stranded_pos.bed.gz\"\n[4] \"TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz\"    \n[5] \"TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz\"    \n\n\n\n\nCode\nfdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, \"fragment\")\nfname = \"TMPRA_K562_OL13_20220512.hg38.raw.stranded_pos.bed.gz\"\nfpath = file.path(fdiry, fname)\n\ncnames = c(\"Chrom\", \"Start\", \"End\", \"Name\", \"Score\", \"Strand\")\ndat = read_tsv(fpath, col_names = cnames, show_col_types = FALSE)\n\ndat_frag_tmpra_OL13 = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 21914     6\n\n\n\nA tibble: 6 × 6\n\n\nChrom\nStart\nEnd\nName\nScore\nStrand\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nchr11\n61787329\n61787528\nchr11:61554801-61555000\n.\n+\n\n\nchr11\n61787334\n61787533\nchr11:61554806-61555005\n.\n+\n\n\nchr11\n61787339\n61787538\nchr11:61554811-61555010\n.\n+\n\n\nchr11\n61787344\n61787543\nchr11:61554816-61555015\n.\n+\n\n\nchr11\n61787349\n61787548\nchr11:61554821-61555020\n.\n+\n\n\nchr11\n61787354\n61787553\nchr11:61554826-61555025\n.\n+\n\n\n\n\n\n\n\nCode\nfdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, \"fragment\")\nfname = \"TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz\"\nfpath = file.path(fdiry, fname)\n\ncnames = c(\"Chrom\", \"Start\", \"End\", \"Name\", \"Score\", \"Strand\")\ndat = read_tsv(fpath, col_names = cnames, show_col_types = FALSE)\n\ndat_frag_tmpra_OL43 = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 96087     6\n\n\n\nA tibble: 6 × 6\n\n\nChrom\nStart\nEnd\nName\nScore\nStrand\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n.\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n.\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n.\n+\n\n\nchr8\n126736051\n126736250\nchr8:126736051-126736250\n.\n+\n\n\nchr8\n126736101\n126736300\nchr8:126736101-126736300\n.\n+\n\n\nchr8\n126736151\n126736350\nchr8:126736151-126736350\n.\n+\n\n\n\n\n\n\n\nCode\nfdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, \"fragment\")\nfname = \"TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz\"\nfpath = file.path(fdiry, fname)\n\ncnames = c(\"Chrom\", \"Start\", \"End\", \"Name\", \"Score\", \"Strand\")\ndat = read_tsv(fpath, col_names = cnames, show_col_types = FALSE)\n\ndat_frag_tmpra_OL45 = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 91092     6\n\n\n\nA tibble: 6 × 6\n\n\nChrom\nStart\nEnd\nName\nScore\nStrand\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n.\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n.\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n.\n+\n\n\nchr11\n4505801\n4506000\nchr11:4505801-4506000\n.\n+\n\n\nchr11\n4505901\n4506100\nchr11:4505901-4506100\n.\n+\n\n\nchr11\n4506001\n4506200\nchr11:4506001-4506200\n.\n+"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#setup-granges-for-each-file",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#setup-granges-for-each-file",
    "title": "Prepare Tiling MPRA data 06",
    "section": "Setup GRanges for each file",
    "text": "Setup GRanges for each file\n\n\nCode\ndat = dat_frag_tmpra_OL13\ngrg = GRanges(\n    seqnames = dat$Chrom,\n    ranges   = IRanges(\n        start = dat$Start, \n        end   = dat$End, \n        names = dat$Name\n    ))\n\ngrg_frag_tmpra_OL13 = grg\n\n\n\n\nCode\ndat = dat_frag_tmpra_OL43\ngrg = GRanges(\n    seqnames = dat$Chrom,\n    ranges   = IRanges(\n        start = dat$Start, \n        end   = dat$End, \n        names = dat$Name\n    ))\n\ngrg_frag_tmpra_OL43 = grg\n\n\n\n\nCode\ndat = dat_frag_tmpra_OL45\ngrg = GRanges(\n    seqnames = dat$Chrom,\n    ranges   = IRanges(\n        start = dat$Start, \n        end   = dat$End, \n        names = dat$Name\n    ))\n\ngrg_frag_tmpra_OL45 = grg"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol13-fads-region",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol13-fads-region",
    "title": "Prepare Tiling MPRA data 06",
    "section": "OL13 | FADS region",
    "text": "OL13 | FADS region\n\n\nCode\ngrg = grg_frag_tmpra_OL13\ngrg\n\n\nGRanges object with 21914 ranges and 0 metadata columns:\n                          seqnames            ranges strand\n                             &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;\n  chr11:61554801-61555000    chr11 61787329-61787528      *\n  chr11:61554806-61555005    chr11 61787334-61787533      *\n  chr11:61554811-61555010    chr11 61787339-61787538      *\n  chr11:61554816-61555015    chr11 61787344-61787543      *\n  chr11:61554821-61555020    chr11 61787349-61787548      *\n                      ...      ...               ...    ...\n  chr11:61665601-61665800    chr11 61898129-61898328      *\n  chr11:61665606-61665805    chr11 61898134-61898333      *\n  chr11:61665611-61665810    chr11 61898139-61898338      *\n  chr11:61665616-61665815    chr11 61898144-61898343      *\n  chr11:61665621-61665820    chr11 61898149-61898348      *\n  -------\n  seqinfo: 1 sequence from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = grg_frag_tmpra_OL13\ngrg = GenomicRanges::reduce(grg)\n\ngrg$Region  = \"FADS\"\ngrg$Dataset = \"OL13\"\ngrg_range_OL13  = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames            ranges strand |      Region     Dataset\n         &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr11 61787329-61898348      * |        FADS        OL13\n  -------\n  seqinfo: 1 sequence from an unspecified genome; no seqlengths\n\n\nSummary\nchr11 61787329 61898348 FADS"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol43-gata-myc-region",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol43-gata-myc-region",
    "title": "Prepare Tiling MPRA data 06",
    "section": "OL43 | GATA-MYC region",
    "text": "OL43 | GATA-MYC region\n\n\nCode\ngrg = grg_frag_tmpra_OL43\ngrg\n\n\nGRanges object with 96087 ranges and 0 metadata columns:\n                           seqnames              ranges strand\n                              &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt;\n  chr8:126735901-126736100     chr8 126735901-126736100      *\n  chr8:126735951-126736150     chr8 126735951-126736150      *\n  chr8:126736001-126736200     chr8 126736001-126736200      *\n  chr8:126736051-126736250     chr8 126736051-126736250      *\n  chr8:126736101-126736300     chr8 126736101-126736300      *\n                       ...      ...                 ...    ...\n    chrX:49880251-49880450     chrX   49880251-49880450      *\n    chrX:49880301-49880500     chrX   49880301-49880500      *\n    chrX:49880351-49880550     chrX   49880351-49880550      *\n    chrX:49880401-49880600     chrX   49880401-49880600      *\n    chrX:49880451-49880650     chrX   49880451-49880650      *\n  -------\n  seqinfo: 2 sequences from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = grg_frag_tmpra_OL43\ngrg = GenomicRanges::reduce(grg)\ngrg = range(grg)\n\ngrg$Region  = c(\"MYC\", \"GATA1\")\ngrg$Dataset = \"OL43\"\ngrg_range_OL43 = grg\ngrg \n\n\nGRanges object with 2 ranges and 2 metadata columns:\n      seqnames              ranges strand |      Region     Dataset\n         &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]     chr8 126735901-128736550      * |         MYC        OL43\n  [2]     chrX   47785501-49880650      * |       GATA1        OL43\n  -------\n  seqinfo: 2 sequences from an unspecified genome; no seqlengths\n\n\nSummary\nchr8 126735901 128736550 MYC\nchrX  47785501 49880650  GATA1"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol45-lmo2-hbe1-rbm38-hba2-bcl11a",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#ol45-lmo2-hbe1-rbm38-hba2-bcl11a",
    "title": "Prepare Tiling MPRA data 06",
    "section": "OL45 | LMO2, HBE1, RBM38, HBA2, BCL11A",
    "text": "OL45 | LMO2, HBE1, RBM38, HBA2, BCL11A\n\n\nCode\ngrg = grg_frag_tmpra_OL45\ngrg = GenomicRanges::reduce(grg)\nlst = split(grg, grg@seqnames)\nprint(length(lst))\nprint(names(lst))\n\n\n[1] 4\n[1] \"chr11\" \"chr16\" \"chr2\"  \"chr20\"\n\n\n\n\nCode\ngrg = lst[[\"chr11\"]]\nidx = grg@ranges@start &lt; 7000000\ngrg = grg[which(idx)]\n\ngrg = range(grg)\ngrg$Region  = \"HBE1\"\ngrg$Dataset = \"OL45\"\ngrg_range_OL45_chr11_v1 = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames          ranges strand |      Region     Dataset\n         &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr11 4505501-6505900      * |        HBE1        OL45\n  -------\n  seqinfo: 4 sequences from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = lst[[\"chr11\"]]\nidx = grg@ranges@start &gt; 7000000\ngrg = grg[which(idx)]\n\ngrg = range(grg)\ngrg$Region  = \"LMO2\"\ngrg$Dataset = \"OL45\"\ngrg_range_OL45_chr11_v2 = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames            ranges strand |      Region     Dataset\n         &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr11 32869701-34870100      * |        LMO2        OL45\n  -------\n  seqinfo: 4 sequences from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = lst[[\"chr16\"]]\ngrg = range(grg)\ngrg$Region  = \"HBA2\"\ngrg$Dataset = \"OL45\"\ngrg_range_OL45_chr16 = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames        ranges strand |      Region     Dataset\n         &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr16 10001-1173100      * |        HBA2        OL45\n  -------\n  seqinfo: 4 sequences from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = lst[[\"chr2\"]]\ngrg = range(grg)\ngrg$Region  = \"BCL11A\"\ngrg$Dataset = \"OL45\"\ngrg_range_OL45_chr2 = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames            ranges strand |      Region     Dataset\n         &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]     chr2 59553301-61553700      * |      BCL11A        OL45\n  -------\n  seqinfo: 4 sequences from an unspecified genome; no seqlengths\n\n\n\n\nCode\ngrg = lst[[\"chr20\"]]\ngrg = range(grg)\ngrg$Region  = \"RBM38\"\ngrg$Dataset = \"OL45\"\ngrg_range_OL45_chr20 = grg\nprint(grg)\n\n\nGRanges object with 1 range and 2 metadata columns:\n      seqnames            ranges strand |      Region     Dataset\n         &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr20 56391301-58391700      * |       RBM38        OL45\n  -------\n  seqinfo: 4 sequences from an unspecified genome; no seqlengths"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#combine-and-export",
    "href": "notebooks/01_prepare_fcc/fcc_16_export_ranges_TMPRA_Hannah_R.html#combine-and-export",
    "title": "Prepare Tiling MPRA data 06",
    "section": "Combine and export",
    "text": "Combine and export\nConcatenate multiple granges\n\n\nCode\ngrg = c(\n    grg_range_OL13,\n    grg_range_OL43,\n    grg_range_OL45_chr11_v1, \n    grg_range_OL45_chr11_v2,\n    grg_range_OL45_chr16,\n    grg_range_OL45_chr2,\n    grg_range_OL45_chr20\n)\n\ngrg_range_merge = grg\nprint(grg)\n\n\nWarning message in .merge_two_Seqinfo_objects(x, y):\n“The 2 combined objects have no sequence levels in common. (Use\n  suppressWarnings() to suppress this warning.)”\nWarning message in .merge_two_Seqinfo_objects(x, y):\n“Each of the 2 combined objects has sequence levels not in the other:\n  - in 'x': chr8, chrX\n  - in 'y': chr16, chr2, chr20\n  Make sure to always combine/compare objects based on the same reference\n  genome (use suppressWarnings() to suppress this warning).”\n\n\nGRanges object with 8 ranges and 2 metadata columns:\n      seqnames              ranges strand |      Region     Dataset\n         &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;\n  [1]    chr11   61787329-61898348      * |        FADS        OL13\n  [2]     chr8 126735901-128736550      * |         MYC        OL43\n  [3]     chrX   47785501-49880650      * |       GATA1        OL43\n  [4]    chr11     4505501-6505900      * |        HBE1        OL45\n  [5]    chr11   32869701-34870100      * |        LMO2        OL45\n  [6]    chr16       10001-1173100      * |        HBA2        OL45\n  [7]     chr2   59553301-61553700      * |      BCL11A        OL45\n  [8]    chr20   56391301-58391700      * |       RBM38        OL45\n  -------\n  seqinfo: 6 sequences from an unspecified genome; no seqlengths\n\n\nConvert to dataframe\n\n\nCode\ngrg = grg_range_merge\ndat = data.frame(\n    Chrom      = as.character(seqnames(grg)),\n    ChromStart = start(grg),\n    ChromEnd   = end(grg),\n    Region     = grg$Region,\n    Dataset    = grg$Dataset\n)\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### assign and show\ndat_range_merge = dat\nfun_display_table(dat)\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nDataset\n\n\n\n\nchr11\n4505501\n6505900\nHBE1\nOL45\n\n\nchr11\n32869701\n34870100\nLMO2\nOL45\n\n\nchr11\n61787329\n61898348\nFADS\nOL13\n\n\nchr16\n10001\n1173100\nHBA2\nOL45\n\n\nchr2\n59553301\n61553700\nBCL11A\nOL45\n\n\nchr20\n56391301\n58391700\nRBM38\nOL45\n\n\nchr8\n126735901\n128736550\nMYC\nOL43\n\n\nchrX\n47785501\n49880650\nGATA1\nOL43\n\n\n\n\n\n\n\nCode\n### set directory\nfdiry = file.path(FD_RES, \"region\", \"fcc_coverage\")\nfname = \"region_screened.tmpra.bed.gz\"\nfpath = file.path(fdiry, fname)\nprint(fpath)\n\n### write table\ndat = dat_range_merge\nwrite_tsv(dat, fpath, col_names = FALSE)\n\n\n[1] \"/mount/repo/Proj_ENCODE_FCC/results/region/fcc_coverage/region_screened.tmpra.bed.gz\"\n\n\n\n\nCode\n### set directory\nfdiry = file.path(FD_RES, \"region\", \"fcc_coverage\")\nfname = \"region_screened.tmpra.tsv\"\nfpath = file.path(fdiry, fname)\nprint(fpath)\n\n### write table\ndat = dat_range_merge\nwrite_tsv(dat, fpath, col_names = TRUE)\n\n\n[1] \"/mount/repo/Proj_ENCODE_FCC/results/region/fcc_coverage/region_screened.tmpra.tsv\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html",
    "title": "Prepare Tiling MPRA data 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references\nGlobal variables\nCode\nTXT_ASSAY_TYPE = \"assay_fcc\"\nTXT_ASSAY_NAME = \"MPRA_Tiling_K562_Tewhey_Hannah\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html#import-data",
    "href": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html#import-data",
    "title": "Prepare Tiling MPRA data 04",
    "section": "Import data",
    "text": "Import data\nCheck data files\n\n\nCode\ntxt_folder = \"fragment_counts/summary\"\ntxt_fdiry  = file.path(FD_RES, TXT_ASSAY_TYPE, TXT_ASSAY_NAME, txt_folder)\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \nTMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \nTMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \nTMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \nTMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv \nTMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \n\n\nImport data\n\n\nCode\n### init\ntxt_folder = \"fragment_counts/summary\"\ntxt_strand = \"stranded_pos\"\ntxt_fdiry  = file.path(FD_RES, TXT_ASSAY_TYPE, TXT_ASSAY_NAME, txt_folder)\n\nvec_txt_prefix = c(\n    'TMPRA_K562_OL13_20220512.hg19.raw',\n    'TMPRA_K562_OL13_20220512.hg19.norm',\n    'TMPRA_K562_OL43_20221003.hg38.raw',\n    'TMPRA_K562_OL43_20221003.hg38.norm',\n    'TMPRA_K562_OL45_20220927.hg38.raw',\n    'TMPRA_K562_OL45_20220927.hg38.norm'\n)\n\n### read table\nlst_dat_read = lapply(vec_txt_prefix, function(txt_prefix){\n    ### setup file name and path\n    txt_fname = paste(\n        txt_prefix, \n        txt_strand, \n        \"tsv\", \n        sep=\".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n\n    ### show progress\n    cat(\"Read table:\", txt_fname, \"\\n\")\n    \n    ### read table\n    dat = read_tsv(txt_fpath, show_col_types = FALSE)\n    return(dat)\n})\n\nnames(lst_dat_read) = vec_txt_prefix\n\n\nRead table: TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \nRead table: TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \nRead table: TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \nRead table: TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \nRead table: TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \nRead table: TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv \n\n\nCheck imported data\n\n\nCode\nlst = lst_dat_read\ntxt = names(lst)[1]\ndat = lst[[txt]]\ncat(txt, \"\\n\")\nfun_display_table(head(dat, 6))\n\n\nTMPRA_K562_OL13_20220512.hg19.raw \n\n\n\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n\n\nchr11:61554801-61555000\nchr11\n61554801\n61555000\n+\n971\n542\n785\n640\n112\n236\n220\n204\n\n\nchr11:61554806-61555005\nchr11\n61554806\n61555005\n+\n1267\n562\n1059\n564\n211\n103\n390\n215\n\n\nchr11:61554811-61555010\nchr11\n61554811\n61555010\n+\n1183\n641\n1118\n655\n261\n476\n98\n276\n\n\nchr11:61554816-61555015\nchr11\n61554816\n61555015\n+\n1020\n476\n1086\n584\n137\n177\n274\n497\n\n\nchr11:61554821-61555020\nchr11\n61554821\n61555020\n+\n1138\n580\n894\n565\n187\n108\n360\n365\n\n\nchr11:61554826-61555025\nchr11\n61554826\n61555025\n+\n702\n406\n745\n318\n82\n163\n195\n66\n\n\n\n\n\n\n\nCode\nlst = lst_dat_read\ntxt = names(lst)[2]\ndat = lst[[txt]]\ncat(txt, \"\\n\")\nfun_display_table(head(dat, 6))\n\n\nTMPRA_K562_OL13_20220512.hg19.norm \n\n\n\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nInput.mean\nOutput.mean\nLog2FC.mean\n\n\n\n\nchr11:61554801-61555000\nchr11\n61554801\n61555000\n+\n532.1798\n531.0790\n481.0834\n621.4943\n239.6332\n475.0396\n279.9729\n249.11100\n541.4591\n310.9392\n-0.8002201\n\n\nchr11:61554806-61555005\nchr11\n61554806\n61555005\n+\n694.4097\n550.6760\n649.0029\n547.6919\n451.4519\n207.3266\n496.3155\n262.54346\n610.4451\n354.4094\n-0.7844449\n\n\nchr11:61554811-61555010\nchr11\n61554811\n61555010\n+\n648.3715\n628.0842\n685.1608\n636.0606\n558.4310\n958.1307\n124.7152\n337.03253\n649.4193\n494.5773\n-0.3929540\n\n\nchr11:61554816-61555015\nchr11\n61554816\n61555015\n+\n559.0354\n466.4089\n665.5498\n567.1136\n293.1228\n356.2797\n348.6935\n606.90279\n564.5269\n401.2497\n-0.4925421\n\n\nchr11:61554821-61555020\nchr11\n61554821\n61555020\n+\n623.7081\n568.3133\n547.8835\n548.6629\n400.1019\n217.3910\n458.1374\n445.71331\n572.1420\n380.3359\n-0.5890991\n\n\nchr11:61554826-61555025\nchr11\n61554826\n61555025\n+\n384.7479\n397.8193\n456.5696\n308.8050\n175.4457\n328.0994\n248.1578\n80.59474\n386.9855\n208.0744\n-0.8951798\n\n\n\n\n\n\n\nCode\nnames(lst)\n\n\n\n'TMPRA_K562_OL13_20220512.hg19.raw''TMPRA_K562_OL13_20220512.hg19.norm''TMPRA_K562_OL43_20221003.hg38.raw''TMPRA_K562_OL43_20221003.hg38.norm''TMPRA_K562_OL45_20220927.hg38.raw''TMPRA_K562_OL45_20220927.hg38.norm'\n\n\n\n\nCode\ndat = lst[[5]]\nprint(table(dat$Chrom))\nhead(dat)\n\n\n\nchr11 chr16  chr2 chr20 \n39848 11438 19914 19892 \n\n\n\nA tibble: 6 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:4505501-4505700\nchr11\n4505501\n4505700\n+\n811\n664\n917\n815\n643\n665\n612\n714\n\n\nchr11:4505601-4505800\nchr11\n4505601\n4505800\n+\n693\n552\n607\n551\n413\n204\n279\n395\n\n\nchr11:4505701-4505900\nchr11\n4505701\n4505900\n+\n577\n414\n448\n371\n303\n241\n217\n291\n\n\nchr11:4505801-4506000\nchr11\n4505801\n4506000\n+\n855\n754\n688\n812\n366\n315\n340\n406\n\n\nchr11:4505901-4506100\nchr11\n4505901\n4506100\n+\n317\n217\n313\n280\n117\n115\n102\n179\n\n\nchr11:4506001-4506200\nchr11\n4506001\n4506200\n+\n444\n422\n454\n473\n237\n237\n215\n383"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html#save-results",
    "href": "notebooks/01_prepare_fcc/fcc_14_convert_table_to_bed_R.html#save-results",
    "title": "Prepare Tiling MPRA data 04",
    "section": "Save results",
    "text": "Save results\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL13_20220512\n\nOL13_20220512.hg19.raw.Input .rep[1-4].stranded_pos.bed\nOL13_20220512.hg19.raw.Output.rep[1-4].stranded_pos.bed\n\nOL13_20220512.hg19.norm.Input .mean.stranded_pos.bed\nOL13_20220512.hg19.norm.Output.mean.stranded_pos.bed\nOL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL43_20221003\n\nOL43_20221003.hg38.raw.Input .rep[1-6].stranded_pos.bed\nOL43_20221003.hg38.raw.Output.rep[1-5].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .rep[1-6].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-5].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nCounts: OL45_20220927\n\nOL43_20221003.hg38.raw. Input .rep[1-4].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-4].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .rep[1-4].stranded_pos.bed\nOL43_20221003.hg38.norm.Output.rep[1-4].stranded_pos.bed\n\nOL43_20221003.hg38.norm.Input .mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\nOL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n\n\n+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n&lt;Results&gt;\nPROJECT/results/assay_fcc\n└── MPRA_Tiling_K562_TewheyHhannah\n    └── fragment_counts\n        ├── TMPRA_K562_OL13_20220512.hg19.raw.Input.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.raw.Output.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.norm.Input.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.norm.Output.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.raw.Input.rep[1-6].stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.raw.Output.rep[1-5].stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.norm.Input.rep[1-6].stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.norm.Output.rep[1-5].stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.norm.Input.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.raw.Input.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.raw.Output.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.norm.Input.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.norm.Output.rep[1-4].stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.norm.Input.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.norm.Output.mean.stranded_pos.bed\n        ├── TMPRA_K562_OL45_20220927.hg38.norm.Log2FC.mean.stranded_pos.bed\n        └── summary\n            ├── TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv\n            ├── TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv\n            ├── TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv\n            ├── TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv\n            ├── TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv\n            └── TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv\n\n\nCode\n### init\ntxt_folder = \"fragment_counts\"\ntxt_strand = \"stranded_pos\"\ntxt_fdiry  = file.path(FD_RES, TXT_ASSAY_TYPE, TXT_ASSAY_NAME, txt_folder)\n\n###\ncat(\"Output directory:\", \"\\n\")\ncat(txt_fdiry, \"\\n\")\n\n###\nlst_dat = lst_dat_read\nfor (txt_prefix in names(lst_dat)){\n    \n    ### split a table by score columns\n    dat = lst_dat[[txt_prefix]]\n    dat = dat %&gt;% \n        dplyr::filter(Strand == \"+\") %&gt;% \n        gather(Sample, Score, -Chrom, -ChromStart, -ChromEnd, -Name, -Strand)\n    lst = split(dat, dat$Sample)\n    \n    ### save each score column into a bed file\n    for (txt_cname in names(lst)){\n        ### setup data for each column\n        dat = lst[[txt_cname]]\n        dat = dat %&gt;%\n            dplyr::select(Chrom, ChromStart, ChromEnd, Name, Score, Strand) %&gt;%\n            dplyr::filter(!is.infinite(Score)) %&gt;% \n            dplyr::mutate(Score = round(Score, 3)) %&gt;%\n            dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n        ### store into a bed file\n        txt_fname = paste(txt_prefix, txt_cname, txt_strand, \"bed.gz\", sep=\".\")\n        txt_fpath = file.path(txt_fdiry, txt_fname)\n        write_tsv(dat, txt_fpath, col_names=FALSE)\n\n        cat(\"\\n++++++++++++++++++++++++++++++++++++++++++\\n\")\n        cat(\"Save bed file:\", txt_fname, \"\\n\")\n        flush.console()\n        \n        fun_display_table(head(dat, 3))\n        flush.console()\n    }\n}\n\n\nOutput directory: \n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_Hannah/fragment_counts \n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n971\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n1267\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n1183\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n542\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n562\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n641\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n785\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n1059\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n1118\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n640\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n564\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n655\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n112\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n211\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n261\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n236\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n103\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n476\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n220\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n390\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n98\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n204\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n215\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n276\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n541.459\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n610.445\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n649.419\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n532.180\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n694.410\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n648.371\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n531.079\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n550.676\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n628.084\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n481.083\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n649.003\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n685.161\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n621.494\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n547.692\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n636.061\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n-0.800\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n-0.784\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n-0.393\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n310.939\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n354.409\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n494.577\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n239.633\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n451.452\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n558.431\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n475.040\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n207.327\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n958.131\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n279.973\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n496.316\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n124.715\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n61554801\n61555000\nchr11:61554801-61555000\n249.111\n+\n\n\nchr11\n61554806\n61555005\nchr11:61554806-61555005\n262.543\n+\n\n\nchr11\n61554811\n61555010\nchr11:61554811-61555010\n337.033\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n1190\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n194\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n746\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n1409\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n161\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n757\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n1259\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n161\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n708\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n1179\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n208\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n704\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep5.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n665\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n95\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n350\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Input.rep6.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n644\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n78\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n379\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n5410\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n440\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n2328\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n3846\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n398\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n1654\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n6325\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n692\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n3308\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n4822\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n485\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n2493\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.raw.Output.rep5.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n4941\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n595\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n2652\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n815.679\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n114.311\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n466.543\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n801.261\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n130.626\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n502.303\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n839.773\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n95.957\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n451.177\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n807.082\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n103.209\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n453.864\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n740.868\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n130.704\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n442.384\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep5.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n867.134\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n123.876\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n456.386\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Input.rep6.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n837.958\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n101.492\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n493.146\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n3.197\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n2.740\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n2.963\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n7477.752\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n763.552\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n3636.737\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n8392.241\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n682.548\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n3611.301\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n6873.620\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n711.311\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n2956.050\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n6826.874\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n746.909\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n3570.482\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n8314.847\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n836.313\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n4298.821\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL43_20221003.hg38.norm.Output.rep5.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr8\n126735901\n126736100\nchr8:126735901-126736100\n6981.177\n+\n\n\nchr8\n126735951\n126736150\nchr8:126735951-126736150\n840.680\n+\n\n\nchr8\n126736001\n126736200\nchr8:126736001-126736200\n3747.031\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n811\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n693\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n577\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n664\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n552\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n414\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n917\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n607\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n448\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n815\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n551\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n371\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n643\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n413\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n303\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n665\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n204\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n241\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n612\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n279\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n217\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.raw.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n714\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n395\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n291\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Input.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n662.965\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n494.493\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n370.779\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Input.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n597.041\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n510.172\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n424.775\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Input.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n576.897\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n479.589\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n359.692\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Input.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n776.291\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n513.859\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n379.257\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Input.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n701.630\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n474.354\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n319.392\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Log2FC.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n0.450\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n-0.195\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n-0.055\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Output.mean.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n905.937\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n432.059\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n356.831\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Output.rep1.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n791.765\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n508.552\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n373.102\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Output.rep2.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n999.076\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n306.483\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n362.071\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Output.rep3.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n1035.589\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n472.107\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n367.194\n+\n\n\n\n\n\n\n++++++++++++++++++++++++++++++++++++++++++\nSave bed file: TMPRA_K562_OL45_20220927.hg38.norm.Output.rep4.stranded_pos.bed.gz \n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\n\n\n\n\nchr11\n4505501\n4505700\nchr11:4505501-4505700\n797.319\n+\n\n\nchr11\n4505601\n4505800\nchr11:4505601-4505800\n441.094\n+\n\n\nchr11\n4505701\n4505900\nchr11:4505701-4505900\n324.958\n+"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html",
    "title": "Prepare Tiling MPRA data 02",
    "section": "",
    "text": "In Tiling MPRA, a series of overlapped oligos are synthesized and tested in K562 for regulatory activity. According to Hannah, each count matrix has input (plasmid) and output barcode counts for each tested oligo.\nSet environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\nCode\nTXT_ASSAY=MPRA_Tiling_K562_Tewhey_Hannah\nCheck data\nCode\nls ${FD_DAT}/processed/${TXT_ASSAY}\n\n\ntiling_counts  tiling_counts.tar.gz\nCode\nFDIRY=${FD_DAT}\nFDIRY=${FDIRY}/processed/${TXT_ASSAY}\nFDIRY=${FDIRY}/tiling_counts\n\nls ${FDIRY}\n\n\nFADS_tile_snp.20190214.attributes\nOL13_20220512_counts.out\nOL13_20220512_normalized_counts.out\nOL43_20211228_counts.out\nOL43_20211228_normalized_counts.out\nOL43_20221003_counts.out\nOL43_20221003_K562_normalized_counts.out\nOL43.attributes\nOL43_K562.bed\nOL45_20220927_counts.out\nOL45_20220927_K562_normalized_counts.out\nOL45.attributes\nOL45_K562.bed\nUKBB_GTEx"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol13",
    "href": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol13",
    "title": "Prepare Tiling MPRA data 02",
    "section": "Raw and normalized barcode count matrix for OL13",
    "text": "Raw and normalized barcode count matrix for OL13\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL13_20220512_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  k562_r1 k562_r2 k562_r3 k562_r4\n(11:61555216-61555415;11:61555315:T:C_A_wC) 1609    1221    1396    798 845 283 574 1223\n(11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   1179    582 1225    721 476 416 912 956\n(11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   1066    643 1206    681 470 846 540 847\n(11:61555330:T:C_A_wC;11:61555231-61555430) 1063    701 786 416 357 568 599 518\n(11:61555366-61555565_RC;11:61555465:A:G_A_wC_RC)   1239    722 1341    682 311 421 604 556\n(11:61555366-61555565;11:61555465:A:G_A_wC) 1362    885 1213    856 407 49  519 344\n(11:61555581-61555780;11:61555680:G:A_A_wC) 673 290 468 362 193 173 378 378\n(11:61555666-61555865_RC;11:61555765:C:T_A_wC_RC)   1361    767 1204    737 3814    3572    4659    4902\n(11:61555666-61555865;11:61555765:C:T_A_wC) 452 336 416 251 628 831 847 1035\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL13_20220512_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  k562_r1 k562_r2 k562_r3 k562_r4\n(11:61555216-61555415;11:61555315:T:C_A_wC) 881.850959258118    1196.39755882377    855.53173555782 774.925715691881    1807.94704620301    569.644913020602    730.47466819187 1493.44488237891\n(11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   646.179167784538    570.273037866859    750.735226402815    700.152181721611    1018.44117632264    837.357893344772    1160.61480381705    1167.40254092742\n(11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   584.246813281015    630.043923279021    739.091169830036    661.308787451342    1005.60368250345    1702.89610040788    687.206133839042    1034.29911314386\n(11:61555330:T:C_A_wC;11:61555231-61555430) 582.602591480037    686.875256949601    481.696235063357    403.971300410805    763.830882241981    1143.31558514382    762.289766980715    632.546565063185\n(11:61555366-61555565_RC;11:61555465:A:G_A_wC_RC)   679.063603804107    707.452119140674    821.82525600504 662.279872308098    665.410096294835    847.42229110132 768.652786738484    678.949594932685\n(11:61555366-61555565;11:61555465:A:G_A_wC) 746.476697644224    867.167763766615    743.381085409481    831.248637383772    870.809997401922    98.6310980141679    660.481450856412    420.069533555474\n(11:61555581-61555780;11:61555680:G:A_A_wC) 368.853757352836    284.156668352902    286.811498740014    351.532718145941    412.939384517373    348.228162376552    481.044293687329    461.588033965027\n(11:61555666-61555865_RC;11:61555765:C:T_A_wC_RC)   745.928623710565    751.5453952644  737.865479664481    715.689539429719    8160.36690440032    7190.00575727771    5929.06181028907    5985.99085316551\n(11:61555666-61555865;11:61555765:C:T_A_wC) 247.729418014089    329.229795057156    254.943554435568    243.742299045942    1343.65768640886    1672.70290713824    1077.89554696605    1263.87199776138"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol43",
    "href": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol43",
    "title": "Prepare Tiling MPRA data 02",
    "section": "Raw and normalized barcode count matrix for OL43",
    "text": "Raw and normalized barcode count matrix for OL43\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL43_20221003_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  plasmid_r5  plasmid_r6  K562_r1 K562_r2 K562_r3 K562_r4 K562_r5\n(8:127381651-127381850;8:127320401-127320600)   1318    1810    1477    1505    738 687 620 636 781 520 538\n(8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC) 634 730 698 761 316 343 158 194 268 141 251\n(8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC) 416 432 418 409 181 211 11164   6818    12118   9512    10450\n(8:128176951-128177150;Nadav:negCtrl:seq31802.neg5.MYC) 1150    1271    1325    1255    597 580 14919   9299    28832   15790   19501\n(X:48782961-48783160;Nadav:posCtrl:ENSG00000102317.270  345 370 389 373 211 187 17116   10370   22126   16725   18361\n(X:48800591-48800790;Nadav:posCtrl:pos2.GATA1)  1008    1075    1137    1049    531 528 9987    7807    13192   9978    11306\n(X:48801781-48801980;Nadav:negCtrl:neg1.GATA1)  334 390 383 391 145 164 4853    2861    4438    3504    3545\n(X:49154578:NA:NA;X:49298001-49298200)  2194    2534    2366    2443    1117    1166    1322    823 1698    1174    1148\n(X:49322601-49322800;X:49551851-49552050)   2164    2372    2184    2371    1181    1087    4503    3182    5161    3330    3702\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL43_20221003_K562_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  plasmid_r5  plasmid_r6  K562_r1 K562_r2 K562_r3 K562_r4 K562_r5\n(8:127381651-127381850;8:127320401-127320600)   887.446571765428    1078.77146597825    946.831377196138    945.721918068606    962.323494733561    893.908535925291    961.772509595888    1136.66734809629    842.970579975295    896.665375538462    760.144341851228\n(8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC) 426.890080803703    435.084624400067    447.453149142115    478.202245614757    412.051794492961    446.303679508552    245.096865348629    346.719285425598    289.265192616363    243.134265290237    354.639832350666\n(8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC) 280.104532514733    257.474736631273    267.959049199719    257.010142518312    236.017008870968    274.54832762771 17318.1101566589    12185.2169486171    13079.5358362876    16402.0789463882    14764.885450456\n(8:128176951-128177150;Nadav:negCtrl:seq31802.neg5.MYC) 774.327433634478    757.524051523953    849.391722941695    788.625253937608    778.464940861702    754.682606749154    23143.0388236469    16619.2919338796    31119.7538563991    27227.5889995237    27553.1130305591\n(X:48782961-48783160;Nadav:posCtrl:ENSG00000102317.270  232.298230090343    220.522343874007    249.368588848543    234.388222883448    275.1358501203  243.320081831193    26551.1262487794    18533.3968549662    23881.6479545882    28839.8623190015    25942.3982541457\n(X:48800591-48800790;Nadav:posCtrl:pos2.GATA1)  678.714828785699    640.706809904209    728.874255837515    659.177602693666    692.403490113172    687.021407523368    15492.2936344099    13952.7704191631    14238.7553022204    17205.62907139  15974.3344404646\n(X:48801781-48801980;Nadav:negCtrl:neg1.GATA1)  224.891619855579    232.442470569899    245.52228670692 245.69918270088 189.07439937177 213.393012942864    7528.19675656265    5113.21585362183    4790.14524190827    6042.1451459361 5008.75779156618\n(X:49154578:NA:NA;X:49298001-49298200)  1477.28207773395    1510.28005236955    1516.72514451324    1535.14860188811    1456.52485585012    1517.17227494744    2050.74718981575    1470.87614384158    1832.73245172606    2024.39452092722    1622.01803800225\n(X:49322601-49322800;X:49551851-49552050)   1457.08223163914    1413.72702613282    1400.05397955069    1489.90476261838    1539.97838384869    1414.37929920057    6985.26066243594    5686.9111661044 5570.51365333226    5742.107116429  5230.58430024767"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol45",
    "href": "notebooks/01_prepare_fcc/fcc_12_explore_data_TMPRA_Hannah_SH.html#raw-and-normalized-barcode-count-matrix-for-ol45",
    "title": "Prepare Tiling MPRA data 02",
    "section": "Raw and normalized barcode count matrix for OL45",
    "text": "Raw and normalized barcode count matrix for OL45\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL45_20220927_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  K562_r1 K562_r2 K562_r3 K562_r4\n(Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270    897 717 761 724 56816   37391   36946   52349\n1:10437778:C:T:R:wC 645 437 491 493 2239    1698    1202    2532\n1:10451799:C:T:R:wC 603 584 512 429 336 280 321 333\n1:110198727:C:G:R:wC    681 589 628 550 46046   37138   33992   53823\n1:110881742:NA:NA   930 795 874 765 24701   18211   17386   29053\n1:111838694:C:T:R:wC    834 579 755 763 34228   34188   32379   37480\n1:113047064:NA:NA   635 500 560 550 390 326 243 574\n1:119063648:C:T:R:wC    539 483 512 471 338 200 139 172\n1:171893999:A:T:R:wC    848 660 722 725 705 694 668 801\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/${TXT_ASSAY}/tiling_counts\nFNAME=OL45_20220927_K562_normalized_counts.out\nFPATH=${FDIRY}/${FNAME}\n\nhead ${FPATH}\n\n\nplasmid_r1  plasmid_r2  plasmid_r3  plasmid_r4  K562_r1 K562_r2 K562_r3 K562_r4\n(Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270    660.352667442521    622.944710266239    644.22828252883 623.288796155809    69961.0133424845    56175.0918266184    62517.7361729988    58457.7541026999\n1:10437778:C:T:R:wC 474.83553010081 379.674809464918    415.658458241335    424.421790752505    2757.01754565303    2551.02313181242    2033.95005900354    2827.46630094245\n1:10451799:C:T:R:wC 443.916007210524    507.391507385611    433.436111241473    369.324438606135    413.737336015819    420.663413962001    543.176346871992    371.85871967371\n1:110198727:C:G:R:wC    501.337978292483    511.735612757064    531.636480194619    473.492870007866    56699.2540898346    55794.9923847171    57519.1600712547    60103.7593663607\n1:110881742:NA:NA   684.646578284888    690.712754060892    739.888986767671    658.585537374577    30415.8510027582    27359.6479702214    29419.5139150045    32443.2774254664\n1:111838694:C:T:R:wC    613.973383107093    503.047402014159    639.148953100219    656.863745120003    42147.0283843734    51363.0028447603    54789.7412316768    41853.6480882002\n1:113047064:NA:NA   467.473738936456    434.410537145215    474.070746670361    473.492870007866    480.230836446933    489.772403398615    411.189570996555    640.981696975104\n1:119063648:C:T:R:wC    396.800543758661    419.640578882278    433.436111241473    405.48207595219 416.200058254009    300.473867115715    235.207203162638    192.071170522157\n1:171893999:A:T:R:wC    624.279890737188    573.421909031684    611.212641242859    624.149692283096    868.109588961764    1042.64431889153    1130.34828570246    894.470974350276"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html",
    "title": "Prepare STARR-seq data 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#helper-functions",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#helper-functions",
    "title": "Prepare STARR-seq data 04",
    "section": "Helper functions",
    "text": "Helper functions\nDefine functions\n\n\nCode\nGROUPS  = c(\"Input\", \"Output\")\nSAMPLES = c(\n    paste0(\"Input.rep\",  1:6),\n    paste0(\"Output.rep\", 1:6))\n\nget_info = function(string, patterns){\n    idx = str_detect(string = string, pattern = patterns)\n    return(patterns[idx])\n}\n\nget_group  = function(strings){\n    res = sapply(strings, function(string){get_info(string, GROUPS)})\n    return(res)\n}\n\nget_sample = function(strings){\n    res = sapply(strings, function(string){get_info(string, SAMPLES)})\n    return(res)\n}\n\n\nTest functions\n\n\nCode\ntxt = \"ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\"\nget_info(txt, SAMPLES)\n\n\n'Input.rep1'\n\n\n\n\nCode\ntxt = \"ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\"\nget_group(txt)\n\n\nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz: 'Input'"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-astarr-fragment-counts-ks91",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-astarr-fragment-counts-ks91",
    "title": "Prepare STARR-seq data 04",
    "section": "Metadata for ASTARR fragment counts (KS91)",
    "text": "Metadata for ASTARR fragment counts (KS91)\nGet the file names for fragment counts\n\n\nCode\nTXT_ASSAY  = \"STARR_ATAC_K562_Reddy_KS91\"\nTXT_PREFIX = \"ASTARRseq_K562_KS91\"\nTXT_FOLDER = \"fragment_counts\"\n\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER)\ntxt_fname  = \"*WGS*bed.gz\"\ntxt_fglob  = file.path(txt_fdiry, txt_fname)\n\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nfor (txt in vec_txt_fname){cat(txt, \"\\n\")}\n\n\nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz \nASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz \n\n\nCreate metadata for the files\n\n\nCode\ndat = data.frame(\n    FName  = vec_txt_fname,\n    Assay  = TXT_ASSAY,\n    Prefix = TXT_PREFIX\n)\ndat = dat %&gt;%\n    dplyr::mutate(\n        Group  = get_group(FName),\n        Sample = get_sample(FName)\n    )\n\ndat_metadata_astarr = dat\nfun_display_table(dat)\n\n\n\n\n\nFName\nAssay\nPrefix\nGroup\nSample\n\n\n\n\nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep1\n\n\nASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep2\n\n\nASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep3\n\n\nASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep4\n\n\nASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep5\n\n\nASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nInput\nInput.rep6\n\n\nASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nOutput\nOutput.rep1\n\n\nASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nOutput\nOutput.rep2\n\n\nASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nOutput\nOutput.rep3\n\n\nASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS91\nASTARRseq_K562_KS91\nOutput\nOutput.rep4\n\n\n\n\n\nSave results\n\n\nCode\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER, \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ntxt = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt)\n\ndat = dat_metadata_astarr\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-astarr-fragment-counts-ks274",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-astarr-fragment-counts-ks274",
    "title": "Prepare STARR-seq data 04",
    "section": "Metadata for ASTARR fragment counts (KS274)",
    "text": "Metadata for ASTARR fragment counts (KS274)\nGet the file names for fragment counts\n\n\nCode\nTXT_ASSAY  = \"STARR_ATAC_K562_Reddy_KS274\"\nTXT_PREFIX = \"ASTARRseq_K562_KS274\"\nTXT_FOLDER = \"fragment_counts\"\n\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER)\ntxt_fname  = \"*WGS*bed.gz\"\ntxt_fglob  = file.path(txt_fdiry, txt_fname)\n\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nfor (txt in vec_txt_fname){cat(txt, \"\\n\")}\n\n\nASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz \nASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz \nASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz \n\n\nCreate metadata for the files\n\n\nCode\ndat = data.frame(\n    FName  = vec_txt_fname,\n    Assay  = TXT_ASSAY,\n    Prefix = TXT_PREFIX\n)\ndat = dat %&gt;%\n    dplyr::mutate(\n        Group  = get_group(FName),\n        Sample = get_sample(FName)\n    )\n\ndat_metadata_astarr = dat\nfun_display_table(dat)\n\n\n\n\n\nFName\nAssay\nPrefix\nGroup\nSample\n\n\n\n\nASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS274\nASTARRseq_K562_KS274\nOutput\nOutput.rep1\n\n\nASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS274\nASTARRseq_K562_KS274\nOutput\nOutput.rep2\n\n\nASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz\nSTARR_ATAC_K562_Reddy_KS274\nASTARRseq_K562_KS274\nOutput\nOutput.rep3\n\n\n\n\n\nSave results\n\n\nCode\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER, \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ntxt = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt)\n\ndat = dat_metadata_astarr\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-wstarr-fragment-counts",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#metadata-for-wstarr-fragment-counts",
    "title": "Prepare STARR-seq data 04",
    "section": "Metadata for WSTARR fragment counts",
    "text": "Metadata for WSTARR fragment counts\nGet the file names for fragment counts\n\n\nCode\nTXT_ASSAY  = \"STARR_WHG_K562_Reddy_A001\"\nTXT_PREFIX = \"WSTARRseq_K562_A001\"\nTXT_FOLDER = \"fragment_counts\"\n\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER)\ntxt_fname  = \"*WGS*bed.gz\"\ntxt_fglob  = file.path(txt_fdiry, txt_fname)\n\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nfor (txt in vec_txt_fname){cat(txt, \"\\n\")}\n\n\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz \nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz \n\n\nCreate metadata for the files\n\n\nCode\ndat = data.frame(\n    FName  = vec_txt_fname,\n    Assay  = TXT_ASSAY,\n    Prefix = TXT_PREFIX\n)\ndat = dat %&gt;%\n    dplyr::mutate(\n        Group  = get_group(FName),\n        Sample = get_sample(FName)\n    )\n\ndat_metadata_astarr = dat\nfun_display_table(dat)\n\n\n\n\n\nFName\nAssay\nPrefix\nGroup\nSample\n\n\n\n\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nInput\nInput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nInput\nInput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nInput\nInput.rep3\n\n\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nInput\nInput.rep4\n\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nOutput\nOutput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nOutput\nOutput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nSTARR_WHG_K562_Reddy_A001\nWSTARRseq_K562_A001\nOutput\nOutput.rep3\n\n\n\n\n\nSave results\n\n\nCode\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER, \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ntxt = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt)\n\ndat = dat_metadata_astarr\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#review",
    "href": "notebooks/01_prepare_fcc/fcc_04_export_metadata_STARR_TR_R.html#review",
    "title": "Prepare STARR-seq data 04",
    "section": "Review",
    "text": "Review\nCheck results\n\n\nCode\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", \"STARR*\", \"fragment_counts\", \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fglob = file.path(txt_fdiry, txt_fname)\n\nvec_txt_fpath = Sys.glob(txt_fglob)\nfor (txt_fpath in vec_txt_fpath){\n    cat(txt_fpath, \"\\n\")\n    txt_cmd = paste(\"cat\", txt_fpath)\n    \n    vec = system(txt_cmd, intern = TRUE)\n    for (txt in vec){\n        cat(txt, \"\\n\")\n    }\n    cat(\"\\n\")\n}\n\n\n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts/summary/metadata.tsv \nFName   Assay   Prefix  Group   Sample \nASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz STARR_ATAC_K562_Reddy_KS274 ASTARRseq_K562_KS274    Output  Output.rep1 \nASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz STARR_ATAC_K562_Reddy_KS274 ASTARRseq_K562_KS274    Output  Output.rep2 \nASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz STARR_ATAC_K562_Reddy_KS274 ASTARRseq_K562_KS274    Output  Output.rep3 \n\n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/summary/metadata.tsv \nFName   Assay   Prefix  Group   Sample \nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep1 \nASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep2 \nASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep3 \nASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep4 \nASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep5 \nASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz   STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Input   Input.rep6 \nASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz  STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Output  Output.rep1 \nASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz  STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Output  Output.rep2 \nASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz  STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Output  Output.rep3 \nASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz  STARR_ATAC_K562_Reddy_KS91  ASTARRseq_K562_KS91 Output  Output.rep4 \n\n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/summary/metadata.tsv \nFName   Assay   Prefix  Group   Sample \nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz   STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Input   Input.rep1 \nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz   STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Input   Input.rep2 \nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz   STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Input   Input.rep3 \nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz   STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Input   Input.rep4 \nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz  STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Output  Output.rep1 \nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz  STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Output  Output.rep2 \nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz  STARR_WHG_K562_Reddy_A001   WSTARRseq_K562_A001 Output  Output.rep3"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html",
    "title": "Prepare STARR-seq data 031",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\nCode\nmkdir -p ${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nmkdir -p ${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts\nmkdir -p ${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nmkdir -p ${FD_RES}/region/fcc_astarr_macs"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-fragment-counts-of-astarr-ks91",
    "href": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-fragment-counts-of-astarr-ks91",
    "title": "Prepare STARR-seq data 031",
    "section": "Prepare fragment counts of ASTARR (KS91)",
    "text": "Prepare fragment counts of ASTARR (KS91)\nData: Original files\nPROJECT/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n\nASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\nASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\nCheck data\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nls -1 ${FD_INP}/*fragments.counts* | xargs -n 1 basename\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\nExecute\nList the file names, loop the list, and link the files\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nFN_INPS=(\n    KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n    KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\n)\n\n\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUTS=(\n    ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\n)\n\n\n\n\nCode\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ -h ${LINK} ]]; then\n        echo \"Remove existing link.\"\n        rm ${LINK}\n    fi\n    \n    if [[ ! -e ${LINK} ]]; then\n        echo \"Create symbolic links.\"\n        ln -s ${FILE} ${LINK}\n    fi\ndone\n\n\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\n\n\nCheck results\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/*bed.gz\nls -l ${FD_OUT}\n\n\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 166 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 176 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 166 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 176 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\n\n\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head -n 6\n\n\nchr1    10001   10143   chr1_10001_10143    1   .\nchr1    10002   10118   chr1_10002_10118    1   .\nchr1    10002   10131   chr1_10002_10131    1   .\nchr1    10002   10203   chr1_10002_10203    1   .\nchr1    10002   10209   chr1_10002_10209    1   .\nchr1    10002   10227   chr1_10002_10227    1   .\n\n\nCheck results\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nls -l ${FD_OUT}/*bed.gz\n\n\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 172 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 166 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 176 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 166 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 176 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts/ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\n\n\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS91/fragment_counts\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head -n 6\n\n\nchr1    10001   10143   chr1_10001_10143    1   .\nchr1    10002   10118   chr1_10002_10118    1   .\nchr1    10002   10131   chr1_10002_10131    1   .\nchr1    10002   10203   chr1_10002_10203    1   .\nchr1    10002   10209   chr1_10002_10209    1   .\nchr1    10002   10227   chr1_10002_10227    1   ."
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-fragment-counts-of-wstarr-a001",
    "href": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-fragment-counts-of-wstarr-a001",
    "title": "Prepare STARR-seq data 031",
    "section": "Prepare fragment counts of WSTARR (A001)",
    "text": "Prepare fragment counts of WSTARR (A001)\nData: Original files\nPROJECT/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\nResults: SymLinks\nPROJECT/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nCheck data\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\nls -lh ${FD_INP}\n\n\ntotal 9.8G\n-rw-r--r-- 1 kk319 reddylab  284M Apr 10 21:45 A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab 1022M Apr 10 21:45 A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Apr 10 21:45 A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.1G Apr 10 21:45 A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Apr 10 21:45 A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  1.6G Apr 10 21:45 A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 kk319 reddylab  3.2G Apr 10 21:45 A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\nExecute\nList the file names, loop the list, and link the files\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\nFN_INPS=(\n    A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n    A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n    A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n)\n\n\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUTS=(\n    WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\n    WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\n)\n\n\n\n\nCode\nfor idx in \"${!FN_INPS[@]}\"\ndo\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    \n    FILE=${FD_INP}/${FN_INP}\n    LINK=${FD_OUT}/${FN_OUT}\n    \n    if [[ -h ${LINK} ]]; then\n        echo \"Remove existing link.\"\n        rm ${LINK}\n    fi\n    \n    if [[ ! -e ${LINK} ]]; then\n        echo \"Create symbolic links.\"\n        ln -s ${FILE} ${LINK}\n    fi\ndone\n\n\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\nRemove existing link.\nCreate symbolic links.\n\n\nCheck results\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nls -lh ${FD_OUT}/*bed.gz\n\n\nlrwxrwxrwx 1 kk319 reddylab 154 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 154 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 154 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 154 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 148 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 148 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nlrwxrwxrwx 1 kk319 reddylab 148 Apr 10 22:06 /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts/WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz -&gt; /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments/A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\n\nCode\nFD_OUT=${FD_RES}/assay_fcc/STARR_WHG_K562_Reddy_A001/fragment_counts\nFN_OUT=WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head\n\n\nchr1    10335   10549   chr1_10335_10549    1   .\nchr1    16983   17500   chr1_16983_17500    1   .\nchr1    16985   17499   chr1_16985_17499    1   .\nchr1    17004   17500   chr1_17004_17500    1   .\nchr1    17483   17898   chr1_17483_17898    1   .\nchr1    17487   17941   chr1_17487_17941    1   .\nchr1    33606   33997   chr1_33606_33997    1   .\nchr1    33617   33997   chr1_33617_33997    1   .\nchr1    38785   39226   chr1_38785_39226    1   .\nchr1    46328   46678   chr1_46328_46678    1   ."
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-regions-of-macs-peaks-called-in-astarr-input-libraries",
    "href": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#prepare-regions-of-macs-peaks-called-in-astarr-input-libraries",
    "title": "Prepare STARR-seq data 031",
    "section": "Prepare regions of MACS peaks called in ASTARR input libraries",
    "text": "Prepare regions of MACS peaks called in ASTARR input libraries\nData: Original files\nPROJECT/data/processed/ASTARRseq_K562_hg38_KS91_210401/peaks\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nResults: SymLinks\nPROJECT/results/region/starr_macs\nASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed\nASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed\nCheck data\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nls -lh ${FD_INP}\n\n\ntotal 9.5M\n-rw-r--r-- 1 kk319 reddylab 5.7M Apr 10 21:46 KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n-rw-r--r-- 1 kk319 reddylab 3.8M Apr 10 21:46 KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\ncat ${FP_INP} | head\n\n\nchr1    10038   10405   6\nchr1    14282   14614   6\nchr1    16025   16338   6\nchr1    17288   17689   6\nchr1    28934   29499   6\nchr1    115429  115969  6\nchr1    136201  137353  6\nchr1    137748  138049  6\nchr1    138321  139517  6\nchr1    181005  181854  6\n\n\nExecute\nCopy union peak file\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ngzip -c ${FP_INP} &gt; ${FP_OUT}\nzcat ${FP_OUT} | head\n\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\nchr1    101603  101849\nchr1    115411  115986\nchr1    118518  118743\nchr1    136071  137429\n\n\nUpdate overlap/intersect peak file\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFN_INP=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFP_INP=${FD_INP}/${FN_INP}\n\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat ${FP_INP} | cut -f1-3 | gzip -c &gt; ${FP_OUT}\nzcat ${FP_OUT} | head\n\n\nchr1    10038   10405\nchr1    14282   14614\nchr1    16025   16338\nchr1    17288   17689\nchr1    28934   29499\nchr1    115429  115969\nchr1    136201  137353\nchr1    137748  138049\nchr1    138321  139517\nchr1    181005  181854\n\n\nCreate metadata\n\n\nCode\nTAB=\"$(printf '\\t')\"\n\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nFN_OUT=description.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\n\ncat &gt; ${FP_OUT} &lt;&lt; EOF\nName${TAB}Note\nChrom${TAB}Name of the chromosome\nChromStart${TAB}The starting position of the feature in the chromosome\nChromEnd${TAB}The ending position of the feature in the chromosome\nEOF\n\ncat ${FP_OUT} | expand -t 15\n\n\nName           Note\nChrom          Name of the chromosome\nChromStart     The starting position of the feature in the chromosome\nChromEnd       The ending position of the feature in the chromosome\n\n\nCheck results\n\n\nCode\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nls -lh ${FD_OUT}\n\n\ntotal 512\n-rw-rw-r-- 1 kk319 reddylab 1.2M Apr 10 22:06 ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 2.0M Apr 10 22:06 ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed.gz\n-rw-rw-r-- 1 kk319 reddylab  167 Apr 10 22:06 description.tsv"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#copy-atac-peaks-to-reference-folder",
    "href": "notebooks/01_prepare_fcc/fcc_031_prepare_data_STARR_TR_KS91_SH.html#copy-atac-peaks-to-reference-folder",
    "title": "Prepare STARR-seq data 031",
    "section": "Copy ATAC peaks to reference folder",
    "text": "Copy ATAC peaks to reference folder\n\n\nCode\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nFD_REF=${FD_PRJ}/references/fcc_peak_call_atac\nFN_REF=STARRseq_ATAC.K562.TR.hg38.Input.rep_all.union.q5.bed.gz\nFP_REF=${FD_REF}/${FN_REF}\n\ncp ${FP_OUT} ${FP_REF}\n\n\n\n\nCode\nFD_OUT=${FD_RES}/region/fcc_astarr_macs\nFN_OUT=ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nFD_REF=${FD_PRJ}/references/fcc_peak_call_atac\nFN_REF=STARRseq_ATAC.K562.TR.hg38.Input.rep_all.max_overlaps.q5.bed.gz\nFP_REF=${FD_REF}/${FN_REF}\n\ncp ${FP_OUT} ${FP_REF}\n\n\n\n\nCode\nls -lh ${FD_PRJ}/references/fcc_peak_call_atac\n\n\ntotal 2.0M\n-rw-rw-r-- 1 kk319 reddylab 1.2M Apr 10 22:06 STARRseq_ATAC.K562.TR.hg38.Input.rep_all.max_overlaps.q5.bed.gz\n-rw-rw-r-- 1 kk319 reddylab 2.0M Apr 10 22:06 STARRseq_ATAC.K562.TR.hg38.Input.rep_all.union.q5.bed.gz"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html",
    "title": "Prepare STARR-seq data 01",
    "section": "",
    "text": "In this analysis, we are using the fragment counts data generated and processed from the Reddy lab. The ASTARR in K562 is designed and done by Keith and WSTARR in K562 is generated by Kari. For more information, check the data dictionary page.\nSet environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html#check-existence-of-starr-data",
    "href": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html#check-existence-of-starr-data",
    "title": "Prepare STARR-seq data 01",
    "section": "Check existence of STARR data",
    "text": "Check existence of STARR data\nWSTARR\n\n\nCode\nls ${FD_WGS_WSTARR}\n\n\nfragments  metadata  motifs  peaks  processed_raw_reads  qc  raw_reads\n\n\n\n\nCode\necho ${FD_WGS_WSTARR_FRAGS}\necho \nfor FPATH in ${FP_WGS_WSTARR_FRAGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\n\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\n\nCode\necho ${FD_WGS_WSTARR_INP_BAM}\necho \nfor FPATH in ${FP_WGS_WSTARR_INP_BWIGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\n/data/reddylab/kstrouse/superstarr/input_libs/A001/nextseq/processing/starr_seq/A001_nextseq-pe\n\nrep1.f3q10.sorted.dedup.rpkm.bw\nrep2.f3q10.sorted.dedup.rpkm.bw\nrep3.f3q10.sorted.dedup.rpkm.bw\nrep4.f3q10.sorted.dedup.rpkm.bw\n\n\n\n\nCode\necho ${FD_WGS_WSTARR_OUT_BAM_rep01}\necho ${FD_WGS_WSTARR_OUT_BAM_rep23}\necho \nfor FPATH in ${FP_WGS_WSTARR_OUT_BWIGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\n/data/reddylab/kstrouse/superstarr/output_libs/A001_K562/A001_K562_20201124/combined_reads/processing/starr_seq/A001_K562_20201124_combined-pe\n/data/reddylab/kstrouse/superstarr/output_libs/A001_K562/A001_K562_20210213/processing/starr_seq/Strouse_6825_210223A5-pe\n\nA001-K562-rep1.f3q10.sorted.dedup.rpkm.bw\nA001-K562-rep2.f3q10.sorted.dedup.rpkm.bw\nA001-K562-rep3.f3q10.sorted.dedup.rpkm.bw\n\n\nASTARR (KS91)\n\n\nCode\necho ${FD_WGS_ASTARR_KS91_INP}\necho ${FD_WGS_ASTARR_KS91_OUT}\n\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS91_FRAGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS91_FRAGS[@]}; do\n    ls -l ${FPATH}\ndone\n\n\n-rw-r--r-- 1 aeb84 reddylab 3146501530 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 3995769876 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 4291888489 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 4037119129 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 3938483893 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 3550102461 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2/KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 320000484 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 588618835 Apr  4 13:26 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 595652591 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 672333423 Apr  4 13:29 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 672333423 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 1096240707 Apr  4 14:08 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\n-rw-r--r-- 1 aeb84 reddylab 1107286720 Jul  7  2022 /data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis/KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS91_BWIGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep5.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep6.f3q10.sorted.with_umis.dedup.cpm.bw\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS91[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep5.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep6.f3q10.sorted.with_umis.dedup.cpm.bw\n\n\nASTARR (KS274)\n\n\nCode\necho ${FD_WGS_ASTARR_KS274_OUT}\n\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS274_OUT_FRAGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS274_OUT_BWIGS[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nK562_ASTARR_repeat_rep1.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep2.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep3.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n\n\n\nCode\nfor FPATH in ${FP_WGS_ASTARR_KS274[@]}; do\n    ls ${FPATH} | xargs -n 1 basename\ndone\n\n\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep1.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep2.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep3.f3q10.sorted.with_umis.dedup.rpkm.bw"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html#set-data-directories-and-copy-the-final-processed-data-of-starr-seq",
    "href": "notebooks/01_prepare_fcc/fcc_01_acquire_data_STARR_TR_SH.html#set-data-directories-and-copy-the-final-processed-data-of-starr-seq",
    "title": "Prepare STARR-seq data 01",
    "section": "Set data directories and copy the final processed data of STARR-seq",
    "text": "Set data directories and copy the final processed data of STARR-seq\n\nCreate data directories\nPROJECT/data/processed\n├── STARR_ATAC_K562_Reddy_KS91_210401\n│   ├── fragments\n│   └── peaks\n│\n├── STARR_ATAC_K562_Reddy_KS274_240311\n│   └── fragments\n│\n├── STARR_WHG_K562_Reddy_A001_Alex\n│   └── fragments\n│\n└── STARR_WHG_K562_Reddy_A001_Kari\n    └── superstarr\n        ├── input_libs\n        │   └── A001_K562\n        └── output_libs\n            ├── A001_K562_20201124\n            └── A001_K562_20210213\n\n\nCode\nmkdir -p ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nmkdir -p ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nmkdir -p ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nmkdir -p ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\n\nFDIRY=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari/superstarr\nmkdir -p ${FDIRY}/input_libs\nmkdir -p ${FDIRY}/output_libs\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR*\nls -1 ${FD_DAT}/processed/STARR*/superstarr\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311:\nfragments\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401:\nfragments\npeaks\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex:\nfragments\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Kari:\nsuperstarr\ninput_libs\noutput_libs\n\n\n\n\nCopy data files\nCopy WSTARR fragment counts\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\n\nfor FPATH in ${FP_WGS_WSTARR_FRAGS[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/data/starr_seq/fragments\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\nCopy WSTARR bigwigs\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari/superstarr/input_libs\n\nfor FPATH in ${FP_WGS_WSTARR_INP_BWIGS[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/kstrouse/superstarr/input_libs/A001/nextseq/processing/starr_seq/A001_nextseq-pe\nrep1.f3q10.sorted.dedup.rpkm.bw\n\n/data/reddylab/kstrouse/superstarr/input_libs/A001/nextseq/processing/starr_seq/A001_nextseq-pe\nrep2.f3q10.sorted.dedup.rpkm.bw\n\n/data/reddylab/kstrouse/superstarr/input_libs/A001/nextseq/processing/starr_seq/A001_nextseq-pe\nrep3.f3q10.sorted.dedup.rpkm.bw\n\n/data/reddylab/kstrouse/superstarr/input_libs/A001/nextseq/processing/starr_seq/A001_nextseq-pe\nrep4.f3q10.sorted.dedup.rpkm.bw\n\n\n\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari/superstarr/output_libs\n\nfor FPATH in ${FP_WGS_WSTARR_OUT_BWIGS[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/kstrouse/superstarr/output_libs/A001_K562/A001_K562_20201124/combined_reads/processing/starr_seq/A001_K562_20201124_combined-pe\nA001-K562-rep1.f3q10.sorted.dedup.rpkm.bw\n\n/data/reddylab/kstrouse/superstarr/output_libs/A001_K562/A001_K562_20210213/processing/starr_seq/Strouse_6825_210223A5-pe\nA001-K562-rep2.f3q10.sorted.dedup.rpkm.bw\n\n/data/reddylab/kstrouse/superstarr/output_libs/A001_K562/A001_K562_20210213/processing/starr_seq/Strouse_6825_210223A5-pe\nA001-K562-rep3.f3q10.sorted.dedup.rpkm.bw\n\n\n\nCopy ASTARR fragment counts\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\n\nfor FPATH in ${FP_WGS_ASTARR_KS91[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal/merged2\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.exclude_dups.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.sorted.with_umis.dedup.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.sorted.with_umis.dedup.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep5.f3q10.sorted.with_umis.dedup.cpm.bw\n\n/data/reddylab/Alex/encode4_duke/processing/starr_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-umis\nKS91_K562_hg38_ASTARRseq_Output_rep6.f3q10.sorted.with_umis.dedup.cpm.bw\n\n\n\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\n\nfor FPATH in ${FP_WGS_ASTARR_KS274[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep1.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep2.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n/data/reddylab/Keith/encode4_duke/processing/starr_seq/240311_KS274_ASTARR_Output_Nextseq-pe-umis\nK562_ASTARR_repeat_rep3.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n\n\nCopy ASTARR peak calls\n\n\nCode\nFD_OUT=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\n\nfor FPATH in ${FP_WGS_ASTARR_KS91_INP_PEAKS[@]}; do\n    FDIRY=$(dirname  ${FPATH})\n    FNAME=$(basename ${FPATH})\n    cp ${FPATH} ${FD_OUT}/${FNAME}\n    \n    echo ${FDIRY}\n    echo ${FNAME}\n    echo\ndone\n\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n\n/data/reddylab/Alex/encode4_duke/processing/atac_seq/210401_KS91_K562ASTARR_NovaSeq.hg38-pe-blacklist-removal\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\nCheck results\nCheck if the data is copied correctly.\n\n\nCode\nls -d ${FD_DAT}/processed/STARR*\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Kari\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR*\nls -1 ${FD_DAT}/processed/STARR*/superstarr\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311:\nfragments\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401:\nfragments\npeaks\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex:\nfragments\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Kari:\nsuperstarr\ninput_libs\noutput_libs\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\n\n\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari/superstarr/input_libs\n\n\nrep1.f3q10.sorted.dedup.rpkm.bw\nrep2.f3q10.sorted.dedup.rpkm.bw\nrep3.f3q10.sorted.dedup.rpkm.bw\nrep4.f3q10.sorted.dedup.rpkm.bw\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari/superstarr/output_libs\n\n\nA001-K562-rep1.f3q10.sorted.dedup.rpkm.bw\nA001-K562-rep2.f3q10.sorted.dedup.rpkm.bw\nA001-K562-rep3.f3q10.sorted.dedup.rpkm.bw\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.exclude_dups.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.corrected.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep5.f3q10.sorted.with_umis.dedup.cpm.bw\nKS91_K562_hg38_ASTARRseq_Output_rep6.f3q10.sorted.with_umis.dedup.cpm.bw\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\n\n\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\n\nCode\nls -1 ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\n\n\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep1.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep2.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep3.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n\nCheck folder size\n\n\nCode\ndu -sh ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex\n\n\n9.8G    /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Alex\n\n\n\n\nCode\ndu -sh ${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Kari\n\n\n8.4G    /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_WHG_K562_Reddy_A001_Kari\n\n\n\n\nCode\ndu -sh ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\n\n\n44G /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\n\n\n\n\nCode\ndu -sh ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\n\n\n4.1M    /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\n\n\n\n\nCode\ndu -sh ${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311\n\n\n5.5G    /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311"
  },
  {
    "objectID": "notebooks/00_setup/13_check_config_sing_SH.html",
    "href": "notebooks/00_setup/13_check_config_sing_SH.html",
    "title": "Check environment 03",
    "section": "",
    "text": "Code\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Singularity: singularity_proj_encode_fcc\nBASE DIRECTORY (FD_BASE):      /mount\nREPO DIRECTORY (FD_REPO):      /mount/repo\nWORK DIRECTORY (FD_WORK):      /mount/work\nDATA DIRECTORY (FD_DATA):      /mount/data\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /mount/repo/Proj_CombEffect_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /mount/repo/Proj_CombEffect_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /mount/repo/Proj_CombEffect_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /mount/repo/Proj_CombEffect_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /mount/repo/Proj_CombEffect_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /mount/repo/Proj_CombEffect_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /mount/repo/Proj_CombEffect_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /mount/repo/Proj_CombEffect_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /mount/repo/Proj_CombEffect_ENCODE_FCC/references\n\n\n\n\n\nCode\nTXT=$(fun_get_server)\necho ${TXT}\n\n\nSingularity\n\n\n\n\nCode\nif [[ ${TXT} == \"Singularity\" ]]; then\n    echo \"You are in singularity\"\nfi\n\n### =====================================\n\nif [[ ${TXT} == \"HARDAC\" ]]; then\n    echo \"You are in HARDAC\"\nfi\n\n\nYou are in singularity"
  },
  {
    "objectID": "notebooks/00_setup/11_check_config_and_kernel_PY.html",
    "href": "notebooks/00_setup/11_check_config_and_kernel_PY.html",
    "title": "Check environment 01",
    "section": "",
    "text": "Code\nimport numpy  as np\nimport scipy  as sc\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\n\n\nCode\nimport umap\n\n\n\n\nCode\nimport igv_notebook\nimport hicstraw"
  },
  {
    "objectID": "notebooks/00_setup/03_setup_config_on_sing_SH.html",
    "href": "notebooks/00_setup/03_setup_config_on_sing_SH.html",
    "title": "Setup Envionment 03",
    "section": "",
    "text": "Set environment"
  },
  {
    "objectID": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_path_sing.sh",
    "href": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_path_sing.sh",
    "title": "Setup Envionment 03",
    "section": "Setup config_path_sing.sh",
    "text": "Setup config_path_sing.sh"
  },
  {
    "objectID": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_project_sing.r",
    "href": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_project_sing.r",
    "title": "Setup Envionment 03",
    "section": "Setup config_project_sing.R",
    "text": "Setup config_project_sing.R"
  },
  {
    "objectID": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_project_sing.py",
    "href": "notebooks/00_setup/03_setup_config_on_sing_SH.html#setup-config_project_sing.py",
    "title": "Setup Envionment 03",
    "section": "Setup config_project_sing.py",
    "text": "Setup config_project_sing.py"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html",
    "title": "Setup Envionment 01",
    "section": "",
    "text": "PROJECT\n├── app\n│   └── singularity_proj_encode_fcc.sif\n├── data\n│   ├── external\n│   └── processed\n├── results\n├── scripts\n├── references\n├── notebooks\n├── docs\n├── site\n├── log\n├── README.md\n└── .gitignore\nSet environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#link-to-folders",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#link-to-folders",
    "title": "Setup Envionment 01",
    "section": "Link to folders",
    "text": "Link to folders\nln -s file link\n\n\nCode\necho ${FD_WORK}\necho ${FD_PRJ}\n\n\n/data/reddylab/Kuei/work\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC\n\n\nCreate softlinks\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/data\nLINK=${FD_PRJ}/data\n\nln -sf ${FILE} ${LINK}\n\n\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/results\nLINK=${FD_PRJ}/results\n\nln -sf ${FILE} ${LINK}\n\n\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/log\nLINK=${FD_PRJ}/log\n\nln -sf ${FILE} ${LINK}\n\n\nCheck folder structure\n\n\nCode\necho  ${FD_PRJ}\nls -1 ${FD_PRJ}\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC\napp\ndata\ndocs\nlog\nnotebooks\nREADME.md\nreferences\nresults\nscripts\nsite\ntests\ntmp"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#link-to-container",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#link-to-container",
    "title": "Setup Envionment 01",
    "section": "Link to container",
    "text": "Link to container\n\n\nCode\necho ${FD_SING}\necho ${FD_APP}\n\n\n/data/reddylab/Kuei/container\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\n\n\n\n\nCode\nls ${FD_SING}\necho\nls ${FD_SING}/biocontainer\necho\nls ${FD_SING}/project\n\n\nbiocontainer  home  project  project_backup  project_tmp  rstudio_tmp  toolbox\n\nbedtools:2.30.0--h468198e_3  bedtools:2.31.1--hf5e1c6e_1  deeptools:3.5.1--py_0\n\nsingularity_motif.sif            singularity_scratch.sif\nsingularity_proj_encode_fcc.sif  singularity_test.sif\n\n\n\n\nCode\nFILE=${FD_SING}/biocontainer/bedtools:2.31.1--hf5e1c6e_1\nLINK=${FD_APP}/app/bedtools\n\n\n\n\nCode\nFILE=${FD_SING}/project/singularity_proj_encode_fcc.sif\nLINK=${FD_APP}/app/bedtools"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#set-executable",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#set-executable",
    "title": "Setup Envionment 01",
    "section": "Set executable",
    "text": "Set executable\nchmod +x file\n\n\nCode\necho ${FD_EXE}\n\n\n/data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/scripts\n\n\n\n\nCode\nchmod +x ${FD_EXE}/*\nls -1 ${FD_EXE}\n\n\nconfig_func.sh\nconfig_path_duke_hardac.sh\nconfig_path_sing.sh\nconfig_project.sh\nconfig_venv_wrapper.sh\nsing_jupyter.sh\nsing_quarto.sh\nsing_script.sh"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#create-symlinks",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#create-symlinks",
    "title": "Setup Envionment 01",
    "section": "Create symlinks",
    "text": "Create symlinks\nln -s file link\n&lt;PROJECT&gt;\n├── app\n│   └── singularity_proj_encode_fcc.sif -&gt; &lt;CONTAINER&gt;/project/singularity_proj_encode_fcc.sif\n├── data    -&gt; &lt;WORK&gt;/data\n├── results -&gt; &lt;WORK&gt;/results\n├── scripts\n├── references\n├── notebooks\n├── docs\n├── site\n├── log     -&gt; &lt;WORK&gt;/log\n├── README.md\n└── .gitignore\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/data\nLINK=${FD_PRJ}/data\n\nif [[ -h ${LINK} ]]; then\n    echo \"Remove existing link.\"\n    rm ${LINK}\nfi\n\nif [[ -e ${FILE} ]]; then\n    echo \"Create symbolic links: LINK -&gt; FILE\"\n    ln -s ${FILE} ${LINK}\nfi\n\n\nRemove existing link.\nCreate symbolic links: LINK -&gt; FILE\n\n\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/log\nLINK=${FD_PRJ}/log\n\nif [[ -h ${LINK} ]]; then\n    echo \"Remove existing link.\"\n    rm ${LINK}\nfi\n\nif [[ -e ${FILE} ]]; then\n    echo \"Create symbolic links: LINK -&gt; FILE\"\n    ln -s ${FILE} ${LINK}\nfi\n\n\nRemove existing link.\nCreate symbolic links: LINK -&gt; FILE\n\n\n\n\nCode\nFILE=${FD_WORK}/proj_encode_fcc/results\nLINK=${FD_PRJ}/results\n\nif [[ -h ${LINK} ]]; then\n    echo \"Remove existing link.\"\n    rm ${LINK}\nfi\n\nif [[ -e ${FILE} ]]; then\n    echo \"Create symbolic links: LINK -&gt; FILE\"\n    ln -s ${FILE} ${LINK}\nfi\n\n\nRemove existing link.\nCreate symbolic links: LINK -&gt; FILE"
  },
  {
    "objectID": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#check-folder-structure",
    "href": "notebooks/00_setup/01_setup_folder_on_hardac_SH.html#check-folder-structure",
    "title": "Setup Envionment 01",
    "section": "Check folder structure",
    "text": "Check folder structure\n\n\nCode\necho  ${FD_PRJ}\nls -1 ${FD_PRJ}\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC\napp\ndata\ndocs\nlog\nnotebooks\nREADME.md\nreferences\nresults\nscripts\nsite\ntests\ntmp\n\n\n\n\nCode\necho  ${FD_PRJ}/tmp\nls -1 ${FD_PRJ}/tmp\n\n\n/data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC/tmp\nnotebooks_pre\nnotebooks_v1\nnotebooks_v2\nnotebooks_v3\nnotebooks_v4\ntest.txt\n\n\n\n\nCode\nls ${FD_SING}\nls ${FD_SING}/project\n\n\nbiocontainer  home  project  project_backup  project_tmp  rstudio_tmp  toolbox\nsingularity_motif.sif            singularity_scratch.sif\nsingularity_proj_encode_fcc.sif  singularity_test.sif\n\n\n\n\nCode\nfind -L ${FD_PRJ} -maxdepth 2 -type d -not -path '*/.*' | cut -d/ -f 6- | sort\n\n\nProj_ENCODE_FCC\nProj_ENCODE_FCC/app\nProj_ENCODE_FCC/data\nProj_ENCODE_FCC/data/external\nProj_ENCODE_FCC/data/processed\nProj_ENCODE_FCC/docs\nProj_ENCODE_FCC/docs/01_setup\nProj_ENCODE_FCC/docs/02_prepare\nProj_ENCODE_FCC/docs/11_fcc_coverage\nProj_ENCODE_FCC/docs/figure\nProj_ENCODE_FCC/docs/notebooks\nProj_ENCODE_FCC/docs/site_libs\nProj_ENCODE_FCC/log\nProj_ENCODE_FCC/notebooks\nProj_ENCODE_FCC/notebooks/01_setup\nProj_ENCODE_FCC/notebooks/02_prepare\nProj_ENCODE_FCC/notebooks/31_region_nuc\nProj_ENCODE_FCC/notebooks/32_region_coverage\nProj_ENCODE_FCC/notebooks/33_region_annotation\nProj_ENCODE_FCC/notebooks/41_hic_nuc\nProj_ENCODE_FCC/notebooks/42_hic_coverage\nProj_ENCODE_FCC/notebooks/43_hic_annotation\nProj_ENCODE_FCC/notebooks/44_hic_meta\nProj_ENCODE_FCC/notebooks/build_site\nProj_ENCODE_FCC/notebooks/build_tracks\nProj_ENCODE_FCC/notebooks/discussion\nProj_ENCODE_FCC/notebooks/shared\nProj_ENCODE_FCC/references\nProj_ENCODE_FCC/references/encode_crispri_hcrff\nProj_ENCODE_FCC/references/encode_open_chromatin\nProj_ENCODE_FCC/results\nProj_ENCODE_FCC/results/annotation\nProj_ENCODE_FCC/results/assay_fcc\nProj_ENCODE_FCC/results/assay_hic\nProj_ENCODE_FCC/results/region\nProj_ENCODE_FCC/scripts\nProj_ENCODE_FCC/site\nProj_ENCODE_FCC/site/01_setup\nProj_ENCODE_FCC/site/02_prepare\nProj_ENCODE_FCC/site/11_fcc_coverage\nProj_ENCODE_FCC/site/12_fcc_comparison\nProj_ENCODE_FCC/site/docs\nProj_ENCODE_FCC/site/figure\nProj_ENCODE_FCC/site/notebooks\nProj_ENCODE_FCC/site/table\nProj_ENCODE_FCC/tests\nProj_ENCODE_FCC/tmp\nProj_ENCODE_FCC/tmp/notebooks_pre\nProj_ENCODE_FCC/tmp/notebooks_v1\nProj_ENCODE_FCC/tmp/notebooks_v2\nProj_ENCODE_FCC/tmp/notebooks_v3\nProj_ENCODE_FCC/tmp/notebooks_v4"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ENCODE Project: Functional characterization of regulatory regions using genome-wide functional screens and chromatin interactions",
    "section": "",
    "text": "Introduction\nEstablishing non-coding mechanisms for disease remains a major goal in human genetics. Identifying the genomic mechanisms that contribute to gene regulation is critical to achieving that goal. Two promising technologies for identifying those mechanisms are high-throughput reporter assays and CRISPR screens.\n\n\n\nObjectives\nThis site documents a segment of the analyses conducted by the ENCODE Functional Characterization Center (FCC) working group. In this series of analyses, we have integrated data from STARR/MPRA/CRISPRi/Hi-C assays with genomic annotations of chromatin states (cCREs/ChromHMM) and transcription factor (TF) binding sites to:\nThis site documents a part of analyses in the ENCODE FCC working group. In this series of analyses, we integrated the STARR/MPRA/CRISPRi/Hi-C assays with genomic annotations of chromatin states (cCREs/ChromHMM) and TF binding sites in order to:\n\nQualitatively summarize the regulatory regions identified through STARR/MPRA/CRISPRi assays.\nQuantitative compare the regulatory effects measured in STARR/MPRA/CRISPRi assays\nInvestigate the physical interactions of the regulatory regions using the Hi-C assay\n\n Figure. The ENCODE resource of functional characterization assays and functional genomic data in K562. Phase 4 of the ENCODE project included a coordinated effort across eight labs to functionally characterize human gene regulatory elements using high-throughput reporter assay screens (ATAC-STARR-seq, WHG-STARR-seq, Tiling-MPRA, and Lenti-MPRA) and high-throughput CRISPR perturbational screens (CRISPRi HCR-FlowFISH and CRISPRi growth screen).\nRead more about the ENCODE FCC project and working group\n\n\nSummary\n\nCompared the effects of STARR-seq, MPRA, CRISPRi, and Hi-C assays across the FCC coordinated target regions (GATA1/MYC, LMO2, GATA1, Globin, MYB, and FADS). To do so, we compared Z-score and ranked normalized effects from all of the assays across the regions. Overall, we found common enrichment of strong effects, but also many examples where the assays give different results.\nMeasured enrichment in regulatory states for a combined set of FCC-defined elements. To do so, we took the union of the significant effects from STARR-seq and MPRA (Junke’s peak calls), CRISPRi-FF (CASA peaks), CRISPR-growth (Alex’s DESeq analysis). We then calculated enrichment for cCREs and ChromHMM states in those call sets. We found several chromatin states that were enriched in FCC-identified elements. We also found some cCRE states vary across the assays. We are currently investigating if that variation is biological or due to technical issues about how peaks are called for the different assays.\nDeveloped an analysis pipeline to summarize and compare regulatory effects across accessible regions. Specifically, for each site of chromatin accessibility defined by ATAC-seq, we compiled the estimated effects for ATAC-STARR-seq (Keith, Alex), WG-STARR-seq (Kari, Alex), Tiling MPRA (Hannah), Lenti-MPRA (Vikram), and CRISPRi (Jin-Woo). That resulted in a master table of effects for each assay across all ATAC-seq regions. We then estimated effect size distributions and correlated effects across open chromatin sites using that matrix. We also did across different chromatin states (e.g., cCREs, ChromHMM) assigned to the open chromatin sites. We again found that activity of the assays was positively enriched in many chromatin states associated with active gene regulation. We also found some states had repressed activity for ATAC-STARR-seq but activation in other assays. We are currently investigating if that is a biological finding or due to biases in the analysis.\nExamined the relationship between functional genomic and chromatin 3D organization. This idea is based on the TAD analysis by Jin-Woo and discussions with Gurkan. To do so, we examined loop coverage at regulatory regions across different assays and found that the frequency of loop calls in regulatory regions are higher than background for regulatory regions. We further performed aggregate region analysis to provide a general overview of the 3D genomic structure around the significant regions identified by CRISPRi-HCR FlowFISH assays. From the average contact map, we observed an enrichment of Hi-C signal at TSS-Peak location for regulatory elements identified by the assays. We are currently designing and performing aggregate region analysis for regulatory elements identified in STARR/MPRA and CRISPRi-Growth assays.\nWe are investigating if there is evidence of different classes of enhancers in the FCC datasets. Specifically, we are investigating if there are some enhancers that have activity on their own, and others whose activity depends on nearby physical interacting enhancers. This idea is based on a previous analysis from the ReddyLab using ChIP-STARR-seq (Vockley et al., 2016). Currently, we are classifying which elements are isolated in the genome, and which are potentially interacting. We will then compare regulatory effects across the FCC assays for those classes.\n\nRead the main report of the analyses\n\n\nExploration\nOne of the main goal in this project is to better characterize cis-regulatory elements (CREs) by leveraging a wide range of FCC functional screens performed under a consistent biological condition (K562 steady state)\nTo identify what factors could possibly make a region become functional, we compared significant regions to inactive regions by integrating multiple assays together. We first grouped CREs using the traditional proximal and distal categories. We then compared each group to inactive regions by designing an enrichment analysis based on propensity score-based covariate matching and permutation testing. These results allowed us to describe what factors were enriched in the regulatory regions.\nRecognizing that traditional CRE categories may not fully capture the complexity of regulatory mechanisms, we further applied unsupervised dimensionality reduction and clustering to ChIP-seq profiles, revealing distinct CRE subtypes with characteristic transcription factor and histone mark signatures. These results highlighted the biological heterogeneity of CREs and the need for more sophisticate classification/annotation of regulatory elements.\n\nRead the details of the analyses\n\n\nAcknowledgement\nThe analytical work presented in this document was primarily conducted by Kuei-Yueh Ko under the guidance and supervision of Tim Reddy (Advisor) and Alex Barrera. The direction of the analyses was also guided by Keith Siklenka and Gürkan Yardimci. We express our sincere appreciation to the research teams and individuals involved in conducting, processing, and sharing the experiments and data that underpin our analyses. For further details, please refer to the data dictionary.\n\n\nMore information\n\nAbout the ENCODE FCC project and working group\nMain report of the analyses\nData used and computational environment setup in the anlayses\nMethods and steps of the analyses\nList of figures and tables generated in the anlayses"
  },
  {
    "objectID": "code.html",
    "href": "code.html",
    "title": "List of steps in the analyses",
    "section": "",
    "text": "This part is mainly about\n\nDownloading data to PROJECT/data folder\nPreparing data from PROJECT/data to PROJECT/results folder\nGenerating metadata for down stream analysis\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 03\n\n\nPrepare the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare Lenti-MPRA data 01\n\n\nGet K562 MPRA data files from Nadav lab\n\n\n\n\nPrepare Lenti-MPRA data 02\n\n\nExplore Lenti-MPRA data files\n\n\n\n\nPrepare Lenti-MPRA data 03\n\n\nExport Lenti-MPRA data file from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 01\n\n\nGet K562 STARR-seq data files from Reddy lab\n\n\n\n\nPrepare STARR-seq data 02\n\n\nExplore STARR-seq data files\n\n\n\n\nPrepare STARR-seq data 031\n\n\nPrepare STARR-seq data files from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 032\n\n\nPrepare ATAC-STARR KS274 files from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 04\n\n\nCreate metadata for STARR-seq data files\n\n\n\n\nPrepare Tiling MPRA data 01\n\n\nGet K562 MPRA data files from Tewhey lab\n\n\n\n\nPrepare Tiling MPRA data 02\n\n\nExplore Tiling MPRA data files\n\n\n\n\nPrepare Tiling MPRA data 03\n\n\nExtract fragment counts from Tiling MPRA data\n\n\n\n\nPrepare Tiling MPRA data 04\n\n\nCovert count matrix to bed format\n\n\n\n\nPrepare Tiling MPRA data 05\n\n\nLiftover OL13 fragments from hg19 to hg38\n\n\n\n\nPrepare Tiling MPRA data 06\n\n\nGet the genomic range of fragments designed in TMPRA\n\n\n\n\nPrepare Tiling MPRA data 07\n\n\nCreate metadata for Tiling MPRA data files\n\n\n\n\n\nNo matching items\n\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ENCODE RNA-seq 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE RNA-seq 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE RNA-seq 03\n\n\nExplore and visualize the data\n\n\n\n\n\nNo matching items\n\n\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ASTARR CSAW Peaks 01\n\n\nAcquire data\n\n\n\n\nPrepare ASTARR CSAW Peaks 02\n\n\nPrepare data\n\n\n\n\nPrepare ASTARR CSAW Peaks 03\n\n\nCreate metadata\n\n\n\n\nPrepare ASTARR CSAW Peaks 03\n\n\nExplore the data\n\n\n\n\nPrepare ASTARR Input MACS Peaks 01\n\n\nPrepare K562 accessible regions\n\n\n\n\nPrepare ASTARR Input MACS Peaks 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare ASTARR Input MACS Peaks 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare CRISPRi Growth data 01\n\n\nPrepare data\n\n\n\n\nPrepare CRISPRi Growth data 02\n\n\nGenerate metadata of the peak file\n\n\n\n\nPrepare CRISPRi Growth data 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare CRISPRi HCRFF data 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare CRISPRi HCRFF data 02\n\n\nDownload the data\n\n\n\n\nPrepare CRISPRi HCRFF data 03\n\n\nPrepare the data\n\n\n\n\nPrepare CRISPRi HCRFF data 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare CRISPRi HCRFF data 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 03\n\n\nPrepare the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 06\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare ENCODE Chromatin State 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE Chromatin State 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE Chromatin State 03\n\n\nPrepare region files\n\n\n\n\nPrepare ENCODE Chromatin State 04\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare ENCODE Chromatin State 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare Junke peak call region 01\n\n\nView files\n\n\n\n\nPrepare Junke peak call region 02\n\n\nDecompress files\n\n\n\n\nPrepare Junke peak call region 03\n\n\nPrepare data\n\n\n\n\nPrepare Junke peak call region 05\n\n\nGenerate metadata of the peak file\n\n\n\n\nPrepare Junke peak call region 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare TF Modules 01\n\n\nExport the data\n\n\n\n\nPrepare TF Modules 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare TF Modules 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare TSS annotation 01\n\n\nPrepare K562 TSS annotation\n\n\n\n\nPrepare TSS annotation 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare TSS annotation 03\n\n\nExplore and visualize the data\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "code.html#step-preparing-fcc-data",
    "href": "code.html#step-preparing-fcc-data",
    "title": "List of steps in the analyses",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 03\n\n\nPrepare the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare Lenti-MPRA data 01\n\n\nGet K562 MPRA data files from Nadav lab\n\n\n\n\nPrepare Lenti-MPRA data 02\n\n\nExplore Lenti-MPRA data files\n\n\n\n\nPrepare Lenti-MPRA data 03\n\n\nExport Lenti-MPRA data file from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 01\n\n\nGet K562 STARR-seq data files from Reddy lab\n\n\n\n\nPrepare STARR-seq data 02\n\n\nExplore STARR-seq data files\n\n\n\n\nPrepare STARR-seq data 031\n\n\nPrepare STARR-seq data files from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 032\n\n\nPrepare ATAC-STARR KS274 files from PROJECT/data to PROJECT/results folder\n\n\n\n\nPrepare STARR-seq data 04\n\n\nCreate metadata for STARR-seq data files\n\n\n\n\nPrepare Tiling MPRA data 01\n\n\nGet K562 MPRA data files from Tewhey lab\n\n\n\n\nPrepare Tiling MPRA data 02\n\n\nExplore Tiling MPRA data files\n\n\n\n\nPrepare Tiling MPRA data 03\n\n\nExtract fragment counts from Tiling MPRA data\n\n\n\n\nPrepare Tiling MPRA data 04\n\n\nCovert count matrix to bed format\n\n\n\n\nPrepare Tiling MPRA data 05\n\n\nLiftover OL13 fragments from hg19 to hg38\n\n\n\n\nPrepare Tiling MPRA data 06\n\n\nGet the genomic range of fragments designed in TMPRA\n\n\n\n\nPrepare Tiling MPRA data 07\n\n\nCreate metadata for Tiling MPRA data files\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "code.html#step-preparing-annotations",
    "href": "code.html#step-preparing-annotations",
    "title": "List of steps in the analyses",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ENCODE RNA-seq 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE RNA-seq 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE RNA-seq 03\n\n\nExplore and visualize the data\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "code.html#step-preparing-regions",
    "href": "code.html#step-preparing-regions",
    "title": "List of steps in the analyses",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\nTitle\n\n\nSubtitle\n\n\n\n\n\n\nPrepare ASTARR CSAW Peaks 01\n\n\nAcquire data\n\n\n\n\nPrepare ASTARR CSAW Peaks 02\n\n\nPrepare data\n\n\n\n\nPrepare ASTARR CSAW Peaks 03\n\n\nCreate metadata\n\n\n\n\nPrepare ASTARR CSAW Peaks 03\n\n\nExplore the data\n\n\n\n\nPrepare ASTARR Input MACS Peaks 01\n\n\nPrepare K562 accessible regions\n\n\n\n\nPrepare ASTARR Input MACS Peaks 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare ASTARR Input MACS Peaks 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare CRISPRi Growth data 01\n\n\nPrepare data\n\n\n\n\nPrepare CRISPRi Growth data 02\n\n\nGenerate metadata of the peak file\n\n\n\n\nPrepare CRISPRi Growth data 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare CRISPRi HCRFF data 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare CRISPRi HCRFF data 02\n\n\nDownload the data\n\n\n\n\nPrepare CRISPRi HCRFF data 03\n\n\nPrepare the data\n\n\n\n\nPrepare CRISPRi HCRFF data 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare CRISPRi HCRFF data 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 03\n\n\nPrepare the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 04\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare ENCODE ATAC/DNase Peaks 06\n\n\nGenerate metadata for the peak file\n\n\n\n\nPrepare ENCODE Chromatin State 01\n\n\nGenerate download script to download the data\n\n\n\n\nPrepare ENCODE Chromatin State 02\n\n\nDownload the data\n\n\n\n\nPrepare ENCODE Chromatin State 03\n\n\nPrepare region files\n\n\n\n\nPrepare ENCODE Chromatin State 04\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare ENCODE Chromatin State 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare Junke peak call region 01\n\n\nView files\n\n\n\n\nPrepare Junke peak call region 02\n\n\nDecompress files\n\n\n\n\nPrepare Junke peak call region 03\n\n\nPrepare data\n\n\n\n\nPrepare Junke peak call region 05\n\n\nGenerate metadata of the peak file\n\n\n\n\nPrepare Junke peak call region 05\n\n\nExplore and visualize the data\n\n\n\n\nPrepare TF Modules 01\n\n\nExport the data\n\n\n\n\nPrepare TF Modules 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare TF Modules 03\n\n\nExplore and visualize the data\n\n\n\n\nPrepare TSS annotation 01\n\n\nPrepare K562 TSS annotation\n\n\n\n\nPrepare TSS annotation 02\n\n\nCreate metadata table for downstream analysis\n\n\n\n\nPrepare TSS annotation 03\n\n\nExplore and visualize the data\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "code.html#step-starrmpra-analysis",
    "href": "code.html#step-starrmpra-analysis",
    "title": "List of steps in the analyses",
    "section": "Step: STARR/MPRA Analysis",
    "text": "Step: STARR/MPRA Analysis"
  },
  {
    "objectID": "code.html#step-crispr-analysis",
    "href": "code.html#step-crispr-analysis",
    "title": "List of steps in the analyses",
    "section": "Step: CRISPR Analysis",
    "text": "Step: CRISPR Analysis"
  },
  {
    "objectID": "code.html#step-hi-c-analysis",
    "href": "code.html#step-hi-c-analysis",
    "title": "List of steps in the analyses",
    "section": "Step: Hi-C Analysis",
    "text": "Step: Hi-C Analysis"
  },
  {
    "objectID": "code.html#step-region-coverage",
    "href": "code.html#step-region-coverage",
    "title": "List of steps in the analyses",
    "section": "Step: Region Coverage",
    "text": "Step: Region Coverage"
  },
  {
    "objectID": "code.html#step-region-annotation",
    "href": "code.html#step-region-annotation",
    "title": "List of steps in the analyses",
    "section": "Step: Region Annotation",
    "text": "Step: Region Annotation"
  },
  {
    "objectID": "code.html#step-integrative-analysis",
    "href": "code.html#step-integrative-analysis",
    "title": "List of steps in the analyses",
    "section": "Step: Integrative Analysis",
    "text": "Step: Integrative Analysis\nThis part is mainly about\n\nFCC union peak set of cis-regulatory elements\nEnrichment analysis of chromtain states and TFs\nQuantitative comparison across assays"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the ENCODE FCC project and working group",
    "section": "",
    "text": "The ENCODE consortium has identified millions of elements with regulatory potential throughout the human genome. These technologies have been utilized to evaluate the functionality of these elements by systematically measuring their regulatory effects. Together, tens of billions of DNA fragments were assayed in high-throughput reporter assays and millions of locations were perturbed in CRISPR screens.\nThe compilation and analysis of data and results involve joint effort spanning multiple laboratories and collaboration across various ENCODE working groups. Among them, the ENCODE Functional Characterization Center (FCC) working group has systematically studied the regulatory regions and their effects as identified and quantified by these functional assays. The group developed analysis methods and sequence models to identify similarities and differences among those identified regulatory elements, based on their regulatory activities and sequence features. Furthermore, the group has integrated multiple genomic annotations, ChIP-seq data, and physical interactions from ENCODE, providing a comprehensive characterization of these regulatory regions."
  },
  {
    "objectID": "11_fcc_summary/02_fcc_wstarr.html",
    "href": "11_fcc_summary/02_fcc_wstarr.html",
    "title": "WHG-STARR-seq (WSTARR)",
    "section": "",
    "text": "Library sizes of WSTARR\n\n\nSample\nGroup\nCount\n\n\n\n\nInput.rep1\nInput\n26,908,970\n\n\nInput.rep2\nInput\n99,899,775\n\n\nInput.rep3\nInput\n105,623,984\n\n\nInput.rep4\nInput\n108,635,002\n\n\nOutput.rep1\nOutput\n160,349,140\n\n\nOutput.rep2\nOutput\n157,326,312\n\n\nOutput.rep3\nOutput\n38,522,888",
    "crumbs": [
      "Home",
      "FCC Summary",
      "WHG-STARR-seq (WSTARR)"
    ]
  },
  {
    "objectID": "11_fcc_summary/02_fcc_wstarr.html#whg-starr-seq-wstarr",
    "href": "11_fcc_summary/02_fcc_wstarr.html#whg-starr-seq-wstarr",
    "title": "WHG-STARR-seq (WSTARR)",
    "section": "",
    "text": "Library sizes of WSTARR\n\n\nSample\nGroup\nCount\n\n\n\n\nInput.rep1\nInput\n26,908,970\n\n\nInput.rep2\nInput\n99,899,775\n\n\nInput.rep3\nInput\n105,623,984\n\n\nInput.rep4\nInput\n108,635,002\n\n\nOutput.rep1\nOutput\n160,349,140\n\n\nOutput.rep2\nOutput\n157,326,312\n\n\nOutput.rep3\nOutput\n38,522,888",
    "crumbs": [
      "Home",
      "FCC Summary",
      "WHG-STARR-seq (WSTARR)"
    ]
  },
  {
    "objectID": "02_prepare/data_23_others.html",
    "href": "02_prepare/data_23_others.html",
    "title": "Other Annotations",
    "section": "",
    "text": "RNA-seq of K562\ndetail numbers\n #{Gene | Total } = 59526 \n #{Gene | TPM==0} = 33608 \n #{Gene | TPM &gt;0} = 25918 \n #{Gene | TPM &gt;1} = 13184 \n\n\n\nDefine transcription start sites (TSS) in K562\n\nSelect isoforms with the highest K562 Pol2 signals\n\nFor each gene in NCBI Refgene, the isoform with highest level of pol2 chip seq (ENCFF914WIS.bigWig) at [TSS-500, TSS+500] were selected.\nIf there are genes with multiple lines, it means they had isoforms with the same pol2 signal (they are mostly genes with very low pol2 signals, e,g., TP53TG3B)\nThis was done by Jin-Woo. For more details, see the followin link\n\n\nAfter filtering, the number of TSS = 29,330\n\nFilter based on RNA-seq to get K562 specific TSS\n\nWe can see that this number is still pretty high considering the number of genes expressed in a human cell type. Previous study estimated that the number of genes expressed in most human and most tissues would be around 11-13k genes, or 60-70% of refseq protein-coding genes (Ramsköld et al. 2009).\nTo acquire K562-specific TSS, we further filtered out lowly expressed genes using K562 RNA-seq. Applying the threshold of 1.0 TPM resulted in TSS of almost 12k genes.\nENCODE: ENCSR615EEK\nAssay: RNA-seq (total RNA-seq)\nBiosample: K562\nPlatform: Illumina NovaSeq 6000\n“…… Applying the threshold 0.3 RPKM, the number of genes expressed in most human and mouse tissues varied from 11,000 to 13,000, corresponding to roughly 60–70% of RefSeq protein-coding genes (Table 1).” (Ramsköld et al. 2009)\nFor current state, Alex proposed further selecting the TSS with corresponding gene expressed in K562 before we are able to get the cell specific TSS from the ENCODE RNA group\nENCSR615EEK – ENCODE\nAssay: RNA-seq (total RNA-seq)\nBiosample: K562\nPlatform: Illumina NovaSeq 6000\nOnly genes with TPM larger than the threshold are left.\nNUM_TPM_CUTOFF = 1\ndat = dat %&gt;% dplyr::filter(TPM &gt; NUM_TPM_CUTOFF)\ndetail numbers\n   #{TSS  | NCBI RefSeq + K562 Pol2}           = 29,330\n=&gt; #{TSS  | NCBI RefSeq + K562 Pol2 + RNA-seq} = 11,892\nDownload K562 TSS used in this documentation\n\n\n\nEssential gene\ndemap.v24Q2.AchillesCommonEssentialControls.csv",
    "crumbs": [
      "Home",
      "Prepare",
      "Other Annotations"
    ]
  },
  {
    "objectID": "02_prepare/data_12_encode_annotation.html",
    "href": "02_prepare/data_12_encode_annotation.html",
    "title": "Chromatin States and TF Modules",
    "section": "",
    "text": "There are a few existing ENCODE genome characterization annotation using ENCODE ChIP-seq data. In this study, the annotation we integrates consisted of types of annotation. One type of the annotation mainly focused on histone modifications, while the other used the co-localization information of transcription factors.",
    "crumbs": [
      "Home",
      "Prepare",
      "Chromatin States and TF Modules"
    ]
  },
  {
    "objectID": "02_prepare/data_12_encode_annotation.html#encode-candidate-cis-regulatory-elements-ccres",
    "href": "02_prepare/data_12_encode_annotation.html#encode-candidate-cis-regulatory-elements-ccres",
    "title": "Chromatin States and TF Modules",
    "section": "ENCODE candidate cis-regulatory elements (cCREs)",
    "text": "ENCODE candidate cis-regulatory elements (cCREs)\nAfter intersecting multiple genomic information (histone modifications, CTCF cCREs applied a series of if-else statements to classify regions into different chromatin states.",
    "crumbs": [
      "Home",
      "Prepare",
      "Chromatin States and TF Modules"
    ]
  },
  {
    "objectID": "02_prepare/data_12_encode_annotation.html#encode-chromhmm-chromatin-states",
    "href": "02_prepare/data_12_encode_annotation.html#encode-chromhmm-chromatin-states",
    "title": "Chromatin States and TF Modules",
    "section": "ENCODE ChromHMM chromatin states",
    "text": "ENCODE ChromHMM chromatin states\nChromHMM is a multivariate hidden Markov model trained on histone modifications to identify chromatin states.",
    "crumbs": [
      "Home",
      "Prepare",
      "Chromatin States and TF Modules"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html",
    "href": "02_prepare/data_01_fcc.html",
    "title": "FCC Data",
    "section": "",
    "text": "FCC Metadata (WSTARR)\n\n\n\n\n\n\n\nFile Name\nGroup\nSample\n\n\n\n\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nInput\nInput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nInput\nInput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nInput\nInput.rep3\n\n\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\nInput\nInput.rep4\n\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nOutput\nOutput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nOutput\nOutput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nOutput\nOutput.rep3",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#whg-starr-seq-wstarr",
    "href": "02_prepare/data_01_fcc.html#whg-starr-seq-wstarr",
    "title": "FCC Data",
    "section": "",
    "text": "FCC Metadata (WSTARR)\n\n\n\n\n\n\n\nFile Name\nGroup\nSample\n\n\n\n\nWSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\nInput\nInput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\nInput\nInput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\nInput\nInput.rep3\n\n\nWSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\nInput\nInput.rep4\n\n\nWSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\nOutput\nOutput.rep1\n\n\nWSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\nOutput\nOutput.rep2\n\n\nWSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\nOutput\nOutput.rep3",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#atac-starr-seq-astarr",
    "href": "02_prepare/data_01_fcc.html#atac-starr-seq-astarr",
    "title": "FCC Data",
    "section": "ATAC-STARR-seq (ASTARR)",
    "text": "ATAC-STARR-seq (ASTARR)",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#tiling-mpra-tmpra",
    "href": "02_prepare/data_01_fcc.html#tiling-mpra-tmpra",
    "title": "FCC Data",
    "section": "Tiling MPRA (TMPRA)",
    "text": "Tiling MPRA (TMPRA)\n\n\n\nFCC Region Screened (Tiling-MPRA)\n\n\nChrom\nChromStart\nChromEnd\nRegion\nDataset\n\n\n\n\nchr11\n4505501\n6505900\nHBE1\nOL45\n\n\nchr11\n32869701\n34870100\nLMO2\nOL45\n\n\nchr11\n61787329\n61898348\nFADS\nOL13\n\n\nchr16\n10001\n1173100\nHBA2\nOL45\n\n\nchr2\n59553301\n61553700\nBCL11A\nOL45\n\n\nchr20\n56391301\n58391700\nRBM38\nOL45\n\n\nchr8\n126735901\n128736550\nMYC\nOL43\n\n\nchrX\n47785501\n49880650\nGATA1\nOL43",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#lenti-mpra-lmpra",
    "href": "02_prepare/data_01_fcc.html#lenti-mpra-lmpra",
    "title": "FCC Data",
    "section": "Lenti-MPRA (LMPRA)",
    "text": "Lenti-MPRA (LMPRA)\n\n\n\nLMPRA Log2FC (Features)\n\n\n\n\n\n\n\n\n\n\nLMPRA Log2FC (Total)\n\n\n\n\n\n\n\nLMPRA Log2FC (Neg. Ctrl)\n\n\n\n\n\n\n\nLMPRA Log2FC and z score\n\n\n\n\n\n\nFigure 1: Distribution of LMPRA Log2 fold change",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#crispri-hcr-flowfish-crispri-hcrff",
    "href": "02_prepare/data_01_fcc.html#crispri-hcr-flowfish-crispri-hcrff",
    "title": "FCC Data",
    "section": "CRISPRi-HCR FlowFISH (CRISPRi-HCRFF)",
    "text": "CRISPRi-HCR FlowFISH (CRISPRi-HCRFF)",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#crispri-growth-screen-crispri-growth",
    "href": "02_prepare/data_01_fcc.html#crispri-growth-screen-crispri-growth",
    "title": "FCC Data",
    "section": "CRISPRi Growth screen (CRISPRi-Growth)",
    "text": "CRISPRi Growth screen (CRISPRi-Growth)",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "02_prepare/data_01_fcc.html#crispr-e2g-benchmark-data-crispr-e2g",
    "href": "02_prepare/data_01_fcc.html#crispr-e2g-benchmark-data-crispr-e2g",
    "title": "FCC Data",
    "section": "CRISPR E2G benchmark data (CRISPR-E2G)",
    "text": "CRISPR E2G benchmark data (CRISPR-E2G)\nEPCrisprBenchmark_ensemble_data_GRCh38.tsv\nBiosample: K562\nReference\nUlirsch2016\nGasperini et al., 2019\nWakabayashi2016\nSchraivogel et al., 2020\nKlann2017\nThakore2015\nXie2017\nFulco2019\nQi2018\nHuang2018\nXu2015\nFulco2016\n\n#EP links = 10,412\n#Regulated     =   487 (~4.7% of total)\n#Not Regulated = 9,924",
    "crumbs": [
      "Home",
      "Prepare",
      "FCC Data"
    ]
  },
  {
    "objectID": "01_setup/work_21_results_fcc.html",
    "href": "01_setup/work_21_results_fcc.html",
    "title": "12 Results (FCC)",
    "section": "",
    "text": "Results: FCC Assays — Fragment Properties\nPROJECT/results/assay_fcc\n└── &lt;STARR&gt;\n    └── fragment_nuc\n\n\nResults: FCC Assays — Fragment Coverage and library size\nPROJECT/results/assay_fcc/&lt;STARR/MPRA&gt;\n└── fragment_counts\n    └── summary\n        ├── metadata.tsv\n        ├── metadata.size.tsv\n        ├── result.size.{0..N}.csv\n        ├── result.size.concat.csv\n        └── \n\n\nResults: FCC Assays — Fragment Coverage and bigwig tracks\n\n\nResults: FCC Assays — Region Coverage and STARR-seq library complexity\n\noverlap_fragment\n\nintersection between region and fragment\n\noverlap_fragment_unique\n\nunique fragments from the region-fragment intersection\n\noverlap_fragment_one2one\n\nfor all regions intersected with each fragment, pick the region-fragment pair with the longest overlap\n\noverlap_count_one2one\n\ncount total fragments for each region\n\noverlap_count_one2one_unique\n\ncount unique fragments for each region\n\noverlap_count\n\ncount total fragments for each region\n\n\nPROJECT/results/assay_fcc/&lt;STARR&gt;/coverage/&lt;Region Folder&gt;/&lt;Region Label&gt;\n├── overlap_fragment\n|   └── summary\n├── overlap_fragment_unique\n|   └── summary\n|       ├── result.size.{1..N}.csv\n|       ├── result.size.concat.csv\n|       └── result.size.summary.tsv\n├── overlap_fragment_one2one\n|   └── summary\n|       ├── result.size.{1..N}.csv\n|       ├── result.size.csv\n|\n├── overlap_count\n|   └── summary\n└── overlap_count_unique\n    └── summary\nPROJECT/results/assay_fcc/&lt;STARR/TMPRA&gt;\n└── coverage\n    └── &lt;Region Folder&gt;\n        └── &lt;Region Label&gt;\n            ├── overlap_fragment\n            |   └── summary\n            |\n            ├── overlap_fragment_unique //\n            |   └── summary\n            |       ├── result.size.{0..N}.tsv\n            |       ├── result.size.concat.tsv\n            |       └── \n            |\n            ├── overlap_fragment_one2one //\n            |   └── summary\n            |       ├── result.size.{0..N}.tsv\n            |       ├── result.size.concat.tsv\n            |       └── \n            |\n            ├── overlap_count/score\n            |   └── summary\n            |       ├── data_list_count_column.rds\n            |       ├── data_list_score.rds         // matrices: raw, cpm, rpkm, tpm, deseq, edger (TMM)\n            |       ├── data_edger.rds\n            |       ├── data_deseq.rds\n            |       ├── result.Log2FC.deseq.tsv\n            |       ├── result.Log2FC.edger.tsv\n            |       ├── result.score.mean.tsv       // mean of rpkm, tpm\n            |       └── \n            |\n            ├── overlap_count_unique\n            \n            \n\n\nResults: FCC Assays — Region Coverage and DESeq2/EdgeR\noverlap_count\n└── summary\n    ├── data_list_count_column.rds\n    ├── data_list_score.rds         // matrices: raw, cpm, rpkm, tpm, deseq, edger (TMM)\n    ├── data_edger.rds\n    ├── data_deseq.rds\n    ├── result.Log2FC.deseq.tsv\n    ├── result.Log2FC.edger.tsv\n    ├── result.score.mean.tsv       // mean of rpkm, tpm\n    └── \n\n\nResults: FCC Assays (Detailed)\nFolder\nPROJECT/results/assay_fcc\n├── &lt;STARR&gt;\n|   ├── fragment\n|   ├── fragment_nuc\n|   ├── fragment_counts\n|   |   └── summary\n|   └── coverage\n|       ├── track\n|       └── &lt;Region Folder&gt;\n|           └── &lt;Region Label&gt;\n|               ├── overlap_fragment\n|               ├── overlap_fragment_unique\n|               ├── overlap_fragment_one2one\n|               ├── overlap_count\n|               └── overlap_count_unique\n|\n├── &lt;TMPRA&gt;\n|   ├── fragment\n|   ├── fragment_nuc\n|   ├── fragment_counts\n|   └── coverage\n|       ├── track\n|       └── &lt;Region Folder&gt;\n|           └── &lt;Region Label&gt;\n|               ├── overlap_fragment\n|               └── overlap_count\n|\n├── &lt;LMPRA&gt;\n|   ├── fragment\n|   ├── fragment_nuc\n|   ├── fragment_counts\n|   └── coverage\n|       ├── track\n|       └── &lt;Region Folder&gt;\n|           └── &lt;Region Label&gt;\n|               ├── overlap_fragment\n|               └── overlap_score\n|\n└── &lt;CRISPRi&gt;\n    ├── guide_scores\n    CRISPRi_HCRFF_K562.hg38.ZScore.unstranded.bed.gz\n    CRISPRi_HCRFF_K562.hg38.ZScore.filtered.unstranded.bed.gz\n    |   └── summary\n    |       ├── track_info.tsv\n    |       └── metadata.tsv\n    ├── guide_scores_filter\n    |   └── summary\n    |       └── metadata.tsv\n    └── coverage\n        └── &lt;Region Folder&gt;\n            └── &lt;Region Label&gt;\n                ├── overlap_guide\n                └── overlap_score\nFiles\nPROJECT/results/assay_fcc\n├── CRISPRi_FlowFISH_K562_Riley_JinWoo\n│   └── guide_scores\n│       ├── CRISPRi_HCRFF_K562.hg38.ZScore.unstranded.bed.gz\n│       ├── CRISPRi_HCRFF_K562.hg38.ZScore.filtered.unstranded.bed.gz\nPROJECT/results/region_annotation",
    "crumbs": [
      "Home",
      "Setup",
      "12 Results (FCC)"
    ]
  },
  {
    "objectID": "01_setup/work_14_prep_region.html",
    "href": "01_setup/work_14_prep_region.html",
    "title": "14 Prepare: Region",
    "section": "",
    "text": "Description\nSummary\nencode_chipseq_flagship\nencode_chipseq_histone\nencode_chipseq_subset\nencode_chromatin_states\nencode_open_chromatin\nencode_e2g_benchmark\nencode_e2g_prediction\nfcc_enhancer_junke_zscore\nfcc_astarr_csaw\nfcc_astarr_macs\nfcc_wstarr_cradle\nfcc_crispri_growth\nfcc_crispri_hcrff\nfcc_screened\nhic_insitu_K562_ENCSR545YBD\nhic_intact_K562_ENCSR479XDG\nhic_intact_K562_deep\n\ngenome_tss\ngenome_cres\ngenome_...\nref_tss (what if it is from RAMPAGE?)\n\n(TF_modules)\nPROJECT/results/region\n├── encode_open_chromatin\n│   ├── K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n│   ├── K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       ├── metadata.label.tsv\n│\n├── encode_chromatin_states\n│   ├── K562.hg38.cCREs.silencer_rest.bed.gz\n│   ├── K562.hg38.cCREs.silencer_starr.bed.gz\n│   ├── K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz\n│   ├── K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       ├── K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.bed.gz\n│       ├── K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.label2name.PLS_ELS.bed.gz\n│       └── metadata.label.tsv\n│\n├── encode_chipseq_flagship\n│   └── summary\n│\n├── encode_chipseq_histone\n│   └── summary\n│\n├── encode_chipseq_subset\n│   └── summary\n│\n├── encode_e2g_benchmark\n│   ├── K562.hg38.EPCrisprBenchmark.active.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.active.merge.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.total.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.total.merge.gz\n│   └── summary\n│\n├── encode_e2g_prediction_ENCSR328LMT\n│   ├── K562.hg38.ENCSR328LMT.ENCFF202FID.element_gene_links.active.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF202FID.element_gene_links.active.merge.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF122UMY.element_gene_links.total.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF122UMY.element_gene_links.total.merge.bed.gz\n│   └── summary\n│\n├── fcc_astarr_csaw\n│   ├── K562.hg38.ASTARR.csaw.KS91.bed.gz\n│   ├── K562.hg38.ASTARR.csaw.KSMerge.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── fcc_astarr_macs\n│   ├── ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed.gz\n│   ├── ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed.gz\n│   ├── K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\n│   ├── K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── fcc_crispri_hcrff\n│   ├── K562.hg38.CRISPRi_HCRFF.CASA.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── fcc_crispri_growth\n│   ├── K562.hg38.CRISPRi_Growth.DHS.active.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.active.merge.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.total.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.total.merge.bed.gz\n│   └── summary\n│\n├── fcc_mpra_agarwal2023\n│   ├── K562.hg38.LMPRA.lib_design.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── fcc_screened\n│   ├── region_screened.crispri_hcrff.bed.gz\n│   ├── region_screened.crispri_hcrff.tsv\n│   ├── region_screened.tmpra.bed.gz\n│   ├── region_screened.tmpra.tsv\n│   └── summary\n│\n├── genome_tss\n│   ├── K562.hg38.TSS.selected_by_highest_Pol2_signal.bed.gz\n│   ├── K562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── module_tf_shannon\n│   ├── K562.hg38.TF_Module.bed.gz\n│   └── summary\n│       ├── matrix.Module.tsv\n│       ├── matrix.TF.tsv\n│       ├── data.TF_Module.tsv\n│       ├── description.tsv\n│       └── metadata.label.tsv\n│\n├── hic_insitu_K562_ENCSR545YBD\n│   ├── K562.hg38.hic_insitu.Loop_A.bed.gz\n│   ├── K562.hg38.hic_insitu.Loop_B.bed.gz\n│   ├── K562.hg38.hic_insitu.TAD.bedpe.gz\n│   └── summary\n│       ├── description.tsv\n│       ├── K562.hg38.hic_insitu.Loop.tsv\n│       ├── K562.hg38.hic_insitu.TAD.tsv\n│       └── metadata.label.tsv\n│\n├── hic_intact_K562_ENCSR479XDG\n│   ├── K562.hg38.hic_intact.Loop_A.bed.gz\n│   ├── K562.hg38.hic_intact.Loop_B.bed.gz\n│   ├── K562.hg38.hic_intact.TAD.bedpe.gz\n│   └── summary\n│       ├── description.tsv\n│       ├── K562.hg38.hic_intact.Loop.tsv\n│       ├── K562.hg38.hic_intact.TAD.tsv\n│       └── metadata.label.tsv\n│\n├── hic_intact_K562_deep\n│   ├── K562.hg38.hic_intact.Loop_A.bed.gz\n│   ├── K562.hg38.hic_intact.Loop_B.bed.gz\n│   └── summary\n│       ├── description.tsv\n│       ├── K562.hg38.hic_intact.Loop.tsv\n│       └── metadata.label.tsv\n│\n└── summary\n    ├── annotation.macs.label.region_A.tsv\n    ├── annotation.macs.label.region_B.chipseq_full.tsv\n    ├── annotation.macs.label.region_B.chipseq_subset.tsv\n    ├── annotation.macs.label.region_B.main.tsv\n    ├── metadata.label.astarr_macs.tsv\n    ├── metadata.label.chipseq_full.tsv\n    ├── metadata.label.main.tsv\n    ├── metadata.label.ocr.tsv\nPROJECT/results/region\n├── encode_open_chromatin\n│   ├── K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n│   ├── K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n│   └── summary\n|       ├── metadata.label.tsv\n|       ├── metadata.size.tsv\n|       ├── result.size.concat.csv\n|       ├── result.size.&lt;...&gt;.csv\n│       └── description.tsv\n│\n├── encode_chipseq_flagship\n│   └── summary\n│\n├── encode_chipseq_histone\n│   └── summary\n│\n├── encode_chipseq_subset\n│   └── summary\n│\n├── encode_chromatin_states\n│   └── summary\n│\n├── encode_e2g_benchmark\n│   ├── K562.hg38.EPCrisprBenchmark.active.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.active.merge.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.total.bed.gz\n│   ├── K562.hg38.EPCrisprBenchmark.total.merge.gz\n│   └── summary\n│\n├── encode_e2g_prediction_ENCSR328LMT\n│   ├── K562.hg38.ENCSR328LMT.ENCFF202FID.element_gene_links.active.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF202FID.element_gene_links.active.merge.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF122UMY.element_gene_links.total.bed.gz\n│   ├── K562.hg38.ENCSR328LMT.ENCFF122UMY.element_gene_links.total.merge.bed.gz\n│   └── summary\n│\n├── fcc_astarr_csaw\n│   ├── ASTARRseq_K562_KSMerge.hg38.bed.gz\n\n│   ├── K562.hg38.ASTARR.KSMerge.csaw.bed.gz\n│   ├── K562.hg38.ASTARR.KS91.csaw.bed.gz\n\n│   ├── K562.hg38.ASTARR.csaw.KSMerge.bed.gz\n│   ├── K562.hg38.ASTARR.csaw.KS91.bed.gz\n\n│   └── summary\n|\n├── fcc_astarr_macs\n│   ├── ASTARRseq_K562_KS91.hg38.Input.rep_all.union.q5.bed.gz\n│   ├── ASTARRseq_K562_KS91.hg38.Input.rep_all.max_overlaps.q5.bed.gz\n\n│   ├── K562.hg38.ASTARR.KS91.macs.input.rep_all.union.q5.bed.gz\n│   ├── K562.hg38.ASTARR.KS91.macs.input.rep_all.max_overlaps.q5.bed.gz\n\n│   ├── K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\n│   ├── K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\n\n│   └── summary\n│\n├── fcc_crispri_hcrff\n│   ├── K562.hg38.CRISPRi_HCRFF.CASA.bed.gz\n│   ├── K562.hg38.CRISPRi_HCRFF.CASA.merge.bed.gz\n│   └── summary\n│\n├── fcc_crispri_growth\n│   ├── K562.hg38.CRISPRi_Growth.DHS.active.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.active.merge.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.total.bed.gz\n│   ├── K562.hg38.CRISPRi_Growth.DHS.total.merge.bed.gz\n│   └── summary\n│\n├── fcc_screened\n│   ├── region_screened.crispri_hcrff.bed.gz\n│   ├── region_screened.crispri_hcrff.tsv\n│   ├── region_screened.tmpra.bed.gz\n│   ├── region_screened.tmpra.tsv\n│   └── summary\n│\n├── hic_insitu_K562_ENCSR545YBD\n│   ├── K562.hg38.ENCSR545YBD.ENCFF271SAF.hic_insitu.contact_domain.bed.gz\n│   ├── K562.hg38.ENCSR545YBD.ENCFF693XIL.hic_insitu.loop.A.bed.gz\n│   ├── K562.hg38.ENCSR545YBD.ENCFF693XIL.hic_insitu.loop.B.bed.gz\n\n│   ├── K562.hg38.hic_insitu.contact_domain.bed.gz\n│   ├── K562.hg38.hic_insitu.loop.A.bed.gz\n│   ├── K562.hg38.hic_insitu.loop.B.bed.gz\n\n│   └── summary\n│\n├── hic_intact_K562_ENCSR479XDG\n│   ├── K562.hg38.ENCSR479XDG.ENCFF126GED.hic_intact.contact_domain.bed.gz\n│   ├── K562.hg38.ENCSR479XDG.ENCFF256ZMD.hic_intact.loop.A.bed.gz\n│   ├── K562.hg38.ENCSR479XDG.ENCFF256ZMD.hic_intact.loop.B.bed.gz\n\n│   ├── K562.hg38.hic_intact.contact_domain.bed.gz\n│   ├── K562.hg38.hic_intact.loop.A.bed.gz\n│   ├── K562.hg38.hic_intact.loop.B.bed.gz\n\n│   └── summary\n│\n├── hic_intact_K562_deep\n│   ├── K562.hg38.deep.hic_intact.loop.A.bed.gz\n│   ├── K562.hg38.deep.hic_intact.loop.B.bed.gz\n│   └── summary\n│\n└── summary\n    ├── metadata.size.tsv\n    ├── metadata.label.tsv\n    ├── metadata.label.ocr.total.tsv\n    ├── metadata.label.ocr.astarr_macs.tsv\n    ├── metadata.label.cres.tsv\n    ├── metadata.label.chromstates.tsv\n    ├── metadata.label.chipseq_subset.tsv\n    ├── metadata.label.chipseq.tsv\n\n\n&lt;Assay&gt;_&lt;File Index&gt;/&lt;Label&gt;\nencode_open_chromatin\n├── atac_&lt;File Index&gt;\n└── dnase_&lt;File Index&gt;\n\nencode_chipseq_subset/histone/flagship\n└── chipseq_&lt;File Index&gt;\n\nencode_chromatin_states\n├── ccres_&lt;File Index&gt;\n└── chromhmm_&lt;File Index&gt;\n\nencode_e2g_benchmark\n├── encode_e2g_benchmark_active_merge\n└── encode_e2g_benchmark_total_merge\n\nencode_e2g_prediction\n├── encode_e2g_prediction_active_merge\n└── encode_e2g_prediction_total_merge\n\nfcc_crispri_hcrff\n├── crispri_hcrff_active_merge\n└── crispri_hcrff_total_merge\n\nfcc_crispri_growth\n├── crispri_growth_active_merge\n└── crispri_growth_total_merge\n\nfcc_screened\n├── ...",
    "crumbs": [
      "Home",
      "Setup",
      "14 Prepare: Region"
    ]
  },
  {
    "objectID": "01_setup/work_14_prep_region.html#region-labeling",
    "href": "01_setup/work_14_prep_region.html#region-labeling",
    "title": "14 Prepare: Region",
    "section": "",
    "text": "&lt;Assay&gt;_&lt;File Index&gt;/&lt;Label&gt;\nencode_open_chromatin\n├── atac_&lt;File Index&gt;\n└── dnase_&lt;File Index&gt;\n\nencode_chipseq_subset/histone/flagship\n└── chipseq_&lt;File Index&gt;\n\nencode_chromatin_states\n├── ccres_&lt;File Index&gt;\n└── chromhmm_&lt;File Index&gt;\n\nencode_e2g_benchmark\n├── encode_e2g_benchmark_active_merge\n└── encode_e2g_benchmark_total_merge\n\nencode_e2g_prediction\n├── encode_e2g_prediction_active_merge\n└── encode_e2g_prediction_total_merge\n\nfcc_crispri_hcrff\n├── crispri_hcrff_active_merge\n└── crispri_hcrff_total_merge\n\nfcc_crispri_growth\n├── crispri_growth_active_merge\n└── crispri_growth_total_merge\n\nfcc_screened\n├── ...",
    "crumbs": [
      "Home",
      "Setup",
      "14 Prepare: Region"
    ]
  },
  {
    "objectID": "01_setup/work_04_data.html",
    "href": "01_setup/work_04_data.html",
    "title": "04 Data Files",
    "section": "",
    "text": "Scatches\nthinking: why external and processed? original thought external is the folder for downloading data from ENCODE portal processed is the data I got from others\n\n\nDownload external data\nSummary\nPROJECT/data/external\n├── (encode_astarr_csaw)\n├── encode_chipseq_flagship\n├── encode_chipseq_histone\n├── encode_chipseq_subset\n├── encode_chromatin_states\n├── encode_crispri_hcrff\n├── encode_open_chromatin\n├── encode_e2g_benchmark\n├── encode_e2g_prediction\n├── encode_rnaseq\n├── (genome_gencode)\n├── (genome_ncbi_refseq)\n├── genome_gene\n├── genome_cres\n├── genome_tss\n├── hic_insitu_K562_ENCSR545YBD\n├── hic_intact_K562_ENCSR479XDG\n├── hic_intact_K562_deep\n├── chrom.sizes.hg19\n├── chrom.sizes.hg38\n├── chrom.list.main\n├── chrom.list.auto\n└── chrom.list.sex\nDetailed\nPROJECT/data/external\n├── encode_open_chromatin\n│   ├── K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n│   ├── K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n│   ├── K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n│   └── K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n│   \n├── encode_chromatin_states\n│\n├── encode_chipseq_flagship\n├── encode_chipseq_subset\n├── encode_crispri_hcrff\n│   ├── K562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz\n│   ├── K562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz\n│   ├── K562.hg38.ENCSR157WAN.ENCFF270LYK.CRISPRi_HCRFF.CASA.CD164.bed.gz\n│   ├── K562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz\n│   ├── K562.hg38.ENCSR382ZJS.ENCFF786ZPA.CRISPRi_HCRFF.CASA.FADS1.bed.gz\n│   ├── K562.hg38.ENCSR968CIN.ENCFF149IDL.CRISPRi_HCRFF.CASA.FADS2.bed.gz\n│   ├── K562.hg38.ENCSR630WLB.ENCFF227DUX.CRISPRi_HCRFF.CASA.FADS3.bed.gz\n│   ├── K562.hg38.ENCSR278YTB.ENCFF151MNC.CRISPRi_HCRFF.CASA.FEN1.bed.gz\n│   ├── K562.hg38.ENCSR917XEU.ENCFF413WYU.CRISPRi_HCRFF.CASA.GATA1.bed.gz\n│   ├── K562.hg38.ENCSR564EPW.ENCFF845YHV.CRISPRi_HCRFF.CASA.HBE1.bed.gz\n│   ├── K562.hg38.ENCSR449NJV.ENCFF811PPJ.CRISPRi_HCRFF.CASA.HBG1.bed.gz\n│   ├── K562.hg38.ENCSR459QNY.ENCFF910PDZ.CRISPRi_HCRFF.CASA.HBG2.bed.gz\n│   ├── K562.hg38.ENCSR759RSA.ENCFF337VVS.CRISPRi_HCRFF.CASA.HBS1L.bed.gz\n│   ├── K562.hg38.ENCSR009KPS.ENCFF632PQY.CRISPRi_HCRFF.CASA.HDAC6.bed.gz\n│   ├── K562.hg38.ENCSR321CEH.ENCFF469FXP.CRISPRi_HCRFF.CASA.LMO2.bed.gz\n│   ├── K562.hg38.ENCSR940PYU.ENCFF894DJT.CRISPRi_HCRFF.CASA.MEF2C.bed.gz\n│   ├── K562.hg38.ENCSR408VHJ.ENCFF091IOP.CRISPRi_HCRFF.CASA.MYB.bed.gz\n│   ├── K562.hg38.ENCSR825SFH.ENCFF240IPT.CRISPRi_HCRFF.CASA.MYC.bed.gz\n│   ├── K562.hg38.ENCSR393VDD.ENCFF270ZLE.CRISPRi_HCRFF.CASA.NMU.bed.gz\n│   └── K562.hg38.ENCSR496MZF.ENCFF005DTR.CRISPRi_HCRFF.CASA.PVT1.bed.gz\n│\n├── encode_e2g\n├── encode_rnaseq\n├── (genome_tss)\n├── \n├── hic_insitu_K562_ENCSR545YBD\n│   ├── ENCFF621AIY.hic\n│   ├── K562.ENCSR479XDG.ENCFF126GED.contact_domains.bedpe.gz\n│   └──K562.ENCSR479XDG.ENCFF256ZMD.loops.bedpe.gz\n│\n├── hic_intact_K562_ENCSR479XDG\n├── hic_intact_K562_deep\n├── chrom.sizes.hg19\n├── chrom.sizes.hg38\n├── chrom.list.main\n├── chrom.list.auto\n└── chrom.list.sex\n\n\nAcquire processed data\nSummary\nPROJECT/data/processed\n├── STARR_ATAC_K562_Reddy_KS91_210401\n├── STARR_ATAC_K562_Reddy_KS274_240311\n├── STARR_WHG_K562_Reddy_A001_Alex\n├── STARR_WHG_K562_Reddy_A001_Kari\n├── MPRA_Tiling_K562_Tewhey_Hannah\n├── MPRA_Lenti_K562_Nadav_Vikram_230621\n├── CRISPRi_FlowFISH_K562_Riley_JinWoo\n├── CRISPRi_Growth_K562_Gersbach_Alex\n├── fcc_trackhub_JinWoo\n├── fcc_enhancer_Junke_zscore\n├── TF_modules_Shannon\n└── \nDetailed (Folder)\nPROJECT/data/processed\n├── STARR_ATAC_K562_Reddy_KS91_210401\n│   ├── fragments\n│   └── peaks\n├── STARR_ATAC_K562_Reddy_KS274_240311\n│   └── fragments\n├── STARR_WHG_K562_Reddy_A001_Alex\n│   └── fragments\n├── STARR_WHG_K562_Reddy_A001_Kari\n│   └── superstarr\n│       ├── input_libs\n│       └── output_libs\n├── CRISPRi_Growth_K562_Gersbach_Alex\n│   ├── guides\n│   └── region\n├── CRISPRi_Growth_K562_Gersbach_JinWoo\n│\n├── CRISPRi_FlowFISH_K562_Riley_JinWoo\n│\n├── fcc_trackhub_JinWoo\n│\n├── fcc_enhancer_Junke_zscore\n│\n├── TF_modules_Shannon\n└── \nDetailed (Files)\nPROJECT/data/processed\n├── STARR_ATAC_K562_Reddy_KS91_210401\n│   ├── fragments\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep1.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep2.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep3.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep4.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep5.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Input_rep6.masked.exclude_dups.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.sorted.with_umis.dedup.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.sorted.with_umis.dedup.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.sorted.with_umis.dedup.cpm.bw\n│   │   ├── KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n│   │   └── KS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.sorted.with_umis.dedup.cpm.bw\n│   └── peaks\n│       ├── KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\n│       └── KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n│\n├── STARR_ATAC_K562_Reddy_KS274_240311\n│   └── fragments\n│       ├── \n│\n├── STARR_WHG_K562_Reddy_A001_Alex\n│   ├── fragments\n│   │   ├── A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\n│   │   ├── A001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\n│   │   ├── A001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\n│   │   ├── A001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\n│   │   ├── A001-K562-rep1.masked.dedup.fragments.counts.txt.gz\n│   │   ├── A001-K562-rep2.masked.dedup.fragments.counts.txt.gz\n│   │   └── A001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n│   └── peaks\n│   \n├── STARR_WHG_K562_Reddy_A001_Kari\n│\n├── MPRA_Tiling_K562_Tewhey_Hannah\n│   └── tiling_counts\n│       ├── OL13_20220512_counts.out\n│       ├── OL13_20220512_normalized_counts.out\n│       ├── OL43_20211228_counts.out      \n│       ├── OL43_20211228_normalized_counts.out\n│       ├── OL43_20221003_counts.out \n│       ├── OL43_20221003_K562_normalized_counts.out\n│       ├── OL45_20220927_counts.out \n│       └── OL45_20220927_K562_normalized_counts.out\n│\n├── MPRA_Lenti_K562_Nadav_vikram\n│\n├── CRISPRi_FlowFISH_K562_Riley_JinWoo\n│   └── track_bedgraph\n│       ├── \n│       └── \n│\n├── CRISPRi_Growth_K562_Gersbach_Alex\n│   ├── k562-gw-v3-all.sorted.counts.results.hg38.txt.gz\n│   └── k562-gw-v3-all.sorted.counts.results.top_guide_fdr_0_05.hg38.bed.gz\nReadmd.md\n│\n├── fcc_trackhub_jinwoo\n│   ├── track_bigwig\n│   └── region\n│       ├── tss_pol2\n│       └── tss_tse_crispri_hcrff\n│\n├── fcc_enhancer_junke_zscore\n│\n├── TF_modules_K562_shannon\n│\n└──",
    "crumbs": [
      "Home",
      "Setup",
      "04 Data Files"
    ]
  },
  {
    "objectID": "01_setup/work_02_dir.html",
    "href": "01_setup/work_02_dir.html",
    "title": "02 Working Directory",
    "section": "",
    "text": "Working Directory\nSummary\nPROJECT\n├── data\n├── results\n├── scripts\n├── references\n├── notebooks\n├── docs\n├── site\n├── log\n├── README.md\n└── .gitignore\nFolders\nPROJECT\n├── data\n│   ├── external\n│   └── processed\n├── results\n│   ├── assay_fcc\n│   ├── assay_hic\n│   └── region\n├── scripts\n├── references\n├── notebooks\n├── docs\n├── site\n├── log\n├── README.md\n└── .gitignore\n\n\nNaming Convention of folders and files\nBelow are some naming convention in this documentation.\n\nAssay folder name\n\n&lt;Assay Type&gt;_&lt;Cell Type&gt;_&lt;Lab&gt;_&lt;Label&gt;\nLabel\n\nbatch, source, people, id numbers\n\n\n\nSTARR_ATAC_K562_Reddy_KS91\nSTARR_ATAC_K562_Reddy_KS274\nSTARR_ATAC_K562_Reddy_KSMerge\nSTARR_WHG_K562_Reddy_A001\nMPRA_Tiling_K562_Tewhey_Hannah\nMPRA_Lenti_K562_Nadav_Vikram\nCRISPRi_FlowFISH_K562_Riley_JinWoo\nCRISPRi_Growth_K562_Gersbach_JinWoo\nCRISPRi_Growth_K562_Gersbach_Alex\n\nAssay file name\n\n&lt;Prefix&gt;.&lt;Genome&gt;.&lt;Input/Output/Log2FC/ZScore&gt;.&lt;Replicate&gt;.&lt;Region&gt;.&lt;Unstranded/Stranded&gt;.&lt;File Extension&gt;\nPrefix\n\nASTARRseq_K562_KS91\nWSTARRseq_K562_A001\nTMPRA_K562_OL13\nTMPRA_K562_OL43\nTMPRA_K562_OL45\nTMPRA_K562_Merge\nLMPRA_K562\nCRISPRi_HCRFF_K562\nCRISPRi_Growth_K562\n\nReplicate\n\nrep1/2/3/4\nrep1_vs_rep2\nrep_all\n\nRegion\n\nWHG = whole genome\nMYC = MYC region\nGATA1 = GATA1 region\nChrom_Main = chr1-22,X,Y\nChrom_Auto = chr1-22 (Autosome)\nChrom_Sex = chrX,Y (Sex chromsome)\n\n\nENCODE region file name\n\n&lt;Prefix&gt;.&lt;Genome&gt;.&lt;Experiment ID&gt;.&lt;File ID&gt;.&lt;Assay&gt;.&lt;Description&gt;.&lt;File Extension&gt;\nPrefix: biosample\n\nK562: a human erythroleukemic cell line\nA549: a human lung epithelial Cell line\nHsa: Human\n\nGenome: reference for alignment\n\nhg38: GRCh38\nhg19: GRCh37\n\nAssay and Description\n\nATAC/DNase\nChIPseq.H3K27ac\ncCREs/ChromHMM\n\n\nEnhancer calls",
    "crumbs": [
      "Home",
      "Setup",
      "02 Working Directory"
    ]
  },
  {
    "objectID": "01_setup/work_01_env.html",
    "href": "01_setup/work_01_env.html",
    "title": "01 Working Environment",
    "section": "",
    "text": "BootStrap: docker\nFrom: jupyter/scipy-notebook:ubuntu-22.04\n\n%environment\n    PATH=\"$PATH:/usr/games\"\n    export PATH\n\n%post    \n    ### ===========================================\n    ### install Linux packages\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    ### Package for checking containers environment\n    apt-get update && apt-get install -yq fortune cowsay lolcat\n\n    ### Common tools\n    apt-get install -yq --no-install-recommends apt-utils\n    apt-get install -yq --no-install-recommends libcurl4-openssl-dev libxml2-dev libssl-dev\n\n    ### ===========================================\n    ### install python packages\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    \n    ### Base packages version\n    ###   Numpy:      1.24.4\n    ###   Scipy:      1.11.3\n    ###   Pandas:     2.1.1\n    ###   Sklearn:    1.3.1\n    ###   Numba:      0.57.1\n    ###   Matplotlib: 3.8.0\n    ###   Seaborn:    0.12.2\n    ### Note: \n    ###   I did not update base packages since the dependencies is already fixed in the container\n    ###   When trying to update, I got the following error:\n    ###     ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. \n    ###     This behaviour is the source of the following dependency conflicts.\n    ###     numba 0.57.1 requires numpy&lt;1.25,&gt;=1.21, but you have numpy 1.26.0 which is incompatible.\n    \n    ### ML tools\n    pip install --no-cache-dir umap-learn\n\n    ### Bio\n    pip install --no-cache-dir biopython\n    pip install --no-cache-dir pyBigWig\n    pip install --no-cache-dir hic-straw\n    pip install --no-cache-dir juicebox-notebook\n    pip install --no-cache-dir igv-notebook\n\n    ### Others\n    pip install --no-cache-dir plotly\n    pip install --no-cache-dir daft\n    pip install --no-cache-dir distogram\n    \n    ### ===========================================\n    ### install R 4.x\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    ### install two helper packages we need\n    apt-get update && apt-get install -yq --no-install-recommends software-properties-common dirmngr\n\n    ### add the signing key (by Michael Rutter) for these repos\n    ### To verify key, run gpg --show-keys /etc/apt/trusted.gpg.d/cran_ubuntu_key.asc \n    ### Fingerprint: E298A3A825C0D65DFD57CBB651716619E084DAB9\n    wget -qO- https://cloud.r-project.org/bin/linux/ubuntu/marutter_pubkey.asc | sudo tee -a /etc/apt/trusted.gpg.d/cran_ubuntu_key.asc\n    \n    ### add the R 4.0 repo from CRAN -- adjust 'focal' to 'groovy' or 'bionic' as needed\n    add-apt-repository \"deb https://cloud.r-project.org/bin/linux/ubuntu $(lsb_release -cs)-cran40/\"\n    \n    ### install R and its dependencies.\n    apt-get install -yq --no-install-recommends r-base r-base-dev\n\n    ### ===========================================\n    ### install R packages\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    ### Solve errors\n    ### + add-apt-repository ppa:c2d4u.team/c2d4u4.0+\n    ###     gpg: error running '/usr/bin/gpg-agent': probably not installed\n    ###     gpg: failed to start agent '/usr/bin/gpg-agent': Configuration error\n    ###     gpg: can't connect to the agent: Configuration error\n    apt-get install -yq gpg-agent\n\n    ### Solve errors\n    ### + Rscript -e \"install.packages('ggpubr')\"\n    ###     ERROR: configuration failed for package ‘nloptr’\n    ###     ERROR: dependency ‘nloptr’ is not available for package ‘lme4’\n    ###     ERROR: dependency ‘lme4’ is not available for package ‘pbkrtest’\n    ###     ERROR: dependencies ‘pbkrtest’, ‘lme4’ are not available for package ‘car’\n    ###     ERROR: dependency ‘car’ is not available for package ‘rstatix’\n    ###     ERROR: dependency ‘rstatix’ is not available for package ‘ggpubr’\n    apt-get install -yq libnlopt-dev\n\n    ### add the current R 4.0 or later ‘c2d4u’ repository\n    add-apt-repository ppa:c2d4u.team/c2d4u4.0+\n    apt-get update\n\n    ### basic tools\n    apt install -yq --no-install-recommends r-cran-tidyverse\n    apt install -yq --no-install-recommends r-cran-pryr\n    apt install -yq --no-install-recommends r-cran-plyr\n    \n    ### tools for plotting extensions\n    Rscript -e \"install.packages('gridExtra')\"\n    Rscript -e \"install.packages('cowplot')\"\n    Rscript -e \"install.packages('hexbin')\"\n    Rscript -e \"install.packages('ggtext')\"\n    Rscript -e \"install.packages('ggpubr')\"\n    Rscript -e \"install.packages('GGally')\"\n\n    ### tools for plotting different types of figures\n    Rscript -e \"install.packages('ggseqlogo')\"\n    Rscript -e \"install.packages('pheatmap')\"\n    Rscript -e \"install.packages('UpSetR')\"\n    Rscript -e \"install.packages('plotly')\"\n    \n    ### Other tools\n    Rscript -e \"install.packages('zoo')\"\n    Rscript -e \"install.packages('psych')\"\n    Rscript -e \"install.packages('corrr')\"\n    Rscript -e \"install.packages('kableExtra')\"\n    Rscript -e \"install.packages('simpleCache')\"\n    Rscript -e \"install.packages('devtools')\"\n    Rscript -e \"install.packages('R.utils')\"\n    Rscript -e \"install.packages('FactoMineR')\"\n    Rscript -e \"install.packages('factoextra')\"\n\n    ### ===========================================\n    ### install R Bioconductor\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    ### install bioconductor packages\n    ### https://github.com/Bioconductor/bioconductor_docker/tree/devel/bioc_scripts\n    Rscript -e 'install.packages(\"BiocManager\", repos=\"https://cran.rstudio.com\")'\n    Rscript -e \"BiocManager::install(update=TRUE, ask=FALSE)\"\n\n    ### ===========================================\n    ### install R Bioconductor packages\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    ### Genomic track/range analysis\n    Rscript -e \"BiocManager::install('IRanges')\"\n    Rscript -e \"BiocManager::install('GenomicRanges')\"\n    Rscript -e \"BiocManager::install('rtracklayer')\"\n    Rscript -e \"BiocManager::install('GenomicDistributions')\"\n    Rscript -e \"BiocManager::install('GenomicDistributionsData')\"\n    \n    ### install RNAseq related packages\n    Rscript -e \"BiocManager::install('DESeq2')\"\n    Rscript -e \"BiocManager::install('edgeR')\"\n    Rscript -e \"BiocManager::install('genefilter')\"\n    Rscript -e \"BiocManager::install('airway')\"\n    \n    ### install motif related packages\n    Rscript -e \"BiocManager::install('universalmotif')\"\n\n    ### install tools for enrichment analysis\n    Rscript -e \"BiocManager::install('fgsea')\"\n    Rscript -e \"BiocManager::install('LOLA')\"\n    \n    ### =========================================== \n    ### Install Jupyter and Set Jupyter kernels\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    \n    ### set bash kernel in jupyter\n    pip install bash_kernel\n    python -m bash_kernel.install\n    \n    ### set R kernel in jupyter\n    apt-get update && apt-get install -yq libzmq3-dev\n    Rscript -e \"install.packages('IRkernel')\"\n    Rscript -e \"IRkernel::installspec(name = 'ir', displayname = 'R')\"\n\n    ### rebuild jupyter lab\n    jupyter lab clean\n    jupyter lab build\n\n    ### ===========================================\n    ### Other\n    ### ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    \n    ### clean files and packages\n    apt-get update && apt-get clean",
    "crumbs": [
      "Home",
      "Setup",
      "01 Working Environment"
    ]
  },
  {
    "objectID": "01_setup/work_03_ref.html",
    "href": "01_setup/work_03_ref.html",
    "title": "03 Reference Files",
    "section": "",
    "text": "Reference files\nDescription\n\nencode_chipseq_flagship\nencode_chipseq_histone\nencode_chipseq_subset\nencode_chromatin_states\nencode_crispri_hcrff\nencode_e2g_benchmark\nencode_e2g_prediction\nencode_open_chromatin\nencode_rnaseq\ngenome_gene\ngenome_tss\ngenome_cres\n\ncollecting studied enhancers and regulatory regions, including:\n\nGATA1\nHDAC6\nMYC/PVT1\nFADS\nLocus control region\nLMO2 enhancers\n\n\nfcc_peak_call_atac\nfcc_peak_call_cres\nfcc_trackhub_JinWoo\nTF_modules_Shannon\n\nSummary\nPROJECT/reference\n├── encode_chipseq_flagship\n├── encode_chipseq_histone\n├── encode_chipseq_subset\n├── encode_chromatin_states\n├── encode_crispri_hcrff\n├── encode_e2g_benchmark\n├── encode_e2g_prediction\n├── encode_open_chromatin\n├── encode_rnaseq\n├── genome_tss\n├── genome_cres\n├── fcc_peak_call_atac\n├── fcc_peak_call_cres\n├── fcc_trackhub_JinWoo\n├── hic...\n└── TF_modules_Shannon\nDetailed\nPROJECT/reference\n├── encode_chipseq_flagship\n│\n├── encode_chipseq_subset\n│\n├── encode_open_chromatin\n│\n├── fcc_trackhub_JinWoo\n│   ├── K562_TSS_selected_by_higest_Pol2_TSS_sig.out\n│   └── trackhub.txt\n│\n└── fcc_astarr_macs",
    "crumbs": [
      "Home",
      "Setup",
      "03 Reference Files"
    ]
  },
  {
    "objectID": "01_setup/work_11_prep_fcc.html",
    "href": "01_setup/work_11_prep_fcc.html",
    "title": "11 Prepare: FCC",
    "section": "",
    "text": "Results after preparation\n\nProcess files in data (arrange/extract)\nSymLink files in data (file aliases)\n\n\n\nFCC assay\nPROJECT/results/assay_fcc\n├── STARR_ATAC_K562_Reddy_KS91\n│   ├── fragment_counts\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep1.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep2.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep3.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep4.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep5.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Input.rep6.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Output.rep1.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Output.rep2.WGS.unstranded.bed.gz\n│   │   ├── ASTARRseq_K562_KS91.hg38.Output.rep3.WGS.unstranded.bed.gz\n│   │   └── ASTARRseq_K562_KS91.hg38.Output.rep4.WGS.unstranded.bed.gz\n│   └── fragment\n│\n├── STARR_ATAC_K562_Reddy_KS274\n│   ├── fragment_counts\n│   └── fragment\n│\n├── STARR_ATAC_K562_Reddy_KSMerge\n│   ├── fragment_counts\n│   └── fragment\n│\n├── STARR_WHG_K562_Reddy_A001\n│   ├── fragment_counts\n│   │   ├── WSTARRseq_K562_A001.hg38.Input.rep1.WGS.unstranded.bed.gz\n│   │   ├── WSTARRseq_K562_A001.hg38.Input.rep2.WGS.unstranded.bed.gz\n│   │   ├── WSTARRseq_K562_A001.hg38.Input.rep3.WGS.unstranded.bed.gz\n│   │   ├── WSTARRseq_K562_A001.hg38.Input.rep4.WGS.unstranded.bed.gz\n│   │   ├── WSTARRseq_K562_A001.hg38.Output.rep1.WGS.unstranded.bed.gz\n│   │   ├── WSTARRseq_K562_A001.hg38.Output.rep2.WGS.unstranded.bed.gz\n│   │   └── WSTARRseq_K562_A001.hg38.Output.rep3.WGS.unstranded.bed.gz\n│   └── fragment\n│\n├── MPRA_Tiling_K562_Tewhey_Hannah\n│   ├── fragment_counts\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.raw. Input .rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.raw. Output.rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.norm.Input .rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.norm.Output.rep[1-4].stranded_pos.bed\n│   │   │ \n│   │   ├── TMPRA_K562_OL13_20220512.hg19.norm.Input .mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed\n│   │   │ \n│   │   ├── TMPRA_K562_OL43_20221003.hg38.raw. Input .rep[1-6].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL43_20221003.hg38.raw. Output.rep[1-5].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL43_20221003.hg38.norm.Input .rep[1-6].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL43_20221003.hg38.norm.Output.rep[1-5].stranded_pos.bed\n│   │   │ \n│   │   ├── TMPRA_K562_OL43_20221003.hg38.norm.Input .mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL43_20221003.hg38.norm.Output.mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed\n│   │   │ \n│   │   ├── TMPRA_K562_OL45_20220927.hg38.raw. Input .rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL45_20220927.hg38.raw. Output.rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL45_20220927.hg38.norm.Input .rep[1-4].stranded_pos.bed\n│   │   ├── TMPRA_K562_OL45_20220927.hg38.norm.Output.rep[1-4].stranded_pos.bed\n│   │   │ \n│   │   ├── TMPRA_K562_OL45_20220927.hg38.norm.Input .mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL45_20220927.hg38.norm.Output.mean.stranded_pos.bed\n│   │   ├── TMPRA_K562_OL45_20220927.hg38.norm.Log2FC.mean.stranded_pos.bed\n│   │   │\n│   │   └── summary\n│   │       ├── TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \n│   │       ├── TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \n│   │       ├── TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \n│   │       ├── TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \n│   │       ├── TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \n│   │       └── TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv \n│   └── fragment\n│       ├── TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz \n│       ├── TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz \n│       └── TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz \n│\n├── MPRA_Lenti_K562_Nadav_Vikram\n│   ├── fragment_counts\n│   |   ├── LMPRA_K562.hg38.Log2FC.unstranded.bed.gz\n│   |   ├── LMPRA_K562.hg38.ZScore.unstranded.bed.gz\n│   |   └── summary\n│   │       ├── \n│   │       └── \n│   └── fragment\n│\n├── CRISPRi_FlowFISH_K562_Riley_JinWoo\n│   └── guide_scores\n│       ├── CRISPRi_HCRFF_K562.hg38.ZScore.unstranded.bed.gz\n│       ├── CAPRIN1_HCRFF_rAVG.log2FC_2.bed\n│       ├── CAT_HCRFF_rAVG.log2FC_2.bed\n│       ├── CD164_HCRFF_rAVG.log2FC_2.bed\n│       ├── ERP29_HCRFF_rAVG.log2FC_2.bed\n│       ├── FADS1_HCRFF_rAVG.log2FC_2.bed\n│       ├── FADS2_HCRFF_rAVG.log2FC_2.bed\n│       ├── FADS3_HCRFF_rAVG.log2FC_2.bed\n│       ├── FEN1_HCRFF_rAVG.log2FC_2.bed\n│       ├── GATA1_HCRFF_rAVG.log2FC_2.bed\n│       ├── HBE1_HCRFF_rAVG.log2FC_2.bed\n│       ├── HBG1_HCRFF_rAVG.log2FC_2.bed\n│       ├── HBG2_HCRFF_rAVG.log2FC_2.bed\n│       ├── HBS1L_HCRFF_rAVG.log2FC_2.bed\n│       ├── HDAC6_HCRFF_rAVG.log2FC_2.bed\n│       ├── LMO2_HCRFF_rAVG.log2FC_2.bed\n│       ├── MEF2C_HCRFF_rAVG.log2FC_2.bed\n│       ├── MYB_HCRFF_rAVG.log2FC_2.bed\n│       ├── MYC_HCRFF_rAVG.log2FC_2.bed\n│       ├── NMU_HCRFF_rAVG.log2FC_2.bed\n│       ├── PVT1_HCRFF_rAVG.log2FC_2.bed\n│       └── summary\n│           ├── track_info.tsv\n│           ├── metadata.tsv\n│           └── metadata.library_design.tsv\n│\n└── CRISPRi_Growth_K562_Gersbach_JinWoo\n    └── guide_scores\n        ├── CRISPRi_rAVG_log2FC_2.wig\n        ├── CRISPRi_rAVG_log2FC_2.bed\n        ├── CRISPRi_Growth_K562.hg38.ZScore.unstranded.bed.gz\n        └── summary\n            ├── track_info.tsv\n            └── metadata.tsv\n\n\nHiC assay\nSummary\nPROJECT/results/assay_hic\n├── hic_insitu_K562_ENCSR545YBD\n├── hic_intact_K562_ENCSR479XDG\n└── hic_intact_K562_deep",
    "crumbs": [
      "Home",
      "Setup",
      "11 Prepare: FCC"
    ]
  },
  {
    "objectID": "01_setup/work_15_prep_others.html",
    "href": "01_setup/work_15_prep_others.html",
    "title": "15 Prepare: Others",
    "section": "",
    "text": "K562 RNA-seq\n\n\nProtein domain/family annotations",
    "crumbs": [
      "Home",
      "Setup",
      "15 Prepare: Others"
    ]
  },
  {
    "objectID": "01_setup/work_21_results_fcc2.html",
    "href": "01_setup/work_21_results_fcc2.html",
    "title": "12 Results (FCC)",
    "section": "",
    "text": "PROJECT/results/region_coverage_fcc\n└── &lt;Region&gt;\n    └── &lt;STARR&gt;\n        ├── overlap_count\n        |   └── summary\n        |       ├── data.count_column.raw.WGS.rds\n        |       ├── data.deseq2.rds\n        |       ├── data.edger.rds\n        |       ├── matrix.count.raw.WGS.tsv\n        |       ├── result.coverage.screened.tsv\n        |       ├── result.coverage.Log2FC.deseq.tsv\n        |       ├── result.coverage.TPM.tsv\n        |       ├── result.coverage.CPM.tsv\n        |       ├── result.coverage.FPKM.tsv\n\n        └── summary\n            ├── result.summary.tsv \n                (Input Output coverage)\n                (Output/Input Z Score, Input & Output TPM/FPKM)\nPROJECT/results/region_coverage_fcc\n└── &lt;Region&gt;\n    └── &lt;TMPRA&gt;\n        ├── overlap_score\n        |   └── summary\n        |       ├── data.count_column.raw.OL43.rds\n        |       ├── data.count_column.norm.OL43.rds\n        |       ├── data.deseq2.rds\n        |       ├── data.edger.rds\n        |       ├── matrix.count.raw.WGS.tsv\n        |       ├── result.coverage.screened.tsv\n        |       ├── result.coverage.Log2FC.deseq.tsv\n        └── summary\n            ├── result.summary.tsv \n                (Input Output coverage)\n                (Output/Input Z Score, Input & Output TPM/FPKM)\nPROJECT/results/region_coverage_fcc\n└── &lt;Region&gt;\n    └── &lt;STARR&gt;\n        ├── overlap_score\n        ├── overlap_fragment_unique\n        ├── overlap_fragment_one2one",
    "crumbs": [
      "Home",
      "Setup",
      "12 Results (FCC)"
    ]
  },
  {
    "objectID": "01_setup/work_23_results_region.html",
    "href": "01_setup/work_23_results_region.html",
    "title": "14 Results (Region)",
    "section": "",
    "text": "└── annotation\n    ├── ASTARRseq_K562_KS91_Input_rep_all_union\n    └── ASTARRseq_K562_KS91_Input_rep_all_max_overlap\n\n\n\n\n\n\n\n\nAssay_Name\nAssay_Type\nAssay_Label\n\n\n\n\nSTARR_ATAC_K562_Reddy_KS91, STARR_ATAC_K562_Reddy_KS274\nASTARR\nASTARR_AB/ASTARR_A/ASTARR_R\n\n\nSTARR_WHG_K562_Reddy_A001\nWSTARR\nWSTARR_AB/WSTARR_A/WSTARR_R\n\n\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA\nTMPRA_A/TMPRA_R\n\n\nMPRA_Lenti_K562_Nadav_Vikram\nLMPRA\nLMPRA_A/LMPRA_R\n\n\nCRISPRi_FlowFISH_K562_Riley_JinWoo\nCRISPRi-HCRFF\nCRISPRi-HCRFF:GATA1/CRISPRi-HCRFF:MYC\n\n\nCRISPRi_Growth_K562_Gersbach_JinWoo, CRISPRi_Growth_K562_Gersbach_Alex\nCRISPRi-Growth\nCRISPRi-Growth",
    "crumbs": [
      "Home",
      "Setup",
      "14 Results (Region)"
    ]
  },
  {
    "objectID": "02_prepare/data_21_peak_calling.html",
    "href": "02_prepare/data_21_peak_calling.html",
    "title": "Peak calling",
    "section": "",
    "text": "This page provides an overview of the peak calling methodologies applied to our functional characterization data. Our approach incorporates the results from various screen analysis tools to ensure comprehensive analysis for assay comparisons.\n\nUnified processing pipeline for peak calling in high-throughput reporter assays\nAn unified processing pipeline has been developed by Junke from the Yu Lab to standardize the enhancer calling process for high-throughput reporter assays.\ndeep_ATAC_STARR_seq.genomic_bin_100_sliding_10.tar.gz\nlentiMPRA.tar.gz\ntilingMPRA_MYC_GATA.tar.gz\ntilingMPRA_OL13.tar.gz\ntilingMPRA_OL45.tar.gz\nWHG_STARR_TR.tar.gz\n\n\n\nFCC Metadata (STARR/MPRA)\n\n\nLabel\nAssay\nDirection\nCount\n\n\n\n\nASTARR_A\nATAC-STARR-seq\nActive (either direction)\n35505\n\n\nASTARR_AB\nATAC-STARR-seq\nActive (both direction)\n11680\n\n\nASTARR_R\nATAC-STARR-seq\nRepressive (either direction)\n154337\n\n\nASTARR_RB\nATAC-STARR-seq\nRepressive (both direction)\n28775\n\n\neSTARR_A\neSTARR-seq\nActive (either direction)\n150\n\n\neSTARR_AB\neSTARR-seq\nActive (both direction)\n31\n\n\neSTARR_R\neSTARR-seq\nRepressive (either direction)\n341\n\n\neSTARR_RB\neSTARR-seq\nRepressive (both direction)\n65\n\n\nLMPRA_A\nLenti-MPRA\nActive (either direction)\n25648\n\n\nLMPRA_AB\nLenti-MPRA\nActive (both direction)\n16603\n\n\nLMPRA_R\nLenti-MPRA\nRepressive (either direction)\n485\n\n\nLMPRA_RB\nLenti-MPRA\nRepressive (both direction)\n128\n\n\nTMPRA_A\nTiling-MPRA\nActive (either direction)\n6017\n\n\nTMPRA_AB\nTiling-MPRA\nActive (both direction)\n57\n\n\nTMPRA_R\nTiling-MPRA\nRepressive (either direction)\n254\n\n\nTMPRA_RB\nTiling-MPRA\nRepressive (both direction)\n1\n\n\nWSTARR_A\nWHG-STARR-seq\nActive (either direction)\n79738\n\n\nWSTARR_AB\nWHG-STARR-seq\nActive (both direction)\n25505\n\n\nWSTARR_R\nWHG-STARR-seq\nRepressive (either direction)\n62201\n\n\n\n\n\n\nIn this study we are going to use only “either direction” calls.\n\n\nApplying ChIP-seq differential peak calling (csaw) on ATAC-STARR-seq assay\nThe csaw tool was utilized for differential peak calling in ATAC-STARR assay data to identify cis-regulatory element from the chromatin accessible regions. This process was conducted by Alex.\nKS91 (6Dna4Rna) -&gt; KSMerge (6Dna7Rna)   \nNumber of significant regions increased. Negative regions increased more than positive regions.\n\nTotal number of regions: \n352,944 -&gt; 359,104\n\nSignificant regions (-log10Q &gt;= 3):\n87,695 -&gt; 93,208\n\nPercentage of negative and positive:\n- Postive: 0.61 (53110) -&gt; 0.53 (49041)\n- Negative: 0.39 (34585) -&gt; 0.47 (44167)\n\n\n\nCRISPR activity screen analysis (CASA) on CRISPRi-HCR Flow-FISH data\nThe CASA analysis pipeline, developed by the Sabeti Lab, has been applied to CRISPRi-HCR Flow-FISH data to identify regulatory elements. The results of significant regions can be downloaded from the ENCODE portal as follows:\nThe table is downloaded by ENCODE FCC CRSIRPi HCR FlowFISH\n\n\n\n\nCalling DHS regions using DESeq analysis for CRISPRi-Growth\nFor the analysis of CRISPRi-Growth data, DHS (DNase I hypersensitive sites) regions with significant effect on cell fittness have been identified using DESeq analysis, performed by Alex.\nThere are ~ 1M (1,092,166) guides designed to screen across ~111K (111,702) DHS regions in K562.\nMethod: DESeq2 analysis on all guides -&gt; log2 foldchange and p-values\nSignificant: Guide with fdr_0_05\nWe got 6424 DHS regions containing at least one significant guides.\n#Guide  (Total):      1092166 \n#Region (Total):      111702 \n#Guide  (padj&lt;=0.05): 8200 \n#Region (padj&lt;=0.05): 6242 \n\n#Guide  (Signif): 6242 \n#Region (Signif): 6242",
    "crumbs": [
      "Home",
      "Prepare",
      "Peak calling"
    ]
  },
  {
    "objectID": "02_prepare/data_22_ocr.html",
    "href": "02_prepare/data_22_ocr.html",
    "title": "Open chromatin regions",
    "section": "",
    "text": "Applying MACS on ATAC-STARR-seq input libraries\nTo define the accessible regions used for this studies, we applied the MACS peak calling at the ATAC-STARR input libraries.\nThe input libraries of ATAC-STARR libraries were built on the genomic fragments after Tn5 digestion. The input library was transfected in K562 cell for testing regulatory activities.\nThe sequencing of input libraries results in X billions of unique fragments across six technical replicates.\nThe MACS tool was applied to ASTARR input libraries to acquire the chromatin accessible regions. This process was conducted by Alex.\nThere are two sets of accessible regions in this - less stringent region set: union of base pairs across replicates - more stringent region set: overlap/interaction of base pairs across all replicates, only the base pairs that exist in all replicates are retained\nNote: write the description of length using Mode and IQR, 90 percentile - Union: Mode = 422 bp, Median = 800 bp, 1031-435 = 596 bp, 90 percentile = 1475 bp - Overlap: Mode = 342 bp, Median = 597 bp, 909-401 = 508 bp, 90 percentile) = 1293 bp\nDetail numbers\nATAC (Union)\n#{Region} = 246,852\nLength (Min) = 218 bp\nLength (1st Q) = 435 bp\nLength (Median) = 665 bp\nLength (Mean) = 800 bp\nLength (Mode) = 422 bp\nLength (3rd Q) = 1031 bp\nLength (Max) = 6251 bp\nLength (90 percentile) = 1475 bp\n\nATAC (Overlap or intersection)\n#{Region} = 150,042\nLength (Min) = 1 bp\nLength (1st Q) = 401 bp\nLength (Median) = 597 bp\nLength (Mean) = 712 bp\nLength (Mode) = 342 bp\nLength (3rd Q) = 909 bp\nLength (Max) = 6172 bp\nLength (90 percentile) = 1293 bp\nDistribution of length\n[TODO] Use figure panel to include the distribution of GC content and accessibility (TPM) https://quarto.org/docs/authoring/figures.html\n\n\n\nENCODE K562 ATAC/DNase peaks\nDistribution of length\n\n\n\nComparison: Chromosome distribution plots of accessible regions",
    "crumbs": [
      "Home",
      "Prepare",
      "Open chromatin regions"
    ]
  },
  {
    "objectID": "11_fcc_summary/01_fcc_astarr.html",
    "href": "11_fcc_summary/01_fcc_astarr.html",
    "title": "ATAC-STARR-seq (ASTARR)",
    "section": "",
    "text": "Library sizes of ASTARR (KS279)\n\n\nSample\nGroup\nCount\n\n\n\n\nInput.rep1\nInput\n348,695,063\n\n\nInput.rep2\nInput\n451,369,741\n\n\nInput.rep3\nInput\n487,579,055\n\n\nInput.rep4\nInput\n456,246,254\n\n\nInput.rep5\nInput\n444,268,950\n\n\nInput.rep6\nInput\n397,333,562\n\n\nOutput.rep1\nOutput\n44,103,844\n\n\nOutput.rep2\nOutput\n97,471,282\n\n\nOutput.rep3\nOutput\n84,103,298\n\n\nOutput.rep4\nOutput\n183,115,379\n\n\n\n\nLibrary sizes of ASTARR (KS279)\n\n\nSample\nGroup\nCount\n\n\n\n\nOutput.rep1\nOutput\n…\n\n\nOutput.rep2\nOutput\n…\n\n\nOutput.rep3\nOutput\n…",
    "crumbs": [
      "Home",
      "FCC Summary",
      "ATAC-STARR-seq (ASTARR)"
    ]
  },
  {
    "objectID": "11_fcc_summary/01_fcc_astarr.html#atac-starr-seq-astarr",
    "href": "11_fcc_summary/01_fcc_astarr.html#atac-starr-seq-astarr",
    "title": "ATAC-STARR-seq (ASTARR)",
    "section": "",
    "text": "Library sizes of ASTARR (KS279)\n\n\nSample\nGroup\nCount\n\n\n\n\nInput.rep1\nInput\n348,695,063\n\n\nInput.rep2\nInput\n451,369,741\n\n\nInput.rep3\nInput\n487,579,055\n\n\nInput.rep4\nInput\n456,246,254\n\n\nInput.rep5\nInput\n444,268,950\n\n\nInput.rep6\nInput\n397,333,562\n\n\nOutput.rep1\nOutput\n44,103,844\n\n\nOutput.rep2\nOutput\n97,471,282\n\n\nOutput.rep3\nOutput\n84,103,298\n\n\nOutput.rep4\nOutput\n183,115,379\n\n\n\n\nLibrary sizes of ASTARR (KS279)\n\n\nSample\nGroup\nCount\n\n\n\n\nOutput.rep1\nOutput\n…\n\n\nOutput.rep2\nOutput\n…\n\n\nOutput.rep3\nOutput\n…",
    "crumbs": [
      "Home",
      "FCC Summary",
      "ATAC-STARR-seq (ASTARR)"
    ]
  },
  {
    "objectID": "analysis.html",
    "href": "analysis.html",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "",
    "text": "Open the board link"
  },
  {
    "objectID": "analysis.html#questions",
    "href": "analysis.html#questions",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nWhat percentage of data falls within open chromatin regions?\nHow many open chromatin regions are covered in each FCC assay?"
  },
  {
    "objectID": "analysis.html#questions-1",
    "href": "analysis.html#questions-1",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nHow much variation in the output library can be explained by the input library?"
  },
  {
    "objectID": "analysis.html#questions-2",
    "href": "analysis.html#questions-2",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nWhat are the correlations of effect sizes across different FCC assays?"
  },
  {
    "objectID": "analysis.html#questions-3",
    "href": "analysis.html#questions-3",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nHow do effect sizes differ across various chromatin states (e.g., promoters and enhancers)?\nAre certain chromatin states associated with higher or lower effect sizes in each assay?"
  },
  {
    "objectID": "analysis.html#methods",
    "href": "analysis.html#methods",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Methods:",
    "text": "Methods:\n\nGroup regions by chromatin states (e.g., cCREs, ChromHMM).\nCompare effect sizes among different groups (e.g., promoters vs. enhancers)."
  },
  {
    "objectID": "analysis.html#questions-4",
    "href": "analysis.html#questions-4",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nHow do effect sizes vary across regions with different physical connectivity?\nIs there a significant difference in effect sizes between regions with high loop counts and those with low loop counts?\nAre certain types of chromatin interactions (e.g., long-range vs. short-range loops) associated with distinct effect size distributions?"
  },
  {
    "objectID": "analysis.html#methods-1",
    "href": "analysis.html#methods-1",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Methods:",
    "text": "Methods:\n\nGroup regions by loop counts or loop distance\nCompare effect sizes among different groups"
  },
  {
    "objectID": "analysis.html#questions-5",
    "href": "analysis.html#questions-5",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\nHow much variation in regulatory effects can be explained by ChIP-seq annotations?\nWhat is the predictivity of regulatory effects using ChIP-seq information?"
  },
  {
    "objectID": "analysis.html#method",
    "href": "analysis.html#method",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Method:",
    "text": "Method:\n\nRegression: FCC ~ ChIP-seq"
  },
  {
    "objectID": "analysis.html#questions-6",
    "href": "analysis.html#questions-6",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Questions:",
    "text": "Questions:\n\n(Keith) are there features associated with active enhancers that differentiate them into different categories or subclasses"
  },
  {
    "objectID": "analysis.html#method-1",
    "href": "analysis.html#method-1",
    "title": "Analysis: Summarize ideas and findings of the analyses",
    "section": "Method:",
    "text": "Method:\n\nIntegrate the FCC data and ChIP-seq into a matrix (Option 1: z score; Option 2: peak calls)\nClustering the matrix\nVisualize the matrix and cluster by UMAP dimentional reduction"
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Data dictionary",
    "section": "",
    "text": "Below are the main data used in the analyses. We express our sincere appreciation to the research teams and individuals involved in conducting, processing, and sharing the experiments and data that underpin our analyses."
  },
  {
    "objectID": "data.html#atac-starr-seq-astarr",
    "href": "data.html#atac-starr-seq-astarr",
    "title": "Data dictionary",
    "section": "ATAC-STARR-seq (ASTARR)",
    "text": "ATAC-STARR-seq (ASTARR)\nhttps://www.encodeproject.org/functional-characterization-experiments/ENCSR312UQM/"
  },
  {
    "objectID": "data.html#whg-starr-seq-wstarr",
    "href": "data.html#whg-starr-seq-wstarr",
    "title": "Data dictionary",
    "section": "WHG-STARR-seq (WSTARR)",
    "text": "WHG-STARR-seq (WSTARR)\n\nMore information\n\nhttps://www.encodeproject.org/functional-characterization-experiments/ENCSR661FOW/"
  },
  {
    "objectID": "data.html#tiling-mpra-tmpra",
    "href": "data.html#tiling-mpra-tmpra",
    "title": "Data dictionary",
    "section": "Tiling MPRA (TMPRA)",
    "text": "Tiling MPRA (TMPRA)\nENCODE FCC K562 Tiling MPRA from Tewhey’s lab\n\nENCODE MPRA K562 OL43-GATA/MYC region\n\nHomo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci\n\n[ENCODE MPRA]\n\nhttps://www.encodeproject.org/search/?type=File&searchTerm=OL43&file_format=bed\nMPRA of multiple loci in K562 Homo sapiens K562, 48 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: FEN1, FADS1, FADS2, FADS3 Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR394HXI\nryan-tewhey:mpra-OL13-fads-k562\nMPRA of multiple loci in K562 Homo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: GATA1, MYC Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR917SFD\nryan-tewhey:mpra-OL43-gata_myc_ctrl-k562\nMPRA of multiple loci in K562 Homo sapiens K562, 24 hours post-nucleic acid delivery time genetically modified (episome) using transient transfection for multiple loci Loci: LMO2, HBE1, RBM38, HBA2, BCL11A Lab: Ryan Tewhey, JAX Project: ENCODE\nFunctional Characterization Experiment ENCSR363XER\nryan-tewhey:mpra-OL45-common_ctrl-k562\nIn this analysis, we are using the unnormalized and normalized data processed and shared by Hannah from the Tewhey lab."
  },
  {
    "objectID": "data.html#lenti-mpra-lmpra",
    "href": "data.html#lenti-mpra-lmpra",
    "title": "Data dictionary",
    "section": "Lenti-MPRA (LMPRA)",
    "text": "Lenti-MPRA (LMPRA)\nLentivirus-based MPRA (lentiMPRA) produces “in-genome” readouts (M Grace Gordon et al., 2020)\n\nBenefits\n\nenables the use of MPRA in hard-to-transfect cells.\n\nReference\n\nM Grace Gordon et al. (2020) lentiMPRA and MPRAflow for high-throughput functional characterization of gene regulatory elements. Nature protocols, 15, 2387–2412."
  },
  {
    "objectID": "data.html#crispri-hcr-flowfish-crispri-hcrff",
    "href": "data.html#crispri-hcr-flowfish-crispri-hcrff",
    "title": "Data dictionary",
    "section": "CRISPRi-HCR FlowFISH (CRISPRi-HCRFF)",
    "text": "CRISPRi-HCR FlowFISH (CRISPRi-HCRFF)"
  },
  {
    "objectID": "data.html#crispri-growth-screen-crispri-growth",
    "href": "data.html#crispri-growth-screen-crispri-growth",
    "title": "Data dictionary",
    "section": "CRISPRi Growth screen (CRISPRi-Growth)",
    "text": "CRISPRi Growth screen (CRISPRi-Growth)"
  },
  {
    "objectID": "data.html#cres-calls-for-reporter-assays-starrmpra",
    "href": "data.html#cres-calls-for-reporter-assays-starrmpra",
    "title": "Data dictionary",
    "section": "CREs calls for reporter assays (STARR/MPRA)",
    "text": "CREs calls for reporter assays (STARR/MPRA)\nAn unified processing pipeline has been developed by Junke from the Yu Lab to standardize the enhancer calling process for high-throughput reporter assays."
  },
  {
    "objectID": "data.html#cres-calls-for-crispri-hcr-flowfish",
    "href": "data.html#cres-calls-for-crispri-hcr-flowfish",
    "title": "Data dictionary",
    "section": "CREs calls for CRISPRi-HCR FlowFISH",
    "text": "CREs calls for CRISPRi-HCR FlowFISH\nCRISPR activity screen analysis (CASA) on CRISPRi-HCR Flow-FISH data\nThe CASA analysis pipeline, developed by the Sabeti Lab, has been applied to CRISPRi-HCR Flow-FISH data to identify regulatory elements. The results of significant regions in K562 FlowFISH CRISPRi screens from Reilly lab can be downloaded from the ENCODE portal (Link)"
  },
  {
    "objectID": "data.html#cres-calls-for-crispri-growth-screen",
    "href": "data.html#cres-calls-for-crispri-growth-screen",
    "title": "Data dictionary",
    "section": "CREs calls for CRISPRi-Growth screen",
    "text": "CREs calls for CRISPRi-Growth screen\nCalling DHS regions using DESeq analysis for CRISPRi-Growth\nFor the analysis of CRISPRi-Growth data, DHS (DNase I hypersensitive sites) regions with significant effect on cell fittness have been identified using DESeq analysis, performed by Alex."
  },
  {
    "objectID": "data.html#encode-re2g-predictions-of-enhancer-gene-regulatory-interactions-crispr-e2g",
    "href": "data.html#encode-re2g-predictions-of-enhancer-gene-regulatory-interactions-crispr-e2g",
    "title": "Data dictionary",
    "section": "ENCODE-rE2G predictions of enhancer-gene regulatory interactions (CRISPR-E2G)",
    "text": "ENCODE-rE2G predictions of enhancer-gene regulatory interactions (CRISPR-E2G)\n\nDistal regulation ENCODE-rE2G\n\nENCODE-E2G models\n\n\nCRISPR E2G Benchmark\n\nBenchmark enhancer-gene prediction models against CRISPR data\n\nCRISPR E2G Prediction\n\nENCODE: ENCSR328LMT\n\nDescription:\n\nENCODE-rE2G (extended) predictions of enhancer-gene regulatory interactions for K562\n\nAnnotation type:\n\nelement gene regulatory interaction predictions\n\nExperimental input (Assay: DNase-seq, ChIP-seq, HiC, ChIA-PET):\n\nENCSR000EOT (K562 DNase-seq)\nENCSR668LDD (K562 ChIP-seq: H3K4me3)\nENCSR000AKP (K562 ChIP-seq: H3K27ac)\nENCSR000EGE (K562 ChIP-seq: EP300)\nENCSR000DWE (K562 ChIP-seq: CTCF)\nENCSR597AKG (K562 ChIA-PET: CTCF)\nENCSR545YBD (K562 in situ Hi-C)\nENCSR479XDG (K562 intact Hi-C)"
  },
  {
    "objectID": "data.html#atac-peaks",
    "href": "data.html#atac-peaks",
    "title": "Data dictionary",
    "section": "ATAC peaks",
    "text": "ATAC peaks\nMACS peaks called of the ASTARR input libraries\nprocessed by Alex"
  },
  {
    "objectID": "data.html#in-situ-hi-c",
    "href": "data.html#in-situ-hi-c",
    "title": "Data dictionary",
    "section": "in-situ Hi-C",
    "text": "in-situ Hi-C\nExperiment summary for ENCSR545YBD - HiC (in situ Hi-C) - Homo sapiens K562 - K562 in situ Hi-C experiment"
  },
  {
    "objectID": "data.html#chromatin-states",
    "href": "data.html#chromatin-states",
    "title": "Data dictionary",
    "section": "Chromatin states",
    "text": "Chromatin states\nRead more about the chromatin states data\n\nENCODE candidate cis-regulatory elements (cCREs)\n\nENCODE Link: ENCODE v4 cCREs (ENCSR913HQX)\nDescription: candidate regulatory elements for GRCh38 in K562\n\nENCODE ChromHMM chromatin states (ChromHMM)\n\nENCODE Link: ENCODE v4 ChromHMM (ENCSR365YNI)\nDescription: ChromHMM 15-state model of K562"
  },
  {
    "objectID": "data.html#chip-seq-tfhistone-data",
    "href": "data.html#chip-seq-tfhistone-data",
    "title": "Data dictionary",
    "section": "ChIP-seq (TF/Histone) data",
    "text": "ChIP-seq (TF/Histone) data\n\nK562 ChIP-seq table from the ENCODE flagship\nENCODE ChIP-seq (Histone)\n\nLink:\n\nhttps://www.encodeproject.org/search/?type=Experiment&searchTerm=chipseq&assay_title=Histone+ChIP-seq&biosample_ontology.term_name=K562&perturbed=false&assembly=GRCh38&files.file_type=bed+narrowPeak&files.file_type=bigWig\n\n\nENCODE ChIP-seq (Transcription Factors)\n\nLink:"
  },
  {
    "objectID": "data.html#tf-binding-modules",
    "href": "data.html#tf-binding-modules",
    "title": "Data dictionary",
    "section": "TF binding modules",
    "text": "TF binding modules\n\nShannon et al. look at TF binding patterns across the genome enrichment by cluster the TFs into different modules/groups."
  },
  {
    "objectID": "data.html#accessible-regions-atacdhs-regions",
    "href": "data.html#accessible-regions-atacdhs-regions",
    "title": "Data dictionary",
    "section": "Accessible regions (ATAC/DHS regions)",
    "text": "Accessible regions (ATAC/DHS regions)\n\nK562 Accessible regions (ATAC/DHS regions) used for testing assay coverage"
  },
  {
    "objectID": "data.html#tss-annotation",
    "href": "data.html#tss-annotation",
    "title": "Data dictionary",
    "section": "TSS annotation",
    "text": "TSS annotation\nRead more about the TSS annotation used in this documentation"
  },
  {
    "objectID": "data.html#gene-expression-rna-seq",
    "href": "data.html#gene-expression-rna-seq",
    "title": "Data dictionary",
    "section": "Gene expression (RNA-seq)",
    "text": "Gene expression (RNA-seq)\n\nENCODE: ENCSR615EEK\n\nAssay: RNA-seq (total RNA-seq)\nBiosample: K562\nExternal resources: GEO:GSE174954"
  },
  {
    "objectID": "data.html#gene-annotation",
    "href": "data.html#gene-annotation",
    "title": "Data dictionary",
    "section": "Gene annotation",
    "text": "Gene annotation\n\nEssential gene DeMap: AchillesCommonEssentialControls.csv\n\nDescription - List of genes used as positive controls, intersection of Biomen (2014) and Hart (2015) essentials. Each entry is separated by a newline. - The scores of these genes are used as the dependent distribution for inferring dependency probability\nRelease Citation - Current DepMap Release data, including CRISPR Screens, PRISM Drug Screens, Copy Number, Mutation, Expression, and Fusions - DepMap, Broad (2024). DepMap 24Q2 Public. Figshare+. Dataset. https://doi.org/10.25452/figshare.plus.25880521.v1"
  },
  {
    "objectID": "notebooks/test/test_notebook.html",
    "href": "notebooks/test/test_notebook.html",
    "title": "Test ipynb for documentation",
    "section": "",
    "text": "Code\nsuppressMessages(suppressWarnings(library(\"tidyverse\")))",
    "crumbs": [
      "Home",
      "Test Notebook",
      "Test ipynb for documentation"
    ]
  },
  {
    "objectID": "notebooks/test/test_notebook.html#ploting",
    "href": "notebooks/test/test_notebook.html#ploting",
    "title": "Test ipynb for documentation",
    "section": "Ploting",
    "text": "Ploting\n\n\nCode\nset.seed(123)\ndat = data.frame(\n    x = rnorm(1000),\n    y = rnorm(1000),\n    z = sample(c(\"a\", \"b\"), size = 1000, replace = TRUE)\n)\n\n\n\n\nCode\ngpt = ggplot(dat, aes(x=x, y=y, color=z)) + geom_point() + theme_bw()\n\n\n\n\nCode\noptions(repr.plot.height=2, repr.plot.width=3)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\noptions(repr.plot.height=5, repr.plot.width=6)\nprint(gpt)",
    "crumbs": [
      "Home",
      "Test Notebook",
      "Test ipynb for documentation"
    ]
  },
  {
    "objectID": "notebooks/test/test_notebook.html#showing-table",
    "href": "notebooks/test/test_notebook.html#showing-table",
    "title": "Test ipynb for documentation",
    "section": "Showing table",
    "text": "Showing table\nHelper function\n\n\nCode\nfun_display_table = function(dat){\n    dat %&gt;%\n        kableExtra::kable(\"html\") %&gt;%\n        as.character() %&gt;%\n        IRdisplay::display_html()\n}\n\n\nCreate a table\n\n\nCode\ndat   = data.frame(x=LETTERS, y=letters)\ndat_t = dat %&gt;% t %&gt;% data.frame\n\n\nWithout styling\n\n\nCode\nhead(dat)\n\n\n\nA data.frame: 6 × 2\n\n\n\nx\ny\n\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\n1\nA\na\n\n\n2\nB\nb\n\n\n3\nC\nc\n\n\n4\nD\nd\n\n\n5\nE\ne\n\n\n6\nF\nf\n\n\n\n\n\n\n\nCode\nhead(dat_t)\n\n\n\nA data.frame: 2 × 26\n\n\n\nX1\nX2\nX3\nX4\nX5\nX6\nX7\nX8\nX9\nX10\n⋯\nX17\nX18\nX19\nX20\nX21\nX22\nX23\nX24\nX25\nX26\n\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n⋯\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nx\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\n⋯\nQ\nR\nS\nT\nU\nV\nW\nX\nY\nZ\n\n\ny\na\nb\nc\nd\ne\nf\ng\nh\ni\nj\n⋯\nq\nr\ns\nt\nu\nv\nw\nx\ny\nz\n\n\n\n\n\nWith kable styling\n\n\nCode\nfun_display_table(head(dat))\n\n\n\n\n\nx\ny\n\n\n\n\nA\na\n\n\nB\nb\n\n\nC\nc\n\n\nD\nd\n\n\nE\ne\n\n\nF\nf\n\n\n\n\n\n\n\nCode\nfun_display_table(head(dat_t))\n\n\n\n\n\n\nX1\nX2\nX3\nX4\nX5\nX6\nX7\nX8\nX9\nX10\nX11\nX12\nX13\nX14\nX15\nX16\nX17\nX18\nX19\nX20\nX21\nX22\nX23\nX24\nX25\nX26\n\n\n\n\nx\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\nM\nN\nO\nP\nQ\nR\nS\nT\nU\nV\nW\nX\nY\nZ\n\n\ny\na\nb\nc\nd\ne\nf\ng\nh\ni\nj\nk\nl\nm\nn\no\np\nq\nr\ns\nt\nu\nv\nw\nx\ny\nz",
    "crumbs": [
      "Home",
      "Test Notebook",
      "Test ipynb for documentation"
    ]
  },
  {
    "objectID": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html",
    "href": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html",
    "title": "Setup Envionment 02",
    "section": "",
    "text": "Set environment\nCode\nls /data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC\n\n\napp   docs  notebooks  references  scripts  tests\ndata  log   README.md  results     site     tmp\nCode\nFD_PRJ=/data/reddylab/Kuei/repo/Proj_CombEffect_ENCODE_FCC"
  },
  {
    "objectID": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-config_project.sh",
    "href": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-config_project.sh",
    "title": "Setup Envionment 02",
    "section": "Setup config_project.sh",
    "text": "Setup config_project.sh"
  },
  {
    "objectID": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-config_func.sh",
    "href": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-config_func.sh",
    "title": "Setup Envionment 02",
    "section": "Setup config_func.sh",
    "text": "Setup config_func.sh\n### https://unix.stackexchange.com/questions/72661/show-sum-of-file-sizes-in-directory-listing\n#dir () { ls -FaGlh \"${@}\" | awk '{ total += $4; print }; END { print total }'; }\ndir() { \n    ls -lhaG --color=always \"${@}\" |\\\n    sed -re 's/^([^ ]* ){3}//' |\\\n    awk '{ total += $1; print }; END { print total }'\n}\n\n### https://unix.stackexchange.com/questions/27013/displaying-seconds-as-days-hours-mins-seconds\nfunction displaytime {\n  local T=$1\n  local D=$((T/60/60/24))\n  local H=$((T/60/60%24))\n  local M=$((T/60%60))\n  local S=$((T%60))\n  (( $D &gt; 0 )) && printf '%d days ' $D\n  (( $H &gt; 0 )) && printf '%d hours ' $H\n  (( $M &gt; 0 )) && printf '%d minutes ' $M\n  (( $D &gt; 0 || $H &gt; 0 || $M &gt; 0 )) && printf 'and '\n  printf '%d seconds\\n' $S\n}\n\n### helper function\nfunction fun_cat {\n    FPATH=$1\n    \n    ### check if file is a symlink, if yes, get the file path\n    if [[ -h ${FPATH} ]]; then\n        FPATH=$(readlink -f ${FPATH})\n    fi\n    \n    ### check if file is compress, if yes: `zcat`, else: `cat`\n    if (file ${FPATH} | grep -q compressed); then\n        zcat ${FPATH}\n    else\n        cat  ${FPATH}\n    fi\n}\n\nfun_cat\nDefine function\n\n\nCode\nfunction fun_cat {\n    FPATH=$1\n    \n    ### check if file is a symlink, if yes, get the file path\n    if [[ -h ${FPATH} ]]; then\n        FPATH=$(readlink -f ${FPATH})\n    fi\n    \n    ### check if file is compress, if yes: `zcat`, else: `cat`\n    if (file ${FPATH} | grep -q compressed); then\n        zcat ${FPATH}\n    else\n        cat  ${FPATH}\n    fi\n}\n\n\nTest function\nCreate test files\n\n\nCode\n### create a text file\ncat &gt; test.txt &lt;&lt; EOF\nHello!\nHow are you?\nEOF\n\n### compress the text file\ngzip -c test.txt &gt; test.txt.gz\n\n### create symlink of the plain/compressed files\nln -f -s test.txt    link2test\nln -f -s test.txt.gz link2testgz\n\n\n\n\nCode\nls test*\n\n\ntest.txt  test.txt.gz\n\n\n\n\nCode\nls -l link*\n\n\nlrwxrwxrwx 1 kk319 reddylab  8 Mar 12 11:06 link2test -&gt; test.txt\nlrwxrwxrwx 1 kk319 reddylab 11 Mar 12 11:06 link2testgz -&gt; test.txt.gz\n\n\nrun function\n\n\nCode\nfun_cat test.txt\n\n\nHello!\nHow are you?\n\n\n\n\nCode\nfun_cat test.txt.gz\n\n\nHello!\nHow are you?\n\n\n\n\nCode\nfun_cat link2test\n\n\nHello!\nHow are you?\n\n\n\n\nCode\nfun_cat link2testgz\n\n\nHello!\nHow are you?"
  },
  {
    "objectID": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-run_config_project.sh",
    "href": "notebooks/00_setup/02_setup_config_on_duke_hardac_SH.html#setup-run_config_project.sh",
    "title": "Setup Envionment 02",
    "section": "Setup run_config_project.sh",
    "text": "Setup run_config_project.sh"
  },
  {
    "objectID": "notebooks/00_setup/04_setup_config_module_SH.html",
    "href": "notebooks/00_setup/04_setup_config_module_SH.html",
    "title": "Setup Envionment 04",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/00_setup/04_setup_config_module_SH.html#setup-config-for-loading-bedtools-module",
    "href": "notebooks/00_setup/04_setup_config_module_SH.html#setup-config-for-loading-bedtools-module",
    "title": "Setup Envionment 04",
    "section": "Setup config for loading bedtools module",
    "text": "Setup config for loading bedtools module\n\n\nCode\nls -d ${FD_EXE}\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\n\n\n\n\nCode\ncat &gt; ${FD_EXE}/config_load_module_bedtools.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n### Check which duke server I am at and load the corresponding modules\n\nif echo $(pwd -P) | grep -q \"gpfs\"; then\n    #echo \"You are on Duke Server: HARDAC\"\n    module load bedtools2\nfi\n\nif echo $(pwd -P) | grep -q \"hpc\"; then\n    #echo \"You are on Duke Server: DCC\"\n    module load Bedtools\nfi\n\nEOF\n\ncat ${FD_EXE}/config_load_module_bedtools.sh\n\n\n#!/bin/bash\n\n### Check which duke server I am at and load the corresponding modules\n\nif echo $(pwd -P) | grep -q \"gpfs\"; then\n    #echo \"You are on Duke Server: HARDAC\"\n    module load bedtools2\nfi\n\nif echo $(pwd -P) | grep -q \"hpc\"; then\n    #echo \"You are on Duke Server: DCC\"\n    module load Bedtools\nfi"
  },
  {
    "objectID": "notebooks/00_setup/04_setup_config_module_SH.html#setup-config-for-loading-bedops-module",
    "href": "notebooks/00_setup/04_setup_config_module_SH.html#setup-config-for-loading-bedops-module",
    "title": "Setup Envionment 04",
    "section": "Setup config for loading bedops module",
    "text": "Setup config for loading bedops module\n\n\nCode\ncat &gt; ${FD_EXE}/config_load_module_bedops.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n### Check which duke server I am at and load the corresponding modules\n\nif echo $(pwd -P) | grep -q \"gpfs\"; then\n    #echo \"You are on Duke Server: HARDAC\"\n    module load bedops\nfi\n\nEOF\n\ncat ${FD_EXE}/config_load_module_bedops.sh\n\n\n#!/bin/bash\n\n### Check which duke server I am at and load the corresponding modules\n\nif echo $(pwd -P) | grep -q \"gpfs\"; then\n    #echo \"You are on Duke Server: HARDAC\"\n    module load bedops\nfi"
  },
  {
    "objectID": "notebooks/00_setup/12_check_config_and_kernel_R.html",
    "href": "notebooks/00_setup/12_check_config_and_kernel_R.html",
    "title": "Check environment 02",
    "section": "",
    "text": "Code\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references \n\n\n\n\n\nCode\nset.seed(123)\ndat = data.frame(\n    x = rnorm(1000),\n    y = rnorm(1000),\n    z = sample(c(\"a\", \"b\"), size = 1000, replace = TRUE)\n)\n\n\n\n\nCode\ngpt = ggplot(dat, aes(x = x, y = y, color = z)) +\n    geom_point() +\n    theme_cowplot()\n\n\n\n\nCode\noptions(repr.plot.height=5, repr.plot.width=6)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = tribble(\n  ~x, ~y, ~z,\n  \"a\", 2, 3.6,\n  \"b\", 1, 8.5\n)\n\nprint(dat)\n\n\n# A tibble: 2 × 3\n  x         y     z\n  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 a         2   3.6\n2 b         1   8.5"
  },
  {
    "objectID": "notebooks/00_setup/14_check_config_SH.html",
    "href": "notebooks/00_setup/14_check_config_SH.html",
    "title": "Check environment 04",
    "section": "",
    "text": "Code\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\n\n\n\n\n\nCode\nTXT=$(fun_get_server)\necho ${TXT}\n\n\nHARDAC\n\n\n\n\nCode\nif [[ ${TXT} == \"Singularity\" ]]; then\n    echo \"You are in singularity\"\nfi\n\n### =====================================\n\nif [[ ${TXT} == \"HARDAC\" ]]; then\n    echo \"You are in HARDAC\"\nfi\n\n\nYou are in HARDAC"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html",
    "title": "Prepare STARR-seq data 02",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-fragment-counts-of-astarr",
    "href": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-fragment-counts-of-astarr",
    "title": "Prepare STARR-seq data 02",
    "section": "Explore fragment counts of ASTARR",
    "text": "Explore fragment counts of ASTARR\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nls ${FDIRY}/*.txt.gz | xargs -n 1 basename\n\n\nKS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep2.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep3.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep4.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep5.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Input_rep6.masked.dedup.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep1.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep2.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep3.f3q10.fragments.counts.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.corrected.txt.gz\nKS91_K562_hg38_ASTARRseq_Output_rep4.f3q10.fragments.counts.txt.gz\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/fragments\nFNAME=KS91_K562_hg38_ASTARRseq_Input_rep1.masked.dedup.fragments.counts.txt.gz\nFPATH=${FDIRY}/${FNAME}\n\nzcat ${FPATH} | head -n 6\n\n\nchr1    10001   10143   chr1_10001_10143    1   .\nchr1    10002   10118   chr1_10002_10118    1   .\nchr1    10002   10131   chr1_10002_10131    1   .\nchr1    10002   10203   chr1_10002_10203    1   .\nchr1    10002   10209   chr1_10002_10209    1   .\nchr1    10002   10227   chr1_10002_10227    1   .\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nls ${FDIRY}/*bedpe | xargs -n 1 basename\n\n\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nFNAME=K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nFPATH=${FDIRY}/${FNAME}\n\ncat ${FPATH} | head -n 6\n\n\nchr1    14145   14485\nchr1    14145   14485\nchr1    14243   14498\nchr1    14454   14729\nchr1    14522   14725\nchr1    14599   14850"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-macs-peak-calls-on-astarr-input",
    "href": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-macs-peak-calls-on-astarr-input",
    "title": "Prepare STARR-seq data 02",
    "section": "Explore MACS peak calls on ASTARR input",
    "text": "Explore MACS peak calls on ASTARR input\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nls ${FDIRY}\n\n\nKS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nKS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFNAME=KS91_K562_hg38_ASTARRseq_Input.all_reps.masked.union_narrowPeak.q5.bed\nFPATH=${FDIRY}/${FNAME}\n\ncat ${FPATH} | head -n 6\n\n\nchr1    10015   10442\nchr1    14253   14645\nchr1    16015   16477\nchr1    17237   17772\nchr1    28903   29613\nchr1    30803   31072\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS91_210401/peaks\nFNAME=KS91_K562_hg38_ASTARRseq_Input.q5.in_all.max_overlaps.bed\nFPATH=${FDIRY}/${FNAME}\n\ncat ${FPATH} | head -n 6\n\n\nchr1    10038   10405   6\nchr1    14282   14614   6\nchr1    16025   16338   6\nchr1    17288   17689   6\nchr1    28934   29499   6\nchr1    115429  115969  6"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-fragment-counts-of-wstarr",
    "href": "notebooks/01_prepare_fcc/fcc_02_explore_data_STARR_TR_SH.html#explore-fragment-counts-of-wstarr",
    "title": "Prepare STARR-seq data 02",
    "section": "Explore fragment counts of WSTARR",
    "text": "Explore fragment counts of WSTARR\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\nls ${FDIRY}\n\n\nA001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep3.masked.dedup.fragments.counts.txt.gz\nA001-input-K562-rep4.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep1.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep2.masked.dedup.fragments.counts.txt.gz\nA001-K562-rep3.masked.dedup.fragments.counts.txt.gz\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_WHG_K562_Reddy_A001_Alex/fragments\nFNAME=A001-input-K562-rep1.masked.dedup.fragments.counts.txt.gz\nFPATH=${FDIRY}/${FNAME}\n\nzcat ${FPATH} | head -n 6\n\n\nchr1    10335   10549   chr1_10335_10549    1   .\nchr1    16983   17500   chr1_16983_17500    1   .\nchr1    16985   17499   chr1_16985_17499    1   .\nchr1    17004   17500   chr1_17004_17500    1   .\nchr1    17483   17898   chr1_17483_17898    1   .\nchr1    17487   17941   chr1_17487_17941    1   ."
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html",
    "title": "Prepare STARR-seq data 032",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#prepare",
    "href": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#prepare",
    "title": "Prepare STARR-seq data 032",
    "section": "Prepare",
    "text": "Prepare\nCheck data\n\n\nCode\nls ${FD_DAT}/processed/STARR_ATAC*\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311:\nfragments\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS91_210401:\nfragments  peaks\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\necho ${FDIRY}\nls   ${FDIRY}\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep1.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep2.f3q10.sorted.with_umis.dedup.rpkm.bw\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\nK562_ASTARR_repeat_rep3.f3q10.sorted.with_umis.dedup.rpkm.bw\n\n\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts\necho  ${FDIRY}\nls -d ${FDIRY}\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts\n\n\nTest: Calcualte fragment -&gt; fragment counts\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nFN_INP=K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nFP_INP=${FD_INP}/${FN_INP}\ncat ${FP_INP} | head\n\n\nchr1    14145   14485\nchr1    14145   14485\nchr1    14243   14498\nchr1    14454   14729\nchr1    14522   14725\nchr1    14599   14850\nchr1    14659   14864\nchr1    14659   14864\nchr1    14781   15268\nchr1    15172   15659\n\n\n\n\nCode\ncat ${FP_INP} | head |\\\n    sort -k 1,1 -k2,2n |\\\n    uniq -c |\\\n    awk '{$(NF+1)=$1;$1=\"\"}1'   |\\\n    sed -e 's/^[[:space:]]*//'  |\\\n    sed -e 's/[[:space:]]/\\t/g' |\\\n    awk '{print $1\"\\t\"$2\"\\t\"$3\"\\t\"$1\":\"$2\"-\"$3\"\\t\"$4\"\\t\"\".\"}'\n\n\nchr1    14145   14485   chr1:14145-14485    2   .\nchr1    14243   14498   chr1:14243-14498    1   .\nchr1    14454   14729   chr1:14454-14729    1   .\nchr1    14522   14725   chr1:14522-14725    1   .\nchr1    14599   14850   chr1:14599-14850    1   .\nchr1    14659   14864   chr1:14659-14864    2   .\nchr1    14781   15268   chr1:14781-15268    1   .\nchr1    15172   15659   chr1:15172-15659    1   ."
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#execute",
    "href": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#execute",
    "title": "Prepare STARR-seq data 032",
    "section": "Execute",
    "text": "Execute\nRun: Loop each fragment file and output fragment counts\n\n\nCode\nFD_INP=${FD_DAT}/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments\nFD_OUT=${FD_RES}/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts\n\nFN_INPS=(\n    K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\n    K562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\n    K562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\n)\n\nFN_OUTS=(\n    ASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz\n    ASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz\n)\n\n\n\n\nCode\nfor idx in \"${!FN_INPS[@]}\"; do\n    FN_INP=${FN_INPS[idx]}\n    FN_OUT=${FN_OUTS[idx]}\n    FN_LOG=fragment_count.${FN_INP}.txt\n    \n    FP_INP=${FD_INP}/${FN_INP}\n    FP_OUT=${FD_OUT}/${FN_OUT}\n    FP_LOG=${FD_LOG}/${FN_LOG}\n    \n    echo \"Calculate fragment counts...\"\n    echo ${FN_INP}\n    echo ${FN_OUT}\n    echo ${FN_LOG}\n    \n    sbatch -p ${NODE} \\\n        --exclude=dl-01   \\\n        --cpus-per-task 4 \\\n        --mem 4G \\\n        --output ${FP_LOG} \\\n        --export=FD_PRJ=${FD_PRJ},FP_INP=${FP_INP},FP_OUT=${FP_OUT} \\\n        &lt;&lt;'EOF'\n#!/bin/bash\n### set environment\nsource ${FD_PRJ}/scripts/config_project.sh\n\n### print start message\ntimer_start=`date +%s`\necho \"Hostname:          \" $(hostname)\necho \"Slurm Array Index: \" ${SLURM_ARRAY_TASK_ID}\necho \"Time Stamp:        \" $(date +\"%m-%d-%y+%T\")\necho\n\n### show input file\necho \"Input: \" ${FP_INP}\necho\necho \"show first few lines of input\"\nfun_cat ${FP_INP} | head\necho\n\n### execute\ncat ${FP_INP} |\\\n    sort -k 1,1 -k2,2n |\\\n    uniq -c |\\\n    awk '{$(NF+1)=$1;$1=\"\"}1'   |\\\n    sed -e 's/^[[:space:]]*//'  |\\\n    sed -e 's/[[:space:]]/\\t/g' |\\\n    awk '{print $1\"\\t\"$2\"\\t\"$3\"\\t\"$1\":\"$2\"-\"$3\"\\t\"$4\"\\t\"\".\"}' |\\\n    gzip -c &gt; ${FP_OUT}\n\n### show output file\necho \"Output: \" ${FP_OUT}\necho\necho \"show first few lines of output\"\nfun_cat ${FP_OUT} | head\necho\n\n### print end message\ntimer=`date +%s`\nruntime=$(echo \"${timer} - ${timer_start}\" | bc -l)\necho\necho 'Done!'\necho \"Run Time: $(displaytime ${runtime})\"\nEOF\n    echo\ndone\n\n\nCalculate fragment counts...\nK562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\nASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz\nfragment_count.K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe.txt\nSubmitted batch job 30757862\n\nCalculate fragment counts...\nK562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\nASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz\nfragment_count.K562_ASTARR_repeat_rep2.f3q10.fragments.bedpe.txt\nSubmitted batch job 30757863\n\nCalculate fragment counts...\nK562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\nASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz\nfragment_count.K562_ASTARR_repeat_rep3.f3q10.fragments.bedpe.txt\nSubmitted batch job 30757864"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#review",
    "href": "notebooks/01_prepare_fcc/fcc_032_prepare_data_STARR_TR_KS274_SH.html#review",
    "title": "Prepare STARR-seq data 032",
    "section": "Review",
    "text": "Review\nCheck results\n\n\nCode\ncat ${FD_LOG}/fragment_count.K562_ASTARR_repeat_rep3.f3q10.fragments.bedpe.txt\n\n\nHostname:           x2-02-3.genome.duke.edu\nSlurm Array Index: \nTime Stamp:         04-09-24+17:31:02\n\nInput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments/K562_ASTARR_repeat_rep3.f3q10.fragments.bedpe\n\nshow first few lines of input\nchr1    10421   10570\nchr1    13044   13243\nchr1    13044   13243\nchr1    13303   13459\nchr1    13483   13661\nchr1    14091   14513\nchr1    14129   14468\nchr1    14191   14755\nchr1    14231   14498\nchr1    14449   14971\n\nOutput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts/ASTARRseq_K562_KS274.hg38.Output.rep3.WGS.unstranded.bed.gz\n\nshow first few lines of output\nchr1    10421   10570   chr1:10421-10570    1   .\nchr1    13044   13243   chr1:13044-13243    2   .\nchr1    13303   13459   chr1:13303-13459    1   .\nchr1    13483   13661   chr1:13483-13661    1   .\nchr1    14091   14513   chr1:14091-14513    1   .\nchr1    14129   14468   chr1:14129-14468    1   .\nchr1    14191   14755   chr1:14191-14755    1   .\nchr1    14231   14498   chr1:14231-14498    1   .\nchr1    14449   14971   chr1:14449-14971    1   .\nchr1    14452   14620   chr1:14452-14620    1   .\n\n\nDone!\nRun Time: 23 minutes and 2 seconds\n\n\n\n\nCode\ncat ${FD_LOG}/fragment_count.K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe.txt\n\n\nHostname:           x2-02-3.genome.duke.edu\nSlurm Array Index: \nTime Stamp:         04-09-24+17:31:01\n\nInput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments/K562_ASTARR_repeat_rep1.f3q10.fragments.bedpe\n\nshow first few lines of input\nchr1    14145   14485\nchr1    14145   14485\nchr1    14243   14498\nchr1    14454   14729\nchr1    14522   14725\nchr1    14599   14850\nchr1    14659   14864\nchr1    14659   14864\nchr1    14781   15268\nchr1    15172   15659\n\nOutput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts/ASTARRseq_K562_KS274.hg38.Output.rep1.WGS.unstranded.bed.gz\n\nshow first few lines of output\nchr1    14145   14485   chr1:14145-14485    2   .\nchr1    14243   14498   chr1:14243-14498    1   .\nchr1    14454   14729   chr1:14454-14729    1   .\nchr1    14522   14725   chr1:14522-14725    1   .\nchr1    14599   14850   chr1:14599-14850    1   .\nchr1    14659   14864   chr1:14659-14864    2   .\nchr1    14781   15268   chr1:14781-15268    1   .\nchr1    15172   15659   chr1:15172-15659    1   .\nchr1    15503   15729   chr1:15503-15729    3   .\nchr1    15508   15711   chr1:15508-15711    4   .\n\n\nDone!\nRun Time: 25 minutes and 30 seconds\n\n\n\n\nCode\ncat ${FD_LOG}/fragment_count.K562_ASTARR_repeat_rep2.f3q10.fragments.bedpe.txt\n\n\nHostname:           x2-02-3.genome.duke.edu\nSlurm Array Index: \nTime Stamp:         04-09-24+17:31:02\n\nInput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/STARR_ATAC_K562_Reddy_KS274_240311/fragments/K562_ASTARR_repeat_rep2.f3q10.fragments.bedpe\n\nshow first few lines of input\nchr1    13055   13163\nchr1    13236   13481\nchr1    13253   13495\nchr1    13261   13479\nchr1    13314   13500\nchr1    14449   14642\nchr1    14449   14645\nchr1    14449   14645\nchr1    14452   14620\nchr1    14452   14679\n\nOutput:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results/assay_fcc/STARR_ATAC_K562_Reddy_KS274/fragment_counts/ASTARRseq_K562_KS274.hg38.Output.rep2.WGS.unstranded.bed.gz\n\nshow first few lines of output\nchr1    13055   13163   chr1:13055-13163    1   .\nchr1    13236   13481   chr1:13236-13481    1   .\nchr1    13253   13495   chr1:13253-13495    1   .\nchr1    13261   13479   chr1:13261-13479    1   .\nchr1    13314   13500   chr1:13314-13500    1   .\nchr1    14449   14642   chr1:14449-14642    1   .\nchr1    14449   14645   chr1:14449-14645    2   .\nchr1    14452   14620   chr1:14452-14620    1   .\nchr1    14452   14679   chr1:14452-14679    1   .\nchr1    14482   14709   chr1:14482-14709    1   .\n\n\nDone!\nRun Time: 20 minutes and 52 seconds"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html",
    "title": "Prepare Tiling MPRA data 01",
    "section": "",
    "text": "In this analysis, we are using the unnormalized and normalized MPRA data processed and shared by Hannah from the Tewhey lab.\nSet environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#check-data",
    "href": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#check-data",
    "title": "Prepare Tiling MPRA data 01",
    "section": "Check data",
    "text": "Check data\n\n\nCode\nls -d ${FD_DAT}/processed/MPRA_Tiling*\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/MPRA_Tiling_K562_Tewhey_Hannah\n\n\n\n\nCode\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_Hannah\nFNAME=tiling_counts.tar.gz\nFPATH=${FDIRY}/${FNAME}\n\nls ${FPATH} | xargs -n 1 basename\n\n\ntiling_counts.tar.gz"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#extract-data",
    "href": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#extract-data",
    "title": "Prepare Tiling MPRA data 01",
    "section": "Extract data",
    "text": "Extract data\n\n\nCode\nFDIRY=${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_Hannah\nFNAME=tiling_counts.tar.gz\nFPATH=${FDIRY}/${FNAME}\n\ntar -xf ${FPATH} -C ${FDIRY}"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#check-results",
    "href": "notebooks/01_prepare_fcc/fcc_11_acquire_data_TMPRA_Hannah_SH.html#check-results",
    "title": "Prepare Tiling MPRA data 01",
    "section": "Check results",
    "text": "Check results\n\n\nCode\nls -1 ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_Hannah\n\n\ntiling_counts\ntiling_counts.tar.gz\n\n\n\n\nCode\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_Hannah/tiling_counts\n\n\nFADS_tile_snp.20190214.attributes\nOL13_20220512_counts.out\nOL13_20220512_normalized_counts.out\nOL43_20211228_counts.out\nOL43_20211228_normalized_counts.out\nOL43_20221003_counts.out\nOL43_20221003_K562_normalized_counts.out\nOL43.attributes\nOL43_K562.bed\nOL45_20220927_counts.out\nOL45_20220927_K562_normalized_counts.out\nOL45.attributes\nOL45_K562.bed\nUKBB_GTEx\n\n\n\n\nCode\nls ${FD_DAT}/processed/MPRA_Tiling_K562_Tewhey_Hannah/tiling_counts/UKBB_GTEx\n\n\nOL27_20221220_K562_normalized_counts.out\nOL28_20221220_K562_normalized_counts.out\nOL29_20221220_K562_normalized_counts.out\nOL30_20221220_K562_normalized_counts.out\nOL31_20221220_K562_normalized_counts.out\nOL32_20221220_K562_normalized_counts.out\nOL33_20221220_K562_normalized_counts.out\nOL41_20221220_SKNSH_normalized_counts.out\nOL41_42_20221220_K562_normalized_counts.out\nOL41B_20221220_HepG2_normalized_counts.out\nOL42_20221220_HepG2_normalized_counts.out"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html",
    "title": "Prepare Tiling MPRA data 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references\nCode\nTXT_ASSAY = \"MPRA_Tiling_K562_Tewhey_Hannah\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#import-data",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#import-data",
    "title": "Prepare Tiling MPRA data 03",
    "section": "Import data",
    "text": "Import data\n&lt;Data&gt;\n* OL13 (FADS)\n* OL43 (GATA/MYC)\n* OL45 (HBE1/LMO2/RBM38/HBA2/BCL11A)\n\n- OL13_20220512_counts.out\n- OL13_20220512_normalized_counts.out\n- OL43_20211228_counts.out      \n- OL43_20211228_normalized_counts.out\n- OL43_20221003_counts.out \n- OL43_20221003_K562_normalized_counts.out\n- OL45_20220927_counts.out \n- OL45_20220927_K562_normalized_counts.out\nCheck data\n\n\nCode\nfdiry = file.path(FD_DAT, \"processed\", TXT_ASSAY, \"tiling_counts\")\nprint(dir(fdiry))\n\n\n [1] \"FADS_tile_snp.20190214.attributes\"       \n [2] \"OL13_20220512_counts.out\"                \n [3] \"OL13_20220512_normalized_counts.out\"     \n [4] \"OL43_20211228_counts.out\"                \n [5] \"OL43_20211228_normalized_counts.out\"     \n [6] \"OL43_20221003_counts.out\"                \n [7] \"OL43_20221003_K562_normalized_counts.out\"\n [8] \"OL43_K562.bed\"                           \n [9] \"OL43.attributes\"                         \n[10] \"OL45_20220927_counts.out\"                \n[11] \"OL45_20220927_K562_normalized_counts.out\"\n[12] \"OL45_K562.bed\"                           \n[13] \"OL45.attributes\"                         \n[14] \"UKBB_GTEx\"                               \n\n\n\n\nCode\nfdiry = file.path(FD_DAT, \"processed\", TXT_ASSAY, \"tiling_counts\")\nfpaths = dir(fdiry)\nprint(grep(\"out\", fpaths, value=TRUE))\n\n\n[1] \"OL13_20220512_counts.out\"                \n[2] \"OL13_20220512_normalized_counts.out\"     \n[3] \"OL43_20211228_counts.out\"                \n[4] \"OL43_20211228_normalized_counts.out\"     \n[5] \"OL43_20221003_counts.out\"                \n[6] \"OL43_20221003_K562_normalized_counts.out\"\n[7] \"OL45_20220927_counts.out\"                \n[8] \"OL45_20220927_K562_normalized_counts.out\"\n\n\nSetup metadata\n\n\nCode\ndat_meta = data.frame(\n    Dataset = c(\n        \"OL13_20220512\", \"OL13_20220512\", \n        \"OL43_20221003\", \"OL43_20221003\", \n        \"OL45_20220927\", \"OL45_20220927\"),\n    Process = c(\"raw\", \"norm\", \"raw\", \"norm\", \"raw\", \"norm\"),\n    Genome  = c(\"hg19\", \"hg19\", \"hg38\", \"hg38\", \"hg38\", \"hg38\"),\n    N_Rep_Input  = c(4, 4, 6, 6, 4, 4),  \n    N_Rep_Output = c(4, 4, 5, 5, 4, 4), \n    FName = c(\n        \"OL13_20220512_counts.out\",\n        \"OL13_20220512_normalized_counts.out\",\n        \"OL43_20221003_counts.out\",\n        \"OL43_20221003_K562_normalized_counts.out\",\n        \"OL45_20220927_counts.out\",\n        \"OL45_20220927_K562_normalized_counts.out\")\n)\ndat_meta\n\n\n\nA data.frame: 6 × 6\n\n\nDataset\nProcess\nGenome\nN_Rep_Input\nN_Rep_Output\nFName\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n\n\n\n\nOL13_20220512\nraw\nhg19\n4\n4\nOL13_20220512_counts.out\n\n\nOL13_20220512\nnorm\nhg19\n4\n4\nOL13_20220512_normalized_counts.out\n\n\nOL43_20221003\nraw\nhg38\n6\n5\nOL43_20221003_counts.out\n\n\nOL43_20221003\nnorm\nhg38\n6\n5\nOL43_20221003_K562_normalized_counts.out\n\n\nOL45_20220927\nraw\nhg38\n4\n4\nOL45_20220927_counts.out\n\n\nOL45_20220927\nnorm\nhg38\n4\n4\nOL45_20220927_K562_normalized_counts.out\n\n\n\n\n\nRead data\n\n\nCode\nlst_dat_read = lapply(1:nrow(dat_meta), function(idx){\n\n    ### Extract data info from the metadata table\n    xrow  = dat_meta[idx,]\n    fname = xrow$FName\n    n_rep_input  = xrow$N_Rep_Input\n    n_rep_output = xrow$N_Rep_Output\n    \n    ### Set file directory\n    fdiry = file.path(FD_DAT, \"processed\", TXT_ASSAY, \"tiling_counts\")\n    fpath = file.path(fdiry, fname)\n          \n    ### import data\n    dat = read.table(fpath, row.names=1)\n    dat = dat %&gt;% rownames_to_column(var = \"Name\")\n\n    ### rename columns & assign\n    cnames = c(\n        \"Name\", \n        paste0(\"Input.rep\",  1:n_rep_input), \n        paste0(\"Output.rep\", 1:n_rep_output)\n    )\n    colnames(dat) = cnames\n    \n    ### show progress and return\n    cat(\"\\n=======================\\n\")\n    cat(fname, \"\\n\")\n    cat(\"Shape:\", dim(dat), \"\\n\")\n    print(head(dat, 3))\n    flush.console()\n    return(dat)\n})\n\nnames(lst_dat_read) = paste(\n    paste(\"TMPRA_K562\", dat_meta$Dataset, sep=\"_\"), \n    dat_meta$Genome, \n    dat_meta$Process, sep=\".\")\n\n\n\n=======================\nOL13_20220512_counts.out \nShape: 55229 9 \n                                               Name Input.rep1 Input.rep2\n1       (11:61555216-61555415;11:61555315:T:C_A_wC)       1609       1221\n2 (11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)       1179        582\n3 (11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)       1066        643\n  Input.rep3 Input.rep4 Output.rep1 Output.rep2 Output.rep3 Output.rep4\n1       1396        798         845         283         574        1223\n2       1225        721         476         416         912         956\n3       1206        681         470         846         540         847\n\n=======================\nOL13_20220512_normalized_counts.out \nShape: 55229 9 \n                                               Name Input.rep1 Input.rep2\n1       (11:61555216-61555415;11:61555315:T:C_A_wC)   881.8510  1196.3976\n2 (11:61555231-61555430_RC;11:61555330:T:C_A_wC_RC)   646.1792   570.2730\n3 (11:61555315:T:C_A_wC_RC;11:61555216-61555415_RC)   584.2468   630.0439\n  Input.rep3 Input.rep4 Output.rep1 Output.rep2 Output.rep3 Output.rep4\n1   855.5317   774.9257    1807.947    569.6449    730.4747    1493.445\n2   750.7352   700.1522    1018.441    837.3579   1160.6148    1167.403\n3   739.0912   661.3088    1005.604   1702.8961    687.2061    1034.299\n\n=======================\nOL43_20221003_counts.out \nShape: 99307 12 \n                                                     Name Input.rep1 Input.rep2\n1           (8:127381651-127381850;8:127320401-127320600)       1318       1810\n2 (8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC)        634        730\n3 (8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC)        416        432\n  Input.rep3 Input.rep4 Input.rep5 Input.rep6 Output.rep1 Output.rep2\n1       1477       1505        738        687         620         636\n2        698        761        316        343         158         194\n3        418        409        181        211       11164        6818\n  Output.rep3 Output.rep4 Output.rep5\n1         781         520         538\n2         268         141         251\n3       12118        9512       10450\n\n=======================\nOL43_20221003_K562_normalized_counts.out \nShape: 99307 12 \n                                                     Name Input.rep1 Input.rep2\n1           (8:127381651-127381850;8:127320401-127320600)   887.4466  1078.7715\n2 (8:127742001-127742200;Nadav:negCtrl:seq31776.neg1.MYC)   426.8901   435.0846\n3 (8:128045001-128045200;Nadav:posCtrl:seq31797.pos5.MYC)   280.1045   257.4747\n  Input.rep3 Input.rep4 Input.rep5 Input.rep6 Output.rep1 Output.rep2\n1   946.8314   945.7219   962.3235   893.9085    961.7725   1136.6673\n2   447.4531   478.2022   412.0518   446.3037    245.0969    346.7193\n3   267.9590   257.0101   236.0170   274.5483  17318.1102  12185.2169\n  Output.rep3 Output.rep4 Output.rep5\n1    842.9706    896.6654    760.1443\n2    289.2652    243.1343    354.6398\n3  13079.5358  16402.0789  14764.8855\n\n=======================\nOL45_20220927_counts.out \nShape: 94381 9 \n                                                                  Name\n1 (Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270\n2                                                  1:10437778:C:T:R:wC\n3                                                  1:10451799:C:T:R:wC\n  Input.rep1 Input.rep2 Input.rep3 Input.rep4 Output.rep1 Output.rep2\n1        897        717        761        724       56816       37391\n2        645        437        491        493        2239        1698\n3        603        584        512        429         336         280\n  Output.rep3 Output.rep4\n1       36946       52349\n2        1202        2532\n3         321         333\n\n=======================\nOL45_20220927_K562_normalized_counts.out \nShape: 94381 9 \n                                                                  Name\n1 (Nadav:posCtrl:seq33763.pos1.GATA1;Nadav:posCtrl:ENSG00000102317.270\n2                                                  1:10437778:C:T:R:wC\n3                                                  1:10451799:C:T:R:wC\n  Input.rep1 Input.rep2 Input.rep3 Input.rep4 Output.rep1 Output.rep2\n1   660.3527   622.9447   644.2283   623.2888  69961.0133  56175.0918\n2   474.8355   379.6748   415.6585   424.4218   2757.0175   2551.0231\n3   443.9160   507.3915   433.4361   369.3244    413.7373    420.6634\n  Output.rep3 Output.rep4\n1  62517.7362  58457.7541\n2   2033.9501   2827.4663\n3    543.1763    371.8587"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#preprocess-the-table-extract-only-tiling-regions",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#preprocess-the-table-extract-only-tiling-regions",
    "title": "Prepare Tiling MPRA data 03",
    "section": "Preprocess the table: Extract only tiling regions",
    "text": "Preprocess the table: Extract only tiling regions\nDefine helper functions for data processing\n\n\nCode\nget_strand = function(x){ifelse(is.na(x), \"+\", \"-\")}\nadd_chrom  = function(x){ifelse(str_detect(x, \"chr\"), x, paste0(\"chr\", x))}\n\nfun_extract   = function(dat) {\n    ### Input:  dataframe\n    ### Output: dataframe\n    ### Description:\n    ###     Preprocess the raw dataframe\n    ###     - expand duplicates\n    ###     - filter and extract only tiling oligos\n    ###     - get location information\n    ### ===========================================\n    ### init regex pattern\n    pattern = \"^[chr|0-9|X]+:[0-9]*-[0-9]*\"\n    \n    ### preprocess\n    res = dat %&gt;% \n        dplyr::mutate(Name = gsub(\"\\\\(|\\\\)\", \"\", Name)) %&gt;% \n        tidyr::separate_rows(Name, sep=\";\") %&gt;%\n        dplyr::filter(!grepl(pattern = \"Nadav\", Name)) %&gt;%\n        dplyr::filter(str_detect(string=Name, pattern=pattern)) %&gt;%\n        tidyr::separate(Name, c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Strand\"), remove=FALSE, fill=\"right\") %&gt;%\n        dplyr::mutate(\n            Chrom      = add_chrom(Chrom),\n            ChromStart = as.integer(ChromStart),\n            ChromEnd   = as.integer(ChromEnd),\n            Name       = add_chrom(Name),\n            Strand     = get_strand(Strand))\n    return(res)\n}\n\n\nApply processing functions\n\n\nCode\n### init\nlst = lst_dat_read\n\n### before preprocessed\nprint(lapply(lst, dim))\ncat(\"++++++++++++++++++++++++++++++++++++++++\\n\")\n\n### after proprocessed\nlst = lapply(lst, fun_extract)\nlst_dat_extract = lst\nprint(lapply(lst, dim))\n\n\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 55229     9\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 55229     9\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 99307    12\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 99307    12\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 94381     9\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 94381     9\n\n++++++++++++++++++++++++++++++++++++++++\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43907    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43907    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96108    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96108    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 91110    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 91110    13\n\n\n\nShow results\n\n\nCode\nset.seed(123)\nlst = lst_dat_extract\nlapply(lst, slice_sample, n=3)\n\n\n\n    $TMPRA_K562_OL13_20220512.hg19.raw\n        \n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61559376-61559575_RC\nchr11\n61559376\n61559575\n-\n363\n256\n368\n252\n0\n32\n0\n37\n\n\nchr11:61628981-61629180_RC\nchr11\n61628981\n61629180\n-\n823\n497\n638\n344\n78\n300\n263\n298\n\n\nchr11:61628421-61628620\nchr11\n61628421\n61628620\n+\n400\n378\n637\n250\n138\n165\n295\n236\n\n\n\n\n\n    $TMPRA_K562_OL13_20220512.hg19.norm\n        \n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:61648876-61649075_RC\nchr11\n61648876\n61649075\n-\n303.0849\n283.1768\n304.58401\n238.8869\n179.7249\n181.1592\n0.0000\n363.8974\n\n\nchr11:61558796-61558995\nchr11\n61558796\n61558995\n+\n488.8819\n550.6760\n591.39550\n539.9232\n842.9954\n215.3781\n674.4801\n461.5880\n\n\nchr11:61652526-61652725\nchr11\n61652526\n61652725\n+\n118.9320\n117.5821\n86.41116\n140.8073\n0.0000\n255.6357\n442.8662\n124.5555\n\n\n\n\n\n    $TMPRA_K562_OL43_20221003.hg38.raw\n        \n\nA tibble: 3 × 16\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr8:127212351-127212550\nchr8\n127212351\n127212550\n+\n498\n576\n544\n596\n231\n270\n228\n201\n369\n182\n251\n\n\nchrX:48539581-48539780\nchrX\n48539581\n48539780\n+\n271\n290\n221\n253\n108\n139\n15877\n10329\n17175\n14124\n14530\n\n\nchrX:48294251-48294450\nchrX\n48294251\n48294450\n+\n181\n221\n277\n253\n96\n106\n38\n73\n128\n74\n105\n\n\n\n\n\n    $TMPRA_K562_OL43_20221003.hg38.norm\n        \n\nA tibble: 3 × 16\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr8:127441201-127441400\nchr8\n127441201\n127441400\n+\n233.6449\n222.3104\n171.1604\n221.1921\n215.1536\n252.4283\n228.0332\n121.5305\n212.6315\n184.5061\n156.8328\n\n\nchr8:127491151-127491350\nchr8\n127491151\n127491350\n+\n438.3367\n409.4564\n412.1954\n390.8565\n355.9815\n352.6189\n642.2158\n616.5884\n457.6434\n496.6147\n508.6468\n\n\nchr8:128028501-128028700\nchr8\n128028501\n128028700\n+\n1120.4181\n1169.3644\n1135.3002\n1182.6237\n1090.1117\n1122.9157\n1002.1049\n886.4576\n943.3499\n1046.6844\n916.9771\n\n\n\n\n\n    $TMPRA_K562_OL45_20220927.hg38.raw\n        \n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr20:58250701-58250900\nchr20\n58250701\n58250900\n+\n225\n216\n217\n192\n120\n105\n121\n98\n\n\nchr11:33783701-33783900\nchr11\n33783701\n33783900\n+\n786\n596\n647\n773\n2050\n1933\n1917\n2263\n\n\nchr11:5570301-5570500\nchr11\n5570301\n5570500\n+\n294\n254\n226\n187\n158\n137\n110\n250\n\n\n\n\n\n    $TMPRA_K562_OL45_20220927.hg38.norm\n        \n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr2:60047901-60048100\nchr2\n60047901\n60048100\n+\n635.3226\n677.6804\n700.1009\n686.1342\n446.9841\n381.6018\n419.6503\n503.62848\n\n\nchr11:33672501-33672700\nchr11\n33672501\n33672700\n+\n711.1490\n671.5987\n617.9851\n668.9163\n507.3208\n438.6918\n417.9581\n714.68343\n\n\nchr11:34229601-34229800\nchr11\n34229601\n34229800\n+\n128.8313\n118.1597\n126.1367\n141.1870\n155.1515\n174.2748\n135.3711\n92.68551\n\n\n\n\n\n\n\n\n\n\nCode\nlst = lst_dat_extract\nlapply(lst, function(dat){table(dat$Chrom)})\n\n\n$TMPRA_K562_OL13_20220512.hg19.raw\n\nchr11 \n43907 \n\n$TMPRA_K562_OL13_20220512.hg19.norm\n\nchr11 \n43907 \n\n$TMPRA_K562_OL43_20221003.hg38.raw\n\n chr8  chrX \n41905 54203 \n\n$TMPRA_K562_OL43_20221003.hg38.norm\n\n chr8  chrX \n41905 54203 \n\n$TMPRA_K562_OL45_20220927.hg38.raw\n\nchr11 chr16  chr2 chr20 \n39857 11439 19917 19897 \n\n$TMPRA_K562_OL45_20220927.hg38.norm\n\nchr11 chr16  chr2 chr20 \n39857 11439 19917 19897"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#filter-out-the-fragments-oligos-where-mean-input-is-zero",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#filter-out-the-fragments-oligos-where-mean-input-is-zero",
    "title": "Prepare Tiling MPRA data 03",
    "section": "Filter out the fragments (Oligos) where mean input is zero",
    "text": "Filter out the fragments (Oligos) where mean input is zero\nDefine helper functions\n\n\nCode\nfun_filter = function(dat){\n    ### Input:  dataframe\n    ### Output: dataframe\n    ### Description:\n    ###     calculate the mean of input for each fragment and \n    ###     filter out the fragment w/ plasmid mean is zero\n    ###     - convert wide matrix to long matrix\n    ###     - group by the input and output to calculate the mean\n    ###     - get the non-zero fragments from the input dataframe\n    \n    ### calculate the mean of input for each fragment and \n    tmp = dat %&gt;% \n        tidyr::gather(Sample, Value, -Chrom, -ChromStart, -ChromEnd, -Name, -Strand) %&gt;% \n        tidyr::separate(Sample, c(\"Group\", \"Rep\"), sep=\"\\\\.\", remove=FALSE) %&gt;%\n        dplyr::filter(Group == \"Input\") %&gt;%\n        dplyr::group_by(Chrom, ChromStart, ChromEnd, Name, Strand, Group) %&gt;%\n        dplyr::summarise(Value = mean(Value), .groups=\"drop\")\n    \n    ### filter out the fragment w/ plasmid mean is zero\n    tmp = tmp %&gt;% dplyr::filter(Value &gt; 0)\n    idx = unique(tmp$Name)\n    res = dat %&gt;% dplyr::filter(Name %in% idx)\n    return(res)\n}\n\n\nFilter fragments\n\n\nCode\n### init\nlst = lst_dat_extract\n\n### show info before processing\nprint(lapply(lst, dim))\ncat(\"++++++++++++++++++++++++++++++++++++++++\\n\")\n\n### processing\nlst = lapply(lst, fun_filter)\n\n### assign and show info\nlst_dat_filter = lst\nprint(lapply(lst, dim))\n\n\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43907    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43907    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96108    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96108    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 91110    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 91110    13\n\n++++++++++++++++++++++++++++++++++++++++\n$TMPRA_K562_OL13_20220512.hg19.raw\n[1] 43871    13\n\n$TMPRA_K562_OL13_20220512.hg19.norm\n[1] 43871    13\n\n$TMPRA_K562_OL43_20221003.hg38.raw\n[1] 96087    16\n\n$TMPRA_K562_OL43_20221003.hg38.norm\n[1] 96087    16\n\n$TMPRA_K562_OL45_20220927.hg38.raw\n[1] 91092    13\n\n$TMPRA_K562_OL45_20220927.hg38.norm\n[1] 91092    13\n\n\n\nShow results\n\n\nCode\nlst = lst_dat_filter\ndat = lst[[1]]\nhead(dat, 3)\n\n\n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n1609\n1221\n1396\n798\n845\n283\n574\n1223\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n1179\n582\n1225\n721\n476\n416\n912\n956\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n1066\n643\n1206\n681\n470\n846\n540\n847"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#calculate-mean-for-normalized-count-table",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#calculate-mean-for-normalized-count-table",
    "title": "Prepare Tiling MPRA data 03",
    "section": "Calculate mean for normalized count table",
    "text": "Calculate mean for normalized count table\nDefine helper functions\n\n\nCode\nfun_add_mean_column = function(dat){\n    ### get input and output to calculate log2FC\n    x_inp = dat %&gt;% dplyr::select(starts_with(\"Input\"))  %&gt;% apply(., 1, mean)\n    x_out = dat %&gt;% dplyr::select(starts_with(\"Output\")) %&gt;% apply(., 1, mean)\n    x_lfc = log2(x_out) - log2(x_inp)\n    \n    ### add columns\n    dat$Input.mean  = x_inp\n    dat$Output.mean = x_out\n    dat$Log2FC.mean = x_lfc\n \n    return(dat)\n}\n\n\nCalculate mean and add it as an additional column for normalized count\n\n\nCode\nlst = lst_dat_filter\nprint(names(lst))\ncat(\"=======================\\n\")\nsid = grep(\"norm\", names(lst), value=TRUE)\nprint(sid)\n\n\n[1] \"TMPRA_K562_OL13_20220512.hg19.raw\"  \"TMPRA_K562_OL13_20220512.hg19.norm\"\n[3] \"TMPRA_K562_OL43_20221003.hg38.raw\"  \"TMPRA_K562_OL43_20221003.hg38.norm\"\n[5] \"TMPRA_K562_OL45_20220927.hg38.raw\"  \"TMPRA_K562_OL45_20220927.hg38.norm\"\n=======================\n[1] \"TMPRA_K562_OL13_20220512.hg19.norm\" \"TMPRA_K562_OL43_20221003.hg38.norm\"\n[3] \"TMPRA_K562_OL45_20220927.hg38.norm\"\n\n\n\n\nCode\n### init\nlst  = lst_dat_filter\nidxs = grep(\"norm\", names(lst), value=TRUE)\n\n### add mean for normalization count\nfor (idx in idxs){\n    cat(idx, \"\\n\")\n    lst[[idx]] = fun_add_mean_column(lst[[idx]])\n}\n\n### assigned\nlst_dat_prep = lst\n\n\nTMPRA_K562_OL13_20220512.hg19.norm \nTMPRA_K562_OL43_20221003.hg38.norm \nTMPRA_K562_OL45_20220927.hg38.norm \n\n\nShow results\n\n\nCode\nlst = lst_dat_prep\nidx = names(lst)[1]\ndat = lst_dat_prep[[1]]\n\ncat(idx)\nhead(dat, 3)\n\n\nTMPRA_K562_OL13_20220512.hg19.raw\n\n\n\nA tibble: 3 × 13\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n1609\n1221\n1396\n798\n845\n283\n574\n1223\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n1179\n582\n1225\n721\n476\n416\n912\n956\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n1066\n643\n1206\n681\n470\n846\n540\n847\n\n\n\n\n\n\n\nCode\nlst = lst_dat_prep\nidx = names(lst)[2]\ndat = lst_dat_prep[[2]]\n\ncat(idx)\nhead(dat, 3)\n\n\nTMPRA_K562_OL13_20220512.hg19.norm\n\n\n\nA tibble: 3 × 16\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nInput.mean\nOutput.mean\nLog2FC.mean\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr11:61555216-61555415\nchr11\n61555216\n61555415\n+\n881.8510\n1196.3976\n855.5317\n774.9257\n1807.947\n569.6449\n730.4747\n1493.445\n927.1765\n1150.378\n0.3111919\n\n\nchr11:61555231-61555430_RC\nchr11\n61555231\n61555430\n-\n646.1792\n570.2730\n750.7352\n700.1522\n1018.441\n837.3579\n1160.6148\n1167.403\n666.8349\n1045.954\n0.6494180\n\n\nchr11:61555216-61555415_RC\nchr11\n61555216\n61555415\n-\n584.2468\n630.0439\n739.0912\n661.3088\n1005.604\n1702.8961\n687.2061\n1034.299\n653.6727\n1107.501\n0.7606680\n\n\n\n\n\n\n\nCode\nlst = lst_dat_prep\nidx = names(lst)[3]\ndat = lst_dat_prep[[3]]\n\ncat(idx)\nhead(dat, 3)\n\n\nTMPRA_K562_OL43_20221003.hg38.raw\n\n\n\nA tibble: 3 × 16\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;int&gt;\n\n\n\n\nchr8:127381651-127381850\nchr8\n127381651\n127381850\n+\n1318\n1810\n1477\n1505\n738\n687\n620\n636\n781\n520\n538\n\n\nchr8:127320401-127320600\nchr8\n127320401\n127320600\n+\n1318\n1810\n1477\n1505\n738\n687\n620\n636\n781\n520\n538\n\n\nchr8:127742001-127742200\nchr8\n127742001\n127742200\n+\n634\n730\n698\n761\n316\n343\n158\n194\n268\n141\n251\n\n\n\n\n\n\n\nCode\nlst = lst_dat_prep\nidx = names(lst)[4]\ndat = lst_dat_prep[[4]]\n\ncat(idx)\nhead(dat, 3)\n\n\nTMPRA_K562_OL43_20221003.hg38.norm\n\n\n\nA tibble: 3 × 19\n\n\nName\nChrom\nChromStart\nChromEnd\nStrand\nInput.rep1\nInput.rep2\nInput.rep3\nInput.rep4\nInput.rep5\nInput.rep6\nOutput.rep1\nOutput.rep2\nOutput.rep3\nOutput.rep4\nOutput.rep5\nInput.mean\nOutput.mean\nLog2FC.mean\n\n\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;int&gt;\n&lt;int&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr8:127381651-127381850\nchr8\n127381651\n127381850\n+\n887.4466\n1078.7715\n946.8314\n945.7219\n962.3235\n893.9085\n961.7725\n1136.6673\n842.9706\n896.6654\n760.1443\n952.5006\n919.6440\n-0.0506444\n\n\nchr8:127320401-127320600\nchr8\n127320401\n127320600\n+\n887.4466\n1078.7715\n946.8314\n945.7219\n962.3235\n893.9085\n961.7725\n1136.6673\n842.9706\n896.6654\n760.1443\n952.5006\n919.6440\n-0.0506444\n\n\nchr8:127742001-127742200\nchr8\n127742001\n127742200\n+\n426.8901\n435.0846\n447.4531\n478.2022\n412.0518\n446.3037\n245.0969\n346.7193\n289.2652\n243.1343\n354.6398\n440.9976\n295.7711\n-0.5762898"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#store-the-fragments-and-counts",
    "href": "notebooks/01_prepare_fcc/fcc_13_extract_fragment_counts_R.html#store-the-fragments-and-counts",
    "title": "Prepare Tiling MPRA data 03",
    "section": "Store the fragments and counts",
    "text": "Store the fragments and counts\n&lt;Data&gt;\n* OL13 (FADS)\n* OL43 (GATA/MYC)\n* OL45 (HBE1/LMO2/RBM38/HBA2/BCL11A)\n\n- OL13_20220512_counts.out\n- OL13_20220512_normalized_counts.out\n- OL43_20211228_counts.out      \n- OL43_20211228_normalized_counts.out\n- OL43_20221003_counts.out \n- OL43_20221003_K562_normalized_counts.out\n- OL45_20220927_counts.out \n- OL45_20220927_K562_normalized_counts.out\n\n&lt;Results&gt;\nPROJECT/results/assay_fcc\n└── MPRA_Tiling_K562_Tewhey_Hannah\n    ├── fragment_counts\n    │   └── summary\n    │       ├── TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \n    │       ├── TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \n    │       ├── TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \n    │       ├── TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \n    │       ├── TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \n    │       └── TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv \n    │\n    └── fragment\n        ├── TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz \n        ├── TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz \n        └── TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz \n\nSetup output directory\n\n\nCode\n### create fragment folder\ntxt_folder = \"fragment\"\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, txt_folder)\ncat(txt_fdiry, \"\\n\")\n\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### create fragment count folders\ntxt_folder = \"fragment_counts/summary\"\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, txt_folder)\ncat(txt_fdiry, \"\\n\")\n\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n\n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_Hannah/fragment \n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_Hannah/fragment_counts/summary \n\n\n\n\nCode\n### check loop names\nlst  = lst_dat_prep\nidxs = grep(\"raw\", names(lst), value=TRUE)\nfor (idx in idxs) {cat(idx, \"\\n\")}\n\n\nTMPRA_K562_OL13_20220512.hg19.raw \nTMPRA_K562_OL43_20221003.hg38.raw \nTMPRA_K562_OL45_20220927.hg38.raw \n\n\n\n\nStore fragments\n\n\nCode\ntxt_assay  = TXT_ASSAY\ntxt_folder = \"fragment\"\ntxt_strand = \"stranded_pos\"\n\nlst  = lst_dat_prep\nidxs = grep(\"raw\", names(lst), value=TRUE)\n\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ncat(\"Output directory:\", \"\\n\")\ncat(txt_fdiry, \"\\n\")\n\nfor (idx in idxs){\n    ### show progres\n    cat(\"\\n=======================\")\n    cat(\"\\nSample:\", idx, \"\\n\")\n    \n    ### init\n    dat = lst[[idx]]\n    \n    ### extract positive trands and order by positions\n    dat = dat %&gt;% \n        dplyr::filter(Strand == \"+\") %&gt;% \n        dplyr::arrange(Chrom, ChromStart, ChromEnd)\n    \n    ### arrange the column into bed file format\n    dat = dat %&gt;%\n        dplyr::mutate(Score = \".\") %&gt;%\n        dplyr::select(Chrom, ChromStart, ChromEnd, Name, Score, Strand)\n    \n    ### save table\n    txt_fname = paste(idx, txt_strand, \"bed.gz\", sep=\".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    write_tsv(dat, txt_fpath, col_names=FALSE)\n    \n    ### show progress\n    #print(fpath)\n    print(head(dat))\n    cat(\"\\nSaved Table:\", txt_fname, \"\\n\")\n}\n\n\nOutput directory: \n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_Hannah/fragment \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.raw \n# A tibble: 6 × 6\n  Chrom ChromStart ChromEnd Name                    Score Strand\n  &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt; \n1 chr11   61554801 61555000 chr11:61554801-61555000 .     +     \n2 chr11   61554806 61555005 chr11:61554806-61555005 .     +     \n3 chr11   61554811 61555010 chr11:61554811-61555010 .     +     \n4 chr11   61554816 61555015 chr11:61554816-61555015 .     +     \n5 chr11   61554821 61555020 chr11:61554821-61555020 .     +     \n6 chr11   61554826 61555025 chr11:61554826-61555025 .     +     \n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.raw \n# A tibble: 6 × 6\n  Chrom ChromStart  ChromEnd Name                     Score Strand\n  &lt;chr&gt;      &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt; \n1 chr8   126735901 126736100 chr8:126735901-126736100 .     +     \n2 chr8   126735951 126736150 chr8:126735951-126736150 .     +     \n3 chr8   126736001 126736200 chr8:126736001-126736200 .     +     \n4 chr8   126736051 126736250 chr8:126736051-126736250 .     +     \n5 chr8   126736101 126736300 chr8:126736101-126736300 .     +     \n6 chr8   126736151 126736350 chr8:126736151-126736350 .     +     \n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.raw \n# A tibble: 6 × 6\n  Chrom ChromStart ChromEnd Name                  Score Strand\n  &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt; &lt;chr&gt; \n1 chr11    4505501  4505700 chr11:4505501-4505700 .     +     \n2 chr11    4505601  4505800 chr11:4505601-4505800 .     +     \n3 chr11    4505701  4505900 chr11:4505701-4505900 .     +     \n4 chr11    4505801  4506000 chr11:4505801-4506000 .     +     \n5 chr11    4505901  4506100 chr11:4505901-4506100 .     +     \n6 chr11    4506001  4506200 chr11:4506001-4506200 .     +     \n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz \n\n\n\n\nStore table of counts\n\n\nCode\ntxt_assay  = TXT_ASSAY\ntxt_folder = \"fragment_counts/summary\"\ntxt_strand = \"stranded_pos\"\n\nlst  = lst_dat_prep\nidxs = names(lst)\n\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", txt_assay, txt_folder)\ncat(\"Output directory:\", \"\\n\")\ncat(txt_fdiry, \"\\n\")\n\nfor (idx in idxs){\n    ### show progres\n    cat(\"\\n=======================\")\n    cat(\"\\nSample:\", idx, \"\\n\")\n    \n    ### init\n    dat = lst[[idx]]\n    \n    ### extract positive trands and order by positions\n    dat = dat %&gt;% \n       dplyr::filter(Strand == \"+\") %&gt;% \n       dplyr::arrange(Chrom, ChromStart, ChromEnd)\n    \n    ### save table\n    txt_fname = paste(idx, txt_strand, \"tsv\", sep=\".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    write_tsv(dat, txt_fpath)\n\n    ### show progress\n    print(head(dat))\n    cat(\"\\nSaved Table:\", txt_fname, \"\\n\")\n}\n\n\nOutput directory: \n/mount/repo/Proj_ENCODE_FCC/results/assay_fcc/MPRA_Tiling_K562_Tewhey_Hannah/fragment_counts/summary \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.raw \n# A tibble: 6 × 13\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr11:61554… chr11   61554801 61555000 +             971        542        785\n2 chr11:61554… chr11   61554806 61555005 +            1267        562       1059\n3 chr11:61554… chr11   61554811 61555010 +            1183        641       1118\n4 chr11:61554… chr11   61554816 61555015 +            1020        476       1086\n5 chr11:61554… chr11   61554821 61555020 +            1138        580        894\n6 chr11:61554… chr11   61554826 61555025 +             702        406        745\n# ℹ 5 more variables: Input.rep4 &lt;int&gt;, Output.rep1 &lt;int&gt;, Output.rep2 &lt;int&gt;,\n#   Output.rep3 &lt;int&gt;, Output.rep4 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL13_20220512.hg19.norm \n# A tibble: 6 × 16\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr11:61554… chr11   61554801 61555000 +            532.       531.       481.\n2 chr11:61554… chr11   61554806 61555005 +            694.       551.       649.\n3 chr11:61554… chr11   61554811 61555010 +            648.       628.       685.\n4 chr11:61554… chr11   61554816 61555015 +            559.       466.       666.\n5 chr11:61554… chr11   61554821 61555020 +            624.       568.       548.\n6 chr11:61554… chr11   61554826 61555025 +            385.       398.       457.\n# ℹ 8 more variables: Input.rep4 &lt;dbl&gt;, Output.rep1 &lt;dbl&gt;, Output.rep2 &lt;dbl&gt;,\n#   Output.rep3 &lt;dbl&gt;, Output.rep4 &lt;dbl&gt;, Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;,\n#   Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL13_20220512.hg19.norm.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.raw \n# A tibble: 6 × 16\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr8:126735… chr8   126735901   1.27e8 +            1190       1409       1259\n2 chr8:126735… chr8   126735951   1.27e8 +             194        161        161\n3 chr8:126736… chr8   126736001   1.27e8 +             746        757        708\n4 chr8:126736… chr8   126736051   1.27e8 +             934       1056        988\n5 chr8:126736… chr8   126736101   1.27e8 +             697        887        772\n6 chr8:126736… chr8   126736151   1.27e8 +            1225       1454       1264\n# ℹ 8 more variables: Input.rep4 &lt;int&gt;, Input.rep5 &lt;int&gt;, Input.rep6 &lt;int&gt;,\n#   Output.rep1 &lt;int&gt;, Output.rep2 &lt;int&gt;, Output.rep3 &lt;int&gt;, Output.rep4 &lt;int&gt;,\n#   Output.rep5 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL43_20221003.hg38.norm \n# A tibble: 6 × 19\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr8:126735… chr8   126735901   1.27e8 +            801.      840.        807.\n2 chr8:126735… chr8   126735951   1.27e8 +            131.       96.0       103.\n3 chr8:126736… chr8   126736001   1.27e8 +            502.      451.        454.\n4 chr8:126736… chr8   126736051   1.27e8 +            629.      629.        633.\n5 chr8:126736… chr8   126736101   1.27e8 +            469.      529.        495.\n6 chr8:126736… chr8   126736151   1.27e8 +            825.      867.        810.\n# ℹ 11 more variables: Input.rep4 &lt;dbl&gt;, Input.rep5 &lt;dbl&gt;, Input.rep6 &lt;dbl&gt;,\n#   Output.rep1 &lt;dbl&gt;, Output.rep2 &lt;dbl&gt;, Output.rep3 &lt;dbl&gt;, Output.rep4 &lt;dbl&gt;,\n#   Output.rep5 &lt;dbl&gt;, Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;, Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL43_20221003.hg38.norm.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.raw \n# A tibble: 6 × 13\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;int&gt;      &lt;int&gt;\n1 chr11:45055… chr11    4505501  4505700 +             811        664        917\n2 chr11:45056… chr11    4505601  4505800 +             693        552        607\n3 chr11:45057… chr11    4505701  4505900 +             577        414        448\n4 chr11:45058… chr11    4505801  4506000 +             855        754        688\n5 chr11:45059… chr11    4505901  4506100 +             317        217        313\n6 chr11:45060… chr11    4506001  4506200 +             444        422        454\n# ℹ 5 more variables: Input.rep4 &lt;int&gt;, Output.rep1 &lt;int&gt;, Output.rep2 &lt;int&gt;,\n#   Output.rep3 &lt;int&gt;, Output.rep4 &lt;int&gt;\n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.tsv \n\n=======================\nSample: TMPRA_K562_OL45_20220927.hg38.norm \n# A tibble: 6 × 16\n  Name         Chrom ChromStart ChromEnd Strand Input.rep1 Input.rep2 Input.rep3\n  &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n1 chr11:45055… chr11    4505501  4505700 +            597.       577.       776.\n2 chr11:45056… chr11    4505601  4505800 +            510.       480.       514.\n3 chr11:45057… chr11    4505701  4505900 +            425.       360.       379.\n4 chr11:45058… chr11    4505801  4506000 +            629.       655.       582.\n5 chr11:45059… chr11    4505901  4506100 +            233.       189.       265.\n6 chr11:45060… chr11    4506001  4506200 +            327.       367.       384.\n# ℹ 8 more variables: Input.rep4 &lt;dbl&gt;, Output.rep1 &lt;dbl&gt;, Output.rep2 &lt;dbl&gt;,\n#   Output.rep3 &lt;dbl&gt;, Output.rep4 &lt;dbl&gt;, Input.mean &lt;dbl&gt;, Output.mean &lt;dbl&gt;,\n#   Log2FC.mean &lt;dbl&gt;\n\nSaved Table: TMPRA_K562_OL45_20220927.hg38.norm.stranded_pos.tsv"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_15_liftover_TMPRA_OL13_SH.html",
    "href": "notebooks/01_prepare_fcc/fcc_15_liftover_TMPRA_OL13_SH.html",
    "title": "Prepare Tiling MPRA data 05",
    "section": "",
    "text": "Set environment\n\n\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif\n\n\n\n\n\nCode\nTXT_ASSAY=MPRA_Tiling_K562_Tewhey_Hannah\n\n\nCheck data\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment\nFPATH=${FDIRY}/*hg19*\nbasename ${FPATH}\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz\n\n\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment_counts\nFPATHS=($(ls ${FDIRY}/*hg19*))\nbasename -a ${FPATHS[@]}\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz\n\n\nCheck script\n\n\nCode\n${FD_EXE}/run_liftOver.sh\n\n\nliftOver - Move annotations from one assembly to another\nusage:\n   liftOver oldFile map.chain newFile unMapped\noldFile and newFile are in bed format by default, but can be in GFF and\nmaybe eventually others with the appropriate flags below.\nThe map.chain file has the old genome as the target and the new genome\nas the query.\n\n***********************************************************************\nWARNING: liftOver was only designed to work between different\n         assemblies of the same organism. It may not do what you want\n         if you are lifting between different organisms. If there has\n         been a rearrangement in one of the species, the size of the\n         region being mapped may change dramatically after mapping.\n***********************************************************************\n\noptions:\n   -minMatch=0.N Minimum ratio of bases that must remap. Default 0.95\n   -gff  File is in gff/gtf format.  Note that the gff lines are converted\n         separately.  It would be good to have a separate check after this\n         that the lines that make up a gene model still make a plausible gene\n         after liftOver\n   -genePred - File is in genePred format\n   -sample - File is in sample format\n   -bedPlus=N - File is bed N+ format (i.e. first N fields conform to bed format)\n   -positions - File is in browser \"position\" format\n   -hasBin - File has bin value (used only with -bedPlus)\n   -tab - Separate by tabs rather than space (used only with -bedPlus)\n   -pslT - File is in psl format, map target side only\n   -ends=N - Lift the first and last N bases of each record and combine the\n             result. This is useful for lifting large regions like BAC end pairs.\n   -minBlocks=0.N Minimum ratio of alignment blocks or exons that must map\n                  (default 1.00)\n   -fudgeThick    (bed 12 or 12+ only) If thickStart/thickEnd is not mapped,\n                  use the closest mapped base.  Recommended if using \n                  -minBlocks.\n   -multiple               Allow multiple output regions\n   -noSerial               In -multiple mode, do not put a serial number in the 5th BED column\n   -minChainT, -minChainQ  Minimum chain size in target/query, when mapping\n                           to multiple output regions (default 0, 0)\n   -minSizeT               deprecated synonym for -minChainT (ENCODE compat.)\n   -minSizeQ               Min matching region size in query with -multiple.\n   -chainTable             Used with -multiple, format is db.tablename,\n                               to extend chains from net (preserves dups)\n   -errorHelp              Explain error messages\n\n\n\n: 255\n\n\nExecute: LiftOver fragment\nTest file IO\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment\n\nFP_INP=${FDIRY}/*hg19*\nFN_INP=$(basename ${FP_INP})\n\nFN_OUT_LIFTED=${FN_INP/hg19/hg38}\nFN_TMP_LIFTED=${FN_OUT_LIFTED%.*}\nFN_OUT_UNLIFT=${FN_INP/hg19/unlifted}\nFN_TMP_UNLIFT=${FN_OUT_UNLIFT%.*}\n\necho ${FN_INP}\necho ${FN_OUT_LIFTED}\necho ${FN_TMP_LIFTED}\necho ${FN_OUT_UNLIFT}\necho ${FN_TMP_UNLIFT}\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.stranded_pos.bed\n\n\nrun liftOver\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment\n\nFP_INP=${FDIRY}/*hg19*\nFN_INP=$(basename ${FP_INP})\n\nFN_OUT_LIFTED=${FN_INP/hg19/hg38}\nFN_OUT_UNLIFT=${FN_INP/hg19/unlifted}\n\n${FD_EXE}/run_liftOver.sh \\\n    -bedPlus=6 \\\n    ${FDIRY}/${FN_INP} \\\n    /data/reddylab/Reference_Data/Genomes/hg38/hg19ToHg38.over.chain \\\n    ${FDIRY}/${FN_TMP_LIFTED} \\\n    ${FDIRY}/${FN_TMP_UNLIFT}\n\n\nReading liftover chains\nMapping coordinates\n\n\n\n\nCode\ngzip -f ${FDIRY}/${FN_TMP_UNLIFT}\ngzip -f ${FDIRY}/${FN_TMP_LIFTED}\n\n\nCheck results\n\n\nCode\nls ${FDIRY}\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.stranded_pos.bed.gz\nTMPRA_K562_OL43_20221003.hg38.raw.stranded_pos.bed.gz\nTMPRA_K562_OL45_20220927.hg38.raw.stranded_pos.bed.gz\n\n\n\n\nCode\nzcat ${FDIRY}/${FN_INP}        | wc -l \nzcat ${FDIRY}/${FN_OUT_LIFTED} | wc -l \nzcat ${FDIRY}/${FN_OUT_UNLIFT} | wc -l \n\n\n21914\n21914\n0\n\n\nExecute: LiftOver fragment count\nTest loop and file IO\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment_counts\nFPATHS=($(ls ${FDIRY}/*hg19*))\n\nfor FP_INP in ${FPATHS[@]}; do\n    ###\n    FN_INP=$(basename ${FP_INP})\n    FN_OUT_LIFTED=${FN_INP/hg19/hg38}\n    FN_OUT_UNLIFT=${FN_INP/hg19/unlifted}\n    FN_TMP_LIFTED=${FN_OUT_LIFTED%.*}\n    FN_TMP_UNLIFT=${FN_OUT_UNLIFT%.*}\n\n    echo ${FN_INP}\n    echo ${FN_OUT_LIFTED}\n    echo ${FN_TMP_LIFTED}\n    echo ${FN_OUT_UNLIFT}\n    echo ${FN_TMP_UNLIFT}\n    \n    echo ==================\ndone\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.mean.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.mean.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep1.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep2.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep2.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep3.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep3.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep4.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep4.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Log2FC.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Log2FC.mean.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Log2FC.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Log2FC.mean.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.mean.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.mean.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.mean.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep1.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep1.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep2.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep2.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep3.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep3.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep4.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep4.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep1.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep1.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep2.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep2.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep3.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep3.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep4.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep4.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep1.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep1.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep1.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep2.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep2.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep2.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep3.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep3.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep3.stranded_pos.bed\n==================\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep4.stranded_pos.bed\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep4.stranded_pos.bed.gz\nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep4.stranded_pos.bed\n==================\n\n\nrun liftOver and check results\n\n\nCode\nFDIRY=${FD_RES}/assay_fcc/${TXT_ASSAY}/fragment_counts\nFPATHS=($(ls ${FDIRY}/*hg19*))\n\nfor FP_INP in ${FPATHS[@]}; do\n    ### setup\n    FN_INP=$(basename ${FP_INP})\n    FN_OUT_LIFTED=${FN_INP/hg19/hg38}\n    FN_OUT_UNLIFT=${FN_INP/hg19/unlifted}\n    FN_TMP_LIFTED=${FN_OUT_LIFTED%.*}\n    FN_TMP_UNLIFT=${FN_OUT_UNLIFT%.*}\n    \n    ### liftover\n    ${FD_EXE}/run_liftOver.sh \\\n        -bedPlus=6 \\\n        ${FDIRY}/${FN_INP} \\\n        /data/reddylab/Reference_Data/Genomes/hg38/hg19ToHg38.over.chain \\\n        ${FDIRY}/${FN_TMP_LIFTED} \\\n        ${FDIRY}/${FN_TMP_UNLIFT}\n    \n    ### compress files\n    gzip -f ${FDIRY}/${FN_TMP_UNLIFT}\n    gzip -f ${FDIRY}/${FN_TMP_LIFTED}\n    \n    ### show\n    echo \"Input: \" ${FN_INP}\n    echo \"Output:\" ${FN_OUT_LIFTED}\n    zcat ${FDIRY}/${FN_INP}        | wc -l\n    zcat ${FDIRY}/${FN_OUT_LIFTED} | wc -l\n    zcat ${FDIRY}/${FN_OUT_UNLIFT} | wc -l\n    echo ==================\ndone\n\n\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Input.mean.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Input.rep2.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Input.rep3.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Input.rep4.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Log2FC.mean.stranded_pos.bed.gz\n21757\n21757\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Output.mean.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Output.rep1.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Output.rep2.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Output.rep3.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.norm.Output.rep4.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Input.rep1.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Input.rep2.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Input.rep3.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Input.rep4.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Output.rep1.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Output.rep2.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Output.rep3.stranded_pos.bed.gz\n21914\n21914\n0\n==================\nReading liftover chains\nMapping coordinates\nInput:  TMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz\nOutput: TMPRA_K562_OL13_20220512.hg38.raw.Output.rep4.stranded_pos.bed.gz\n21914\n21914\n0\n=================="
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html",
    "title": "Prepare Tiling MPRA data 07",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references\nCode\nTXT_ASSAY  = \"MPRA_Tiling_K562_Tewhey_Hannah\"\nTXT_FOLDER = \"fragment_counts\""
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html#helper-functions",
    "href": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html#helper-functions",
    "title": "Prepare Tiling MPRA data 07",
    "section": "Helper functions",
    "text": "Helper functions\nDefine functions\n\n\nCode\nGROUPS  = c(\"Input\", \"Output\", \"Log2FC\")\nSAMPLES = c(\n    paste0(\"Input.rep\",  1:6),\n    paste0(\"Output.rep\", 1:6),\n    \"mean\"\n    #\"Input.mean\",\n    #\"Output.mean\",\n    #\"Log2FC.mean\"\n)\n\nget_info = function(string, patterns){\n    idx = str_detect(string = string, pattern = patterns)\n    return(patterns[idx])\n}\n\nget_group  = function(strings){\n    res = sapply(strings, function(string){get_info(string, GROUPS)})\n    return(res)\n}\n\nget_sample = function(strings){\n    res = sapply(strings, function(string){get_info(string, SAMPLES)})\n    return(res)\n}\n\nget_type = function(strings){\n    res = sapply(strings, function(string){get_info(string, c(\"raw\", \"norm\"))})\n    return(res)\n}\n\nget_genome = function(strings){\n    res = sapply(strings, function(string){get_info(string, c(\"hg19\", \"hg38\", \"unlifted\"))})\n    return(res)\n}\n\nget_prefix = function(strings){\n    res = sapply(strings, function(string){\n        lst = str_split(string, \"\\\\.\")\n        vec = lst[[1]]\n        txt = vec[1]\n        return(txt)\n    })\n    return(res)\n}\n\n\nTest functions\n\n\nCode\ntxt = \"TMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\"\nget_info(txt, SAMPLES)\n\n\n'Input.rep1'\n\n\n\n\nCode\ntxt = \"TMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\"\nget_group(txt)\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz: 'Input'\n\n\n\n\nCode\ntxt = \"TMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\"\nget_genome(txt)\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz: 'hg38'\n\n\n\n\nCode\ntxt = \"TMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\"\nget_prefix(txt)\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz: 'TMPRA_K562_OL13_20220512'"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html#metadata-for-tmpra-fragment-counts",
    "href": "notebooks/01_prepare_fcc/fcc_17_export_metadata_TMPRA_Hannah_R.html#metadata-for-tmpra-fragment-counts",
    "title": "Prepare Tiling MPRA data 07",
    "section": "Metadata for TMPRA fragment counts",
    "text": "Metadata for TMPRA fragment counts\nGet the file names for fragment counts\n\n\nCode\ntxt_fdiry  = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER)\ntxt_fname  = \"*bed.gz\"\ntxt_fglob  = file.path(txt_fdiry, txt_fname)\n\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nfor (txt in vec_txt_fname){cat(txt, \"\\n\")}\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Log2FC.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Output.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Input.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Log2FC.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Output.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Input.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Log2FC.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Output.mean.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.norm.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL13_20220512.unlifted.raw.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.mean.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep5.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep6.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Log2FC.mean.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.mean.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep5.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep5.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep6.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep5.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Input.mean.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Log2FC.mean.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Output.mean.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep4.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep1.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep2.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep3.stranded_pos.bed.gz \nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep4.stranded_pos.bed.gz \n\n\nCreate metadata for the files\n\n\nCode\ndat = data.frame(\n    FName  = vec_txt_fname,\n    Assay  = TXT_ASSAY\n)\ndat = dat %&gt;%\n    dplyr::mutate(\n        Prefix = get_prefix(FName),\n        Group  = get_group(FName),\n        Sample = get_sample(FName),\n        Type   = get_type(FName),\n        Genome = get_genome(FName)\n    )\ndat = dat %&gt;% \n    dplyr::filter(Genome %in% c(\"hg19\", \"hg38\")) %&gt;%\n    dplyr::filter(Sample != \"mean\")\n\ndat_metadata_tmpra = dat\nfun_display_table(dat)\n\n\n\n\n\nFName\nAssay\nPrefix\nGroup\nSample\nType\nGenome\n\n\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep1\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep2\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep3\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep4\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep1\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep2\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep3\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.norm.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep4\nnorm\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep1\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep2\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep3\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep4\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep1\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep2\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep3\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg19.raw.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep4\nraw\nhg19\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.norm.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nInput\nInput.rep4\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL13_20220512.hg38.raw.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL13_20220512\nOutput\nOutput.rep4\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep5.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep5\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Input.rep6.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep6\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.norm.Output.rep5.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep5\nnorm\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep4\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep5.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep5\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Input.rep6.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nInput\nInput.rep6\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep4\nraw\nhg38\n\n\nTMPRA_K562_OL43_20221003.hg38.raw.Output.rep5.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL43_20221003\nOutput\nOutput.rep5\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep1\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep2\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep3\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.norm.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep4\nnorm\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Input.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nInput\nInput.rep4\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep1.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep1\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep2.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep2\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep3.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep3\nraw\nhg38\n\n\nTMPRA_K562_OL45_20220927.hg38.raw.Output.rep4.stranded_pos.bed.gz\nMPRA_Tiling_K562_Tewhey_Hannah\nTMPRA_K562_OL45_20220927\nOutput\nOutput.rep4\nraw\nhg38\n\n\n\n\n\nSave results\n\n\nCode\ntxt_fdiry = file.path(FD_RES, \"assay_fcc\", TXT_ASSAY, TXT_FOLDER, \"summary\")\ntxt_fname = \"metadata.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ntxt = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt)\n\ndat = dat_metadata_tmpra\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#import-data",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#import-data",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "Import data",
    "text": "Import data\nImport library design\n\n\nCode\n### set directory\nfdiry = file.path(FD_DAT, \"processed\", \"MPRA_Lenti_K562_Nadav_Vikram_230621\")\nfname = \"LentiMPRA.K562.Library_Design.csv\"\nfpath = file.path(fdiry, fname)\n\n### read table\ndat = read_csv(fpath, show_col_types = FALSE)\n\n### assign and show\ndat_lmpra_library = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 243780      7\n\n\n\n\n\nname\ncategory\nchr.hg38\nstart.hg38\nstop.hg38\nstr.hg38\n230nt sequence (15nt 5' adaptor - 200nt element - 15nt 3' adaptor)\n\n\n\n\npeak1\npotential enhancer\nchr1\n115631\n115831\n+\nAGGACCGGATCAACTGAGCCGGGTCATGAAAAAGGGGATCTTGTGTGTCTGTCCACGATAAGCACTATCACAAGGACTTTCTATAAACTCACAAGAAATTTCTGCCCACCCAGCACACAGTTTGTCCAGCTCATCCTGTAGGTGTCTCTATAATAGGACCTATCATAAAAAATTCCTCAAGACTGCAGCATTTCAGATAAGCCACCCTCACAAGACATTGCGTGAACCGA\n\n\npeak1_Reversed:\npotential enhancer\nchr1\n115631\n115831\n-\nAGGACCGGATCAACTTCTTGTGAGGGTGGCTTATCTGAAATGCTGCAGTCTTGAGGAATTTTTTATGATAGGTCCTATTATAGAGACACCTACAGGATGAGCTGGACAAACTGTGTGCTGGGTGGGCAGAAATTTCTTGTGAGTTTATAGAAAGTCCTTGTGATAGTGCTTATCGTGGACAGACACACAAGATCCCCTTTTTCATGACCCGGCTCCATTGCGTGAACCGA\n\n\npeak10\npotential enhancer\nchr1\n634309\n634509\n+\nAGGACCGGATCAACTTGTCGCCTTAATCCAAGCCTACGTTTTTACACTTCTAGTAAGCCTCTACCTGCACGACAACACATAATGACCCACCAATCACATGCCTATCATATAGTAAAACCCAGCCCATGGCCCCTAACAGGGGCCCTCTCAGCCCTCCTAATGACCTCCGGCCTAGCCATGTGATTTCACTTCCACTCCACAACCCTCCTCATACTCATTGCGTGAACCGA\n\n\npeak10_Reversed:\npotential enhancer\nchr1\n634309\n634509\n-\nAGGACCGGATCAACTAGTATGAGGAGGGTTGTGGAGTGGAAGTGAAATCACATGGCTAGGCCGGAGGTCATTAGGAGGGCTGAGAGGGCCCCTGTTAGGGGCCATGGGCTGGGTTTTACTATATGATAGGCATGTGATTGGTGGGTCATTATGTGTTGTCGTGCAGGTAGAGGCTTACTAGAAGTGTAAAAACGTAGGCTTGGATTAAGGCGACACATTGCGTGAACCGA\n\n\npeak100\npotential enhancer\nchr1\n2133494\n2133694\n+\nAGGACCGGATCAACTCCCCTCCCCAGCTGTGCGCCCGCCCCTTGGTTCCACCCCCCCCAGCTGTGCATCCGTCCCTTGGCTCCGCCCCGCACTGTGCGTCCATTTTTGACTCCGCCCCCGGCTGTGCGCTCATCCCTCGGCTCCGCCCCCGGCTGTGCGTCCGTCCCTCGGTTCCGCCCCCGGCTGCGCGTCTGTCCCTCGACTCGGCCCCTCAGCATTGCGTGAACCGA\n\n\npeak100_Reversed:\npotential enhancer\nchr1\n2133494\n2133694\n-\nAGGACCGGATCAACTCTGAGGGGCCGAGTCGAGGGACAGACGCGCAGCCGGGGGCGGAACCGAGGGACGGACGCACAGCCGGGGGCGGAGCCGAGGGATGAGCGCACAGCCGGGGGCGGAGTCAAAAATGGACGCACAGTGCGGGGCGGAGCCAAGGGACGGATGCACAGCTGGGGGGGGTGGAACCAAGGGGCGGGCGCACAGCTGGGGAGGGGCATTGCGTGAACCGA\n\n\n\n\n\nImport effect size\n\n\nCode\n### set directory\nfdiry = file.path(FD_DAT, \"processed\", \"MPRA_Lenti_K562_Nadav_Vikram_230621\")\nfname = \"LentiMPRA.K562.Log2FC.matrix.csv\"\nfpath = file.path(fdiry, fname)\n\n### read table\ndat = read_csv(fpath, show_col_types = FALSE)\n\n### assign and show\ndat_lmpra_score_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 226254      5\n\n\n\n\n\nname\nreplicate 1 [log2(rna/dna)]\nreplicate 2 [log2(rna/dna)]\nreplicate 3 [log2(rna/dna)]\nmean\n\n\n\n\npeak29573_Reversed:\n-0.190\n0.225\n0.201\n0.079\n\n\npeak71109_Reversed:\n0.650\n0.454\n0.758\n0.620\n\n\nENSG00000123569\n-0.762\n-0.578\n-0.228\n-0.523\n\n\npeak25742_Reversed:\n-0.511\n-0.644\n-0.154\n-0.436\n\n\npeak83398\n-0.154\n-0.298\n0.103\n-0.116\n\n\npeak1037_Reversed:\n-0.056\n0.275\n0.008\n0.076"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#merge-and-arrange-data",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#merge-and-arrange-data",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "Merge and arrange data",
    "text": "Merge and arrange data\n\n\nCode\n### merge score by oligo's ID\ndat = dplyr::left_join(\n    dat_lmpra_score_matrix,\n    dat_lmpra_library,\n    by=\"name\"\n)\n\n### arrange table\ndat = dat %&gt;% \n    dplyr::select(\n        chr.hg38, \n        start.hg38, \n        stop.hg38, \n        name, \n        mean, \n        str.hg38, \n        category)\ncolnames(dat) = c(\"Chrom\", \"ChromStart\", \"ChromEnd\", \"Name\", \"Score\", \"Strand\", \"Category\")\n\n### assign and show\ndat_lmpra_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 226254      7\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\n\n\n\n\nchr16\n3163448\n3163648\npeak29573_Reversed:\n0.079\n-\npotential enhancer\n\n\nchr6\n125083195\n125083395\npeak71109_Reversed:\n0.620\n-\npotential enhancer\n\n\nchrX\n104013573\n104013773\nENSG00000123569\n-0.523\n-\npromoter\n\n\nchr14\n76947662\n76947862\npeak25742_Reversed:\n-0.436\n-\npotential enhancer\n\n\nchr9\n98271532\n98271732\npeak83398\n-0.116\n+\npotential enhancer\n\n\nchr1\n17059727\n17059927\npeak1037_Reversed:\n0.076\n-\npotential enhancer"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-regions",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-regions",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "Explore regions",
    "text": "Explore regions\nExplore: GATA1 promoter\n\n\nCode\ndat = dat_lmpra_arrange\ndat = dat %&gt;% dplyr::filter(Chrom == \"chrX\", ChromEnd &gt;= 48782525, ChromStart &lt;=48783758)\n\nfun_display_table(dat)\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\n\n\n\n\nchrX\n48782354\n48782554\nGATA1_4980_Reversed:\n-0.721\n-\nintergenic (7 loci)\n\n\nchrX\n48782354\n48782554\nGATA1_4980\n-0.780\n+\nintergenic (7 loci)\n\n\n\n\n\nExplore: MYC promoter\nExplore: MYC enhancer"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-distributions-of-effect-sizes",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-distributions-of-effect-sizes",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "Explore distributions of effect sizes",
    "text": "Explore distributions of effect sizes\n\n\nCode\ntheme_text = theme(\n    text         = element_text(size=10), #change font size of all text\n    axis.text    = element_text(size=10), #change font size of axis text\n    axis.title   = element_text(size=15), #change font size of axis titles\n    plot.title   = element_text(size=15), #change font size of plot title\n    legend.text  = element_text(size= 5), #change font size of legend text\n    legend.title = element_text(size= 7), #change font size of legend text\n    strip.text   = element_text(size= 5)\n) #change font size of legend title\n\n\nDistribution of scores (Total)\n\n\nCode\n### create plot\ndat = dat_lmpra_score_matrix\ngpt = ggplot(dat, aes(x=mean)) + \n    geom_histogram(binwidth = 0.1) + \n    labs(\n        x = \"Log2 Fold Change\", \n        y = \"Count\", \n        title=\"Lenti-MPRA Log2FC\\n(Total)\") +\n    theme_cowplot() +\n    background_grid() +\n    theme_text\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n### plotting parameters\ntxt_prefix = \"fig.fcc_assay.LMPRA.hist.Log2fc.total\"\nnum_height = 10\nnum_width  = 14\n\n### save plot\nfor (txt_fext in c(\"png\", \"svg\")){\n    txt_fdiry  = \"./\"\n    txt_fname = paste(txt_prefix, txt_fext, sep = \".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    ggsave(\n        txt_fpath,\n        plot   = gpt,\n        height = num_height,\n        width  = num_width,\n        units = \"cm\",\n        dpi = 300)    \n}\n\n\n\n\n\n\n\n\n\nDistribution of scores (Negative control; random shuffled seqeunces)\n\n\nCode\n### create plot\ndat = dat_lmpra_score_matrix\ndat = dat %&gt;% dplyr::filter(str_detect(name, \"shuffle\"))\n\ngpt = ggplot(dat, aes(x=mean)) + \n    geom_histogram(binwidth = 0.1) + \n    labs(\n        x = \"Log2 Fold Change\", \n        y = \"Count\", \n        title=\"Lenti-MPRA Log2FC\\n(Negative Control, shuffled sequences)\") +\n    theme_cowplot() +\n    background_grid() +\n    theme_text\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n### plotting parameters\ntxt_prefix = \"fig.fcc_assay.LMPRA.hist.Log2fc.neg_ctrl_shuffled\"\nnum_height = 10\nnum_width  = 14\n\n### save plot\nfor (txt_fext in c(\"png\", \"svg\")){\n    txt_fdiry = \"./\"\n    txt_fname = paste(txt_prefix, txt_fext, sep = \".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    ggsave(\n        txt_fpath,\n        plot   = gpt,\n        height = num_height,\n        width  = num_width,\n        units = \"cm\",\n        dpi = 300)    \n}\n\n\n\n\n\n\n\n\n\nDistribution of scores for each category\n\n\nCode\ndat = dat_lmpra_arrange\ntable(dat$Category)\n\n\n\n                intergenic (7 loci) negative control (Ernst et al 2016) \n                              27145                                 185 \n         negative control, shuffled positive control (Ernst et al 2016) \n                                247                                  41 \n                 potential enhancer                            promoter \n                             169260                               29376 \n\n\n\n\nCode\n### arrange plot text\ndat = dat_lmpra_arrange\ndat = dat %&gt;% \n    dplyr::select(Name, Score, Strand, Category) %&gt;%\n    dplyr::mutate(\n        Category = recode(\n            Category, \n            \"potential enhancer\" = \"potential\\nenhancer\",\n            \"negative control, shuffled\" = \"negative control\\n(shuffled)\",\n            \"negative control (Ernst et al 2016)\" = \"negative control\\n(Ernst et al 2016)\",\n            \"positive control (Ernst et al 2016)\" = \"positive control\\n(Ernst et al 2016)\"\n        ))\n\n### create plot\ngpt = ggplot(dat, aes(x=Score, group=Category, fill=Category)) +\n    geom_density(alpha=0.5) +\n    labs(\n        title=\"Lenti-MPRA Log2FC\", \n        x=\"Log2FC\", \n        y=\"Density\") +\n    theme_cowplot() +\n    theme(\n        panel.grid.major.y = element_line(color = \"grey70\", linewidth = 0.5, linetype = 1),\n        panel.grid.major.x = element_line(color = \"grey70\", linewidth = 0.5, linetype = 1),\n        panel.grid.minor.x = element_line(color = \"grey70\", linewidth = 0.5, linetype = 1)\n    ) +\n    facet_grid(Category~.)\n\n### show plot\noptions(repr.plot.height=10, repr.plot.width=8)\nprint(gpt)\n\n### plotting parameters\ntxt_prefix = \"fig.fcc_assay.LMPRA.hist.Log2fc.split\"\nnum_height = 25\nnum_width  = 16\n\n### save plot\nfor (txt_fext in c(\"png\", \"svg\")){\n    txt_fdiry = \"./\"\n    txt_fname = paste(txt_prefix, txt_fext, sep = \".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    ggsave(\n        txt_fpath,\n        plot   = gpt,\n        height = num_height,\n        width  = num_width,\n        units = \"cm\",\n        dpi = 300)    \n}"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-distributions-of-z-scores",
    "href": "notebooks/01_prepare_fcc/fcc_22_explore_data_LMPRA_Vikram_R.html#explore-distributions-of-z-scores",
    "title": "Prepare Lenti-MPRA data 02",
    "section": "Explore distributions of z scores",
    "text": "Explore distributions of z scores\nExtract Log2FC of negative control (Shuffled sequences)\n\n\nCode\ndat = dat_lmpra_arrange\nlst = split(dat, dat$Category)\ndat = lst[[\"negative control, shuffled\"]]\n\ndat_lmpra_score_negative_shuffled = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 247   7\n\n\n\nA tibble: 6 × 7\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nNA\nNA\nNA\nseq5206_shuffled_0\n-0.453\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq31328_shuffled_0\n-0.768\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq12212_shuffled_0\n-0.600\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq9803_shuffled_0\n-0.933\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq2756_shuffled_0\n-0.545\nNA\nnegative control, shuffled\n\n\nNA\nNA\nNA\nseq13776_shuffled_0\n-0.837\nNA\nnegative control, shuffled\n\n\n\n\n\nZ Score transformation\n\n\nCode\ndat = dat_lmpra_score_negative_shuffled\nvec = dat$Score\nval_mu = mean(vec)\nval_sd = sd(vec)\n\ndat = dat_lmpra_arrange\ndat = dat %&gt;% dplyr::mutate(ZScore = (Score - val_mu) / val_sd)\n\ndat_lmpra_zscore = dat\nprint(val_mu)\nprint(val_sd)\nhead(dat)\n\n\n[1] -0.5249433\n[1] 0.2754342\n\n\n\nA tibble: 6 × 8\n\n\nChrom\nChromStart\nChromEnd\nName\nScore\nStrand\nCategory\nZScore\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n\n\n\n\nchr16\n3163448\n3163648\npeak29573_Reversed:\n0.079\n-\npotential enhancer\n2.192695368\n\n\nchr6\n125083195\n125083395\npeak71109_Reversed:\n0.620\n-\npotential enhancer\n4.156866764\n\n\nchrX\n104013573\n104013773\nENSG00000123569\n-0.523\n-\npromoter\n0.007055477\n\n\nchr14\n76947662\n76947862\npeak25742_Reversed:\n-0.436\n-\npotential enhancer\n0.322920378\n\n\nchr9\n98271532\n98271732\npeak83398\n-0.116\n+\npotential enhancer\n1.484722314\n\n\nchr1\n17059727\n17059927\npeak1037_Reversed:\n0.076\n-\npotential enhancer\n2.181803475\n\n\n\n\n\nVisualization\n\n\nCode\n### arrange data for plotting\ndat = dat_lmpra_zscore\n\nvec = c(\"potential enhancer\", \"promoter\", \"intergenic (7 loci)\")\ndat = dat %&gt;% dplyr::filter(Category %in% vec)\n\ndat = dat %&gt;% dplyr::select(Score, ZScore)\ncolnames(dat) = c(\"Log2FC\", \"ZScore\")\ndat = dat %&gt;% tidyr::gather(Group, Score)\n\n### create plot\ngpt = ggplot(dat, aes(x=Score, fill=Group)) + \n    geom_density(alpha=0.5) + \n    geom_vline(xintercept = 0, color = \"grey30\", linewidth=1) +\n    labs(\n        y=\"Density\",\n        title=\"Lenti-MPRA Log2FC vs Z-Score\\n(Promoters/Enhancers/Intergenic regions)\") +\n    theme_cowplot() +\n    background_grid() +\n    theme_text\n\n### show plot\noptions(repr.plot.height=6, repr.plot.width=10)\nprint(gpt)\n\n### plotting parameters\ntxt_prefix = \"fig.fcc_assay.LMPRA.hist.Log2fc.zscore\"\nnum_height = 10\nnum_width  = 14\n\n### save plot\nfor (txt_fext in c(\"png\", \"svg\")){\n    txt_fdiry = \"./\"\n    txt_fname = paste(txt_prefix, txt_fext, sep = \".\")\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    ggsave(\n        txt_fpath,\n        plot   = gpt,\n        height = num_height,\n        width  = num_width,\n        units = \"cm\",\n        dpi = 300)    \n}"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html",
    "href": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity \nBASE DIRECTORY (FD_BASE): /mount \nREPO DIRECTORY (FD_REPO): /mount/repo \nWORK DIRECTORY (FD_WORK): /mount/work \nDATA DIRECTORY (FD_DATA): /mount/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /mount/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /mount/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /mount/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /mount/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /mount/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /mount/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /mount/repo/Proj_ENCODE_FCC/log \nPROJECT APP     (FD_APP): /mount/repo/Proj_ENCODE_FCC/app \nPROJECT REF     (FD_REF): /mount/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#import-metadata-from-reference-file",
    "href": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#import-metadata-from-reference-file",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Import metadata from reference file",
    "text": "Import metadata from reference file\n\n\nCode\n### set file path\ntxt_fdiry = file.path(FD_REF, \"encode_open_chromatin\")\ntxt_fname = \"ENCODE_K562_hg38_ATAC_DNase.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata = dat\nfun_display_table(dat)\n\n\n\n\n\nAssay\nBiosample\nIndex_Experiment\nIndex_Process\nIndex_File\nFile_Type\nOutput_Type\nisogenic_replicate\nGenome\nFile_Summary\nLab\n\n\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF357GNC\nbigWig\nsignal p-value\n1, 2, 3\nhg38\ncall-macs2_signal_track_pooled/rep.pooled.pval.signal.bigwig\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF333TAT\nbed narrowPeak\npseudoreplicated peaks\n1, 2, 3\nhg38\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR868FGK\nENCODE4 v1.9.1 GRCh38 (ENCAN824UKX)\nENCFF948AFM\nbed narrowPeak\nIDR thresholded peaks\n1, 2, 3\nhg38\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF600FDO\nbigWig\nsignal p-value\n1, 2\nhg38\ncall-macs2_signal_track_pooled/rep.pooled.pval.signal.bigwig\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF558BLC\nbed narrowPeak\npseudoreplicated peaks\n1, 2\nhg38\ncall-overlap_ppr/pooled-pr1_vs_pooled-pr2.overlap.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nATAC\nK562\nENCSR483RKN\nENCODE4 v1.9.1 GRCh38 (ENCAN217QUL)\nENCFF925CYR\nbed narrowPeak\nIDR thresholded peaks\n1, 2\nhg38\ncall-idr_ppr/pooled-pr1_vs_pooled-pr2.idr0.05.bfilt.narrowPeak.gz\nMichael Snyder, Stanford\n\n\nDNase\nK562\nENCSR000EKS\nENCODE4 v3.0.0 GRCh38 (ENCAN694OCK)\nENCFF972GVB\nbigWig\nread-depth normalized signal\n1\nhg38\ncall-starch_to_bigwig/normalized.nuclear.0.05.density.bw\nGregory Crawford, Duke\n\n\nDNase\nK562\nENCSR000EKS\nENCODE4 v3.0.0 GRCh38 (ENCAN694OCK)\nENCFF274YGF\nbed narrowPeak\npeaks\n1\nhg38\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nGregory Crawford, Duke\n\n\nDNase\nK562\nENCSR000EOT\nENCODE4 v3.0.0-alpha.2 GRCh38 (ENCAN780RWD)\nENCFF414OGC\nbigWig\nread-depth normalized signal\n1\nhg38\ncall-starch_to_bigwig/normalized.nuclear.0.05.density.bw\nJohn Stamatoyannopoulos, UW\n\n\nDNase\nK562\nENCSR000EOT\nENCODE4 v3.0.0-alpha.2 GRCh38 (ENCAN780RWD)\nENCFF185XRG\nbed narrowPeak\npeaks\n1\nhg38\ncall-compress/nuclear.0.001.peaks.narrowpeaks.bed.gz\nJohn Stamatoyannopoulos, UW"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#generate-download-commands",
    "href": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#generate-download-commands",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Generate download commands",
    "text": "Generate download commands\nwget -O FILE URL\n\n\nCode\n### init\ndat = dat_metadata\n\n### setup download file name and wget command\ndat = dat %&gt;%\n    dplyr::mutate(\n        File_Ext1 = ifelse(str_detect(File_Type, \"bed\"), \"bed.gz\", \"bw\"),\n        File_Ext2 = ifelse(str_detect(File_Type, \"bed\"), \"bed.gz\", \"bigWig\")\n    ) %&gt;%\n    dplyr::mutate(\n        File_Name = paste(\n            Biosample, \n            \"hg38\", \n            Index_Experiment, \n            Index_File,\n            Assay,\n            File_Ext1, \n            sep=\".\")\n    ) %&gt;%\n    dplyr::mutate(\n        File_URL_Download = file.path(\n            \"https://www.encodeproject.org/files\",\n            Index_File,\n            \"@@download\",\n            paste(Index_File, File_Ext2, sep = \".\")\n        )\n    ) %&gt;%\n    dplyr::mutate(\n        CMD = paste(\"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL_Download)\n    )\n\n### add Shebang and initial commands\n#dat = dat %&gt;% dplyr::select(Assay, Biosample, Index_Experiment, Index_File, File_Name, CMD)\ndat = dat %&gt;% dplyr::select(CMD)\ndat = rbind('echo -n \"\" &gt; run_download.log.txt', dat)\ncolnames(dat) = \"#!/bin/bash\"\n\n### assign and show\ndat_cmd = dat\nfun_display_table(dat)\n\n\n\n\n\n#!/bin/bash\n\n\n\n\necho -n \"\" &gt; run_download.log.txt\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw https://www.encodeproject.org/files/ENCFF357GNC/@@download/ENCFF357GNC.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF333TAT/@@download/ENCFF333TAT.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF948AFM/@@download/ENCFF948AFM.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw https://www.encodeproject.org/files/ENCFF600FDO/@@download/ENCFF600FDO.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF558BLC/@@download/ENCFF558BLC.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz https://www.encodeproject.org/files/ENCFF925CYR/@@download/ENCFF925CYR.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw https://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz https://www.encodeproject.org/files/ENCFF274YGF/@@download/ENCFF274YGF.bed.gz\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw https://www.encodeproject.org/files/ENCFF414OGC/@@download/ENCFF414OGC.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz https://www.encodeproject.org/files/ENCFF185XRG/@@download/ENCFF185XRG.bed.gz"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#save-to-script",
    "href": "notebooks/01_prepare_fcc/region_ocr_01_create_download_script_R.html#save-to-script",
    "title": "Prepare ENCODE ATAC/DNase Peaks 01",
    "section": "Save to script",
    "text": "Save to script\nSave the command lines for each row into a bash script\n\n\nCode\n### set output path\ntxt_fdiry = file.path(FD_DAT, \"external\", \"encode_open_chromatin\")\ntxt_fname = \"run_download.sh\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### save table\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cmd\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html",
    "href": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/app/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#prepare",
    "href": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#prepare",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Prepare",
    "text": "Prepare\n\n\nCode\nFDIRY=${FD_DAT}/external/encode_open_chromatin\n\necho ${FDIRY}\nls   ${FDIRY}/*.bed.gz | wc -l\nls   ${FDIRY}/*.bed.gz | xargs -n 1 basename\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin\n6\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n\n\nCode\nFDIRY=${FD_DAT}/external/encode_open_chromatin\nFNAME=K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nFPATH=${FDIRY}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    181400  181530  .   0   .   0.299874    -1  -1  75\nchr1    778660  778800  .   0   .   14.1383 -1  -1  75\nchr1    779137  779200  .   0   .   0.33144 -1  -1  75\nchr1    827460  827554  .   0   .   3.38384 -1  -1  75\nchr1    842880  843060  .   0   .   1.64457 -1  -1  75\nchr1    869800  869980  .   0   .   2.23485 -1  -1  75\nchr1    875760  875920  .   0   .   0.356692    -1  -1  75\nchr1    898828  899004  .   0   .   0.363005    -1  -1  75\nchr1    900030  900100  .   0   .   0.249369    -1  -1  75\nchr1    901580  901645  .   0   .   0.217803    -1  -1  75"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#copy-and-sort-the-files",
    "href": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#copy-and-sort-the-files",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Copy and sort the files",
    "text": "Copy and sort the files\nln -s file link\nzcat ${FP_INP} | sort -k 1,1 -k2,2n | gzip -c &gt; ${FP_OUT}\n\n\nCode\n### set directory\nFD_INP=${FD_DAT}/external/encode_open_chromatin\nFD_OUT=${FD_RES}/region/encode_open_chromatin\nmkdir -p ${FD_OUT}\n\n### loop and link files\nFP_INPS=($(ls ${FD_INP}/*bed.gz))\nfor FP_INP in ${FP_INPS[@]}; do\n    ### get input file name\n    FN_INP=$(basename ${FP_INP})\n    echo ${FN_INP}\n    \n    ### set output file name\n    FN_OUT=${FN_INP}\n    FP_OUT=${FD_OUT}/${FN_OUT}\n    \n    ### sort and output to a new file\n    zcat ${FP_INP} | sort -k 1,1 -k2,2n | gzip -c &gt; ${FP_OUT}\ndone\n\n\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz"
  },
  {
    "objectID": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#review",
    "href": "notebooks/01_prepare_fcc/region_ocr_03_prepare_data_SH.html#review",
    "title": "Prepare ENCODE ATAC/DNase Peaks 03",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\n### set directory\nFD_INP=${FD_DAT}/external/encode_open_chromatin\nFD_OUT=${FD_RES}/region/encode_open_chromatin\n\nls ${FD_OUT}\n\n\ndescription.tsv\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n\n\nCode\nFNAME=K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nFPATH=${FD_INP}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    100028923   100029241   Peak_202759 52  .   2.91347 5.24652 3.38358 74\nchr1    100037575   100038998   Peak_172664 68  .   1.83651 6.83702 4.90355 60\nchr1    100037575   100038998   Peak_30781  934 .   5.32597 93.45621    90.75060    988\nchr1    100037575   100038998   Peak_37596  722 .   4.66917 72.27560    69.66279    791\nchr1    100037575   100038998   Peak_38860  692 .   4.55797 69.21054    66.61273    1182\nchr1    100037575   100038998   Peak_7320   1000    .   12.39880    394.75714   391.35434   513\nchr1    100046904   100047187   Peak_125191 111 .   3.44067 11.11133    9.04548 94\nchr1    100048739   100048974   Peak_163268 74  .   2.90807 7.42227 5.46578 145\nchr1    100050176   100050470   Peak_153800 81  .   3.11401 8.14941 6.16809 117\nchr1    100090679   100091339   Peak_149202 84  .   3.47044 8.41934 6.42649 269\n\n\n\n\nCode\nFNAME=K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nFPATH=${FD_OUT}/${FNAME}\nzcat ${FPATH} | head\n\n\nchr1    10509   10674   Peak_125662 110 .   4.29354 11.01368    8.94965 94\nchr1    41987   42385   Peak_116641 124 .   4.60022 12.47548    10.37921    281\nchr1    41987   42385   Peak_178161 63  .   3.22015 6.39968 4.47989 99\nchr1    46755   47025   Peak_217457 47  .   2.76013 4.70157 2.87144 182\nchr1    68969   69964   Peak_105604 147 .   5.06024 14.77241    12.63228    733\nchr1    68969   69964   Peak_203155 52  .   2.91347 5.24652 3.38358 77\nchr1    68969   69964   Peak_80922  232 .   6.59365 23.21283    20.95212    310\nchr1    78951   79407   Peak_150566 82  .   3.68018 8.27430 6.28501 335\nchr1    778328  779235  Peak_145438 89  .   2.37705 8.90270 6.89830 74\nchr1    778328  779235  Peak_2263   1000    .   28.93443    749.94922   745.95093   458"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REF = \"encode_rnaseq\"\nTXT_FOLDER_OUT = \"encode_rnaseq\"\nCode\ntxt_fdiry  = file.path(FD_REF, TXT_FOLDER_REF)\ndir(txt_fdiry)\n\n\n\n'ENCODE_K562_hg38_RNAseq_tmp.tsv''ENCODE_K562_hg38_RNAseq.tsv'"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#import-metadata-from-reference-file",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#import-metadata-from-reference-file",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Import metadata from reference file",
    "text": "Import metadata from reference file\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REF\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname = \"ENCODE_K562_hg38_RNAseq.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_metadata_import = dat\nfun_display_table(dat)\n\n\n\n\n\nFile accession\nFile format\nFile type\nFile format type\nOutput type\nFile assembly\nExperiment accession\nAssay\nDonor(s)\nBiosample term id\nBiosample term name\nBiosample type\nBiosample organism\nBiosample treatments\nBiosample treatments amount\nBiosample treatments duration\nBiosample genetic modifications methods\nBiosample genetic modifications categories\nBiosample genetic modifications targets\nBiosample genetic modifications gene targets\nBiosample genetic modifications site coordinates\nBiosample genetic modifications zygosity\nExperiment target\nLibrary made from\nLibrary depleted in\nLibrary extraction method\nLibrary lysis method\nLibrary crosslinking method\nLibrary strand specific\nExperiment date released\nProject\nRBNS protein concentration\nLibrary fragmentation method\nLibrary size range\nBiological replicate(s)\nTechnical replicate(s)\nRead length\nMapped read length\nRun type\nPaired end\nPaired with\nIndex of\nDerived from\nSize\nLab\nmd5sum\ndbxrefs\nFile download URL\nGenome annotation\nPlatform\nControlled by\nFile Status\ns3_uri\nAzure URL\nFile analysis title\nFile analysis status\nAudit WARNING\nAudit NOT_COMPLIANT\nAudit ERROR\n\n\n\n\nENCFF421TJX\ntsv\ntsv\nNA\ngene quantifications\nGRCh38\nENCSR615EEK\ntotal RNA-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nRNA\nNA\nNA\nNA\nNA\nreverse\n1/4/2021\nENCODE\nNA\nNA\nNA\n1\n1_1\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF285DRD/, /files/ENCFF820EYJ/\n11061127\nENCODE Processing Pipeline\na7875635bd3e8a70902a43d4b814832c\nNA\nhttps://www.encodeproject.org/files/ENCFF421TJX/@@download/ENCFF421TJX.tsv\nV29\nNA\nNA\nreleased\ns3://encode-public/2020/10/30/2033273a-286f-4c94-a652-9d75098cdfb5/ENCFF421TJX.tsv\nhttps://datasetencode.blob.core.windows.net/dataset/2020/10/30/2033273a-286f-4c94-a652-9d75098cdfb5/ENCFF421TJX.tsv?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v1.2.1 GRCh38 V29\nreleased\nNA\nunreplicated experiment\nNA\n\n\nENCFF585HTZ\nbigWig\nbigWig\nNA\nplus strand signal of unique reads\nGRCh38\nENCSR615EEK\ntotal RNA-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nRNA\nNA\nNA\nNA\nNA\nreverse\n1/4/2021\nENCODE\nNA\nNA\nNA\n1\n1_1\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF833WFD/, /files/GRCh38_EBV.chrom.sizes/\n112512459\nENCODE Processing Pipeline\ncc22df00ccf3af13fd208828480a7f04\nNA\nhttps://www.encodeproject.org/files/ENCFF585HTZ/@@download/ENCFF585HTZ.bigWig\nV29\nNA\nNA\nreleased\ns3://encode-public/2020/10/30/2b5767d4-57fc-4a6f-b50b-660d164f77b4/ENCFF585HTZ.bigWig\nhttps://datasetencode.blob.core.windows.net/dataset/2020/10/30/2b5767d4-57fc-4a6f-b50b-660d164f77b4/ENCFF585HTZ.bigWig?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v1.2.1 GRCh38 V29\nreleased\nNA\nunreplicated experiment\nNA\n\n\nENCFF876JOV\nbigWig\nbigWig\nNA\nminus strand signal of unique reads\nGRCh38\nENCSR615EEK\ntotal RNA-seq\n/human-donors/ENCDO000AAD/\nEFO:0002067\nK562\ncell line\nHomo sapiens\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nRNA\nNA\nNA\nNA\nNA\nreverse\n1/4/2021\nENCODE\nNA\nNA\nNA\n1\n1_1\nNA\nNA\nNA\nNA\nNA\nNA\n/files/ENCFF833WFD/, /files/GRCh38_EBV.chrom.sizes/\n109644032\nENCODE Processing Pipeline\ncd9f7432892b5d9355ff405220508915\nNA\nhttps://www.encodeproject.org/files/ENCFF876JOV/@@download/ENCFF876JOV.bigWig\nV29\nNA\nNA\nreleased\ns3://encode-public/2020/10/30/92b9cac8-9587-417b-b3bc-abc7059bf075/ENCFF876JOV.bigWig\nhttps://datasetencode.blob.core.windows.net/dataset/2020/10/30/92b9cac8-9587-417b-b3bc-abc7059bf075/ENCFF876JOV.bigWig?sv=2019-10-10&si=prod&sr=c&sig=9qSQZo4ggrCNpybBExU8SypuUZV33igI11xw0P7rB3c%3D\nENCODE4 v1.2.1 GRCh38 V29\nreleased\nNA\nunreplicated experiment\nNA"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#explore-table",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#explore-table",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Explore table",
    "text": "Explore table\nCheck genome assembly\n\n\nCode\ndat = dat_metadata_import\ntable(dat$`File assembly`)\n\n\n\nGRCh38 \n     3 \n\n\nCheck biosample\n\n\nCode\ndat = dat_metadata_import\ntable(dat$`Biosample term name`)\n\n\n\nK562 \n   3"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#arrange-metadata-tables",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#arrange-metadata-tables",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Arrange metadata tables",
    "text": "Arrange metadata tables\nHelper function\n\n\nCode\nfun_simplify_table = function(dat){\n    \n    ### rename some columns\n    dat = dat %&gt;% \n        dplyr::mutate(\n            Index_Experiment = `Experiment accession`,\n            Index_File       = `File accession`,\n            File_Format      = `File format`,\n            File_Type        = `File type`,\n            Output_Type      = `Output type`,\n            Genome           = `File assembly`,\n            #Target           = str_remove(`Experiment target`, \"-human\"),\n            Bio_Replicates   = `Biological replicate(s)`,\n            Analysis         = `File analysis title`,\n            File_Name        = basename(`File download URL`),\n            File_URL         = `File download URL`\n        )\n    \n    ### select the needed columns\n    dat = dat %&gt;%\n        dplyr::select(\n            Assay,\n            Index_Experiment,\n            Index_File,\n            File_Format,\n            File_Type,\n            Output_Type,\n            Genome,\n            #Target,\n            Bio_Replicates,\n            Analysis,\n            md5sum,\n            File_Name,\n            File_URL\n        )\n\n    ### return the simplified table\n    return(dat)\n}\n\n\nSimplify the metatable\n\n\nCode\n### arrange and simplify the table\ndat = dat_metadata_import\ndat = fun_simplify_table(dat)\n\n### assign and show\ndat_metadata_simplify = dat\nfun_display_table(dat)\n\n\n\n\n\nAssay\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Type\nOutput_Type\nGenome\nBio_Replicates\nAnalysis\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF421TJX\ntsv\ntsv\ngene quantifications\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\na7875635bd3e8a70902a43d4b814832c\nENCFF421TJX.tsv\nhttps://www.encodeproject.org/files/ENCFF421TJX/@@download/ENCFF421TJX.tsv\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF585HTZ\nbigWig\nbigWig\nplus strand signal of unique reads\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\ncc22df00ccf3af13fd208828480a7f04\nENCFF585HTZ.bigWig\nhttps://www.encodeproject.org/files/ENCFF585HTZ/@@download/ENCFF585HTZ.bigWig\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF876JOV\nbigWig\nbigWig\nminus strand signal of unique reads\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\ncd9f7432892b5d9355ff405220508915\nENCFF876JOV.bigWig\nhttps://www.encodeproject.org/files/ENCFF876JOV/@@download/ENCFF876JOV.bigWig"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#prepare-download-files",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#prepare-download-files",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Prepare download files",
    "text": "Prepare download files\nHelper function\n\n\nCode\nfun_map_file_label = function(txt){\n    vec1 = c(\"quantifications\", \"plus strand\",   \"minus strand\")\n    vec2 = c(\"tsv\",             \"strand_pos.bw\", \"strand_neg.bw\")\n    res  = fun_str_map_detect(txt, vec1, vec2, .default=txt)\n    return(res)\n}\n\n\nRename filename\n\n\nCode\n### rename filename\ndat = dat_metadata_simplify\ndat = dat %&gt;% dplyr::mutate(\n    File_Name = paste(\n        \"K562\",\n        \"hg38\",\n        Index_Experiment,\n        Index_File,\n        \"RNAseq_total\",\n        fun_map_file_label(Output_Type),\n    sep = \".\")\n)\n\n### assign and show\ndat_metadata_arrange = dat\nfun_display_table(dat)\n\n\n\n\n\nAssay\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Type\nOutput_Type\nGenome\nBio_Replicates\nAnalysis\nmd5sum\nFile_Name\nFile_URL\n\n\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF421TJX\ntsv\ntsv\ngene quantifications\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\na7875635bd3e8a70902a43d4b814832c\nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\nhttps://www.encodeproject.org/files/ENCFF421TJX/@@download/ENCFF421TJX.tsv\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF585HTZ\nbigWig\nbigWig\nplus strand signal of unique reads\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\ncc22df00ccf3af13fd208828480a7f04\nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw\nhttps://www.encodeproject.org/files/ENCFF585HTZ/@@download/ENCFF585HTZ.bigWig\n\n\ntotal RNA-seq\nENCSR615EEK\nENCFF876JOV\nbigWig\nbigWig\nminus strand signal of unique reads\nGRCh38\n1\nENCODE4 v1.2.1 GRCh38 V29\ncd9f7432892b5d9355ff405220508915\nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw\nhttps://www.encodeproject.org/files/ENCFF876JOV/@@download/ENCFF876JOV.bigWig\n\n\n\n\n\nCheck results\n\n\nCode\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(Index_Experiment, Index_File, File_Format, File_Name)\nfun_display_table(dat)\n\n\n\n\n\nIndex_Experiment\nIndex_File\nFile_Format\nFile_Name\n\n\n\n\nENCSR615EEK\nENCFF421TJX\ntsv\nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\n\n\nENCSR615EEK\nENCFF585HTZ\nbigWig\nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw\n\n\nENCSR615EEK\nENCFF876JOV\nbigWig\nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw\n\n\n\n\n\nChecksum table\n\n\nCode\n### get md5sum for each file\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::select(md5sum, File_Name)\n\n### assign and show\ndat_download_checksum = dat\nfun_display_table(dat)\n\n\n\n\n\nmd5sum\nFile_Name\n\n\n\n\na7875635bd3e8a70902a43d4b814832c\nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\n\n\ncc22df00ccf3af13fd208828480a7f04\nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw\n\n\ncd9f7432892b5d9355ff405220508915\nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#generate-download-scripts",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#generate-download-scripts",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Generate download scripts",
    "text": "Generate download scripts\nwget -O FILE URL\n\n\nCode\n### setup download file wget command\ndat = dat_metadata_arrange\ndat = dat %&gt;% dplyr::mutate(\n        CMD = paste(\n            \"wget\", \"--append-output=run_download.log.txt\", \"-O\", File_Name, File_URL\n        )\n    )\n\n### add Shebang and initial commands\ndat = dat %&gt;% dplyr::select(CMD)\ndat = rbind('echo -n \"\" &gt; run_download.log.txt', dat)\ncolnames(dat) = \"#!/bin/bash\"\n\n### assign and show\ndat_download_script = dat\nfun_display_table(dat)\n\n\n\n\n\n#!/bin/bash\n\n\n\n\necho -n \"\" &gt; run_download.log.txt\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv https://www.encodeproject.org/files/ENCFF421TJX/@@download/ENCFF421TJX.tsv\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw https://www.encodeproject.org/files/ENCFF585HTZ/@@download/ENCFF585HTZ.bigWig\n\n\nwget --append-output=run_download.log.txt -O K562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw https://www.encodeproject.org/files/ENCFF876JOV/@@download/ENCFF876JOV.bigWig"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#save-results",
    "href": "notebooks/04_prepare_annotation/rnaseq_01_total_create_download_script_R.html#save-results",
    "title": "Prepare ENCODE RNA-seq 01",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### set output path\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\n### create directory if not exist\ndir.create(txt_fdiry, showWarnings = FALSE)\n\n### write checksum file\ntxt_fname  = \"run_download_files.sh\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_script\nwrite_tsv(dat, txt_fpath)\n\n### save table\ntxt_fname  = \"checksum_md5sum.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndat = dat_download_checksum\nwrite_tsv(dat, txt_fpath, col_names = FALSE)"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html",
    "href": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html",
    "title": "Prepare ENCODE RNA-seq 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variable\nCode\nTXT_FOLDER = \"encode_rnaseq\""
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#import-data",
    "href": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#import-data",
    "title": "Prepare ENCODE RNA-seq 03",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nchecksum_md5sum.txt \nchecksum_results.txt \nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv \nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw \nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw \nrun_download_files.log.txt \nrun_download_files.sh \nrun_download.log.txt \ntmp \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\ntxt_fname  = \"K562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_rnaseq_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 59526    17\n\n\n\n\n\ngene_id\ntranscript_id(s)\nlength\neffective_length\nexpected_count\nTPM\nFPKM\nposterior_mean_count\nposterior_standard_deviation_of_count\npme_TPM\npme_FPKM\nTPM_ci_lower_bound\nTPM_ci_upper_bound\nTPM_coefficient_of_quartile_variation\nFPKM_ci_lower_bound\nFPKM_ci_upper_bound\nFPKM_coefficient_of_quartile_variation\n\n\n\n\n10904\n10904\n93\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12954\n12954\n94\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12956\n12956\n72\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12958\n12958\n82\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12960\n12960\n73\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12962\n12962\n72\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#explore-data",
    "href": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#explore-data",
    "title": "Prepare ENCODE RNA-seq 03",
    "section": "Explore data",
    "text": "Explore data\nShow distribution of gene expression\n\n\nCode\ndat = dat_rnaseq_import\nsummary(dat$TPM)\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n     0.00      0.00      0.00     16.80      0.54 152445.71 \n\n\n\n\nCode\ndat = dat_rnaseq_import\ndat = dat %&gt;% dplyr::filter(TPM &gt; 0, TPM &lt;= 2000)\ngpt = ggplot(dat, aes(x=TPM)) +\n    geom_histogram(bins=30) +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=5)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_rnaseq_import\ndat = dat %&gt;% dplyr::filter(TPM &gt; 0, TPM &lt;= 2000)\ngpt = ggplot(dat, aes(x=TPM)) +\n    geom_histogram(bins=30) +\n    scale_y_log10() +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=5)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#summary",
    "href": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#summary",
    "title": "Prepare ENCODE RNA-seq 03",
    "section": "Summary",
    "text": "Summary\nNumber of genes with TPM as zero\n\n\nCode\n### init\ndat = dat_rnaseq_import\n\n### Total\ntmp  = dat\nnum1 = length(unique(tmp$gene_id))\n\n### TPM == 0\ntmp = dat %&gt;% dplyr::filter(TPM == 0)\nnum2 = length(unique(tmp$gene_id))\n\n### TMP &gt; 0\ntmp = dat %&gt;% dplyr::filter(TPM &gt; 0)\nnum3 = length(unique(tmp$gene_id))\n\n### TMP &gt; 1\ntmp = dat %&gt;% dplyr::filter(TPM &gt; 1)\nnum4 = length(unique(tmp$gene_id))\n\n### show\ncat(\"\",\n    \"#{Gene | Total } =\", num1, \"\\n\",\n    \"#{Gene | TPM==0} =\", num2, \"\\n\",\n    \"#{Gene | TPM &gt;0} =\", num3, \"\\n\",\n    \"#{Gene | TPM &gt;1} =\", num4, \"\\n\"\n)\n\n\n #{Gene | Total } = 59526 \n #{Gene | TPM==0} = 33608 \n #{Gene | TPM &gt;0} = 25918 \n #{Gene | TPM &gt;1} = 13184"
  },
  {
    "objectID": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#save-results",
    "href": "notebooks/04_prepare_annotation/rnaseq_03_total_explore_data_R.html#save-results",
    "title": "Prepare ENCODE RNA-seq 03",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### prepare dataframe\ndat = dat_rnaseq_import\ndat = dat %&gt;% dplyr::filter(TPM &gt; 0, TPM &lt;= 2000)\n\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n### create plot\ngpt = ggplot(dat, aes(x=TPM)) +\n    geom_histogram(bins=30) +\n    scale_y_log10() +\n    theme_cowplot() +\n    theme_text +\n    background_grid() +\n    labs(x = \"TPM\", y = \"Count\", \n         title = \"Distribution of K562 RNA-seq (TPM &gt; 0)\")\n\n### assign and show\ngpt_export = gpt\noptions(repr.plot.height=4, repr.plot.width=6)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.rnaseq.distribution.tpm.nonzero.below2k.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 4, width = 6, units = \"in\")\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.rnaseq.distribution.tpm.nonzero.below2k.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, gpt_export, height = 4, width = 6, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html",
    "title": "Prepare ASTARR Input MACS Peaks 02",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_macs\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html#define-file-labeling",
    "title": "Prepare ASTARR Input MACS Peaks 02",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nprint(vec_txt_fname)\n\n\n[1] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\"\n[2] \"K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\"       \n\n\n\n\nCode\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = c(\n        \"K562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\",\n        \"K562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\"\n    ),\n    \"Label\"  = c(\"fcc_astarr_macs_input_overlap\", \"fcc_astarr_macs_input_union\")\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nfcc_astarr_macs\nK562.hg38.ASTARR.macs.KS91.input.rep_all.max_overlaps.q5.bed.gz\nfcc_astarr_macs_input_overlap\n\n\nfcc_astarr_macs\nK562.hg38.ASTARR.macs.KS91.input.rep_all.union.q5.bed.gz\nfcc_astarr_macs_input_union"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_astarr_macs_02_export_metadata_R.html#save-results",
    "title": "Prepare ASTARR Input MACS Peaks 02",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html",
    "title": "Prepare ASTARR CSAW Peaks 01",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh\nSet global variables\nCode\necho ${FD_ALEX}\n\n\n/data/reddylab/Alex\nCode\nFD_INP=${FD_ALEX}/tmp\nFD_OUT=${FD_DAT}/processed/fcc_astarr_csaw"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#check-data",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#check-data",
    "title": "Prepare ASTARR CSAW Peaks 01",
    "section": "Check data",
    "text": "Check data\n\n\nCode\nFP_INPS=($(ls ${FD_INP}/atacSTARR.ultra_deep.6dna7rna*))\nbasename -a ${FP_INPS[@]}\n\n\natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.common_file_formatted.txt\natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.tsv\natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.bed\natacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.txt\natacSTARR.ultra_deep.6dna7rna.csaw_tab_best.hg38.v10.tsv\n\n\n\n\nCode\nFP_INPS=($(ls ${FD_INP}/atacSTARR.ultra_deep.corrected*))\nbasename -a ${FP_INPS[@]}\n\n\natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.down.bed\natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt.gz\natacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.up.bed\natacSTARR.ultra_deep.corrected.csaw.hg38.v10.tsv\natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.tsv\natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.bed\natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.txt\natacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw_tab_best.hg38.v10.tsv"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#copy-to-data-source",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#copy-to-data-source",
    "title": "Prepare ASTARR CSAW Peaks 01",
    "section": "Copy to data source",
    "text": "Copy to data source\n\n\nCode\nmkdir -p ${FD_OUT}\ncp ${FD_INP}/atacSTARR.ultra_deep.corrected* ${FD_OUT}/\n\n\n\n\nCode\nmkdir -p ${FD_OUT}\ncp ${FD_INP}/atacSTARR.ultra_deep.6dna7rna* ${FD_OUT}/"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#check-results",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_01_acquire_data_SH.html#check-results",
    "title": "Prepare ASTARR CSAW Peaks 01",
    "section": "Check results",
    "text": "Check results\n\n\nCode\nls -1 ${FD_DAT}/processed\n\n\nCRISPRi_FlowFISH_K562_Riley_JinWoo\nCRISPRi_Growth_K562_Gersbach_Alex\nfcc_astarr_csaw\nfcc_enhancer_Junke_zscore_240415\nfcc_enhancer_Junke_zscore_240513_astarr_filter\nfcc_enhancer_Junke_zscore_240611\nfcc_trackhub_JinWoo\nMPRA_Lenti_K562_Nadav_Vikram_230621\nMPRA_Tiling_K562_Tewhey_Hannah\nReadmd.md\nSTARR_ATAC_K562_Reddy_KS274_240311\nSTARR_ATAC_K562_Reddy_KS91_210401\nSTARR_WHG_K562_Reddy_A001_Alex\nSTARR_WHG_K562_Reddy_A001_Kari\nTF_modules_Shannon\n\n\n\n\nCode\nls -l ${FD_DAT}/processed/fcc_astarr_csaw\n\n\ntotal 1364016\n-rw-r--r-- 1 kk319 nogroup  29585549 May 12 15:39 atacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.common_file_formatted.txt\n-rw-r--r-- 1 kk319 nogroup  37906290 May 12 15:39 atacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.tsv\n-rw-r--r-- 1 kk319 nogroup 162923789 May 12 15:39 atacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.bed\n-rw-r--r-- 1 kk319 nogroup 410557124 May 12 15:39 atacSTARR.ultra_deep.6dna7rna.csaw.hg38.v10.windows.txt\n-rw-r--r-- 1 kk319 nogroup  52066228 May 12 15:39 atacSTARR.ultra_deep.6dna7rna.csaw_tab_best.hg38.v10.tsv\n-rw-r--r-- 1 kk319 nogroup    821885 May 12 15:39 atacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.down.bed\n-rw-r--r-- 1 kk319 nogroup  29082966 May  9  2024 atacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt\n-rw-r--r-- 1 kk319 nogroup   8802019 May 12 15:39 atacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.txt.gz\n-rw-r--r-- 1 kk319 nogroup   1268836 May 12 15:39 atacSTARR.ultra_deep.corrected.csaw.hg38.v10.common_file_formatted.up.bed\n-rw-r--r-- 1 kk319 nogroup  37180893 May 12 15:39 atacSTARR.ultra_deep.corrected.csaw.hg38.v10.tsv\n-rw-r--r-- 1 kk319 nogroup  37180893 May 12 15:39 atacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.tsv\n-rw-r--r-- 1 kk319 nogroup 156656669 May 12 15:39 atacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.bed\n-rw-r--r-- 1 kk319 nogroup 394467786 May 12 15:39 atacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw.hg38.v10.windows.txt\n-rw-r--r-- 1 kk319 nogroup  38222659 May 12 15:39 atacSTARR.ultra_deep.corrected.no_reps_5_and_6.csaw_tab_best.hg38.v10.tsv"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_astarr_csaw\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html#define-file-labeling",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\nprint(vec_txt_fname)\n\n\n[1] \"K562.hg38.ASTARR.csaw.KS91.bed.gz\"   \n[2] \"K562.hg38.ASTARR.csaw.KSMerge.bed.gz\"\n\n\n\n\nCode\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname,\n    \"Label\"  = c(\"fcc_astarr_csaw_KS91\", \"fcc_astarr_csaw_KSMerge\")\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nfcc_astarr_csaw\nK562.hg38.ASTARR.csaw.KS91.bed.gz\nfcc_astarr_csaw_KS91\n\n\nfcc_astarr_csaw\nK562.hg38.ASTARR.csaw.KSMerge.bed.gz\nfcc_astarr_csaw_KSMerge"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_astarr_csaw_03_export_metadata_R.html#save-results",
    "title": "Prepare ASTARR CSAW Peaks 03",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html",
    "title": "Prepare TSS annotation 01",
    "section": "",
    "text": "To acquire K562 specific TSS annotation, previously we have select the TSS with highest K562 Pol2 signals among the isoform of each genes. Here, we will further filter out lowly expressed genes using K562 RNA-seq.\nSet environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variable\nCut-off threshold for lowly expressed genes\nCode\nNUM_TPM_CUTOFF = 1"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#import-data",
    "title": "Prepare TSS annotation 01",
    "section": "Import data",
    "text": "Import data\nRead data: TSS\n\n\nCode\ntxt_folder = \"fcc_trackhub_JinWoo\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562_TSS_selected_by_higest_Pol2_TSS_sig.out \ntrackDb.txt \n\n\n\n\nCode\n### set file path\ntxt_folder = \"fcc_trackhub_JinWoo\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname  = \"K562_TSS_selected_by_higest_Pol2_TSS_sig.out\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_import = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 29330     4\n\n\n\n\n\ngene_name\nchr\nTSS\nTSS_POL2_sig\n\n\n\n\nA1BG-AS1\nchr19\n58351969\n1.5218000\n\n\nA1BG\nchr19\n58353492\n5.6228400\n\n\nA1CF\nchr10\n50885675\n0.0070613\n\n\n\n\n\nRead data: Gene ID table\n\n\nCode\ntxt_folder = \"genome_gene\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nbiomart.ensembl_gene_111.GRCh38.p14.gene_stable_id2name_tss.tsv.gz \nbiomart.ensembl_gene_111.GRCh38.p14.gene_stable_id2name.tsv.gz \ndemap.v24Q2.AchillesCommonEssentialControls.csv \n\n\n\n\nCode\n### set file path\ntxt_folder = \"genome_gene\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname  = \"biomart.ensembl_gene_111.GRCh38.p14.gene_stable_id2name_tss.tsv.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_gene_table = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 629744     10\n\n\n\n\n\nGene stable ID\nGene stable ID version\nTranscript stable ID\nTranscript stable ID version\nGene name\nGene Synonym\nStrand\nTranscription start site (TSS)\nTranscript start (bp)\nTranscript end (bp)\n\n\n\n\nENSG00000291190\nENSG00000291190.1\nENST00000543404\nENST00000543404.5\nA2MP1\nA2MP\n-1\n9234207\n9228533\n9234207\n\n\nENSG00000291084\nENSG00000291084.1\nENST00000574727\nENST00000574727.5\nALOX12P2\nALOX12E\n1\n6853861\n6853861\n6902192\n\n\nENSG00000291084\nENSG00000291084.1\nENST00000573104\nENST00000573104.5\nALOX12P2\nALOX12E\n1\n6853921\n6853921\n6859433\n\n\n\n\n\nRead data: RNA-seq\n\n\nCode\ntxt_folder = \"encode_rnaseq\"\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nchecksum_md5sum.txt \nchecksum_results.txt \nK562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv \nK562.hg38.ENCSR615EEK.ENCFF585HTZ.RNAseq_total.strand_pos.bw \nK562.hg38.ENCSR615EEK.ENCFF876JOV.RNAseq_total.strand_neg.bw \nrun_download_files.log.txt \nrun_download_files.sh \nrun_download.log.txt \ntmp \n\n\n\n\nCode\n### set file path\ntxt_folder = \"encode_rnaseq\"\ntxt_fdiry  = file.path(FD_DAT, \"external\", txt_folder)\ntxt_fname  = \"K562.hg38.ENCSR615EEK.ENCFF421TJX.RNAseq_total.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### show and assign\ndat_gene_rnaseq_import = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 59526    17\n\n\n\n\n\ngene_id\ntranscript_id(s)\nlength\neffective_length\nexpected_count\nTPM\nFPKM\nposterior_mean_count\nposterior_standard_deviation_of_count\npme_TPM\npme_FPKM\nTPM_ci_lower_bound\nTPM_ci_upper_bound\nTPM_coefficient_of_quartile_variation\nFPKM_ci_lower_bound\nFPKM_ci_upper_bound\nFPKM_coefficient_of_quartile_variation\n\n\n\n\n10904\n10904\n93\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12954\n12954\n94\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12956\n12956\n72\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-columns-of-region-data-into-bed-format",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-columns-of-region-data-into-bed-format",
    "title": "Prepare TSS annotation 01",
    "section": "Arrange columns of region data into bed format",
    "text": "Arrange columns of region data into bed format\n\n\nCode\n### init\ndat = dat_region_import\n\n### arrange columns into bed format\ndat = dat %&gt;% \n    dplyr::rename(\n        \"Chrom\" = \"chr\",\n        \"Gene\"  = \"gene_name\",\n        \"Score\" = \"TSS_POL2_sig\",\n        \"ChromStart\" = \"TSS\"\n    ) %&gt;%\n    dplyr::mutate(ChromEnd = ChromStart + 1) %&gt;%\n    dplyr::mutate(Region = fun_gen_region(Chrom, ChromStart, ChromEnd)) %&gt;%\n    dplyr::select(Chrom, ChromStart, ChromEnd, Region, Gene, Score)\n\n### assign and show\ndat_region_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 29330     6\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\n\n\n\n\nchr19\n58351969\n58351970\nchr19:58351969-58351970\nA1BG-AS1\n1.5218000\n\n\nchr19\n58353492\n58353493\nchr19:58353492-58353493\nA1BG\n5.6228400\n\n\nchr10\n50885675\n50885676\nchr10:50885675-50885676\nA1CF\n0.0070613"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-and-select-columns-of-rna-seq-data",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-and-select-columns-of-rna-seq-data",
    "title": "Prepare TSS annotation 01",
    "section": "Arrange and select columns of RNA-seq data",
    "text": "Arrange and select columns of RNA-seq data\n\n\nCode\n### init\ndat = dat_gene_rnaseq_import\n\n### create gene stable ID\ndat = dat %&gt;% \n    dplyr::filter(str_detect(gene_id, \"ENS\")) %&gt;% \n    tidyr::separate(gene_id, c(\"gene_id_stable\", \"gene_id_version\"), sep=\"\\\\.\", remove = FALSE) %&gt;%\n    dplyr::select(\n        `gene_id`, \n        `gene_id_stable`,\n        `transcript_id(s)`,\n        `length`,\n        `TPM`) %&gt;%\n    dplyr::distinct()\n\n### rename columns\ncolnames(dat) = c(\n    \"Gene_Stable_ID_Version\",\n    \"Gene_Stable_ID\", \n    \"Transcript_Stable_ID_Version\",\n    \"Length\",\n    \"TPM\")\n\n### assign and show\ndat_gene_rnaseq_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 58780     5\n\n\n\n\n\nGene_Stable_ID_Version\nGene_Stable_ID\nTranscript_Stable_ID_Version\nLength\nTPM\n\n\n\n\nENSG00000000003.14\nENSG00000000003\nENST00000373020.8,ENST00000494424.1,ENST00000496771.5,ENST00000612152.4,ENST00000614008.4\n1301.17\n0.05\n\n\nENSG00000000005.5\nENSG00000000005\nENST00000373031.4,ENST00000485971.1\n1339.00\n0.04\n\n\nENSG00000000419.12\nENSG00000000419\nENST00000371582.8,ENST00000371584.8,ENST00000371588.9,ENST00000413082.1,ENST00000466152.5,ENST00000494752.1\n1088.79\n31.75"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-and-select-columns-of-gene-table",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-and-select-columns-of-gene-table",
    "title": "Prepare TSS annotation 01",
    "section": "Arrange and select columns of Gene table",
    "text": "Arrange and select columns of Gene table\n\n\nCode\n### init\ndat = dat_gene_table\n\n### arrange columns\ncolnames(dat) = c(\n    \"Gene_Stable_ID\", \n    \"Gene_Stable_ID_Version\",\n    \"Transcript_Stable_ID\", \n    \"Transcript_Stable_ID_Version\",\n    \"Gene_Name\",\n    \"Gene_Synonym\",\n    \"Strand\",\n    \"Loc_TSS\",\n    \"ChromStart_TSS\",\n    \"ChromEnd_TSS\"\n)\ndat = dat %&gt;% \n    dplyr::select(Gene_Stable_ID, Gene_Name, Gene_Synonym) %&gt;% \n    dplyr::distinct()\n\n### assign and show\ndat_gene_id2name = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 110032      3\n\n\n\n\n\nGene_Stable_ID\nGene_Name\nGene_Synonym\n\n\n\n\nENSG00000291190\nA2MP1\nA2MP\n\n\nENSG00000291084\nALOX12P2\nALOX12E\n\n\nENSG00000286112\nKYAT1\nCCBL1"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#filter-gene-by-tpm",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#filter-gene-by-tpm",
    "title": "Prepare TSS annotation 01",
    "section": "Filter Gene by TPM",
    "text": "Filter Gene by TPM\n\n\nCode\n### filter gene by TPM\ndat = dat_gene_rnaseq_arrange\ndat = dat %&gt;% dplyr::filter(TPM &gt; NUM_TPM_CUTOFF)\nvec = dat$Gene_Stable_ID\n\n### get filtered gene names\ndat = dat_gene_id2name\ndat = dat %&gt;% dplyr::filter(Gene_Stable_ID %in% vec)\nvec = c(\n    dat$Gene_Name,\n    dat$Gene_Synonym\n)\n\n### filter regions by gene names\ndat = dat_region_arrange\ndat = dat %&gt;% dplyr::filter(Gene %in% vec)\n\n### assign and show\ndat_region_filter = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 11892     6\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\n\n\n\n\nchr19\n58351969\n58351970\nchr19:58351969-58351970\nA1BG-AS1\n1.5218000\n\n\nchr19\n58353492\n58353493\nchr19:58353492-58353493\nA1BG\n5.6228400\n\n\nchr12\n9115919\n9115920\nchr12:9115919-9115920\nA2M\n0.0400522"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-the-results",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#arrange-the-results",
    "title": "Prepare TSS annotation 01",
    "section": "Arrange the results",
    "text": "Arrange the results\nTSS only filtering isoforms using K562 Pol2\n\n\nCode\n### TSS filtered by Pol2\ndat = dat_region_arrange\n\n### add group and label for future annotation\ndat = dat %&gt;% dplyr::mutate(Group = \"TSS_Pol2\", Label = Gene)\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### assign and show\ndat_region_arrange_label_pol2 = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 29330     8\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n\n\nchr1\n11873\n11874\nchr1:11873-11874\nDDX11L1\n0.00023\nTSS_Pol2\nDDX11L1\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-1\n9.43812\nTSS_Pol2\nMIR6859-1\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-2\n9.43812\nTSS_Pol2\nMIR6859-2\n\n\n\n\n\nTSS filtering using both K562 Pol2 and K562 RNA-seq\n\n\nCode\n### TSS filtered by Pol2 & RNA-seq\ndat = dat_region_filter\n\n### add group and label for future annotation\ndat = dat %&gt;% dplyr::mutate(Group = \"TSS_Pol2_RNAseq\", Label = Gene)\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### assign and show\ndat_region_arrange_label_pol2_rnaseq = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 11892     8\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n\n\nchr1\n29370\n29371\nchr1:29370-29371\nWASH7P\n0.00023\nTSS_Pol2_RNAseq\nWASH7P\n\n\nchr1\n827522\n827523\nchr1:827522-827523\nLINC00115\n64.46560\nTSS_Pol2_RNAseq\nLINC00115\n\n\nchr1\n827590\n827591\nchr1:827590-827591\nLINC01128\n64.46030\nTSS_Pol2_RNAseq\nLINC01128"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#define-column-description",
    "title": "Prepare TSS annotation 01",
    "section": "Define column description",
    "text": "Define column description\n\n\nCode\n### set column name and description\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Region\",     \"Region coordinate\",\n    \"Gene\",       \"Gene name\",\n    \"Score\",      \"highest level of pol2 chip seq (ENCFF914WIS.bigWig) at [TSS-500, TSS+500] among TSS isoform\",\n    \"Group\",      \"Type of Annotation\",\n    \"Label\",      \"Label of Annotation\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nRegion\nRegion coordinate\n\n\nGene\nGene name\n\n\nScore\nhighest level of pol2 chip seq (ENCFF914WIS.bigWig) at [TSS-500, TSS+500] among TSS isoform\n\n\nGroup\nType of Annotation\n\n\nLabel\nLabel of Annotation"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_tss_01_pol2_export_data_R.html#save-results",
    "title": "Prepare TSS annotation 01",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nwrite table (TSS processed by JinWoo)\n\n\nCode\n### set file path\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### write tabel\ndat = dat_region_arrange_label_pol2\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\n\n\nCode\n### set file path\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### write tabel\ndat = dat_region_arrange_label_pol2\nwrite_tsv(dat, txt_fpath, col_names = TRUE)\n\n\nwrite table (TSS further filtered by RNA-seq)\n\n\nCode\n### set file path\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### write tabel\ndat = dat_region_arrange_label_pol2_rnaseq\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\n\n\nCode\n### set file path\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### write tabel\ndat = dat_region_arrange_label_pol2_rnaseq\nwrite_tsv(dat, txt_fpath, col_names = TRUE)\n\n\nSave a copy to the reference folder\n\n\nCode\n### set file path\ntxt_folder = \"genome_tss\"\ntxt_fdiry  = file.path(FD_REF, txt_folder)\ntxt_fname  = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.bed.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### get table\ndat = dat_region_filter\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\n\n### write tabel\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\nfun_display_table(head(dat, 3))\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\n\n\n\n\nchr1\n29370\n29371\nchr1:29370-29371\nWASH7P\n0.00023\n\n\nchr1\n827522\n827523\nchr1:827522-827523\nLINC00115\n64.46560\n\n\nchr1\n827590\n827591\nchr1:827590-827591\nLINC01128\n64.46030"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html",
    "title": "Prepare TSS annotation 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_REGION_FOLDER = \"genome_tss\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#import-data",
    "title": "Prepare TSS annotation 03",
    "section": "Import data",
    "text": "Import data\n\n\nCode\n### set file path\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_tss_pol2 = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 29330     8\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n\n\nchr1\n11873\n11874\nchr1:11873-11874\nDDX11L1\n0.00023\nTSS_Pol2\nDDX11L1\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-1\n9.43812\nTSS_Pol2\nMIR6859-1\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-2\n9.43812\nTSS_Pol2\nMIR6859-2\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-3\n9.43812\nTSS_Pol2\nMIR6859-3\n\n\nchr1\n17436\n17437\nchr1:17436-17437\nMIR6859-4\n9.43812\nTSS_Pol2\nMIR6859-4\n\n\nchr1\n29370\n29371\nchr1:29370-29371\nWASH7P\n0.00023\nTSS_Pol2\nWASH7P\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname = \"K562.hg38.TSS.selected_by_highest_Pol2_signal.filtered_by_RNAseq_TPM.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_tss_pol2_rnaseq = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 11892     8\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n\n\nchr1\n29370\n29371\nchr1:29370-29371\nWASH7P\n0.000230\nTSS_Pol2_RNAseq\nWASH7P\n\n\nchr1\n827522\n827523\nchr1:827522-827523\nLINC00115\n64.465600\nTSS_Pol2_RNAseq\nLINC00115\n\n\nchr1\n827590\n827591\nchr1:827590-827591\nLINC01128\n64.460300\nTSS_Pol2_RNAseq\nLINC01128\n\n\nchr1\n876802\n876803\nchr1:876802-876803\nFAM41C\n0.007884\nTSS_Pol2_RNAseq\nFAM41C\n\n\nchr1\n959256\n959257\nchr1:959256-959257\nNOC2L\n104.866000\nTSS_Pol2_RNAseq\nNOC2L\n\n\nchr1\n960583\n960584\nchr1:960583-960584\nKLHL17\n8.225710\nTSS_Pol2_RNAseq\nKLHL17"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#explore-tss-of-genes-tested-in-crispri-hcrff",
    "href": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#explore-tss-of-genes-tested-in-crispri-hcrff",
    "title": "Prepare TSS annotation 03",
    "section": "Explore TSS of genes tested in CRISPRi-HCRFF",
    "text": "Explore TSS of genes tested in CRISPRi-HCRFF\n\n\nCode\nvec_txt_gene = c(\n    \"GATA1\", \"HDAC6\",\n    \"MYC\", \"PVT1\", \n    \"FADS1\",\"FADS2\",\"FADS3\", \"FEN1\",\n    \"LMO2\", \"HBE1\", \"HBG1\",  \"HBG2\", \n    \"HBE1\", \"HBG1\", \"HBG2\",  \"HBS1L\", \"MYB\",\n    \"LMO2\", \"CAT\",  \"CAPRIN1\", \n    \"ERP29\",\"NMU\",  \"MEF2C\", \"CD164\"\n)\n\n\n\n\nCode\ndat = dat_region_tss_pol2\ndat = dat %&gt;% dplyr::filter(Gene %in% vec_txt_gene)\ndat\n\n\n\nA spec_tbl_df: 20 × 8\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nchr11\n5249857\n5249858\nchr11:5249857-5249858\nHBG1\n17.42930\nTSS_Pol2\nHBG1\n\n\nchr11\n5254781\n5254782\nchr11:5254781-5254782\nHBG2\n15.73020\nTSS_Pol2\nHBG2\n\n\nchr11\n5269945\n5269946\nchr11:5269945-5269946\nHBE1\n319.92500\nTSS_Pol2\nHBE1\n\n\nchr11\n33869878\n33869879\nchr11:33869878-33869879\nLMO2\n8.55278\nTSS_Pol2\nLMO2\n\n\nchr11\n34051730\n34051731\nchr11:34051730-34051731\nCAPRIN1\n203.81000\nTSS_Pol2\nCAPRIN1\n\n\nchr11\n34438933\n34438934\nchr11:34438933-34438934\nCAT\n68.08190\nTSS_Pol2\nCAT\n\n\nchr11\n61792910\n61792911\nchr11:61792910-61792911\nFEN1\n232.47000\nTSS_Pol2\nFEN1\n\n\nchr11\n61816202\n61816203\nchr11:61816202-61816203\nFADS2\n418.26700\nTSS_Pol2\nFADS2\n\n\nchr11\n61817003\n61817004\nchr11:61817003-61817004\nFADS1\n158.66100\nTSS_Pol2\nFADS1\n\n\nchr11\n61891545\n61891546\nchr11:61891545-61891546\nFADS3\n8.24971\nTSS_Pol2\nFADS3\n\n\nchr12\n112013347\n112013348\nchr12:112013347-112013348\nERP29\n282.37200\nTSS_Pol2\nERP29\n\n\nchr4\n55636298\n55636299\nchr4:55636298-55636299\nNMU\n58.38680\nTSS_Pol2\nNMU\n\n\nchr5\n88883184\n88883185\nchr5:88883184-88883185\nMEF2C\n35.03940\nTSS_Pol2\nMEF2C\n\n\nchr6\n109382467\n109382468\nchr6:109382467-109382468\nCD164\n276.34100\nTSS_Pol2\nCD164\n\n\nchr6\n135054822\n135054823\nchr6:135054822-135054823\nHBS1L\n153.87900\nTSS_Pol2\nHBS1L\n\n\nchr6\n135181307\n135181308\nchr6:135181307-135181308\nMYB\n15.10130\nTSS_Pol2\nMYB\n\n\nchr8\n127736230\n127736231\nchr8:127736230-127736231\nMYC\n272.78100\nTSS_Pol2\nMYC\n\n\nchr8\n127794532\n127794533\nchr8:127794532-127794533\nPVT1\n10.31760\nTSS_Pol2\nPVT1\n\n\nchrX\n48786589\n48786590\nchrX:48786589-48786590\nGATA1\n70.42080\nTSS_Pol2\nGATA1\n\n\nchrX\n48802066\n48802067\nchrX:48802066-48802067\nHDAC6\n183.30000\nTSS_Pol2\nHDAC6\n\n\n\n\n\n\n\nCode\ndat = dat_region_tss_pol2_rnaseq\ndat = dat %&gt;% dplyr::filter(Gene %in% vec_txt_gene)\ndat\n\n\n\nA spec_tbl_df: 20 × 8\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGene\nScore\nGroup\nLabel\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nchr11\n5249857\n5249858\nchr11:5249857-5249858\nHBG1\n17.42930\nTSS_Pol2_RNAseq\nHBG1\n\n\nchr11\n5254781\n5254782\nchr11:5254781-5254782\nHBG2\n15.73020\nTSS_Pol2_RNAseq\nHBG2\n\n\nchr11\n5269945\n5269946\nchr11:5269945-5269946\nHBE1\n319.92500\nTSS_Pol2_RNAseq\nHBE1\n\n\nchr11\n33869878\n33869879\nchr11:33869878-33869879\nLMO2\n8.55278\nTSS_Pol2_RNAseq\nLMO2\n\n\nchr11\n34051730\n34051731\nchr11:34051730-34051731\nCAPRIN1\n203.81000\nTSS_Pol2_RNAseq\nCAPRIN1\n\n\nchr11\n34438933\n34438934\nchr11:34438933-34438934\nCAT\n68.08190\nTSS_Pol2_RNAseq\nCAT\n\n\nchr11\n61792910\n61792911\nchr11:61792910-61792911\nFEN1\n232.47000\nTSS_Pol2_RNAseq\nFEN1\n\n\nchr11\n61816202\n61816203\nchr11:61816202-61816203\nFADS2\n418.26700\nTSS_Pol2_RNAseq\nFADS2\n\n\nchr11\n61817003\n61817004\nchr11:61817003-61817004\nFADS1\n158.66100\nTSS_Pol2_RNAseq\nFADS1\n\n\nchr11\n61891545\n61891546\nchr11:61891545-61891546\nFADS3\n8.24971\nTSS_Pol2_RNAseq\nFADS3\n\n\nchr12\n112013347\n112013348\nchr12:112013347-112013348\nERP29\n282.37200\nTSS_Pol2_RNAseq\nERP29\n\n\nchr4\n55636298\n55636299\nchr4:55636298-55636299\nNMU\n58.38680\nTSS_Pol2_RNAseq\nNMU\n\n\nchr5\n88883184\n88883185\nchr5:88883184-88883185\nMEF2C\n35.03940\nTSS_Pol2_RNAseq\nMEF2C\n\n\nchr6\n109382467\n109382468\nchr6:109382467-109382468\nCD164\n276.34100\nTSS_Pol2_RNAseq\nCD164\n\n\nchr6\n135054822\n135054823\nchr6:135054822-135054823\nHBS1L\n153.87900\nTSS_Pol2_RNAseq\nHBS1L\n\n\nchr6\n135181307\n135181308\nchr6:135181307-135181308\nMYB\n15.10130\nTSS_Pol2_RNAseq\nMYB\n\n\nchr8\n127736230\n127736231\nchr8:127736230-127736231\nMYC\n272.78100\nTSS_Pol2_RNAseq\nMYC\n\n\nchr8\n127794532\n127794533\nchr8:127794532-127794533\nPVT1\n10.31760\nTSS_Pol2_RNAseq\nPVT1\n\n\nchrX\n48786589\n48786590\nchrX:48786589-48786590\nGATA1\n70.42080\nTSS_Pol2_RNAseq\nGATA1\n\n\nchrX\n48802066\n48802067\nchrX:48802066-48802067\nHDAC6\n183.30000\nTSS_Pol2_RNAseq\nHDAC6"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#visualize-distribution-of-pol2-scores",
    "href": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#visualize-distribution-of-pol2-scores",
    "title": "Prepare TSS annotation 03",
    "section": "Visualize: Distribution of POL2 Scores",
    "text": "Visualize: Distribution of POL2 Scores\n\n\nCode\ndat = bind_rows(dat_region_tss_pol2, dat_region_tss_pol2_rnaseq)\ngpt = ggplot(dat, aes(x = Score, color = Group)) +\n    geom_density() +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_region_tss_pol2\ndat = dat %&gt;% dplyr::filter(Score &gt; 0, Score &lt;= 100)\ngpt = ggplot(dat, aes(x = Score)) +\n    geom_density() +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_region_tss_pol2_rnaseq\ndat = dat %&gt;% dplyr::filter(Score &gt; 0, Score &lt;= 100)\ngpt = ggplot(dat, aes(x = Score)) +\n    geom_density() +\n    theme_cowplot() +\n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=7)\nprint(gpt)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_tss_03_pol2_explore_data_R.html#save-figures",
    "title": "Prepare TSS annotation 03",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 14),\n    axis.title = element_text(size = 14),\n    axis.text  = element_text(size = 14)\n)\n\n\n\n\nCode\ndat = dat_region_tss_pol2\ndat = dat %&gt;% dplyr::filter(Score &gt; 0, Score &lt;= 100)\ngpt = ggplot(dat, aes(x = Score)) +\n    geom_density(fill = \"#80b1d3\") +\n    theme_cowplot() +\n    background_grid() +\n    labs(x = \"POLR2A Score\", y = \"Density\", title = \"TSS (Filtered by K562 Pol2)\")\n\ngpt_score_tss_pol2 = gpt\n\noptions(repr.plot.height=4, repr.plot.width=6)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_region_tss_pol2_rnaseq\ndat = dat %&gt;% dplyr::filter(Score &gt; 0, Score &lt;= 100)\ngpt = ggplot(dat, aes(x = Score)) +\n    geom_density(fill = \"#fb8072\") +\n    theme_cowplot() +\n    background_grid() +\n    labs(x = \"POLR2A Score\", y = \"Density\", title = \"TSS (Filtered by K562 Pol2 and RNA-seq)\") +\n    scale_y_continuous(breaks=c(0, 0.01, 0.02))\n\ngpt_score_tss_pol2_rnaseq = gpt\n\noptions(repr.plot.height=4, repr.plot.width=6)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\nlst = list(gpt_score_tss_pol2, gpt_score_tss_pol2_rnaseq)\nlst = lapply(lst, function(gpt){return(gpt + theme_text)})\n\nplt = plot_grid(plotlist = lst, ncol = 1, align = \"v\")\n\nplt_export = plt\n\noptions(repr.plot.height=6, repr.plot.width=6)\nprint(plt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.tss.distribution.pol2.below1h.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 6, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.tss.distribution.pol2.below1h.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 6, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html",
    "href": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh\nSet global variables\nCode\nTXT_FOLDER=\"encode_open_chromatin\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html#execute",
    "href": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html#execute",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "Execute",
    "text": "Execute\nRun download script\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nchmod +x ./run_download_files.sh\n\n./run_download_files.sh\n\n\nRun checksum\n\n\nCode\nFN_EXE=run_checksum_files.sh\nFP_EXE=${FD_EXE}/${FN_EXE}\n\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_INP=${FD_OUT}/checksum_md5sum.txt\nFP_OUT=${FD_OUT}/checksum_results.txt\n\n${FP_EXE} ${FP_CNF} ${FD_OUT} ${FP_INP} ${FP_OUT}\n\n\nHostname:           plp-rcc-node-25\nSlurm Array Index: \nTime Stamp:         05-13-25+15:33:27\n\nChange directory:\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_open_chromatin\n\nChecksum files...\n\n\nDone!\nRun Time: 7 seconds"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html#review",
    "href": "notebooks/05_prepare_region/region_ocr_02_execute_download_script_SH.html#review",
    "title": "Prepare ENCODE ATAC/DNase Peaks 02",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nls -sh {*bed.gz,*.bw} | wc -l\nls -sh {*bed.gz,*.bw}\n\n\n10\n1.3M K562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\n714M K562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw\n1.8M K562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\n672M K562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw\n4.8M K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\n825M K562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw\n2.7M K562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\n6.8M K562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\n2.8G K562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw\n4.1M K562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\n\n\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFN_OUT=K562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head -n 3\n\n\nchr1    100028923   100029241   Peak_202759 52  .   2.91347 5.24652 3.38358 74\nchr1    100037575   100038998   Peak_172664 68  .   1.83651 6.83702 4.90355 60\nchr1    100037575   100038998   Peak_30781  934 .   5.32597 93.45621    90.75060    988\n\n\nCheck checksum results\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_OUT=${FD_OUT}/checksum_results.txt\n\ncat ${FP_OUT}\ncat ${FP_OUT} | grep \"FAILED\" && echo \"FAILED\" || echo \"All PASSED\"\n\n\nK562.hg38.ENCSR000EKS.ENCFF972GVB.DNase.bw: OK\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz: OK\nK562.hg38.ENCSR000EOT.ENCFF414OGC.DNase.bw: OK\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz: OK\nK562.hg38.ENCSR483RKN.ENCFF600FDO.ATAC.bw: OK\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz: OK\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz: OK\nK562.hg38.ENCSR868FGK.ENCFF357GNC.ATAC.bw: OK\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz: OK\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz: OK\nAll PASSED\n\n\nCheck execution log\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\nhead -n 10 ${FD_OUT}/run_download.log.txt\n\n\n--2025-05-13 15:30:59--  https://www.encodeproject.org/files/ENCFF972GVB/@@download/ENCFF972GVB.bigWig\nResolving www.encodeproject.org (www.encodeproject.org)... 34.211.244.144\nConnecting to www.encodeproject.org (www.encodeproject.org)|34.211.244.144|:443... connected.\nHTTP request sent, awaiting response... 307 Temporary Redirect\nLocation: https://encode-public.s3.amazonaws.com/2020/11/22/953ca40d-376f-4043-8dc9-710dd64a5ea9/ENCFF972GVB.bigWig?response-content-disposition=attachment%3B%20filename%3DENCFF972GVB.bigWig&AWSAccessKeyId=ASIATGZNGCNXZYW4CKKO&Signature=FO5Mfgj23r5A6t8MWa4rZLhRDc8%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEEsaCXVzLXdlc3QtMiJGMEQCIBk3ht1wXuBOY0mV2%2BeMo8mYnoKBcLNUJ2417mpMgBWFAiBlqbrBgNXV9vo7awtqpBuPWrFcmbwljHbf826BIeRgxSq8BQj0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDIyMDc0ODcxNDg2MyIMh4BXxWB6vCEm%2FvTbKpAFCDAFujPYEwvRs8y68Jn1ZxiRLvC5xRckEo2mO8cpUMjBPVf4S3%2BCBIom0n4PvOdj6loQ%2BZUcK4fs9sUTvB%2B4RO4XD%2BlNtXk7X07mPBIBfxKzAlThb6Po3Q9LKGwyGO3F1ns57RCYpoulHWAsOrO9Ixq3MKXa659ijhzW%2FKc%2Fvk4LNUQfZ%2FrnTS5a%2BABAIFT1sN2KEVrL%2Fpnnn6WU%2B6ST%2FjmvwBHFlkwcRlY8ILxAV%2Bo2H1kXPrBak0jYPUZ7Xzlo%2BLwYhow7cM57Twrvxg2pY1SC2btSurNcuiyQyBIfX8bMmkp90AeI4o49wMsdlrGcKHOs7ReLbfIlXSi%2BOMKst7hPzTzwj3r4FWAFoTbDwSui2i3wI1vFvDmxmp7erIMatpINeoUwfEulyMsKoFmnFJa0MhlmecWpflvbM91F3wmcNd8tB1nq7620Hg7kvoRwOJpUKoqBGzewRii3pk81VVxljNALdyXi8Sd5MJAKbMzjuRPKtMtrhwcoRPkWdswyalApQItJCD9UjkEVNB47gqVB%2BWBbeVLHDrjLtzs4AKoaCwv6EEvD4X9PVYZsE0rTgVRfJKzXiROkccfLfnmCvMcPHy7bwNgCfVRZLlipbUiKhmxTqVDAhijtvsFaRSD%2BgnCOE7A3683hidqYI0dgs4vQU1I%2BecYDlq%2BAtSq01gDLSSdWPot6ndMUdEeG4MGaBp49UAdHTY4NL7AgyKth7mhVfPVrf5DOFjDWyUOOtnlmMROsazqjVc66jSBg8BIO62OoCPvebsM35TxumSE91914jL7Xc0H5nstpZsX1qXCVyTc6CXmysrtXSW3t9l4QadJUTAiBOIZ1IDlzynGRON8Pry%2FUwR6lynTf4RgR0vcwvqqOwQY6sgH3Qj3QMM7W5Ds%2BH1TlV8g6vk8YV3oNgQG97XWl2mB5qG%2FrTlZsBwquG3hDsduh7YT%2FHAqQyYZEYy3dZz5QNZmIi59jngQ%2BQ6KbsLvO7n8E6OsaV5jQUiwxRqrNe0Tw6Yg%2FXVacY0%2F8ta5n8I6NSkc7dYEobUgonasBq3%2FISArPGFFjr9C9Kcl1Kr%2FAYwmbjuRcUqx5nWceIVx%2F%2BdN9IjCwuuaYXmGZlTX%2FB%2FKyD%2FSO41a9&Expires=1747294260 [following]\n--2025-05-13 15:31:00--  https://encode-public.s3.amazonaws.com/2020/11/22/953ca40d-376f-4043-8dc9-710dd64a5ea9/ENCFF972GVB.bigWig?response-content-disposition=attachment%3B%20filename%3DENCFF972GVB.bigWig&AWSAccessKeyId=ASIATGZNGCNXZYW4CKKO&Signature=FO5Mfgj23r5A6t8MWa4rZLhRDc8%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEEsaCXVzLXdlc3QtMiJGMEQCIBk3ht1wXuBOY0mV2%2BeMo8mYnoKBcLNUJ2417mpMgBWFAiBlqbrBgNXV9vo7awtqpBuPWrFcmbwljHbf826BIeRgxSq8BQj0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDIyMDc0ODcxNDg2MyIMh4BXxWB6vCEm%2FvTbKpAFCDAFujPYEwvRs8y68Jn1ZxiRLvC5xRckEo2mO8cpUMjBPVf4S3%2BCBIom0n4PvOdj6loQ%2BZUcK4fs9sUTvB%2B4RO4XD%2BlNtXk7X07mPBIBfxKzAlThb6Po3Q9LKGwyGO3F1ns57RCYpoulHWAsOrO9Ixq3MKXa659ijhzW%2FKc%2Fvk4LNUQfZ%2FrnTS5a%2BABAIFT1sN2KEVrL%2Fpnnn6WU%2B6ST%2FjmvwBHFlkwcRlY8ILxAV%2Bo2H1kXPrBak0jYPUZ7Xzlo%2BLwYhow7cM57Twrvxg2pY1SC2btSurNcuiyQyBIfX8bMmkp90AeI4o49wMsdlrGcKHOs7ReLbfIlXSi%2BOMKst7hPzTzwj3r4FWAFoTbDwSui2i3wI1vFvDmxmp7erIMatpINeoUwfEulyMsKoFmnFJa0MhlmecWpflvbM91F3wmcNd8tB1nq7620Hg7kvoRwOJpUKoqBGzewRii3pk81VVxljNALdyXi8Sd5MJAKbMzjuRPKtMtrhwcoRPkWdswyalApQItJCD9UjkEVNB47gqVB%2BWBbeVLHDrjLtzs4AKoaCwv6EEvD4X9PVYZsE0rTgVRfJKzXiROkccfLfnmCvMcPHy7bwNgCfVRZLlipbUiKhmxTqVDAhijtvsFaRSD%2BgnCOE7A3683hidqYI0dgs4vQU1I%2BecYDlq%2BAtSq01gDLSSdWPot6ndMUdEeG4MGaBp49UAdHTY4NL7AgyKth7mhVfPVrf5DOFjDWyUOOtnlmMROsazqjVc66jSBg8BIO62OoCPvebsM35TxumSE91914jL7Xc0H5nstpZsX1qXCVyTc6CXmysrtXSW3t9l4QadJUTAiBOIZ1IDlzynGRON8Pry%2FUwR6lynTf4RgR0vcwvqqOwQY6sgH3Qj3QMM7W5Ds%2BH1TlV8g6vk8YV3oNgQG97XWl2mB5qG%2FrTlZsBwquG3hDsduh7YT%2FHAqQyYZEYy3dZz5QNZmIi59jngQ%2BQ6KbsLvO7n8E6OsaV5jQUiwxRqrNe0Tw6Yg%2FXVacY0%2F8ta5n8I6NSkc7dYEobUgonasBq3%2FISArPGFFjr9C9Kcl1Kr%2FAYwmbjuRcUqx5nWceIVx%2F%2BdN9IjCwuuaYXmGZlTX%2FB%2FKyD%2FSO41a9&Expires=1747294260\nResolving encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)... 52.92.202.17, 52.92.176.57, 52.92.204.249, ...\nConnecting to encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)|52.92.202.17|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 747881155 (713M) [binary/octet-stream]"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_REGION_FOLDER = \"encode_open_chromatin\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#define-column-description",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Define column description",
    "text": "Define column description\nThe peak file is in narrowPeak format, which is a standard six field bed with four additional fields (BED6+4 format)\n\n\nCode\n### ENCODE narrowPeak: Narrow (or Point-Source) Peaks format\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Name given to a region; Use '.' if no name is assigned.\",\n    \"Score\",      \"Indicates how dark the peak will be displayed in the browser (0-1000).\",\n    \"Strand\",     \"+/- to denote strand or orientation. Use '.' if no orientation is assigned.\",\n    \"SignalValue\",\"Measurement of overall (usually, average) enrichment for the region.\",\n    \"PValue\",     \"Measurement of statistical significance (-log10). Use -1 if no pValue is assigned.\",\n    \"QValue\",     \"Measurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\",\n    \"Peak\",       \"Point-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called.\"\n    \n)\n\n### assign and show\ndat_cnames = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nName given to a region; Use '.' if no name is assigned.\n\n\nScore\nIndicates how dark the peak will be displayed in the browser (0-1000).\n\n\nStrand\n+/- to denote strand or orientation. Use '.' if no orientation is assigned.\n\n\nSignalValue\nMeasurement of overall (usually, average) enrichment for the region.\n\n\nPValue\nMeasurement of statistical significance (-log10). Use -1 if no pValue is assigned.\n\n\nQValue\nMeasurement of statistical significance using false discovery rate (-log10). Use -1 if no qValue is assigned.\n\n\nPeak\nPoint-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called."
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#define-file-labeling",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\n\n### arrange table\ndat = dat %&gt;% tidyr::separate(\n        FName, \n        c(\"Biosample\", \"Genome\", \"Index_Experiment\", \"Index_File\", \"Assay\", \"File_Type\", \"File_Ext\"),\n        sep = \"\\\\.\",\n        remove = FALSE\n    ) %&gt;%\n    dplyr::mutate(Label = paste(tolower(Assay), Index_File, sep=\"_\")) %&gt;%\n    dplyr::select(Folder, FName, Label) \n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EKS.ENCFF274YGF.DNase.bed.gz\ndnase_ENCFF274YGF\n\n\nencode_open_chromatin\nK562.hg38.ENCSR000EOT.ENCFF185XRG.DNase.bed.gz\ndnase_ENCFF185XRG\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF558BLC.ATAC.bed.gz\natac_ENCFF558BLC\n\n\nencode_open_chromatin\nK562.hg38.ENCSR483RKN.ENCFF925CYR.ATAC.bed.gz\natac_ENCFF925CYR\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF333TAT.ATAC.bed.gz\natac_ENCFF333TAT\n\n\nencode_open_chromatin\nK562.hg38.ENCSR868FGK.ENCFF948AFM.ATAC.bed.gz\natac_ENCFF948AFM"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_ocr_04_export_metadata_R.html#save-results",
    "title": "Prepare ENCODE ATAC/DNase Peaks 04",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cnames\nwrite_tsv(dat, txt_fpath)\n\n\n\n\nCode\ntxt_folder = TXT_REGION_FOLDER\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html",
    "href": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html",
    "title": "Prepare ENCODE ATAC/DNase Peaks 06",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nsuppressMessages(suppressWarnings(library(GenomicDistributions)))\nsuppressMessages(suppressWarnings(library(GenomicRanges)))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#import-data",
    "title": "Prepare ENCODE ATAC/DNase Peaks 06",
    "section": "Import data",
    "text": "Import data\nHelper function: loading data\n\n\nCode\nfun_load_data = function(txt_region_fdiry){\n    ### set file directory\n    txt_fdiry  = file.path(txt_region_fdiry, \"summary\")\n    txt_fname = \"description.tsv\"\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    \n    ### get column names\n    dat = read_tsv(txt_fpath, show_col_types = FALSE)\n    vec_txt_cname = dat$Name\n\n    ### set file directory\n    txt_fdiry  = file.path(txt_region_fdiry, \"summary\")\n    txt_fname = \"metadata.label.tsv\"\n    txt_fpath = file.path(txt_fdiry, txt_fname)\n    \n    ### get file labels\n    dat_metadata = read_tsv(txt_fpath, show_col_types = FALSE)\n    \n    ### set directory\n    txt_fdiry  = txt_region_fdiry\n    txt_fglob  = file.path(txt_fdiry, \"*bed*\")\n    \n    ### get file names and labels\n    vec_txt_fpath = Sys.glob(txt_fglob)\n    vec_txt_fname = basename(vec_txt_fpath)\n    vec_txt_label = fun_str_map_match(\n        vec_txt_fname, \n        dat_metadata$FName, \n        dat_metadata$Label, \n        .default=vec_txt_fname)\n\n    ### further modification of labels\n    vec_txt_label = gsub(\"^dnase\", \"DNase\", vec_txt_label)\n    vec_txt_label = gsub(\"^atac\",  \"ATAC\",  vec_txt_label)\n    vec_txt_label = gsub(\n        \"fcc_astarr_macs_input_union\", \n        \"ASTARR Input (Union)\",  \n        vec_txt_label)\n    vec_txt_label = gsub(\n        \"fcc_astarr_macs_input_overlap\", \n        \"ASTARR Input (Overlap)\",  \n        vec_txt_label)\n    \n    ### read all region files\n    lst = lapply(vec_txt_fpath, function(txt_fpath){\n        dat = read_tsv(txt_fpath, col_names = vec_txt_cname, show_col_types = FALSE)\n        return(dat)\n    })\n    names(lst) = vec_txt_label\n    \n    return(lst)\n}\n\n\nLoad data\n\n\nCode\n### set file directory\ntxt_folder = \"fcc_astarr_macs\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\n### read tables\nlst = fun_load_data(txt_fdiry)\n\n### assign and show\nlst_dat_region_astarr_input = lst\nprint(lapply(lst, nrow))\n\n\n$`ASTARR Input (Overlap)`\n[1] 150042\n\n$`ASTARR Input (Union)`\n[1] 246852\n\n\n\n\n\nCode\n### set file directory\ntxt_folder = \"encode_open_chromatin\"\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\n### read tables\nlst = fun_load_data(txt_fdiry)\n\n### assign and show\nlst_dat_region_encode_ocr = lst\nprint(lapply(lst, nrow))\n\n\n$DNase_ENCFF274YGF\n[1] 118721\n\n$DNase_ENCFF185XRG\n[1] 159277\n\n$ATAC_ENCFF558BLC\n[1] 203874\n\n$ATAC_ENCFF925CYR\n[1] 123009\n\n$ATAC_ENCFF333TAT\n[1] 269800\n\n$ATAC_ENCFF948AFM\n[1] 181340\n\n\n\nConvert dataframe to granges\n\n\nCode\n### init\nlst_dat = lst_dat_region_astarr_input\n\n### setup granges\nlst_grg = lapply(lst_dat, function(dat){\n    ### filter out ChrY\n    vec = paste0(\"chr\", c(1:22, \"X\"))\n    dat = dat %&gt;% dplyr::filter(Chrom %in% vec)\n\n    ### dataframe -&gt; granges     \n    grg = GRanges(\n        seqnames = dat$Chrom,\n        ranges   = IRanges(start = dat$ChromStart, end = dat$ChromEnd)\n    )\n    return(grg)\n})\n\n### preserve labels\nnames(lst_grg) = names(lst_dat)\n\n### create grangesList\nlst_grg = GRangesList(lst_grg)\n\n### assign and show\nlst_grg_region_astarr_input = lst_grg\n\n\n\n\nCode\n### init\nlst_dat = lst_dat_region_encode_ocr\n\n### setup granges\nlst_grg = lapply(lst_dat, function(dat){\n    ### filter out ChrY\n    vec = paste0(\"chr\", c(1:22, \"X\"))\n    dat = dat %&gt;% dplyr::filter(Chrom %in% vec)\n\n    ### dataframe -&gt; granges     \n    grg = GRanges(\n        seqnames = dat$Chrom,\n        ranges   = IRanges(start = dat$ChromStart, end = dat$ChromEnd)\n    )\n    return(grg)\n})\n\n### preserve labels\nnames(lst_grg) = names(lst_dat)\n\n### create grangesList\nlst_grg = GRangesList(lst_grg)\n\n### assign and show\nlst_grg_region_encode_ocr = lst_grg"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#summarize",
    "href": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#summarize",
    "title": "Prepare ENCODE ATAC/DNase Peaks 06",
    "section": "Summarize",
    "text": "Summarize\n\n\nCode\nlst_grg = lst_grg_region_astarr_input\nlst_dat = list(\n    ### aggregate and count the distribution of regions across bins of ref genome\n    \"chrom_bin_cnt\" = suppressMessages(calcChromBinsRef(         lst_grg, \"hg38\", binCount = 3000)),\n\n    ### distance of each region to its nearest feature element\n    \"fdist_tss_frq\" = suppressMessages(calcFeatureDistRefTSS(    lst_grg, \"hg38\")),\n    \n    ### partition distribution by different gencode element (UTR, exon, intron, etc)\n    \"gcode_par_frq\" = suppressMessages(calcPartitionsRef(        lst_grg, \"hg38\")),\n    \"gcode_par_ove\" = suppressMessages(calcExpectedPartitionsRef(lst_grg, \"hg38\"))\n)\n\nlst_dat_stats_astarr_input = lst_dat\n\n\n\n\nCode\nlst_grg = lst_grg_region_encode_ocr\nlst_dat = list(\n    ### aggregate and count the distribution of regions across bins of ref genome\n    \"chrom_bin_cnt\" = suppressMessages(calcChromBinsRef(         lst_grg, \"hg38\", binCount = 3000)),\n\n    ### distance of each region to its nearest feature element\n    \"fdist_tss_frq\" = suppressMessages(calcFeatureDistRefTSS(    lst_grg, \"hg38\")),\n    \n    ### partition distribution by different gencode element (UTR, exon, intron, etc)\n    \"gcode_par_frq\" = suppressMessages(calcPartitionsRef(        lst_grg, \"hg38\")),\n    \"gcode_par_ove\" = suppressMessages(calcExpectedPartitionsRef(lst_grg, \"hg38\"))\n)\n\nlst_dat_stats_encode_ocr = lst_dat"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_ocr_06_explore_comparison_R.html#explore-data",
    "title": "Prepare ENCODE ATAC/DNase Peaks 06",
    "section": "Explore data",
    "text": "Explore data\n\nChromosome distribution (Genomic distribution)\n\n\nCode\n### set text size\ntheme_text = theme(\n    title        = element_text(size = 16),\n    axis.title   = element_text(size = 16),\n    axis.text    = element_text(size = 12),\n    legend.title = element_text(size = 0),\n    legend.text  = element_text(size = 14),\n    strip.text.y = element_text(size = 14)\n)\n\n\nASTARR Input MACS peaks\n\n\nCode\n### get data\nlst = lst_dat_stats_astarr_input\ndat = lst[[\"chrom_bin_cnt\"]]\ngpt = plotChromBins(dat)\ngpt = gpt + theme_text\n\n### assign plot\ngpt_astarr_input = gpt\n\n### show plot\noptions(repr.plot.height=8, repr.plot.width=10)\ngpt\n\n\nWarning message:\n\"Removed 246 rows containing missing values or values outside the scale range (`geom_bar()`).\"\n\n\n\n\n\n\n\n\n\nENCODE Open chromatin regions\n\n\nCode\n### get data\nlst = lst_dat_stats_encode_ocr\ndat = lst[[\"chrom_bin_cnt\"]]\ngpt = plotChromBins(dat)\ngpt = gpt + theme_text\n\n### assign plot\ngpt_encode_ocr = gpt\n\n### show plot\noptions(repr.plot.height=8, repr.plot.width=10)\ngpt\n\n\nWarning message:\n\"Removed 1578 rows containing missing values or values outside the scale range\n(`geom_bar()`).\"\n\n\n\n\n\n\n\n\n\nCombine and save\n\n\nCode\n### combine plot\nplt = plot_grid(\n    gpt_astarr_input + labs(title = \"ATAC-STARR Input\"), \n    gpt_encode_ocr   + labs(title = \"ENCODE ATAC/DNase\"),\n    nrow  = 1,\n    align = \"h\"\n)\nplt_export = plt\n\n### show plot\noptions(repr.plot.height=8, repr.plot.width=20)\nprint(plt)\n\n\nWarning message:\n\"Removed 246 rows containing missing values or values outside the scale range (`geom_bar()`).\"\nWarning message:\n\"Removed 1578 rows containing missing values or values outside the scale range\n(`geom_bar()`).\"\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.distribution.chromosome.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.distribution.chromosome.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\n\n\n\nPercentage partition distribution plots\n\n\nCode\n### set text size\ntheme_text = theme(\n    title        = element_text(size = 14),\n    axis.title   = element_text(size = 14),\n    axis.text    = element_text(size = 14),\n    legend.title = element_text(size = 0),\n    legend.text  = element_text(size = 12)\n)\n\n\nASTARR Input MACS peaks\n\n\nCode\n### arrange data\nlst = lst_dat_stats_astarr_input\ndat = lst[[\"gcode_par_frq\"]]\n\n### Fix warning: .internal.selfref\n### [.data.table(df, , :=(FreqPercent, Freq/sum(Freq) * 100)\ndat = data.table::copy(dat)\ndat[, FreqPercent := Freq/sum(Freq)*100]\n\n### reorder genomic partition\nvec = c(\"intergenic\", \"intron\", \"exon\", \"fiveUTR\", \"threeUTR\", \"promoterCore\", \"promoterProx\")\ndat = dat %&gt;% dplyr::mutate(partition = factor(partition, levels=vec))\n\n### generate plot\ngpt = plotPartitions(dat)\ngpt = gpt + theme_cowplot()\ngpt = gpt + theme_text\ngpt = gpt + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\ngpt = gpt + theme(\n    legend.position = \"inside\", \n    legend.position.inside = c(0.4, 0.8),\n    legend.background = element_rect(fill = \"white\")\n)\n\n### assign plot\ngpt_astarr_input = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=5)\ngpt\n\n\n\n\n\n\n\n\n\nENCODE Open chromatin regions\n\n\nCode\n### arrange data\nlst = lst_dat_stats_encode_ocr\ndat = lst[[\"gcode_par_frq\"]]\n\n### Fix warning: .internal.selfref\n### [.data.table(df, , :=(FreqPercent, Freq/sum(Freq) * 100)\ndat = data.table::copy(dat)\ndat[, FreqPercent := Freq/sum(Freq)*100]\n\n### reorder genomic partition\nvec = c(\"intergenic\", \"intron\", \"exon\", \"fiveUTR\", \"threeUTR\", \"promoterCore\", \"promoterProx\")\ndat = dat %&gt;% dplyr::mutate(partition = factor(partition, levels=vec))\n\n### generate plot\ngpt = plotPartitions(dat)\ngpt = gpt + theme_cowplot()\ngpt = gpt + theme_text\ngpt = gpt + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\ngpt = gpt + theme(\n    legend.position = \"inside\", \n    legend.position.inside = c(0.4, 0.8),\n    legend.background = element_rect(fill = \"white\")\n)\n\n### assign plot\ngpt_encode_ocr = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=5)\ngpt\n\n\n\n\n\n\n\n\n\nCombine and save\n\n\nCode\n### combine plot\nplt = plot_grid(\n    gpt_astarr_input + labs(x = \"\") + theme(plot.title = element_text(hjust = 0)), \n    gpt_encode_ocr   + labs(title = \"\", x = \"\"),\n    nrow  = 1,\n    align = \"h\"\n)\n\n### assign plot\nplt_export = plt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=9)\nprint(plt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.frequency.genomic_partition.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.frequency.genomic_partition.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\n\n\n\nOdds partition distribution plots\n\n\nCode\n### set text size\ntheme_text = theme(\n    title        = element_text(size = 14),\n    axis.title   = element_text(size = 14),\n    axis.text    = element_text(size = 14),\n    legend.title = element_text(size = 0),\n    legend.text  = element_text(size = 10)\n)\n\n\nASTARR Input MACS peaks\n\n\nCode\nlst = lst_dat_stats_astarr_input\ndat = lst[[\"gcode_par_ove\"]]\nhead(dat)\n\n\n\nA data.table: 6 × 7\n\n\npartition\nobserved\nexpected\nlog10OE\nChi.square.pval\nmethod\nname\n\n\n&lt;chr&gt;\n&lt;int&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\npromoterCore\n10559\n86.03854\n2.088929755\n0.00e+00\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\npromoterProx\n2026\n1633.90980\n0.093411363\n7.80e-11\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\nthreeUTR\n7065\n2006.08224\n0.546763433\n0.00e+00\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\nfiveUTR\n5173\n467.16997\n1.044267564\n0.00e+00\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\nexon\n9212\n2112.67148\n0.639521960\n0.00e+00\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\nintron\n55058\n55991.45493\n-0.007301321\n4.23e-04\nPearson's Chi-squared test with Yates' continuity correction\nASTARR Input (Overlap)\n\n\n\n\n\n\n\nCode\n### arrange data\nlst = lst_dat_stats_astarr_input\ndat = lst[[\"gcode_par_ove\"]]\n\n### Fix warning: .internal.selfref\ndat = data.table::copy(dat)\n\n### reorder genomic partition\nvec = c(\"intergenic\", \"intron\", \"exon\", \"fiveUTR\", \"threeUTR\", \"promoterCore\", \"promoterProx\")\ndat = dat %&gt;% dplyr::mutate(partition = factor(partition, levels=rev(vec)))\n\n### generate plot\ngpt = plotExpectedPartitions(dat)\ngpt = gpt + scale_y_continuous(breaks = seq(0, 3, by=0.5))\ngpt = gpt + theme_cowplot()\ngpt = gpt + theme_text\ngpt = gpt + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\ngpt = gpt + theme(\n    legend.position = \"inside\", \n    legend.position.inside = c(0.5, 0.8),\n    legend.background = element_rect(fill = \"white\")\n)\n\n### assign plot\ngpt_astarr_input = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=6)\ngpt\n\n\n\n\n\n\n\n\n\nENCODE Open chromatin regions\n\n\nCode\n### get data\nlst = lst_dat_stats_encode_ocr\ndat = lst[[\"gcode_par_ove\"]]\n\n### Fix warning: .internal.selfref\ndat = data.table::copy(dat)\n\n### reorder genomic partition\nvec = c(\"intergenic\", \"intron\", \"exon\", \"fiveUTR\", \"threeUTR\", \"promoterCore\", \"promoterProx\")\ndat = dat %&gt;% dplyr::mutate(partition = factor(partition, levels=rev(vec)))\n\n### generate plot\ngpt = plotExpectedPartitions(dat)\ngpt = gpt + scale_y_continuous(breaks = seq(0, 3, by=0.5))\ngpt = gpt + theme_cowplot()\ngpt = gpt + theme_text\ngpt = gpt + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\ngpt = gpt + theme(\n    legend.position = \"inside\", \n    legend.position.inside = c(0.5, 0.8),\n    legend.background = element_rect(fill = \"white\")\n)\n\n### assign plot\ngpt_encode_ocr = gpt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=7)\ngpt\n\n\n\n\n\n\n\n\n\nCombine and save\n\n\nCode\n### combine plot\nplt = plot_grid(\n    gpt_astarr_input + labs(title=\"Enrichment across genomic partitions\"), \n    gpt_encode_ocr,\n    nrow  = 1,\n    align = \"h\"\n)\n\n### assign plot\nplt_export = plt\n\n### show plot\noptions(repr.plot.height=5, repr.plot.width=10)\nprint(plt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.enrichment.genomic_partition.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.compare_ocr.enrichment.genomic_partition.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 8, width = 20, units = \"in\")\n\n\n\n\nDistribution of nearest feature distance (TSS)\nASTARR Input MACS peaks\n\n\nCode\n### get data\nlst = lst_dat_stats_astarr_input\ndat = lst[[\"fdist_tss_frq\"]]\n\n### create and show plot\noptions(repr.plot.height=10, repr.plot.width=15)\nplotFeatureDist(dat, featureName=\"TSS\", size = 1e+03)\n\n\nScale for x is already present.\nAdding another scale for x, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\nENCODE Open chromatin regions\n\n\nCode\n### get data\nlst = lst_dat_stats_encode_ocr\ndat = lst[[\"fdist_tss_frq\"]]\n\n### create and show plot\noptions(repr.plot.height=10, repr.plot.width=15)\nplotFeatureDist(dat, featureName=\"TSS\", size = 1e+03)\n\n\nScale for x is already present.\nAdding another scale for x, which will replace the existing scale."
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html",
    "href": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html",
    "title": "Prepare ENCODE Chromatin State 02",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh\nSet global variables\nCode\nTXT_FOLDER=\"encode_chromatin_states\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#execute",
    "href": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#execute",
    "title": "Prepare ENCODE Chromatin State 02",
    "section": "Execute",
    "text": "Execute\nRun download script\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nchmod +x ./run_download_files.sh\n\n./run_download_files.sh\n\n\nRun checksum\n\n\nCode\nFN_EXE=run_checksum_files.sh\nFP_EXE=${FD_EXE}/${FN_EXE}\n\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_INP=${FD_OUT}/checksum_md5sum.txt\nFP_OUT=${FD_OUT}/checksum_results.txt\n\n${FP_EXE} ${FP_CNF} ${FD_OUT} ${FP_INP} ${FP_OUT}\n\n\nHostname:           plp-rcc-node-25\nSlurm Array Index: \nTime Stamp:         05-15-25+16:54:52\n\nChange directory:\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_chromatin_states\n\nChecksum files...\n\n\nDone!\nRun Time: 0 seconds"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#copy-additional-ccres-silencer-annotations",
    "href": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#copy-additional-ccres-silencer-annotations",
    "title": "Prepare ENCODE Chromatin State 02",
    "section": "Copy additional cCREs silencer annotations",
    "text": "Copy additional cCREs silencer annotations\n\n\nCode\nFD_INP=${FD_REF}/encode_chromatin_states\nls ${FD_INP}\n\n\n ccres_v4.silencer.rest.tsv\n ccres_v4.silencer.starr.tsv\n ENCODE_K562_hg38_chromatin_states.tsv\n'Human epigenomes with ChromHMM state (DAC, Kaili Fan).xlsx'\n K562.ENCSR365YNI.ENCAN395TNA.metadata.tsv\n K562.ENCSR913HQX.ENCAN130HDM.metadata.tsv\n\n\n\n\nCode\nFD_INP=${FD_REF}/encode_chromatin_states\n\ncp ${FD_INP}/ccres_v4* ${FD_OUT}/"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#review",
    "href": "notebooks/05_prepare_region/region_chromstate_02_execute_download_script_SH.html#review",
    "title": "Prepare ENCODE Chromatin State 02",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nls -sh {*bed.gz,*.tsv} | wc -l\nls -sh {*bed.gz,*.tsv}\n\n\n4\n480K ccres_v4.silencer.rest.tsv\n364K ccres_v4.silencer.starr.tsv\n4.0M K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz\n 32M K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\n\n\n\n\nCode\nFN_OUT=K562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\nzcat ${FP_OUT} | head -n 3\n\n\nchr1    10033   10250   EH38E2776516    0   .   10033   10250   225,225,225 Low-DNase   All-data/Full-classification\nchr1    10385   10713   EH38E2776517    0   .   10385   10713   225,225,225 Low-DNase   All-data/Full-classification\nchr1    16097   16381   EH38E3951272    0   .   16097   16381   225,225,225 Low-DNase   All-data/Full-classification\n\n\n\n\nCode\nFN_OUT=K562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\nzcat ${FP_OUT} | head -n 3\n\n\nchr1    0   16000   Quies   1   .   0   16000   220,220,220\nchr1    16000   16200   TxWk    1   .   16000   16200   63,154,80\nchr1    16200   17400   Quies   1   .   16200   17400   220,220,220\n\n\n\n\nCode\nFN_OUT=ccres_v4.silencer.rest.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\ncat ${FP_OUT} | head -n 3\n\n\n# REST + cCREs                  \nChr Start   End cCRE accession  cCRE class  Silencer class\nchr10   100680786   100681128   EH38E4018829    CA-H3K4me3  REST+ silencer\n\n\n\n\nCode\nFN_OUT=ccres_v4.silencer.starr.tsv\nFP_OUT=${FD_OUT}/${FN_OUT}\ncat ${FP_OUT} | head -n 3\n\n\n# STARR silencer cCREs                          \nChr Start   End cCRE accession  cCRE class  CAPRA quantification    P-value Threshold\nchr13   22970420    22970595    EH38E4082602    CA  -2.7481 1.15E-09    Stringent\n\n\nCheck checksum results\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_OUT=${FD_OUT}/checksum_results.txt\n\ncat ${FP_OUT}\ncat ${FP_OUT} | grep \"FAILED\" && echo \"FAILED\" || echo \"All PASSED\"\n\n\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.bed.gz: OK\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.bed.gz: OK\nAll PASSED\n\n\nCheck execution log\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\nhead -n 10 ${FD_OUT}/run_download.log.txt\n\n\n--2025-05-15 16:54:45--  https://www.encodeproject.org/files/ENCFF286VQG/@@download/ENCFF286VQG.bed.gz\nResolving www.encodeproject.org (www.encodeproject.org)... 34.211.244.144\nConnecting to www.encodeproject.org (www.encodeproject.org)|34.211.244.144|:443... connected.\nHTTP request sent, awaiting response... 307 Temporary Redirect\nLocation: https://encode-public.s3.amazonaws.com/2022/11/23/179cba53-f3d4-47af-af56-c4e5a3cabeac/ENCFF286VQG.bed.gz?response-content-disposition=attachment%3B%20filename%3DENCFF286VQG.bed.gz&AWSAccessKeyId=ASIATGZNGCNXRX2474FR&Signature=twUgoJS1RV7mWE9XodrFfmLkrtc%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIQDOXOVSzF%2FWVrtWc21NXZ5RyaF614VEtjwLsjLI%2B6KjYAIgcRI17y%2FaSz0E7U%2B904Y%2FJcWVQIzy644ckWo1IrvtlGsqswUINRAAGgwyMjA3NDg3MTQ4NjMiDDj%2FcRBQJB4wGfNpMiqQBVmNbfT61m2dOZvL%2FKEDS673CKGrNvm28%2Fnrg%2B%2FmERskT2Yi4AQs3lBgIh1OK2INDnWG1WU3cj11UzTpT2e%2BzzFtlUuD%2BnIw0hq57gtGBa3sQVKa%2BP%2FfMpDVIxjnZaKtlgGh9Oe61Nn%2BLiNWTqYrbdPv3DFxH5Gly%2BTQoy%2BIKfoya2gst5ITmj0e2xFsYcWOSHUQZAnxtYmRjd6sceNywc3tnKmUBWExaE1LfkX5XHXtbqRMD9ZlrVghLRDhbNqWtKo0AhLzhCYsruplapuG3485DIG6iz83yYSSVCL7tlYe3olocd1Rm01jxRNMyKNiWY8G3q4tET1bwPphNqOWv1a8nbhQ99nbiDtgJmuHLiM8inIiO3QIzg9xVeNshhjCdCiTMJJrPGEcdvN9qkYlW%2Bkh2U%2FcA9AVoxBvwyU1PV4ElJuSxxrUBX16NXLHCAaTtp4AIiEyhUCy4gifjy%2BncBJLjzhz8z9E1O2EJTW0cg59eR%2FwI2ySq08Wm0tuhEKrcBoDZjnmhGJoaP3WY9atO3meWzggGJF0RBsYL9Eu%2FUtmvIQJcGxz7UwJLiXP%2BSrwsy8hRXgHvaByE2jX3Fdf3Dvo9FTRhx39vJSpiOGM9W3gs5M7%2FKGp0wFwsHMIDCGrMPPESbdB%2FTUqwCrD7ZXwWo7HYkfAi2dUXuN3edgAu%2BpKqQQBBi387kLfD2hiMfM997wte9Rxzpwj6oSf%2BusdWhEFk5wB0cxTxWdYMpJEidAJyedQFtk8oEqMkfO5kWhfCsy%2FhHtWCnCwjpvnPcP2jTanHOtolRlzRxBnIkkorBkLsCJskHD%2B8sBdayPhHs%2FajJAvzzF1gZAX5sam2g9sfa5YsHsb3Aa6VZNnfcEE6Np6MJqNmcEGOrEB0O3nrW4Ero9TYHHlwiP7kWKDbHQFFlJbUZmmUxyH8FvLwZvdFLo0pAdASWyM2DLy3%2F0Rc2cmnzdp3MEBVMQ1krrlWuoswSr9AZcFaLj50KmngBbO4nyahMRcjGVfj8jSIf9CUFEaqnJes6eqL%2Fezrxb4vPFHq7hVxVX1tqTBnBrD3PA%2BVyBHRe5o%2BUD42u%2F%2FElYDT6%2FEbcaCVbU%2FO6mhywZtwVQcgwOeOZD29RqwD7c0&Expires=1747472088 [following]\n--2025-05-15 16:54:48--  https://encode-public.s3.amazonaws.com/2022/11/23/179cba53-f3d4-47af-af56-c4e5a3cabeac/ENCFF286VQG.bed.gz?response-content-disposition=attachment%3B%20filename%3DENCFF286VQG.bed.gz&AWSAccessKeyId=ASIATGZNGCNXRX2474FR&Signature=twUgoJS1RV7mWE9XodrFfmLkrtc%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIQDOXOVSzF%2FWVrtWc21NXZ5RyaF614VEtjwLsjLI%2B6KjYAIgcRI17y%2FaSz0E7U%2B904Y%2FJcWVQIzy644ckWo1IrvtlGsqswUINRAAGgwyMjA3NDg3MTQ4NjMiDDj%2FcRBQJB4wGfNpMiqQBVmNbfT61m2dOZvL%2FKEDS673CKGrNvm28%2Fnrg%2B%2FmERskT2Yi4AQs3lBgIh1OK2INDnWG1WU3cj11UzTpT2e%2BzzFtlUuD%2BnIw0hq57gtGBa3sQVKa%2BP%2FfMpDVIxjnZaKtlgGh9Oe61Nn%2BLiNWTqYrbdPv3DFxH5Gly%2BTQoy%2BIKfoya2gst5ITmj0e2xFsYcWOSHUQZAnxtYmRjd6sceNywc3tnKmUBWExaE1LfkX5XHXtbqRMD9ZlrVghLRDhbNqWtKo0AhLzhCYsruplapuG3485DIG6iz83yYSSVCL7tlYe3olocd1Rm01jxRNMyKNiWY8G3q4tET1bwPphNqOWv1a8nbhQ99nbiDtgJmuHLiM8inIiO3QIzg9xVeNshhjCdCiTMJJrPGEcdvN9qkYlW%2Bkh2U%2FcA9AVoxBvwyU1PV4ElJuSxxrUBX16NXLHCAaTtp4AIiEyhUCy4gifjy%2BncBJLjzhz8z9E1O2EJTW0cg59eR%2FwI2ySq08Wm0tuhEKrcBoDZjnmhGJoaP3WY9atO3meWzggGJF0RBsYL9Eu%2FUtmvIQJcGxz7UwJLiXP%2BSrwsy8hRXgHvaByE2jX3Fdf3Dvo9FTRhx39vJSpiOGM9W3gs5M7%2FKGp0wFwsHMIDCGrMPPESbdB%2FTUqwCrD7ZXwWo7HYkfAi2dUXuN3edgAu%2BpKqQQBBi387kLfD2hiMfM997wte9Rxzpwj6oSf%2BusdWhEFk5wB0cxTxWdYMpJEidAJyedQFtk8oEqMkfO5kWhfCsy%2FhHtWCnCwjpvnPcP2jTanHOtolRlzRxBnIkkorBkLsCJskHD%2B8sBdayPhHs%2FajJAvzzF1gZAX5sam2g9sfa5YsHsb3Aa6VZNnfcEE6Np6MJqNmcEGOrEB0O3nrW4Ero9TYHHlwiP7kWKDbHQFFlJbUZmmUxyH8FvLwZvdFLo0pAdASWyM2DLy3%2F0Rc2cmnzdp3MEBVMQ1krrlWuoswSr9AZcFaLj50KmngBbO4nyahMRcjGVfj8jSIf9CUFEaqnJes6eqL%2Fezrxb4vPFHq7hVxVX1tqTBnBrD3PA%2BVyBHRe5o%2BUD42u%2F%2FElYDT6%2FEbcaCVbU%2FO6mhywZtwVQcgwOeOZD29RqwD7c0&Expires=1747472088\nResolving encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)... 52.92.228.217, 52.218.233.187, 52.92.165.145, ...\nConnecting to encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)|52.92.228.217|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 32698783 (31M) [binary/octet-stream]"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html",
    "title": "Prepare ENCODE Chromatin State 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"encode_chromatin_states\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html#define-file-labeling",
    "title": "Prepare ENCODE Chromatin State 04",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\n\n### assign and show\ndat_region = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\n\n\n\n\nencode_chromatin_states\nK562.hg38.cCREs.silencer_rest.bed.gz\n\n\nencode_chromatin_states\nK562.hg38.cCREs.silencer_starr.bed.gz\n\n\nencode_chromatin_states\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz\n\n\nencode_chromatin_states\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz\n\n\n\n\n\n\n\nCode\ndat = dat_region\ndat = dat %&gt;% dplyr::mutate(\n    Label = c(\n        \"encode_ccres_silencer_rest\",\n        \"encode_ccres_silencer_starr\",\n        \"encode_chromhmm_ENCFF106BGJ\",\n        \"encode_ccres_ENCFF286VQG\"\n    )\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nencode_chromatin_states\nK562.hg38.cCREs.silencer_rest.bed.gz\nencode_ccres_silencer_rest\n\n\nencode_chromatin_states\nK562.hg38.cCREs.silencer_starr.bed.gz\nencode_ccres_silencer_starr\n\n\nencode_chromatin_states\nK562.hg38.ENCSR365YNI.ENCFF106BGJ.ChromHMM.simplified.bed.gz\nencode_chromhmm_ENCFF106BGJ\n\n\nencode_chromatin_states\nK562.hg38.ENCSR913HQX.ENCFF286VQG.cCREs.simplified.bed.gz\nencode_ccres_ENCFF286VQG"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_chromstate_04_export_metadata_R.html#save-results",
    "title": "Prepare ENCODE Chromatin State 04",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html",
    "title": "Prepare TF Modules 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FODLER_INP = \"TF_modules_Shannon\"\nTXT_FOLDER_OUT = \"module_tf_shannon\"\nCode\ntxt_folder = TXT_FODLER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec) {cat(txt, \"\\n\")}\n\n\nK562.full.region.assignments.txt \nK562.TFzscore.txt"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#import-data",
    "title": "Prepare TF Modules 01",
    "section": "Import data",
    "text": "Import data\n\n\nCode\n### set directory\ntxt_folder = TXT_FODLER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname  = \"K562.full.region.assignments.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_module_full_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 173997     74\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n33\n34\n35\n36\n37\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n61\n63\n64\n65\n66\n67\n68\n71\n72\n73\n74\n75\n77\nchr\nstart\nend\nTFs\n\n\n\n\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n115702\n115751\nNONO,RNF2,FOXK2,NR2F1,SOX6,ESRRA,ATF4,GMEB1,NFIC,TRIM24,HDAC1,TCF12,NCOR1,NFE2,ATF7,ZNF24,GABPB1,ZBTB2,MTA3,FOXM1,ZBTB40,DPF2,NFRKB,HDAC2,GATAD2A,IKZF1,ARID3A,NBN,EP300,SMARCE1,ZNF281,KDM1A,NCOA1,MAFG,POLR2A,EGR1,REST,TCF3,SMARCC2,MTA1,MEIS2\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n118585\n118665\nRNF2,MAFG,NFE2L1,NFE2\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n136446\n136510\nCEBPB,ESRRA,NR2F1,EGR1\n\n\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n139031\n139110\nZFX,CTCF,RFX1\n\n\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n268005\n268051\nSMC3,CTCF,MAZ,ATF7,ARID2,ZNF281,REST,RAD21\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n586187\n586203\nCTCF,MAZ,SMC3\n\n\n\n\n\n\n\nCode\n### set directory\ntxt_folder = TXT_FODLER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname  = \"K562.TFzscore.txt\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_module_tfs_import = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 2503    2\n\n\n\n\n\nmodule\nTF\n\n\n\n\n1\nZNF589\n\n\n1\nJUNB\n\n\n1\nFOSL1\n\n\n1\nMEIS2\n\n\n1\nEGR1\n\n\n1\nMEF2D"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#rename-columns",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#rename-columns",
    "title": "Prepare TF Modules 01",
    "section": "Rename columns",
    "text": "Rename columns\n\n\nCode\ndat = dat_module_full_import\ndat = dat %&gt;% \n    dplyr::rename(\n        \"Chrom\"      = \"chr\",\n        \"ChromStart\" = \"start\",\n        \"ChromEnd\"   = \"end\"\n    ) %&gt;%\n    dplyr::mutate(Region = fun_gen_region(Chrom, ChromStart, ChromEnd))\n\n### assign and show\ndat_module_full = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 173997     75\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n33\n34\n35\n36\n37\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n61\n63\n64\n65\n66\n67\n68\n71\n72\n73\n74\n75\n77\nChrom\nChromStart\nChromEnd\nTFs\nRegion\n\n\n\n\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n115702\n115751\nNONO,RNF2,FOXK2,NR2F1,SOX6,ESRRA,ATF4,GMEB1,NFIC,TRIM24,HDAC1,TCF12,NCOR1,NFE2,ATF7,ZNF24,GABPB1,ZBTB2,MTA3,FOXM1,ZBTB40,DPF2,NFRKB,HDAC2,GATAD2A,IKZF1,ARID3A,NBN,EP300,SMARCE1,ZNF281,KDM1A,NCOA1,MAFG,POLR2A,EGR1,REST,TCF3,SMARCC2,MTA1,MEIS2\nchr1:115702-115751\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n118585\n118665\nRNF2,MAFG,NFE2L1,NFE2\nchr1:118585-118665\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n136446\n136510\nCEBPB,ESRRA,NR2F1,EGR1\nchr1:136446-136510\n\n\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n139031\n139110\nZFX,CTCF,RFX1\nchr1:139031-139110\n\n\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n268005\n268051\nSMC3,CTCF,MAZ,ATF7,ARID2,ZNF281,REST,RAD21\nchr1:268005-268051\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nchr1\n586187\n586203\nCTCF,MAZ,SMC3\nchr1:586187-586203\n\n\n\n\n\nCheck missing values\n\n\nCode\ndat = dat_module_full\ndat = dat %&gt;% dplyr::select(Chrom, ChromStart, ChromEnd, Region, TFs)\n\nlst = lapply(dat, function(vec){sum(is.na(vec))})\nprint(lst)\n\n\n$Chrom\n[1] 1\n\n$ChromStart\n[1] 1\n\n$ChromEnd\n[1] 1\n\n$Region\n[1] 0\n\n$TFs\n[1] 1\n\n\n\n\n\nCode\ndat = dat_module_full\ndat = dat %&gt;% dplyr::select(Chrom, ChromStart, ChromEnd, Region, TFs)\ndat = dat %&gt;% dplyr::filter(is.na(Chrom))\ndat\n\n\n\nA tibble: 1 × 5\n\n\nChrom\nChromStart\nChromEnd\nRegion\nTFs\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\nNA\nNA\nNA\nNA:NA-NA\nNA\n\n\n\n\n\nRemove NA\n\n\nCode\ndat = dat_module_full\nprint(any(is.na(dat)))\nprint(dim(dat))\n\ndat = dat %&gt;% dplyr::filter(!is.na(Chrom))\n\ndat_module_full_rmna = dat\nprint(any(is.na(dat)))\nprint(dim(dat))\n\n\n[1] TRUE\n[1] 173997     75\n[1] FALSE\n[1] 173996     75"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-tf-module-mapping",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-tf-module-mapping",
    "title": "Prepare TF Modules 01",
    "section": "Arrange TF-Module mapping",
    "text": "Arrange TF-Module mapping\n\n\nCode\n### rename columns\ndat = dat_module_tfs_import\ncolnames(dat) = c(\"Module\", \"TF\")\n\n### rename values\nvec = dat$Module\nvec = stringr::str_pad(vec, 2, pad = \"0\")\nvec = paste(\"Module\", vec, sep = \"_\")\ndat = dat %&gt;% dplyr::mutate(Module = vec)\n\n### assign and show\ndat_module2tf_list = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 2503    2\n\n\n\n\n\nModule\nTF\n\n\n\n\nModule_01\nZNF589\n\n\nModule_01\nJUNB\n\n\nModule_01\nFOSL1\n\n\nModule_01\nMEIS2\n\n\nModule_01\nEGR1\n\n\nModule_01\nMEF2D\n\n\n\n\n\n\n\nCode\n###\ndat = dat_module2tf_list\ndat = dat %&gt;% \n    dplyr::mutate(Value = 1) %&gt;%\n    tidyr::spread(Module, Value) %&gt;%\n    replace(is.na(.), 0)\n\n### assign and show\ndat_module2tf_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 234  71\n\n\n\n\n\nTF\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\nModule_11\nModule_12\nModule_13\nModule_14\nModule_15\nModule_16\nModule_17\nModule_18\nModule_19\nModule_20\nModule_21\nModule_22\nModule_23\nModule_24\nModule_25\nModule_26\nModule_27\nModule_28\nModule_29\nModule_30\nModule_31\nModule_33\nModule_34\nModule_35\nModule_36\nModule_37\nModule_39\nModule_40\nModule_41\nModule_42\nModule_43\nModule_44\nModule_45\nModule_46\nModule_47\nModule_48\nModule_49\nModule_50\nModule_51\nModule_52\nModule_53\nModule_54\nModule_55\nModule_56\nModule_57\nModule_58\nModule_59\nModule_61\nModule_63\nModule_64\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n\nADNP\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nAGO1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n\n\nARHGAP35\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nARID2\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n\n\nARID3A\n1\n1\n0\n0\n0\n0\n0\n1\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\nARID4B\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-tf-regions",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-tf-regions",
    "title": "Prepare TF Modules 01",
    "section": "Arrange TF regions",
    "text": "Arrange TF regions\nRegion-TFs\n\n\nCode\n### get region info of the rows\ndat = dat_module_full_rmna\ndat = dat %&gt;% dplyr::select(Chrom, ChromStart, ChromEnd, Region, TFs)\n\n### assign and show\ndat_region2tf_list = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 173996      5\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nTFs\n\n\n\n\nchr1\n115702\n115751\nchr1:115702-115751\nNONO,RNF2,FOXK2,NR2F1,SOX6,ESRRA,ATF4,GMEB1,NFIC,TRIM24,HDAC1,TCF12,NCOR1,NFE2,ATF7,ZNF24,GABPB1,ZBTB2,MTA3,FOXM1,ZBTB40,DPF2,NFRKB,HDAC2,GATAD2A,IKZF1,ARID3A,NBN,EP300,SMARCE1,ZNF281,KDM1A,NCOA1,MAFG,POLR2A,EGR1,REST,TCF3,SMARCC2,MTA1,MEIS2\n\n\nchr1\n118585\n118665\nchr1:118585-118665\nRNF2,MAFG,NFE2L1,NFE2\n\n\nchr1\n136446\n136510\nchr1:136446-136510\nCEBPB,ESRRA,NR2F1,EGR1\n\n\nchr1\n139031\n139110\nchr1:139031-139110\nZFX,CTCF,RFX1\n\n\nchr1\n268005\n268051\nchr1:268005-268051\nSMC3,CTCF,MAZ,ATF7,ARID2,ZNF281,REST,RAD21\n\n\nchr1\n586187\n586203\nchr1:586187-586203\nCTCF,MAZ,SMC3\n\n\n\n\n\nRegion-TFs matrix\n\n\nCode\ndat = dat_region2tf_list\ndat = dat %&gt;% \n    tidyr::separate_rows(TFs, sep = \",\") %&gt;%\n    dplyr::distinct() %&gt;% \n    na.omit\n\n### convert into Region-TF matrix\ndat = dat %&gt;%\n    dplyr::mutate(Value = 1) %&gt;%\n    tidyr::spread(TFs, Value) %&gt;%\n    replace(is.na(.), 0)\n\n### assign and show\ndat_region2tf_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 173996    269\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nADNP\nAGO1\nARHGAP35\nARID2\nARID3A\nARID4B\nARNT\nATF1\nATF2\nATF3\nATF4\nATF6\nATF7\nBCL6\nBHLHE40\nBRD4\nBRF2\nCAMTA2\nCBFB\nCBX1\nCBX2\nCBX5\nCCAR2\nCEBPB\nCEBPG\nCEBPZ\nCHCHD3\nCHD2\nCHD4\nCREB1\nCREB3\nCREM\nCTCF\nDDIT3\nDMTF1\nDPF2\nE2F1\nE2F4\nE2F5\nE2F8\nEGR1\nEHMT2\nELF1\nELF4\nELK1\nEP300\nERF\nESRRA\nETS1\nETV5\nETV6\nEZH2\nFIP1L1\nFOSL1\nFOXA1\nFOXA3\nFOXJ3\nFOXK1\nFOXK2\nFOXM1\nFOXP1\nFOXP4\nFUS\nGABPA\nGABPB1\nGATA2\nGATAD2A\nGMEB1\nGTF2F1\nHBP1\nHCFC1\nHDAC1\nHDAC2\nHDAC6\nHINFP\nHIVEP1\nHMG20A\nHMG20B\nHNRNPH1\nHNRNPK\nHNRNPL\nHNRNPLL\nHNRNPUL1\nHOMEZ\nIKZF1\nIRF1\nIRF2\nIRF9\nJUN\nJUNB\nJUND\nKAT2B\nKAT7\nKAT8\nKDM1A\nKDM5B\nKLF13\nKLF16\nKLF6\nLCOR\nMAFF\nMAFG\nMAFK\nMAX\nMAZ\nMBD1\nMEF2A\nMEF2D\nMEIS2\nMGA\nMLX\nMNT\nMTA1\nMTA3\nMTF1\nMXD1\nMXI1\nMYBL2\nMYC\nMYNN\nNBN\nNCOA1\nNCOA2\nNCOR1\nNFATC3\nNFE2\nNFE2L1\nNFIC\nNFRKB\nNFYA\nNONO\nNR1H2\nNR2C2\nNR2F1\nNR2F2\nNR2F6\nNR3C1\nNRF1\nPATZ1\nPBX2\nPCBP1\nPCBP2\nPHB2\nPHF20\nPHF21A\nPHF8\nPOLR2A\nPOLR2AphosphoS2\nPOLR2AphosphoS5\nPOLR2G\nPRDM10\nPRPF4\nPTBP1\nRAD21\nRAD51\nRBFOX2\nRBM22\nRBM39\nRBPJ\nRCOR1\nRELA\nREST\nRFX1\nRFX5\nRNF2\nRNF219\nRREB1\nSAFB2\nSETDB1\nSFPQ\nSIN3A\nSIN3B\nSKIL\nSMAD1\nSMAD3\nSMAD4\nSMARCC2\nSMARCE1\nSMC3\nSNRNP70\nSOX6\nSP1\nSRF\nSRSF1\nSRSF9\nSTAG1\nSTAT5B\nSUZ12\nTAF15\nTARDBP\nTBL1XR1\nTBP\nTCF12\nTCF3\nTCF7\nTCF7L2\nTEAD1\nTEAD2\nTEAD4\nTFAP4\nTFDP1\nTFE3\nTGIF2\nTHRA\nTHRB\nTOE1\nTRIM24\nU2AF1\nU2AF2\nUBTF\nUSF1\nUSF2\nXRCC5\nYY1\nZBTB2\nZBTB26\nZBTB33\nZBTB34\nZBTB40\nZBTB49\nZBTB7A\nZBTB8A\nZC3H4\nZC3H8\nZFP1\nZFP36\nZFP91\nZFX\nZHX1\nZKSCAN1\nZKSCAN8\nZMYM3\nZNF12\nZNF121\nZNF124\nZNF143\nZNF146\nZNF217\nZNF224\nZNF232\nZNF24\nZNF253\nZNF263\nZNF274\nZNF280B\nZNF281\nZNF282\nZNF3\nZNF318\nZNF354B\nZNF384\nZNF431\nZNF511\nZNF512\nZNF589\nZNF639\nZNF644\nZNF7\nZNF707\nZNF740\nZNF766\nZNF780A\nZNF83\nZSCAN29\nZZZ3\n\n\n\n\nchr1\n115702\n115751\nchr1:115702-115751\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n1\n0\n1\n1\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n1\n0\n1\n1\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n118585\n118665\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n136446\n136510\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n139031\n139110\nchr1:139031-139110\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n268005\n268051\nchr1:268005-268051\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n586187\n586203\nchr1:586187-586203\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-module-regions",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#arrange-module-regions",
    "title": "Prepare TF Modules 01",
    "section": "Arrange module regions",
    "text": "Arrange module regions\nRegion-Module matrix\n\n\nCode\n### init\ndat = dat_module_full_rmna\n\n### get Region-Module matrix\ntmp = dat %&gt;% dplyr::select( Chrom,  ChromStart,  ChromEnd,  Region)\nmat = dat %&gt;% dplyr::select(-Chrom, -ChromStart, -ChromEnd, -Region, -TFs)\n\n### reset column names\nvec = colnames(mat)\nvec = stringr::str_pad(vec, 2, pad = \"0\")\nvec = paste(\"Module\", vec, sep = \"_\")\ncolnames(mat) = vec\n\n### re-combine\ndat = cbind(tmp, mat)\n\n### assign and show\ndat_region2module_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 173996     74\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\nModule_11\nModule_12\nModule_13\nModule_14\nModule_15\nModule_16\nModule_17\nModule_18\nModule_19\nModule_20\nModule_21\nModule_22\nModule_23\nModule_24\nModule_25\nModule_26\nModule_27\nModule_28\nModule_29\nModule_30\nModule_31\nModule_33\nModule_34\nModule_35\nModule_36\nModule_37\nModule_39\nModule_40\nModule_41\nModule_42\nModule_43\nModule_44\nModule_45\nModule_46\nModule_47\nModule_48\nModule_49\nModule_50\nModule_51\nModule_52\nModule_53\nModule_54\nModule_55\nModule_56\nModule_57\nModule_58\nModule_59\nModule_61\nModule_63\nModule_64\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n\nchr1\n115702\n115751\nchr1:115702-115751\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n118585\n118665\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n136446\n136510\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n139031\n139110\nchr1:139031-139110\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n268005\n268051\nchr1:268005-268051\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n586187\n586203\nchr1:586187-586203\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\nRegion-Module\n\n\nCode\n### reshape the region-module\ndat = dat_region2module_matrix\ndat = dat %&gt;%\n    dplyr::mutate(Group = \"TF_Module\") %&gt;%\n    tidyr::gather(Label, Value, -Chrom, -ChromStart, -ChromEnd, -Region, -Group) %&gt;%\n    dplyr::filter(Value == 1) %&gt;%\n    dplyr::select(-Value)\n\n### assign and show\ndat_region2module_list = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 413728      6\n\n\n\nA data.frame: 6 × 6\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGroup\nLabel\n\n\n\n&lt;chr&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n&lt;chr&gt;\n\n\n\n\n1\nchr1\n1079499\n1080590\nchr1:1079499-1080590\nTF_Module\nModule_01\n\n\n2\nchr1\n1282057\n1282312\nchr1:1282057-1282312\nTF_Module\nModule_01\n\n\n3\nchr1\n1305319\n1306287\nchr1:1305319-1306287\nTF_Module\nModule_01\n\n\n4\nchr1\n1307969\n1309285\nchr1:1307969-1309285\nTF_Module\nModule_01\n\n\n5\nchr1\n1318296\n1318659\nchr1:1318296-1318659\nTF_Module\nModule_01\n\n\n6\nchr1\n1344799\n1345337\nchr1:1344799-1345337\nTF_Module\nModule_01\n\n\n\n\n\nCheck missing values\n\n\nCode\ndat = dat_region2module_list\nlst = lapply(dat, function(vec){any(is.na(vec))})\nprint(lst)\n\n\n$Chrom\n[1] FALSE\n\n$ChromStart\n[1] FALSE\n\n$ChromEnd\n[1] FALSE\n\n$Region\n[1] FALSE\n\n$Group\n[1] FALSE\n\n$Label\n[1] FALSE"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#define-column-description",
    "title": "Prepare TF Modules 01",
    "section": "Define column description",
    "text": "Define column description\nThe peak file is in narrowPeak format, which is a standard six field bed with four additional fields (BED6+4 format)\n\n\nCode\n### create metadata: column information\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Name\",       \"Region of the row\",\n    \"Group\",      \"Annotation name\",\n    \"Label\",      \"TF Modules\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nName\nRegion of the row\n\n\nGroup\nAnnotation name\n\n\nLabel\nTF Modules"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_tfmodule_01_export_data_R.html#save-results",
    "title": "Prepare TF Modules 01",
    "section": "Save results",
    "text": "Save results\nSave column description\n\n\nCode\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nSave bed file: region2model list\n\n\nCode\n### set directory\ntxt_fdiry = file.path(FD_RES, \"region\", \"module_tf_shannon\")\ntxt_fname = \"K562.hg38.TF_Module.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write table\ndat = dat_region2module_list\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\nSave matrix summary\n\n\nCode\n### set directory\ntxt_fdiry = file.path(FD_RES, \"region\", \"module_tf_shannon\", \"summary\")\ntxt_cmd = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n### write region-module (Matrix)\ntxt_fname = \"matrix.region2module.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region2module_matrix\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\nwrite_tsv(dat, txt_fpath)\n\n### write region-module (List)\ntxt_fname = \"data.region2module.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region2module_list\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\nwrite_tsv(dat, txt_fpath)\n\n### write region-tfs matrix\ntxt_fname = \"matrix.region2TF.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region2tf_matrix\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\nwrite_tsv(dat, txt_fpath)\n\n### write region-tfs matrix\ntxt_fname = \"data.region2TF.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_region2tf_list\ndat = dat %&gt;% dplyr::arrange(Chrom, ChromStart, ChromEnd)\nwrite_tsv(dat, txt_fpath)\n\n### write TF-Module mapping (matrix)\ntxt_fname = \"matrix.module2TF.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_module2tf_matrix\nwrite_tsv(dat, txt_fpath)\n\n### write TF-Module mapping (list)\ntxt_fname = \"data.module2TF.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = dat_module2tf_list\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html",
    "title": "Prepare TF Modules 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nsuppressMessages(suppressWarnings(library(\"pheatmap\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"module_tf_shannon\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html#import-data",
    "title": "Prepare TF Modules 03",
    "section": "Import data",
    "text": "Import data\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndata.module2TF.tsv \ndata.region2module.tsv \ndata.region2TF.tsv \ndescription.tsv \nmatrix.module2TF.tsv \nmatrix.region2module.tsv \nmatrix.region2TF.tsv \nmetadata.label.tsv \n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"matrix.region2module.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region2module_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 173996     74\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\nModule_11\nModule_12\nModule_13\nModule_14\nModule_15\nModule_16\nModule_17\nModule_18\nModule_19\nModule_20\nModule_21\nModule_22\nModule_23\nModule_24\nModule_25\nModule_26\nModule_27\nModule_28\nModule_29\nModule_30\nModule_31\nModule_33\nModule_34\nModule_35\nModule_36\nModule_37\nModule_39\nModule_40\nModule_41\nModule_42\nModule_43\nModule_44\nModule_45\nModule_46\nModule_47\nModule_48\nModule_49\nModule_50\nModule_51\nModule_52\nModule_53\nModule_54\nModule_55\nModule_56\nModule_57\nModule_58\nModule_59\nModule_61\nModule_63\nModule_64\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n\nchr1\n115702\n115751\nchr1:115702-115751\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n118585\n118665\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n136446\n136510\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"matrix.region2TF.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region2TF_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 173996    269\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nADNP\nAGO1\nARHGAP35\nARID2\nARID3A\nARID4B\nARNT\nATF1\nATF2\nATF3\nATF4\nATF6\nATF7\nBCL6\nBHLHE40\nBRD4\nBRF2\nCAMTA2\nCBFB\nCBX1\nCBX2\nCBX5\nCCAR2\nCEBPB\nCEBPG\nCEBPZ\nCHCHD3\nCHD2\nCHD4\nCREB1\nCREB3\nCREM\nCTCF\nDDIT3\nDMTF1\nDPF2\nE2F1\nE2F4\nE2F5\nE2F8\nEGR1\nEHMT2\nELF1\nELF4\nELK1\nEP300\nERF\nESRRA\nETS1\nETV5\nETV6\nEZH2\nFIP1L1\nFOSL1\nFOXA1\nFOXA3\nFOXJ3\nFOXK1\nFOXK2\nFOXM1\nFOXP1\nFOXP4\nFUS\nGABPA\nGABPB1\nGATA2\nGATAD2A\nGMEB1\nGTF2F1\nHBP1\nHCFC1\nHDAC1\nHDAC2\nHDAC6\nHINFP\nHIVEP1\nHMG20A\nHMG20B\nHNRNPH1\nHNRNPK\nHNRNPL\nHNRNPLL\nHNRNPUL1\nHOMEZ\nIKZF1\nIRF1\nIRF2\nIRF9\nJUN\nJUNB\nJUND\nKAT2B\nKAT7\nKAT8\nKDM1A\nKDM5B\nKLF13\nKLF16\nKLF6\nLCOR\nMAFF\nMAFG\nMAFK\nMAX\nMAZ\nMBD1\nMEF2A\nMEF2D\nMEIS2\nMGA\nMLX\nMNT\nMTA1\nMTA3\nMTF1\nMXD1\nMXI1\nMYBL2\nMYC\nMYNN\nNBN\nNCOA1\nNCOA2\nNCOR1\nNFATC3\nNFE2\nNFE2L1\nNFIC\nNFRKB\nNFYA\nNONO\nNR1H2\nNR2C2\nNR2F1\nNR2F2\nNR2F6\nNR3C1\nNRF1\nPATZ1\nPBX2\nPCBP1\nPCBP2\nPHB2\nPHF20\nPHF21A\nPHF8\nPOLR2A\nPOLR2AphosphoS2\nPOLR2AphosphoS5\nPOLR2G\nPRDM10\nPRPF4\nPTBP1\nRAD21\nRAD51\nRBFOX2\nRBM22\nRBM39\nRBPJ\nRCOR1\nRELA\nREST\nRFX1\nRFX5\nRNF2\nRNF219\nRREB1\nSAFB2\nSETDB1\nSFPQ\nSIN3A\nSIN3B\nSKIL\nSMAD1\nSMAD3\nSMAD4\nSMARCC2\nSMARCE1\nSMC3\nSNRNP70\nSOX6\nSP1\nSRF\nSRSF1\nSRSF9\nSTAG1\nSTAT5B\nSUZ12\nTAF15\nTARDBP\nTBL1XR1\nTBP\nTCF12\nTCF3\nTCF7\nTCF7L2\nTEAD1\nTEAD2\nTEAD4\nTFAP4\nTFDP1\nTFE3\nTGIF2\nTHRA\nTHRB\nTOE1\nTRIM24\nU2AF1\nU2AF2\nUBTF\nUSF1\nUSF2\nXRCC5\nYY1\nZBTB2\nZBTB26\nZBTB33\nZBTB34\nZBTB40\nZBTB49\nZBTB7A\nZBTB8A\nZC3H4\nZC3H8\nZFP1\nZFP36\nZFP91\nZFX\nZHX1\nZKSCAN1\nZKSCAN8\nZMYM3\nZNF12\nZNF121\nZNF124\nZNF143\nZNF146\nZNF217\nZNF224\nZNF232\nZNF24\nZNF253\nZNF263\nZNF274\nZNF280B\nZNF281\nZNF282\nZNF3\nZNF318\nZNF354B\nZNF384\nZNF431\nZNF511\nZNF512\nZNF589\nZNF639\nZNF644\nZNF7\nZNF707\nZNF740\nZNF766\nZNF780A\nZNF83\nZSCAN29\nZZZ3\n\n\n\n\nchr1\n115702\n115751\nchr1:115702-115751\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n1\n0\n1\n1\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n0\n1\n0\n1\n1\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n118585\n118665\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1\n136446\n136510\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\nCode\n### set file path\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"matrix.module2TF.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_module2TF_matrix = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 234  71\n\n\n\n\n\nTF\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\nModule_11\nModule_12\nModule_13\nModule_14\nModule_15\nModule_16\nModule_17\nModule_18\nModule_19\nModule_20\nModule_21\nModule_22\nModule_23\nModule_24\nModule_25\nModule_26\nModule_27\nModule_28\nModule_29\nModule_30\nModule_31\nModule_33\nModule_34\nModule_35\nModule_36\nModule_37\nModule_39\nModule_40\nModule_41\nModule_42\nModule_43\nModule_44\nModule_45\nModule_46\nModule_47\nModule_48\nModule_49\nModule_50\nModule_51\nModule_52\nModule_53\nModule_54\nModule_55\nModule_56\nModule_57\nModule_58\nModule_59\nModule_61\nModule_63\nModule_64\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n\nADNP\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nAGO1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n\n\nARHGAP35\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_tfmodule_03_explore_data_R.html#explore-data",
    "title": "Prepare TF Modules 03",
    "section": "Explore data",
    "text": "Explore data\n\nRegion-Module: Module locations across the genome\n\n\nCode\n### arrange the matrix\ndat = dat_region2module_matrix\ndat = dat %&gt;% \n    dplyr::select(-Chrom, -ChromStart, -ChromEnd) %&gt;% \n    column_to_rownames(\"Region\")\n\n### assign and show\ndat = dat_region2module_arrange = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 173996     70\n\n\n\nA data.frame: 6 × 70\n\n\n\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\n⋯\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n⋯\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr1:115702-115751\n0\n1\n0\n0\n1\n0\n0\n0\n0\n1\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:139031-139110\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:268005-268051\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:586187-586203\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\nSummarize counts of the binary matrix\n\n\nCode\n### count by row\ndat = dat = dat_region2module_arrange\nvec = apply(dat, 1, sum)\ndat = tibble(Region = names(vec), Count = vec)\ndat = dat %&gt;% dplyr::arrange(Count)\n\n### assign and summary\ndat_region_stats = dat\nprint(dim(dat))\nprint(summary(vec))\n\n### show top/bottom of table\nfun_display_table(\n    bind_rows(\n        head(dat, 6), \n        tail(dat, 6)\n    )\n)\n\n\n[1] 173996      2\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   1.000   2.000   2.378   3.000  14.000 \n\n\n\n\n\nRegion\nCount\n\n\n\n\nchr1:118585-118665\n1\n\n\nchr1:136446-136510\n1\n\n\nchr1:586187-586203\n1\n\n\nchr1:905285-905486\n1\n\n\nchr1:905662-905685\n1\n\n\nchr1:912602-912614\n1\n\n\nchr17:46795428-46795947\n12\n\n\nchr18:23528512-23530101\n12\n\n\nchr19:6603491-6604311\n12\n\n\nchr8:102809995-102811632\n12\n\n\nchr19:10835074-10837434\n13\n\n\nchr10:71860432-71861688\n14\n\n\n\n\n\n\n\nCode\n### count by column\ndat = dat_region2module_arrange\nvec = apply(dat, 2, sum)\ndat = tibble(Module = names(vec), Count = vec)\ndat = dat %&gt;% dplyr::arrange(Count)\n\n### assign and summary\ndat_module_stats = dat\nprint(dim(dat))\nprint(summary(vec))\n\n### show top/bottom of table\nfun_display_table(\n    bind_rows(\n        head(dat, 6), \n        tail(dat, 6)\n    )\n)\n\n\n[1] 70  2\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    636    2052    4620    5910    8176   24267 \n\n\n\n\n\nModule\nCount\n\n\n\n\nModule_08\n636\n\n\nModule_65\n636\n\n\nModule_53\n695\n\n\nModule_26\n802\n\n\nModule_74\n849\n\n\nModule_09\n916\n\n\nModule_35\n13060\n\n\nModule_27\n13750\n\n\nModule_15\n17534\n\n\nModule_02\n18655\n\n\nModule_06\n21510\n\n\nModule_44\n24267\n\n\n\n\n\nVisualize the summary\n\n\nCode\ndat = dat_region_stats\ngpt = ggplot(dat, aes(x=Count)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_module_stats         \ngpt = ggplot(dat, aes(x=Count)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid() +\n    labs(x=\"#{Region} each module binds)\", y = \"Count\")\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nSubset and plot the matrix\n\n\nCode\ndat = dat_region_stats\ndat = dat %&gt;% dplyr::filter(Count &gt; 5)\nidx = dat$Region\nidx_region = idx\n\ndat = dat_module_stats\ndat = dat %&gt;% dplyr::filter(Count &gt; 10)\nidx = dat$Module\nidx_module = idx\n\n\n\n\nCode\n### init\ndat = dat_region2module_arrange\nprint(dim(dat))\n\n### subset the matrix\ndat = dat[idx_region, idx_module]\nprint(dim(dat))\n\n### subset the matrix\nset.seed(123)\nidx = sample(1:nrow(dat), size=7000)\ndat = dat[idx,]\nprint(dim(dat))\n\n### assign\ndat_region2module_subset = dat\n\n\n[1] 173996     70\n[1] 7574   70\n[1] 7000   70\n\n\n\n\nCode\ndat = dat_region2module_subset\n\npheatmap(\n    t(dat),\n    color = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    treeheight_row = 0,\n    treeheight_col = 0,\n    legend = FALSE,\n    show_colnames = FALSE,\n    fontsize_row = 7,\n    main = \"Module annotation across genome\"\n)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \".\"\ntxt_fname = \"fig.matrix.region2module.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region2module_subset\n\noptions(repr.plot.height=10, repr.plot.width=25)\npheatmap(\n    t(dat),\n    color = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    treeheight_row = 0,\n    treeheight_col = 0,\n    legend = FALSE,\n    show_colnames = FALSE,\n    fontsize_row = 7,\n    main = \"Module annotation across genome\",\n    height   = 10,\n    width    = 10,\n    filename = txt_fpath\n)\n\n\n\n\nRegion-TF: Summarized TF binding sites across the genome\n\n\nCode\n### arrange the matrix\ndat = dat_region2TF_matrix\ndat = dat %&gt;% \n    dplyr::select(-Chrom, -ChromStart, -ChromEnd) %&gt;% \n    column_to_rownames(\"Region\")\n\n### assign and show\ndat = dat_region2TF_arrange = dat\nprint(dim(dat))\nhead(dat)\n\n\n[1] 173996    265\n\n\n\nA data.frame: 6 × 265\n\n\n\nADNP\nAGO1\nARHGAP35\nARID2\nARID3A\nARID4B\nARNT\nATF1\nATF2\nATF3\n⋯\nZNF639\nZNF644\nZNF7\nZNF707\nZNF740\nZNF766\nZNF780A\nZNF83\nZSCAN29\nZZZ3\n\n\n\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n⋯\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n&lt;dbl&gt;\n\n\n\n\nchr1:115702-115751\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:118585-118665\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:136446-136510\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:139031-139110\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:268005-268051\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nchr1:586187-586203\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n⋯\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\nSummarize counts of the binary matrix\n\n\nCode\n### count by row\ndat = dat_region2TF_arrange\nvec = apply(dat, 1, sum)\ndat = tibble(Region = names(vec), Count = vec)\ndat = dat %&gt;% dplyr::arrange(Count)\n\n### assign and summary\ndat_region_stats = dat\nprint(dim(dat))\nprint(summary(vec))\n\n### show top/bottom of table\nfun_display_table(\n    bind_rows(\n        head(dat, 6), \n        tail(dat, 6)\n    )\n)\n\n\n[1] 173996      2\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2.00    3.00    6.00   15.74   15.00  214.00 \n\n\n\n\n\nRegion\nCount\n\n\n\n\nchr1:1041445-1041646\n2\n\n\nchr1:1081931-1082133\n2\n\n\nchr1:1247497-1247699\n2\n\n\nchr1:1527412-1527616\n2\n\n\nchr1:1548746-1548953\n2\n\n\nchr1:1616720-1616967\n2\n\n\nchr7:139339776-139342125\n188\n\n\nchr6:27131655-27135406\n195\n\n\nchr11:62839262-62842225\n205\n\n\nchr1:44720944-44722487\n212\n\n\nchr1:11907607-11910232\n214\n\n\nchr1:28647570-28649255\n214\n\n\n\n\n\n\n\nCode\n### count by column\ndat = dat_region2TF_arrange\nvec = apply(dat, 2, sum)\ndat = tibble(TF = names(vec), Count = vec)\ndat = dat %&gt;% dplyr::arrange(Count)\n\n### assign and summary\ndat_tfs_stats = dat\nprint(dim(dat))\nprint(summary(vec))\n\n### show top/bottom of table\nfun_display_table(\n    bind_rows(\n        head(dat, 6), \n        tail(dat, 6)\n    )\n)\n\n\n[1] 265   2\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      3    1694    7159   10333   16695   42737 \n\n\n\n\n\nTF\nCount\n\n\n\n\nSRSF9\n3\n\n\nSAFB2\n10\n\n\nBRF2\n14\n\n\nZC3H4\n15\n\n\nZNF217\n30\n\n\nTGIF2\n31\n\n\nRNF2\n33892\n\n\nIKZF1\n33910\n\n\nMEIS2\n34477\n\n\nREST\n38175\n\n\nRCOR1\n40914\n\n\nJUND\n42737\n\n\n\n\n\nVisualize the summary\n\n\nCode\ndat = dat_region_stats\ngpt = ggplot(dat, aes(x=Count)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid()\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)\n\n\n\n\n\n\n\n\n\n\n\nCode\ndat = dat_tfs_stats         \ngpt = ggplot(dat, aes(x=Count)) + \n    geom_histogram(bins = 100) + \n    theme_cowplot() + \n    background_grid() +\n    labs(x=\"#{Region} each TF binds)\", y = \"Count\")\n\noptions(repr.plot.height=4, repr.plot.width=10)\nprint(gpt)\n\n\n\n\n\n\n\n\n\nSubset and plot the matrix\n\n\nCode\ndat = dat_region_stats\ndat = dat %&gt;% dplyr::filter(Count &gt; 10)\nidx = dat$Region\nidx_region = idx\n\ndat = dat_tfs_stats\ndat = dat %&gt;% dplyr::filter(Count &gt; 1000) %&gt;% dplyr::filter(!str_detect(TF, \"phospho\"))\nidx = dat$TF\nidx_tfs = idx\n\n\n\n\nCode\n### init\ndat = dat_region2TF_arrange\nprint(dim(dat))\n\n### subset the matrix\ndat = dat[idx_region, idx_tfs]\nprint(dim(dat))\n\n### subset the matrix\nset.seed(123)\nidx = sample(1:nrow(dat), size=10000)\ndat = dat[idx,]\nprint(dim(dat))\n\n### assign\ndat_region2TF_subset = dat\n\n\n[1] 173996    265\n[1] 56957   208\n[1] 10000   208\n\n\n\n\nCode\ndat = dat_region2TF_subset\n\noptions(repr.plot.height=20, repr.plot.width=10)\npheatmap(\n    t(dat),\n    color = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    treeheight_row = 0,\n    treeheight_col = 0,\n    legend = FALSE,\n    show_colnames = FALSE,\n    fontsize_row = 7,\n    main = \"TF binding sites across genome\"\n)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \".\"\ntxt_fname = \"fig.matrix.region2TF.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_region2TF_subset\n\npheatmap(\n    t(dat),\n    color = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    treeheight_row = 0,\n    treeheight_col = 0,\n    legend = FALSE,\n    show_colnames = FALSE,\n    fontsize_row = 7,\n    main = \"TF binding sites across genome\",\n    height   = 20,\n    width    = 10,\n    filename = txt_fpath\n)\n\n\n\n\nModule-TF: composition of TFs for each modulde\n\n\nCode\n### arrange matrix\ndat = dat_module2TF_matrix\ndat = dat %&gt;% column_to_rownames(\"TF\")\n\n### assign and show\ndat_module2TF_arrange = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\n[1] 234  70\n\n\n\n\n\n\nModule_01\nModule_02\nModule_03\nModule_04\nModule_05\nModule_06\nModule_07\nModule_08\nModule_09\nModule_10\nModule_11\nModule_12\nModule_13\nModule_14\nModule_15\nModule_16\nModule_17\nModule_18\nModule_19\nModule_20\nModule_21\nModule_22\nModule_23\nModule_24\nModule_25\nModule_26\nModule_27\nModule_28\nModule_29\nModule_30\nModule_31\nModule_33\nModule_34\nModule_35\nModule_36\nModule_37\nModule_39\nModule_40\nModule_41\nModule_42\nModule_43\nModule_44\nModule_45\nModule_46\nModule_47\nModule_48\nModule_49\nModule_50\nModule_51\nModule_52\nModule_53\nModule_54\nModule_55\nModule_56\nModule_57\nModule_58\nModule_59\nModule_61\nModule_63\nModule_64\nModule_65\nModule_66\nModule_67\nModule_68\nModule_71\nModule_72\nModule_73\nModule_74\nModule_75\nModule_77\n\n\n\n\nADNP\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nAGO1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n\n\nARHGAP35\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nARID2\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n\n\nARID3A\n1\n1\n0\n0\n0\n0\n0\n1\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\nARID4B\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n\n\n\n\n\nCode\ndat = dat_module2TF_arrange\n\noptions(repr.plot.height=10, repr.plot.width=25)\npheatmap(\n    t(dat), \n    color  = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    legend = FALSE,\n    fontsize     = 20,\n    fontsize_row = 7,\n    fontsize_col = 5,\n    main = \"Module-TF mapping\"\n)\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \".\"\ntxt_fname = \"fig.matrix.module_tf_mapping.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\ndat = dat_module2TF_arrange\n\noptions(repr.plot.height=10, repr.plot.width=25)\npheatmap(\n    t(dat), \n    color  = c(\"white\", \"black\"),\n    breaks = c(0, 0.5, 1),\n    legend = FALSE,\n    fontsize     = 20,\n    fontsize_row = 7,\n    fontsize_col = 5,\n    main     = \"Module-TF mapping\",\n    height   = 10,\n    width    = 25,\n    filename = txt_fpath\n)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html",
    "title": "Prepare Junke peak call region 02",
    "section": "",
    "text": "Set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: HARDAC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT APP     (FD_APP):      \nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#preview",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#preview",
    "title": "Prepare Junke peak call region 02",
    "section": "Preview",
    "text": "Preview\n\n\nCode\nFD_INP=${FD_DAT}/processed/fcc_enhancer_Junke_zscore_240611\nls ${FD_INP}/*zip | xargs -n 1 basename\n\n\nATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib.zip\neSTARR_seq.zip\nLentiMPRA_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10.zip\nTilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10.zip\nWHG_STARR_TR.zip"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#execute",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#execute",
    "title": "Prepare Junke peak call region 02",
    "section": "Execute",
    "text": "Execute\n\n\nCode\n### init: input files\nFD_INP=${FD_DAT}/processed/fcc_enhancer_Junke_zscore_240611\nFP_INPS=($(ls ${FD_INP}/*zip))\n\n### init: output folder\nFD_OUT=${FD_DAT}/processed/fcc_enhancer_Junke_zscore_240611/decompressed\nrm -rf ${FD_OUT}\n\n### loop and decompress\nfor FP_INP in ${FP_INPS[@]}; do\n    echo ${FP_INP}\n    unzip -o ${FP_INP} -d ${FD_OUT}\n    echo\ndone\n\n### remove MAC folder\nrm -rf ${FD_OUT}/__MACOSX\n\n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/.DS_Store  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/._.DS_Store  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/bin_level/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak/merged_repressor_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/bin_level/bin_level_all_result.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/bin_level/all_bin_tested_in_both_orientations.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/eSTARR_seq.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/eSTARR_seq.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._eSTARR_seq  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/element_level/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/neg_ctrl.pdf  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/merged_peak/merged_repressor_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/element_level/all_element_tested_in_both_orientations.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/eSTARR_seq/element_level/element_level_all_result.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._LentiMPRA_DNA_filtering_avg_DNA_lib_count_10  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/element_level/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl.pdf  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/element_level/all_element_tested_in_both_orientations.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/LentiMPRA_DNA_filtering_avg_DNA_lib_count_10/element_level/element_level_all_result.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/element_level/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl.pdf  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/element_level/element_level_all_result.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/element_level/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl.pdf  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peak_orientation_independent.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/element_level/all_element_tested_in_both_orientations.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10/element_level/element_level_all_result.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/element_level/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/annotated_v4/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/neg_ctrl.pdf  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/TilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10/element_level/element_level_all_result.bed.gz  \n\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/WHG_STARR_TR.zip\nArchive:  /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/WHG_STARR_TR.zip\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/._WHG_STARR_TR  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/.DS_Store  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/__MACOSX/WHG_STARR_TR/._.DS_Store  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/neg_ctrl_region.txt  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/bin_level/\n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/.ipynb_checkpoints/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_repressor_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_enhancer_peaks_in_either_orientation.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/merged_enhancer_peak_orientation_independent.bed.gz  \n   creating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/merged_peak/.ipynb_checkpoints/\n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/bin_level/bin_level_all_result.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/bin_level/all_bin_tested_in_both_orientations.bed.gz  \n  inflating: /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/processed/fcc_enhancer_Junke_zscore_240611/decompressed/WHG_STARR_TR/.ipynb_checkpoints/annotated-checkpoint.out  \nerror: invalid zip file with overlapped components (possible zip bomb)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#review",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_02_decompress_data_SH.html#review",
    "title": "Prepare Junke peak call region 02",
    "section": "Review",
    "text": "Review\n\n\nCode\nls ${FD_OUT}\n\n\nATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_\neSTARR_seq\nLentiMPRA_DNA_filtering_avg_DNA_lib_count_10\nTilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10\nTilingMPRA_ENCSR394HXI_DNA_filtering_avg_DNA_lib_count_10\nTilingMPRA_ENCSR917SFD_DNA_filtering_avg_DNA_lib_count_10\nWHG_STARR_TR\n\n\n\n\nCode\nls ${FD_OUT}/eSTARR_seq\n\n\nelement_level  merged_peak  neg_ctrl.pdf  neg_ctrl_region.txt\n\n\n\n\nCode\nls ${FD_OUT}/eSTARR_seq/merged_peak\n\n\nmerged_enhancer_peak_orientation_independent.bed.gz\nmerged_enhancer_peaks_in_either_orientation.bed.gz\nmerged_repressor_peak_orientation_independent.bed.gz\nmerged_repressor_peaks_in_either_orientation.bed.gz\n\n\n\n\nCode\nls ${FD_OUT}/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10\n\n\nelement_level  merged_peak  neg_ctrl.pdf  neg_ctrl_region.txt\n\n\n\n\nCode\nls ${FD_OUT}/TilingMPRA_ENCSR363XER_DNA_filtering_avg_DNA_lib_count_10/merged_peak\n\n\nmerged_enhancer_peaks_in_either_orientation.bed.gz\nmerged_repressor_peaks_in_either_orientation.bed.gz\n\n\n\n\nCode\nls ${FD_OUT}/ATAC_STARR_seq_100bp_genomic_bin_in_ATAC_seq_peak_cpm_20_avg_DNA_lib_/merged_peak\n\n\nmerged_enhancer_peak_orientation_independent.bed.gz\nmerged_enhancer_peaks_in_either_orientation.bed.gz\nmerged_repressor_peak_orientation_independent.bed.gz\nmerged_repressor_peaks_in_either_orientation.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html",
    "title": "Prepare Junke peak call region 05",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_starrmpra_junke\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html#define-file-labeling",
    "title": "Prepare Junke peak call region 05",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname\n)\n\n### assign and show\ndat_region = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\n\n\n\n\nfcc_starrmpra_junke\nK562.hg38.ASTARR.junke.bed.gz\n\n\nfcc_starrmpra_junke\nK562.hg38.eSTARR.junke.bed.gz\n\n\nfcc_starrmpra_junke\nK562.hg38.LMPRA.junke.bed.gz\n\n\nfcc_starrmpra_junke\nK562.hg38.TMPRA.junke.bed.gz\n\n\nfcc_starrmpra_junke\nK562.hg38.WSTARR.junke.bed.gz\n\n\n\n\n\n\n\nCode\ndat = dat_region\ndat = dat %&gt;% \n    tidyr::separate(\n        FName, \n        c(\"Cell_Type\", \"Genome\", \"Group\", \"Label\", \"File_Type\", \"File_Ext\"), \n        sep = \"\\\\.\",\n        remove = FALSE\n    ) %&gt;%\n    dplyr::mutate(Label = paste(Folder, tolower(Group), sep = \"_\")) %&gt;%\n    dplyr::select(Folder, FName, Label)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nfcc_starrmpra_junke\nK562.hg38.ASTARR.junke.bed.gz\nfcc_starrmpra_junke_astarr\n\n\nfcc_starrmpra_junke\nK562.hg38.eSTARR.junke.bed.gz\nfcc_starrmpra_junke_estarr\n\n\nfcc_starrmpra_junke\nK562.hg38.LMPRA.junke.bed.gz\nfcc_starrmpra_junke_lmpra\n\n\nfcc_starrmpra_junke\nK562.hg38.TMPRA.junke.bed.gz\nfcc_starrmpra_junke_tmpra\n\n\nfcc_starrmpra_junke\nK562.hg38.WSTARR.junke.bed.gz\nfcc_starrmpra_junke_wstarr"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_enhancer_junke_04_export_metadata_R.html#save-results",
    "title": "Prepare Junke peak call region 05",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html",
    "title": "Prepare CRISPRi Growth data 01",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_INP = \"CRISPRi_Growth_K562_Gersbach_Alex\"\nTXT_FOLDER_OUT = \"fcc_crispri_growth\"\nCode\ntxt_folder = TXT_FOLDER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\n\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\n2023_resubmission \nk562-gw-v3-all.sorted.counts.results.hg38.txt.gz \nk562-gw-v3-all.sorted.counts.results.top_guide_fdr_0_05.hg38.bed.gz"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#import-data",
    "title": "Prepare CRISPRi Growth data 01",
    "section": "Import data",
    "text": "Import data\nImport total guides & tested DHS\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname  = \"k562-gw-v3-all.sorted.counts.results.hg38.txt.gz\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read data\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\ncolnames(dat)[1] = \"RowID\"\n\n### assign and show\ndat_region_crispri_growth_total = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\nNew names:\n• `` -&gt; `...1`\n\n\n[1] 1092166      22\n\n\n\n\n\nRowID\nbaseMean\nlog2FoldChange\nlfcSE\nstat\npvalue\npadj\nweight\nname\ndhs_chrom\ndhs_start\ndhs_end\nID\nchrPerturbationTarget\nstartPerturbationTarget\nendPerturbationTarget\nchrom\nstart\nend\ndhs_id\nscore\nstrand\n\n\n\n\n0\n669.8027\n-0.9859338\n0.1352781\n-7.5156478\n0.0000000\n0.0000000\n1.0189024\nchr1.1.1\nchr1\n540930\n541007\nchr1.1\nchr1\n540951\n540970\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n1\n1210.5948\n0.0175568\n0.1125958\n0.9724725\n0.3308155\n0.8618381\n1.3894218\nchr1.1.2\nchr1\n540930\n541007\nchr1.1\nchr1\n540971\n540990\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n2\n2065.7482\n0.0142221\n0.0769462\n0.7948325\n0.4267110\n0.9074943\n1.2206106\nchr1.1.3\nchr1\n540930\n541007\nchr1.1\nchr1\n540963\n540982\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n3\n670.0537\n0.0184355\n0.1262349\n1.0421596\n0.2973377\n0.8864450\n1.0189024\nchr1.1.4\nchr1\n540930\n541007\nchr1.1\nchr1\n540953\n540972\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n4\n1023.9170\n0.0112653\n0.1017871\n0.6436207\n0.5198214\n0.9145863\n1.3894218\nchr1.1.5\nchr1\n540930\n541007\nchr1.1\nchr1\n540954\n540973\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n5\n605.4137\n0.0324261\n0.1459777\n1.6813118\n0.0927024\n0.7390114\n0.9584715\nchr1.1.6\nchr1\n540930\n541007\nchr1.1\nchr1\n540979\n540998\nchr1\n605550\n605627\nchr1.1\n521\n.\n\n\n\n\n\nImport significant guides\n\n\nCode\n### set file directory\ntxt_folder = TXT_FOLDER_INP\ntxt_fdiry  = file.path(FD_DAT, \"processed\", txt_folder)\ntxt_fname = \"k562-gw-v3-all.sorted.counts.results.top_guide_fdr_0_05.hg38.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\n### read data\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\ncolnames(dat)[1] = \"RowID\"\n\n### assign and show\ndat_region_crispri_growth_signif = dat\nprint(dim(dat))\nfun_display_table(head(dat))\n\n\nNew names:\n• `` -&gt; `...1`\n\n\n[1] 6242    7\n\n\n\n\n\nRowID\nchrom\nstart\nend\nname\nlog2FoldChange\npadj\n\n\n\n\n504606\nchr19\n11155578\n11156290\nchr19.1899.3\n-2.549922\n0\n\n\n686888\nchr22\n30356286\n30357525\nchr22.1285.6\n-3.059909\n0\n\n\n868222\nchr6\n34530428\n34530534\nchr6.2172.8\n-3.100194\n0\n\n\n50002\nchr1\n20685850\n20686283\nchr1.2930.10\n-2.862158\n0\n\n\n811835\nchr5\n70924811\n70925615\nchr5.1649.1\n-2.927110\n0\n\n\n811815\nchr5\n70049360\n70050252\nchr5.1647.1\n-2.927110\n0"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#arrange-tables",
    "href": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#arrange-tables",
    "title": "Prepare CRISPRi Growth data 01",
    "section": "Arrange tables",
    "text": "Arrange tables\n\n\nCode\n### init: list of data\nlst = list(\n    \"Total\"  = dat_region_crispri_growth_total,\n    \"Signif\" = dat_region_crispri_growth_signif\n)\n\n### columns and assay type\nvec_txt_cname = c(\n    'Chrom', 'ChromStart', 'ChromEnd', 'Region', \n    'Guide_ID', \n    'Log2FC', \n    'Padj',\n    'Group',\n    'Label'\n)\nvec_txt_label = names(lst)\ntxt_group = \"CRISPRi-Growth\"\n\n### extract columns and arrange table\nlst = lapply(vec_txt_label, function(txt_label){\n    dat = lst[[txt_label]]\n    dat = dat %&gt;%\n        dplyr::mutate(\n            Chrom      = chrom,\n            ChromStart = start,\n            ChromEnd   = end,\n            Region     = fun_gen_region(chrom, start, end),\n            Guide_ID   = name,\n            Log2FC     = log2FoldChange,\n            Padj       = padj,\n            Group      = txt_group,\n            Label      = txt_label\n        ) %&gt;%\n        dplyr::select({{vec_txt_cname}}) %&gt;% \n        dplyr::arrange(Chrom, ChromStart, ChromEnd) %&gt;%\n        dplyr::distinct()\n    return(dat)\n})\nnames(lst) = vec_txt_label\n\n### assign\nlst_dat_region_arrange = lst\n\n\nExplore: number of regions\n\n\nCode\n### init\nlst = lst_dat_region_arrange\n\n### show information\ndat = lst[['Total']]\nvec_txt_region = unique(dat$Region)\ncat(\"#Row    (Total):\", nrow(dat),              \"\\n\")\ncat(\"#Region (Total):\", length(vec_txt_region), \"\\n\")\ncat(\"\\n\")\n\n### show information\ndat = lst[['Signif']]\nvec_txt_region = unique(dat$Region)\ncat(\"#Row    (Signif):\", nrow(dat),              \"\\n\")\ncat(\"#Region (Signif):\", length(vec_txt_region), \"\\n\")\n\n\n#Row    (Total): 1092166 \n#Region (Total): 111702 \n\n#Row    (Signif): 6242 \n#Region (Signif): 6242 \n\n\nCheck: column names\n\n\nCode\ndat = lst[['Signif']]\ncolnames(dat)\n\n\n\n'Chrom''ChromStart''ChromEnd''Region''Guide_ID''Log2FC''Padj''Group''Label'\n\n\nCheck: all active regions are within the set of total regions\n\n\nCode\ndat  = lst[['Signif']]\nvec1 = unique(dat$Region)\n\ndat  = lst[['Total']]\nvec2 = unique(dat$Region)\n\nprint(all(vec1 %in% vec2))\n\n\n[1] TRUE"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#define-column-description",
    "href": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#define-column-description",
    "title": "Prepare CRISPRi Growth data 01",
    "section": "Define column description",
    "text": "Define column description\n\n\nCode\n### set column name and description\ndat = tribble(\n    ~Name,        ~Note,\n    \"Chrom\",      \"Name of the chromosome\",\n    \"ChromStart\", \"The starting position of the feature in the chromosome\",\n    \"ChromEnd\",   \"The ending position of the feature in the chromosome\",\n    \"Region\",     \"Region location\",\n    \"Guide_ID\",   \"ID of significant guide within the DHS\",\n    \"Log2FC\",     \"log2foldchange of the guide\",\n    \"Padj\",       \"Adjusted p value of the guide\",\n    \"Group\",      \"Assay Name\",\n    \"Label\",      \"Assay Name\"\n)\n\n### assign and show\ndat_cname = dat\nfun_display_table(dat)\n\n\n\n\n\nName\nNote\n\n\n\n\nChrom\nName of the chromosome\n\n\nChromStart\nThe starting position of the feature in the chromosome\n\n\nChromEnd\nThe ending position of the feature in the chromosome\n\n\nRegion\nRegion location\n\n\nGuide_ID\nID of significant guide within the DHS\n\n\nLog2FC\nlog2foldchange of the guide\n\n\nPadj\nAdjusted p value of the guide\n\n\nGroup\nAssay Name\n\n\nLabel\nAssay Name"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_crispri_growth_01_export_data_R.html#save-results",
    "title": "Prepare CRISPRi Growth data 01",
    "section": "Save results",
    "text": "Save results\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_cmd    = paste(\"mkdir -p\", txt_fdiry)\nsystem(txt_cmd)\n\n\nWrite column descriptions\n\n\nCode\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"description.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_cname\nwrite_tsv(dat, txt_fpath)\n\n\nWrite bed files\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\n### write table\ntxt_fname = \"K562.hg38.CRISPRi_Growth.total.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = lst[['Total']]\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n### write table\ntxt_fname = \"K562.hg38.CRISPRi_Growth.signif.bed.gz\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = lst[['Signif']]\nwrite_tsv(dat, txt_fpath, col_names = FALSE)\n\n\nWrite tables\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_OUT\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\n\n### write table\ntxt_fname = \"K562.hg38.CRISPRi_Growth.total.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = lst[['Total']]\nwrite_tsv(dat, txt_fpath, col_names = TRUE)\n\n### write table\ntxt_fname = \"K562.hg38.CRISPRi_Growth.signif.tsv\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\n\ndat = lst[['Signif']]\nwrite_tsv(dat, txt_fpath, col_names = TRUE)"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html",
    "title": "Prepare CRISPRi Growth data 03",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_crispri_growth\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#import-data",
    "href": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#import-data",
    "title": "Prepare CRISPRi Growth data 03",
    "section": "Import data",
    "text": "Import data\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\nK562.hg38.CRISPRi_Growth.signif.bed.gz \nK562.hg38.CRISPRi_Growth.signif.tsv \nK562.hg38.CRISPRi_Growth.total.bed.gz \nK562.hg38.CRISPRi_Growth.total.tsv \nsummary \n\n\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\nvec = dir(txt_fdiry)\nfor (txt in vec){cat(txt, \"\\n\")}\n\n\ndescription.tsv \nmetadata.label.tsv \n\n\nRead tables\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.CRISPRi_Growth.signif.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_cgrowth_signif = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 6242    9\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGuide_ID\nLog2FC\nPadj\nGroup\nLabel\n\n\n\n\nchr1\n605550\n605627\nchr1:605550-605627\nchr1.1.1\n-0.9859338\n0.0000000\nCRISPRi-Growth\nSignif\n\n\nchr1\n826642\n827902\nchr1:826642-827902\nchr1.4.8\n0.1855074\n0.0325051\nCRISPRi-Growth\nSignif\n\n\nchr1\n964946\n965136\nchr1:964946-965136\nchr1.41.7\n-1.1466792\n0.0000000\nCRISPRi-Growth\nSignif\n\n\n\n\n\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fname  = \"K562.hg38.CRISPRi_Growth.total.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\n### read table\ndat = read_tsv(txt_fpath, show_col_types = FALSE)\n\n### assign and show\ndat_region_cgrowth_total = dat\nprint(dim(dat))\nfun_display_table(head(dat, 3))\n\n\n[1] 1092166       9\n\n\n\n\n\nChrom\nChromStart\nChromEnd\nRegion\nGuide_ID\nLog2FC\nPadj\nGroup\nLabel\n\n\n\n\nchr1\n605550\n605627\nchr1:605550-605627\nchr1.1.1\n-0.9859338\n0.0000000\nCRISPRi-Growth\nTotal\n\n\nchr1\n605550\n605627\nchr1:605550-605627\nchr1.1.2\n0.0175568\n0.8618381\nCRISPRi-Growth\nTotal\n\n\nchr1\n605550\n605627\nchr1:605550-605627\nchr1.1.3\n0.0142221\n0.9074943\nCRISPRi-Growth\nTotal"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#explore-data",
    "href": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#explore-data",
    "title": "Prepare CRISPRi Growth data 03",
    "section": "Explore data",
    "text": "Explore data\n\nNumber of guides and regions\n\n\nCode\n### show information\ndat = dat_region_cgrowth_total\ntmp = dat %&gt;% dplyr::filter(Padj &lt;= 0.05)\n\ncat(\"#Guide  (Total):     \", length(dat$Region),         \"\\n\")\ncat(\"#Region (Total):     \", length(unique(dat$Region)), \"\\n\")\ncat(\"#Guide  (padj&lt;=0.05):\", length(tmp$Region),         \"\\n\")\ncat(\"#Region (padj&lt;=0.05):\", length(unique(tmp$Region)), \"\\n\")\ncat(\"\\n\")\n\n### show information\ndat = dat_region_cgrowth_signif \n\ncat(\"#Guide  (Signif):\", length(dat$Region),         \"\\n\")\ncat(\"#Region (Signif):\", length(unique(dat$Region)), \"\\n\")\n\n\n#Guide  (Total):      1092166 \n#Region (Total):      111702 \n#Guide  (padj&lt;=0.05): 8200 \n#Region (padj&lt;=0.05): 6242 \n\n#Guide  (Signif): 6242 \n#Region (Signif): 6242 \n\n\n\n\nCode\n### double check\ndat = dat_region_cgrowth_total\ntmp = dat %&gt;% \n    dplyr::filter(Padj &lt;= 0.05) %&gt;% \n    dplyr::group_by(Region) %&gt;% \n    dplyr::slice_max(abs(Log2FC)) %&gt;%\n    dplyr::slice_min(Padj) %&gt;%\n    dplyr::ungroup()\n\n### note: slice would keep the ties\nprint(nrow(tmp))\n\n\n[1] 6244\n\n\n\n\nDistribution of log2 fold changes\n\n\nCode\n### arrange effect size of total regions\ndat = dat_region_cgrowth_total\ndat = dat %&gt;% dplyr::select(Region, Guide_ID, Log2FC)\ndat = dat %&gt;% dplyr::mutate(Label = \"Total\")\ndat_region_arrange_total = dat\n\n### get significant regions\n### defined as regions w/ at least one significant guide\ntmp = dat_region_cgrowth_signif \nvec = tmp$Region\n\n### arrange effect size of significant regions\ndat = dat_region_arrange_total\ndat = dat %&gt;% dplyr::filter(Region %in% vec)\ndat = dat %&gt;% dplyr::mutate(Label = \"Significant\")\ndat_region_arrange_signf = dat\n\n\nPlot the whole distribution of guides\n\n\nCode\n### combine tables\ndat = bind_rows(\n    dat_region_arrange_total,\n    dat_region_arrange_signf\n)\n\n### plot distribution\ngpt = ggplot(dat, aes(x=Log2FC, y = Label)) + \n    geom_violin() +\n    theme_cowplot() +\n    background_grid() +\n    xlim(-0.1, 0.1)\n\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n\nWarning message:\n“Removed 27061 rows containing non-finite outside the scale range\n(`stat_ydensity()`).”\n\n\n\n\n\n\n\n\n\nPlot the mean(log2fc) of regions\n\n\nCode\n### combine tables\ndat = bind_rows(\n    dat_region_arrange_total,\n    dat_region_arrange_signf\n)\n\n### take average of log2fc by regions\ndat = dat %&gt;% \n    dplyr::group_by(Region, Label) %&gt;% \n    dplyr::summarise(Log2FC = mean(Log2FC), .groups = \"drop\")\n\n### plot distribution\ngpt = ggplot(dat, aes(x=Log2FC, y=Label)) + \n    geom_violin() +\n    theme_cowplot() +\n    background_grid() +\n    xlim(-0.5, 0.3)\n\noptions(repr.plot.height=5, repr.plot.width=7)\nprint(gpt)\n\n\nWarning message:\n“Removed 402 rows containing non-finite outside the scale range\n(`stat_ydensity()`).”"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#save-figures",
    "href": "notebooks/05_prepare_region/region_crispri_growth_03_explore_data_R.html#save-figures",
    "title": "Prepare CRISPRi Growth data 03",
    "section": "Save figures",
    "text": "Save figures\n\n\nCode\n### set text size\ntheme_text = theme(\n    title      = element_text(size = 16),\n    axis.title = element_text(size = 16),\n    axis.text  = element_text(size = 14)\n)\n\n\n\n\nCode\n### combine tables\ndat = bind_rows(\n    dat_region_arrange_total,\n    dat_region_arrange_signf\n)\n\n### take average of log2fc by regions\ndat = dat %&gt;% \n    dplyr::group_by(Region, Label) %&gt;% \n    dplyr::summarise(Log2FC = mean(Log2FC), .groups = \"drop\")\n\n### split and define plot titles\nlst = split(dat, dat$Label)\nlst = list(\n    \"DHS (Total)\" = lst[[\"Total\"]],\n    \"DHS (w/ at least one significant guides)\" = lst[[\"Significant\"]]\n)\n\n### plot distribution by loop\nlst = lapply(names(lst), function(idx){\n    ### init: data\n    dat = lst[[idx]]\n\n    ### text annotation\n    txt_title = idx\n    txt_annot = paste(\"N =\", scales::comma(nrow(dat)))\n    \n    ### plot distribution\n    gpt = ggplot(dat, aes(x=Log2FC)) + \n        geom_density(linewidth = 1.2) +\n        theme_cowplot() +\n        background_grid() +\n        labs(x = \"Log2 Fold Change\", y = \"Density\", title = txt_title) +\n        annotate(\n            \"text\", \n            x = -0.4, \n            y = Inf,\n            size  = 5,\n            vjust = 3.0,\n            label = txt_annot)\n    return(gpt)\n})\n\n### Further modification of plots\nlst = lapply(lst, function(gpt){\n    gpt = gpt + \n        xlim(-0.5, 0.3) +\n        theme_text\n    return(gpt)\n})\nlst[[1]] = lst[[1]] + labs(x = \"\")\n\n### create and assign plot\nplt = plot_grid(plotlist = lst, ncol = 1, align = \"v\")\nplt_export = plt\n\n### show plot\noptions(repr.plot.height=6, repr.plot.width=7)\nprint(plt)\n\n\nWarning message:\n“Removed 201 rows containing non-finite outside the scale range\n(`stat_density()`).”\nWarning message:\n“Removed 201 rows containing non-finite outside the scale range\n(`stat_density()`).”\n\n\n\n\n\n\n\n\n\n\n\nCode\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_growth.distribution.log2fc.png\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 7, units = \"in\")\n\ntxt_fdiry = \"./\"\ntxt_fname = \"fig.region.fcc_crispri_growth.distribution.log2fc.svg\"\ntxt_fpath = file.path(txt_fdiry, txt_fname)\nggsave(txt_fpath, plt_export, height = 6, width = 7, units = \"in\")"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html",
    "title": "Prepare CRISPRi HCRFF data 02",
    "section": "",
    "text": "set environment\nCode\nsource ../run_config_project.sh\nshow_env\n\n\nYou are working on             Duke Server: RCC\nBASE DIRECTORY (FD_BASE):      /data/reddylab/Kuei\nREPO DIRECTORY (FD_REPO):      /data/reddylab/Kuei/repo\nWORK DIRECTORY (FD_WORK):      /data/reddylab/Kuei/work\nDATA DIRECTORY (FD_DATA):      /data/reddylab/Kuei/data\nCONTAINER DIR. (FD_SING):      /data/reddylab/Kuei/container\n\nYou are working with           ENCODE FCC\nPATH OF PROJECT (FD_PRJ):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC\nPROJECT RESULTS (FD_RES):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results\nPROJECT SCRIPTS (FD_EXE):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts\nPROJECT DATA    (FD_DAT):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data\nPROJECT NOTE    (FD_NBK):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks\nPROJECT DOCS    (FD_DOC):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs\nPROJECT LOG     (FD_LOG):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log\nPROJECT REF     (FD_REF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nPROJECT IMAGE   (FP_PRJ_SIF):  /data/reddylab/Kuei/container/project/singularity_proj_encode_fcc.sif\nPROJECT CONF.   (FP_CNF):      /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts/config_project.sh\nSet global variables\nCode\nTXT_FOLDER=\"encode_crispri_hcrff\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html#execute",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html#execute",
    "title": "Prepare CRISPRi HCRFF data 02",
    "section": "Execute",
    "text": "Execute\nRun download script\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nchmod +x ./run_download_files.sh\n\n./run_download_files.sh\n\n\nRun checksum\n\n\nCode\nFN_EXE=run_checksum_files.sh\nFP_EXE=${FD_EXE}/${FN_EXE}\n\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_INP=${FD_OUT}/checksum_md5sum.txt\nFP_OUT=${FD_OUT}/checksum_results.txt\n\n${FP_EXE} ${FP_CNF} ${FD_OUT} ${FP_INP} ${FP_OUT}\n\n\nHostname:           plp-rcc-node-25\nSlurm Array Index: \nTime Stamp:         05-19-25+23:02:17\n\nChange directory:\n/data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data/external/encode_crispri_hcrff\n\nChecksum files...\n\n\nDone!\nRun Time: 0 seconds"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html#review",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_02_execute_download_script_SH.html#review",
    "title": "Prepare CRISPRi HCRFF data 02",
    "section": "Review",
    "text": "Review\nCheck output files\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\ncd ${FD_OUT}\nls -sh {*bed.gz,*.bw} | wc -l\nls -sh {*bed.gz,*.bw}\n\n\n60\n300K K562.hg38.ENCSR009KPS.ENCFF514PCW.CRISPRi_HCRFF.signal_R1.HDAC6.bw\n288K K562.hg38.ENCSR009KPS.ENCFF607OIW.CRISPRi_HCRFF.signal_R2.HDAC6.bw\n4.0K K562.hg38.ENCSR009KPS.ENCFF632PQY.CRISPRi_HCRFF.CASA.HDAC6.bed.gz\n884K K562.hg38.ENCSR157WAN.ENCFF186XBW.CRISPRi_HCRFF.signal_R1.CD164.bw\n4.0K K562.hg38.ENCSR157WAN.ENCFF270LYK.CRISPRi_HCRFF.CASA.CD164.bed.gz\n880K K562.hg38.ENCSR157WAN.ENCFF786CHF.CRISPRi_HCRFF.signal_R2.CD164.bw\n4.0K K562.hg38.ENCSR278YTB.ENCFF151MNC.CRISPRi_HCRFF.CASA.FEN1.bed.gz\n224K K562.hg38.ENCSR278YTB.ENCFF571LUW.CRISPRi_HCRFF.signal_R1.FEN1.bw\n224K K562.hg38.ENCSR278YTB.ENCFF666DNQ.CRISPRi_HCRFF.signal_R2.FEN1.bw\n920K K562.hg38.ENCSR321CEH.ENCFF114EMW.CRISPRi_HCRFF.signal_R2.LMO2.bw\n4.0K K562.hg38.ENCSR321CEH.ENCFF469FXP.CRISPRi_HCRFF.CASA.LMO2.bed.gz\n896K K562.hg38.ENCSR321CEH.ENCFF756AUB.CRISPRi_HCRFF.signal_R1.LMO2.bw\n228K K562.hg38.ENCSR382ZJS.ENCFF090IXH.CRISPRi_HCRFF.signal_R1.FADS1.bw\n228K K562.hg38.ENCSR382ZJS.ENCFF161WBO.CRISPRi_HCRFF.signal_R2.FADS1.bw\n4.0K K562.hg38.ENCSR382ZJS.ENCFF786ZPA.CRISPRi_HCRFF.CASA.FADS1.bed.gz\n692K K562.hg38.ENCSR393VDD.ENCFF270SWR.CRISPRi_HCRFF.signal_R2.NMU.bw\n4.0K K562.hg38.ENCSR393VDD.ENCFF270ZLE.CRISPRi_HCRFF.CASA.NMU.bed.gz\n692K K562.hg38.ENCSR393VDD.ENCFF865PZH.CRISPRi_HCRFF.signal_R1.NMU.bw\n4.0K K562.hg38.ENCSR408VHJ.ENCFF091IOP.CRISPRi_HCRFF.CASA.MYB.bed.gz\n656K K562.hg38.ENCSR408VHJ.ENCFF706HXQ.CRISPRi_HCRFF.signal_R1.MYB.bw\n656K K562.hg38.ENCSR408VHJ.ENCFF825RTL.CRISPRi_HCRFF.signal_R2.MYB.bw\n656K K562.hg38.ENCSR449NJV.ENCFF270GAZ.CRISPRi_HCRFF.signal_R1.HBG1.bw\n656K K562.hg38.ENCSR449NJV.ENCFF422LBX.CRISPRi_HCRFF.signal_R2.HBG1.bw\n4.0K K562.hg38.ENCSR449NJV.ENCFF811PPJ.CRISPRi_HCRFF.CASA.HBG1.bed.gz\n656K K562.hg38.ENCSR459QNY.ENCFF052MDO.CRISPRi_HCRFF.signal_R2.HBG2.bw\n656K K562.hg38.ENCSR459QNY.ENCFF110XZR.CRISPRi_HCRFF.signal_R1.HBG2.bw\n4.0K K562.hg38.ENCSR459QNY.ENCFF910PDZ.CRISPRi_HCRFF.CASA.HBG2.bed.gz\n4.0K K562.hg38.ENCSR496MZF.ENCFF005DTR.CRISPRi_HCRFF.CASA.PVT1.bed.gz\n812K K562.hg38.ENCSR496MZF.ENCFF191XOT.CRISPRi_HCRFF.signal_R2.PVT1.bw\n812K K562.hg38.ENCSR496MZF.ENCFF298GWM.CRISPRi_HCRFF.signal_R1.PVT1.bw\n656K K562.hg38.ENCSR564EPW.ENCFF283BAT.CRISPRi_HCRFF.signal_R2.HBE1.bw\n656K K562.hg38.ENCSR564EPW.ENCFF375NHR.CRISPRi_HCRFF.signal_R1.HBE1.bw\n4.0K K562.hg38.ENCSR564EPW.ENCFF845YHV.CRISPRi_HCRFF.CASA.HBE1.bed.gz\n232K K562.hg38.ENCSR630WLB.ENCFF186CEY.CRISPRi_HCRFF.signal_R2.FADS3.bw\n4.0K K562.hg38.ENCSR630WLB.ENCFF227DUX.CRISPRi_HCRFF.CASA.FADS3.bed.gz\n232K K562.hg38.ENCSR630WLB.ENCFF499QYP.CRISPRi_HCRFF.signal_R1.FADS3.bw\n656K K562.hg38.ENCSR759RSA.ENCFF130XRV.CRISPRi_HCRFF.signal_R1.HBS1L.bw\n656K K562.hg38.ENCSR759RSA.ENCFF279WUO.CRISPRi_HCRFF.signal_R2.HBS1L.bw\n4.0K K562.hg38.ENCSR759RSA.ENCFF337VVS.CRISPRi_HCRFF.CASA.HBS1L.bed.gz\n912K K562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw\n4.0K K562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz\n912K K562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw\n4.0K K562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz\n924K K562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw\n920K K562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw\n4.0K K562.hg38.ENCSR825SFH.ENCFF240IPT.CRISPRi_HCRFF.CASA.MYC.bed.gz\n812K K562.hg38.ENCSR825SFH.ENCFF309PDY.CRISPRi_HCRFF.signal_R2.MYC.bw\n812K K562.hg38.ENCSR825SFH.ENCFF336DNM.CRISPRi_HCRFF.signal_R1.MYC.bw\n4.0K K562.hg38.ENCSR917XEU.ENCFF413WYU.CRISPRi_HCRFF.CASA.GATA1.bed.gz\n316K K562.hg38.ENCSR917XEU.ENCFF596QFD.CRISPRi_HCRFF.signal_R2.GATA1.bw\n316K K562.hg38.ENCSR917XEU.ENCFF669ISH.CRISPRi_HCRFF.signal_R1.GATA1.bw\n920K K562.hg38.ENCSR940PYU.ENCFF146MPD.CRISPRi_HCRFF.signal_R2.MEF2C.bw\n924K K562.hg38.ENCSR940PYU.ENCFF683VQC.CRISPRi_HCRFF.signal_R1.MEF2C.bw\n4.0K K562.hg38.ENCSR940PYU.ENCFF894DJT.CRISPRi_HCRFF.CASA.MEF2C.bed.gz\n4.0K K562.hg38.ENCSR968CIN.ENCFF149IDL.CRISPRi_HCRFF.CASA.FADS2.bed.gz\n228K K562.hg38.ENCSR968CIN.ENCFF734CNO.CRISPRi_HCRFF.signal_R2.FADS2.bw\n228K K562.hg38.ENCSR968CIN.ENCFF923ZPB.CRISPRi_HCRFF.signal_R1.FADS2.bw\n916K K562.hg38.ENCSR979QQN.ENCFF079PDD.CRISPRi_HCRFF.signal_R1.ERP29.bw\n908K K562.hg38.ENCSR979QQN.ENCFF184LYJ.CRISPRi_HCRFF.signal_R2.ERP29.bw\n4.0K K562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz\n\n\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFN_OUT=K562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz\nFP_OUT=${FD_OUT}/${FN_OUT}\n\nzcat ${FP_OUT} | head -n 3\n\n\nchr12   111994126   111994726   chr12:111994126-111994726:. 1.432890888 .   chr12:111994126-111994726:. chr12   112013425   112013426   +   NA  NA  ERP29   ENSG00000089248 NA  NA  TRUE    NA  NA  NA  NA  NA  TRUE    NA\nchr12   111995026   111995626   chr12:111995026-111995626:. 1.101615025 .   chr12:111995026-111995626:. chr12   112013425   112013426   +   NA  NA  ERP29   ENSG00000089248 NA  NA  TRUE    NA  NA  NA  NA  NA  TRUE    NA\nchr12   112005226   112006426   chr12:112005226-112006426:. -0.955166691    .   chr12:112005226-112006426:. chr12   112013425   112013426   +   NA  NA  ERP29   ENSG00000089248 NA  NA  TRUE    NA  NA  NA  NA  NA  TRUE    NA\n\n\nCheck checksum results\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\nFP_OUT=${FD_OUT}/checksum_results.txt\n\ncat ${FP_OUT}\ncat ${FP_OUT} | grep \"FAILED\" && echo \"FAILED\" || echo \"All PASSED\"\n\n\nK562.hg38.ENCSR793WTM.ENCFF863AVQ.CRISPRi_HCRFF.CASA.CAPRIN1.bed.gz: OK\nK562.hg38.ENCSR793WTM.ENCFF444UXP.CRISPRi_HCRFF.signal_R1.CAPRIN1.bw: OK\nK562.hg38.ENCSR793WTM.ENCFF994KKV.CRISPRi_HCRFF.signal_R2.CAPRIN1.bw: OK\nK562.hg38.ENCSR794SPV.ENCFF619FXH.CRISPRi_HCRFF.CASA.CAT.bed.gz: OK\nK562.hg38.ENCSR794SPV.ENCFF918VCM.CRISPRi_HCRFF.signal_R1.CAT.bw: OK\nK562.hg38.ENCSR794SPV.ENCFF965PMF.CRISPRi_HCRFF.signal_R2.CAT.bw: OK\nK562.hg38.ENCSR157WAN.ENCFF270LYK.CRISPRi_HCRFF.CASA.CD164.bed.gz: OK\nK562.hg38.ENCSR157WAN.ENCFF186XBW.CRISPRi_HCRFF.signal_R1.CD164.bw: OK\nK562.hg38.ENCSR157WAN.ENCFF786CHF.CRISPRi_HCRFF.signal_R2.CD164.bw: OK\nK562.hg38.ENCSR979QQN.ENCFF813GCK.CRISPRi_HCRFF.CASA.ERP29.bed.gz: OK\nK562.hg38.ENCSR979QQN.ENCFF079PDD.CRISPRi_HCRFF.signal_R1.ERP29.bw: OK\nK562.hg38.ENCSR979QQN.ENCFF184LYJ.CRISPRi_HCRFF.signal_R2.ERP29.bw: OK\nK562.hg38.ENCSR382ZJS.ENCFF786ZPA.CRISPRi_HCRFF.CASA.FADS1.bed.gz: OK\nK562.hg38.ENCSR382ZJS.ENCFF090IXH.CRISPRi_HCRFF.signal_R1.FADS1.bw: OK\nK562.hg38.ENCSR382ZJS.ENCFF161WBO.CRISPRi_HCRFF.signal_R2.FADS1.bw: OK\nK562.hg38.ENCSR968CIN.ENCFF149IDL.CRISPRi_HCRFF.CASA.FADS2.bed.gz: OK\nK562.hg38.ENCSR968CIN.ENCFF923ZPB.CRISPRi_HCRFF.signal_R1.FADS2.bw: OK\nK562.hg38.ENCSR968CIN.ENCFF734CNO.CRISPRi_HCRFF.signal_R2.FADS2.bw: OK\nK562.hg38.ENCSR630WLB.ENCFF227DUX.CRISPRi_HCRFF.CASA.FADS3.bed.gz: OK\nK562.hg38.ENCSR630WLB.ENCFF499QYP.CRISPRi_HCRFF.signal_R1.FADS3.bw: OK\nK562.hg38.ENCSR630WLB.ENCFF186CEY.CRISPRi_HCRFF.signal_R2.FADS3.bw: OK\nK562.hg38.ENCSR278YTB.ENCFF151MNC.CRISPRi_HCRFF.CASA.FEN1.bed.gz: OK\nK562.hg38.ENCSR278YTB.ENCFF571LUW.CRISPRi_HCRFF.signal_R1.FEN1.bw: OK\nK562.hg38.ENCSR278YTB.ENCFF666DNQ.CRISPRi_HCRFF.signal_R2.FEN1.bw: OK\nK562.hg38.ENCSR917XEU.ENCFF413WYU.CRISPRi_HCRFF.CASA.GATA1.bed.gz: OK\nK562.hg38.ENCSR917XEU.ENCFF669ISH.CRISPRi_HCRFF.signal_R1.GATA1.bw: OK\nK562.hg38.ENCSR917XEU.ENCFF596QFD.CRISPRi_HCRFF.signal_R2.GATA1.bw: OK\nK562.hg38.ENCSR564EPW.ENCFF845YHV.CRISPRi_HCRFF.CASA.HBE1.bed.gz: OK\nK562.hg38.ENCSR564EPW.ENCFF375NHR.CRISPRi_HCRFF.signal_R1.HBE1.bw: OK\nK562.hg38.ENCSR564EPW.ENCFF283BAT.CRISPRi_HCRFF.signal_R2.HBE1.bw: OK\nK562.hg38.ENCSR449NJV.ENCFF811PPJ.CRISPRi_HCRFF.CASA.HBG1.bed.gz: OK\nK562.hg38.ENCSR449NJV.ENCFF270GAZ.CRISPRi_HCRFF.signal_R1.HBG1.bw: OK\nK562.hg38.ENCSR449NJV.ENCFF422LBX.CRISPRi_HCRFF.signal_R2.HBG1.bw: OK\nK562.hg38.ENCSR459QNY.ENCFF910PDZ.CRISPRi_HCRFF.CASA.HBG2.bed.gz: OK\nK562.hg38.ENCSR459QNY.ENCFF110XZR.CRISPRi_HCRFF.signal_R1.HBG2.bw: OK\nK562.hg38.ENCSR459QNY.ENCFF052MDO.CRISPRi_HCRFF.signal_R2.HBG2.bw: OK\nK562.hg38.ENCSR759RSA.ENCFF337VVS.CRISPRi_HCRFF.CASA.HBS1L.bed.gz: OK\nK562.hg38.ENCSR759RSA.ENCFF130XRV.CRISPRi_HCRFF.signal_R1.HBS1L.bw: OK\nK562.hg38.ENCSR759RSA.ENCFF279WUO.CRISPRi_HCRFF.signal_R2.HBS1L.bw: OK\nK562.hg38.ENCSR009KPS.ENCFF632PQY.CRISPRi_HCRFF.CASA.HDAC6.bed.gz: OK\nK562.hg38.ENCSR009KPS.ENCFF514PCW.CRISPRi_HCRFF.signal_R1.HDAC6.bw: OK\nK562.hg38.ENCSR009KPS.ENCFF607OIW.CRISPRi_HCRFF.signal_R2.HDAC6.bw: OK\nK562.hg38.ENCSR321CEH.ENCFF469FXP.CRISPRi_HCRFF.CASA.LMO2.bed.gz: OK\nK562.hg38.ENCSR321CEH.ENCFF756AUB.CRISPRi_HCRFF.signal_R1.LMO2.bw: OK\nK562.hg38.ENCSR321CEH.ENCFF114EMW.CRISPRi_HCRFF.signal_R2.LMO2.bw: OK\nK562.hg38.ENCSR940PYU.ENCFF894DJT.CRISPRi_HCRFF.CASA.MEF2C.bed.gz: OK\nK562.hg38.ENCSR940PYU.ENCFF683VQC.CRISPRi_HCRFF.signal_R1.MEF2C.bw: OK\nK562.hg38.ENCSR940PYU.ENCFF146MPD.CRISPRi_HCRFF.signal_R2.MEF2C.bw: OK\nK562.hg38.ENCSR408VHJ.ENCFF091IOP.CRISPRi_HCRFF.CASA.MYB.bed.gz: OK\nK562.hg38.ENCSR408VHJ.ENCFF706HXQ.CRISPRi_HCRFF.signal_R1.MYB.bw: OK\nK562.hg38.ENCSR408VHJ.ENCFF825RTL.CRISPRi_HCRFF.signal_R2.MYB.bw: OK\nK562.hg38.ENCSR825SFH.ENCFF240IPT.CRISPRi_HCRFF.CASA.MYC.bed.gz: OK\nK562.hg38.ENCSR825SFH.ENCFF336DNM.CRISPRi_HCRFF.signal_R1.MYC.bw: OK\nK562.hg38.ENCSR825SFH.ENCFF309PDY.CRISPRi_HCRFF.signal_R2.MYC.bw: OK\nK562.hg38.ENCSR393VDD.ENCFF270ZLE.CRISPRi_HCRFF.CASA.NMU.bed.gz: OK\nK562.hg38.ENCSR393VDD.ENCFF865PZH.CRISPRi_HCRFF.signal_R1.NMU.bw: OK\nK562.hg38.ENCSR393VDD.ENCFF270SWR.CRISPRi_HCRFF.signal_R2.NMU.bw: OK\nK562.hg38.ENCSR496MZF.ENCFF005DTR.CRISPRi_HCRFF.CASA.PVT1.bed.gz: OK\nK562.hg38.ENCSR496MZF.ENCFF298GWM.CRISPRi_HCRFF.signal_R1.PVT1.bw: OK\nK562.hg38.ENCSR496MZF.ENCFF191XOT.CRISPRi_HCRFF.signal_R2.PVT1.bw: OK\nAll PASSED\n\n\nCheck execution log\n\n\nCode\nFD_OUT=${FD_DAT}/external/${TXT_FOLDER}\n\nhead -n 10 ${FD_OUT}/run_download.log.txt\n\n\n--2025-05-19 22:58:45--  https://www.encodeproject.org/files/ENCFF863AVQ/@@download/ENCFF863AVQ.bed.gz\nResolving www.encodeproject.org (www.encodeproject.org)... 34.211.244.144\nConnecting to www.encodeproject.org (www.encodeproject.org)|34.211.244.144|:443... connected.\nHTTP request sent, awaiting response... 307 Temporary Redirect\nLocation: https://encode-public.s3.amazonaws.com/2021/05/13/03597cde-28c5-4132-b315-b51c7c49a26d/ENCFF863AVQ.bed.gz?response-content-disposition=attachment%3B%20filename%3DENCFF863AVQ.bed.gz&AWSAccessKeyId=ASIATGZNGCNX62Y6JJ44&Signature=6EohxZJTYaTZPzoOQ1Kh8wlrUgk%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEOP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHyg%2FlwkPM8wJK3Ddcc2ZuaXCPn4X5c08tbeYodBJywzAiEAre2GLWK%2FzHX5sFte8f8WWIG7O8PyNhYcvJnxTregVpEqvAUInP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgwyMjA3NDg3MTQ4NjMiDOfK1vFM85VhMbUUPCqQBbWd7%2FtwXvLj%2BGxXB8xl763hqs8h2rOBrgnIcDNosvKMY0F1AGAyJn497frcFpWl4cua%2BumJXRFt%2BGjH1qAGj6ApAVqM3SSPoxnG3E1EXbtGCg2F7AjyUTs6GwENwiZTlKLAN%2FwzQNncAx2jHPMvhm5EdvrGqyYD49d5mzX%2FFVnKV7WhbZcjuJJj5wzOr78uRbYjfs0fUR1LKxLACwVOxoSfm7ugqHMOG8a0cpn89iaTt8KiXZQip5DtzhLDctuP1Ky2lN6I9D%2Bz9ePSyB23DK%2Bf5VtDljFCZ%2FxTZdyufPYF1cOXE%2FKuUyaBq0%2BjQ3wOi3PbkDNzWyMzFfjkPnvq5okHFgX3JfnLxqah9eUVlWT01sQ3aHwrYHST5poKqDJ65O344d%2Bkf8ldGYTSLeqWAsDVM7xoqsbUDhQsyetiWcAp%2BV63LQJxdg2CS%2FdyLwazbOTHYdrgWrk9x177Ea%2BkOCsur06KP7kktIMqBuT9bMMhZC0d9YFRe1%2BxbOop0lyxdwsSjJdQznxlbHFP3%2BiV%2FziJv2j2alYiU%2FCrRxHCdMPo%2Bqe%2Bjae188wu01uGxFWSzq7EzmU07WGgAFB9g9JErg8XOJaNjNE%2FQwdrNxhZU1sosXAxYWNwzkR7dsVgOk0BbkEWyLrISULnUdtktgzELBz0VbGC%2BLzdJJ7jpsSjuQmX5h0G5kclzxThZGgZpnZfbSSI7JTZBTZ6nLKdXnq4AIX0kwccv2ikyLMS25NDLASIk3Zuvnpt321nq01uylLgld2HhcyeWMwcdfUwVAXIr74ZiVAlcXyG9DiHiMxQ7TD2HSjRubq4p6zQceEa46v98O0jVYxn9daYflq9pSUaq4IPoezyLDdu3M9f4ehjtASSMLrQr8EGOrEBJT2Ks%2F93edpSIbt0z71bZs6Pw7HqifazlFYlZx%2FZq5DkFfEA1V2Lqx8oHmmCeSEOjXz5bcZi3%2BDuWakG%2Bmachm%2FxLfoGIgjQ1wZ4iTL4Et9ap%2BYZtAkNBd7gXBdtm6Pl1ZlaJoYJNoOWbgpdUZUARcvNV7aljABXw%2F8hWOFFaQmR%2B1nfR45nyX%2FOzIFyZwMq6e2VH3HpDIrTxsQf4byDIEcLm6YaTE3qKb3hlgqVougw&Expires=1747839526 [following]\n--2025-05-19 22:58:46--  https://encode-public.s3.amazonaws.com/2021/05/13/03597cde-28c5-4132-b315-b51c7c49a26d/ENCFF863AVQ.bed.gz?response-content-disposition=attachment%3B%20filename%3DENCFF863AVQ.bed.gz&AWSAccessKeyId=ASIATGZNGCNX62Y6JJ44&Signature=6EohxZJTYaTZPzoOQ1Kh8wlrUgk%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEOP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHyg%2FlwkPM8wJK3Ddcc2ZuaXCPn4X5c08tbeYodBJywzAiEAre2GLWK%2FzHX5sFte8f8WWIG7O8PyNhYcvJnxTregVpEqvAUInP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgwyMjA3NDg3MTQ4NjMiDOfK1vFM85VhMbUUPCqQBbWd7%2FtwXvLj%2BGxXB8xl763hqs8h2rOBrgnIcDNosvKMY0F1AGAyJn497frcFpWl4cua%2BumJXRFt%2BGjH1qAGj6ApAVqM3SSPoxnG3E1EXbtGCg2F7AjyUTs6GwENwiZTlKLAN%2FwzQNncAx2jHPMvhm5EdvrGqyYD49d5mzX%2FFVnKV7WhbZcjuJJj5wzOr78uRbYjfs0fUR1LKxLACwVOxoSfm7ugqHMOG8a0cpn89iaTt8KiXZQip5DtzhLDctuP1Ky2lN6I9D%2Bz9ePSyB23DK%2Bf5VtDljFCZ%2FxTZdyufPYF1cOXE%2FKuUyaBq0%2BjQ3wOi3PbkDNzWyMzFfjkPnvq5okHFgX3JfnLxqah9eUVlWT01sQ3aHwrYHST5poKqDJ65O344d%2Bkf8ldGYTSLeqWAsDVM7xoqsbUDhQsyetiWcAp%2BV63LQJxdg2CS%2FdyLwazbOTHYdrgWrk9x177Ea%2BkOCsur06KP7kktIMqBuT9bMMhZC0d9YFRe1%2BxbOop0lyxdwsSjJdQznxlbHFP3%2BiV%2FziJv2j2alYiU%2FCrRxHCdMPo%2Bqe%2Bjae188wu01uGxFWSzq7EzmU07WGgAFB9g9JErg8XOJaNjNE%2FQwdrNxhZU1sosXAxYWNwzkR7dsVgOk0BbkEWyLrISULnUdtktgzELBz0VbGC%2BLzdJJ7jpsSjuQmX5h0G5kclzxThZGgZpnZfbSSI7JTZBTZ6nLKdXnq4AIX0kwccv2ikyLMS25NDLASIk3Zuvnpt321nq01uylLgld2HhcyeWMwcdfUwVAXIr74ZiVAlcXyG9DiHiMxQ7TD2HSjRubq4p6zQceEa46v98O0jVYxn9daYflq9pSUaq4IPoezyLDdu3M9f4ehjtASSMLrQr8EGOrEBJT2Ks%2F93edpSIbt0z71bZs6Pw7HqifazlFYlZx%2FZq5DkFfEA1V2Lqx8oHmmCeSEOjXz5bcZi3%2BDuWakG%2Bmachm%2FxLfoGIgjQ1wZ4iTL4Et9ap%2BYZtAkNBd7gXBdtm6Pl1ZlaJoYJNoOWbgpdUZUARcvNV7aljABXw%2F8hWOFFaQmR%2B1nfR45nyX%2FOzIFyZwMq6e2VH3HpDIrTxsQf4byDIEcLm6YaTE3qKb3hlgqVougw&Expires=1747839526\nResolving encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)... 52.218.216.98, 52.218.183.105, 52.92.227.129, ...\nConnecting to encode-public.s3.amazonaws.com (encode-public.s3.amazonaws.com)|52.218.216.98|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 227 [binary/octet-stream]"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html",
    "title": "Prepare CRISPRi HCRFF data 04",
    "section": "",
    "text": "Set environment\nCode\nsuppressMessages(suppressWarnings(source(\"../run_config_project_sing.R\")))\nshow_env()\n\n\nYou are working on        Singularity: singularity_proj_encode_fcc \nBASE DIRECTORY (FD_BASE): /data/reddylab/Kuei \nREPO DIRECTORY (FD_REPO): /data/reddylab/Kuei/repo \nWORK DIRECTORY (FD_WORK): /data/reddylab/Kuei/work \nDATA DIRECTORY (FD_DATA): /data/reddylab/Kuei/data \n\nYou are working with      ENCODE FCC \nPATH OF PROJECT (FD_PRJ): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC \nPROJECT RESULTS (FD_RES): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/results \nPROJECT SCRIPTS (FD_EXE): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/scripts \nPROJECT DATA    (FD_DAT): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/data \nPROJECT NOTE    (FD_NBK): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/notebooks \nPROJECT DOCS    (FD_DOC): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/docs \nPROJECT LOG     (FD_LOG): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/log \nPROJECT REF     (FD_REF): /data/reddylab/Kuei/repo/Proj_ENCODE_FCC/references\nSet global variables\nCode\nTXT_FOLDER_REGION = \"fcc_crispri_hcrff\""
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html#define-file-labeling",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html#define-file-labeling",
    "title": "Prepare CRISPRi HCRFF data 04",
    "section": "Define file labeling",
    "text": "Define file labeling\n\n\nCode\n### set directory\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder)\ntxt_fglob  = file.path(txt_fdiry, \"*bed*\")\n\n### get file names\nvec_txt_fpath = Sys.glob(txt_fglob)\nvec_txt_fname = basename(vec_txt_fpath)\n\n### init info table\ndat = data.frame(\n    \"Folder\" = txt_folder,\n    \"FName\"  = vec_txt_fname,\n    \"Label\"  = \"fcc_crispri_hcrff_casa\"\n)\n\n### assign and show\ndat_region_label = dat\nfun_display_table(dat)\n\n\n\n\n\nFolder\nFName\nLabel\n\n\n\n\nfcc_crispri_hcrff\nK562.hg38.CRISPRi_HCRFF.CASA.bed.gz\nfcc_crispri_hcrff_casa"
  },
  {
    "objectID": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html#save-results",
    "href": "notebooks/05_prepare_region/region_crispri_hcrff_04_export_metadata_R.html#save-results",
    "title": "Prepare CRISPRi HCRFF data 04",
    "section": "Save results",
    "text": "Save results\n\n\nCode\ntxt_folder = TXT_FOLDER_REGION\ntxt_fdiry  = file.path(FD_RES, \"region\", txt_folder, \"summary\")\ntxt_fname  = \"metadata.label.tsv\"\ntxt_fpath  = file.path(txt_fdiry, txt_fname)\n\ndir.create(txt_fdiry, showWarnings = FALSE)\ndat = dat_region_label\nwrite_tsv(dat, txt_fpath)"
  },
  {
    "objectID": "report.html",
    "href": "report.html",
    "title": "Report: Summarize ideas and findings of the analyses",
    "section": "",
    "text": "Overview of functional assays and regulatory activity comparison\nWe first summarized the significant regions identified by STARR-seq, MPRA, and CRISPR screens. Using MACS peak calling on the ATAC-STARR-seq input library, we identified approximately 150,000 open chromatin regions. Among these, 18,341 regions exhibited regulatory activity in at least two reporter assays. Within this subset, 15,285 regions were screened by at least one CRISPR assay, and 1,652 regions were found to be significant in at least one CRISPR result. CRISPR assays demonstrated a higher sensitivity to promoters, identifying 20.2% of promoters, compared to 6.3% of enhancers and 4.7% of silencers. This finding highlights the preferences of CRISPR assays for certain regulatory contexts.\nTo evaluate the correlations across reporter assays, we summarized the scores at accessible regions and measured the correlations between the assays. Reporter assays exhibited correlations ranging from 0.2 to 0.6, with the strongest correlation observed between WHG-STARR-seq and tiling MPRA (Spearman correlation: r = 0.54). These results suggest that, while there is overlap in the regulatory regions detected, assay-specific differences also exist.\nOur analysis revealed that regulatory activities measured by reporter assays provide a 70–80% chance of correctly distinguishing CRISPRi hits, based on a cutoff of absolute z-score ≥ 1 (AUROC: 0.7-0.8). This finding underscores the predictive potential of reporter assays for identifying functional elements in CRISPRi data. Compared to scores from reporter assays, chromatin accessibility emerged as the most predictive feature for CRISPRi signals. Ongoing analyses aim to evaluate the marginal gains in predictivity achieved by integrating data from functional characterization assays.\n\n\nCompare regulatory activity across promoters, enhancers, and silencers\nFunctional characterization assays revealed distinct activity profiles across cis-regulatory elements. MPRA assays exhibited higher activity in promoters compared to enhancers. Similarly, CRISPRi-growth screens demonstrated stronger regulatory effects in promoters, particularly in essential genes within K562 cells. This suggested that the disruptions at promoters of essential genes had greater impacts on cell fitness than disruptions at promoters of non-essential genes.\nFurther comparisons of regulatory scores across chromatin states revealed that CRISPRi-Growth regions were enriched for promoter-like signatures, while CRISPRi-HCR FlowFISH highlighted regions with both proximal and distal enhancer-like signatures. These findings aligned with our observations of activity differences across promoters, enhancers, and silencers. Additionally, ATAC-STARR-seq displayed repressive effects in bivalent regions, which is also supported by negative z-scores in regions marked by H3K27me3 modification.\nAlthough reporter assays are episomal and do not directly reflect chromatin context, we observed significant differences in their activity across regions with different chromatin states. This suggested that factors associated with chromatin states may influence the regulatory activities measured in reporter assays.\n\n\nExplore heterogeneity of regulatory regions through TF occupancy and colocalization\nTo investigate TFs involvement in regulatory regions, our ENCODE working group had already explored the TF occupancy of cis-regulatory regions using sequence model and ChIP-seq data. We first investigated assay-specific preferences by analyzing the distribution of TF motifs using sequence models. Distinct TF motifs were enriched in specific assays, including SP1, GATA, and NFY for Lenti-MPRA; AP1 and YY1 for ATAC-STARR; and ATF for WG-STARR. The preference for promoter-associated TF motifs in regions identified by Lenti-MPRA was consistent with the observed differences in regulatory activity across promoters, enhancers, and silencers.\nThe working group also examined the ChIP-seq data for those enriched TFs in reporter assays. We calculated feature-enrichment scores by dividing the average ChIP-seq signal at active elements by that of inactive, GC-matched background elements. This analysis revealed significant enrichments for TFs such as EP300 (p = 7.2e-14), YY1 (p = 2.1e-14), JUN (p = 2.4e-11), and ATF (p = 5.5e-11), along with histone modifications H3K4me3 and H3K27ac at promoter elements across all assays. These results, which were highly significant (p &lt; 0.0001, Wilcoxon rank-sum test), underscore the consistent association of these factors with active regulatory regions.\nPrevious studies have demonstrated that transcriptional regulation varies across regions due to specific TF binding preferences and combinations. Additionally, previous MPRA analyses of synthetic fragments have demonstrated that varying combinations of TF motifs could result in different levels of regulatory activity. Based on these findings, I would like to advance our TF analysis by integrating more than 700 ChIP-seq data in ENCODE. I explored the heterogeneity of regulatory elements by integrating over 500 genomic features, including functional characterization assays, ChIP-seq data, and transcription start site (TSS) annotations. Clustering analyses revealed subgroups of regulatory regions with distinct combinations of features. For instance, CTCF-bounded regions could be decomposed based on the combinations of chromatin organization factors, including CTCF, cohesin, and Rad21.\nOngoing analyses aim to refine our understanding of the factors that define active regulatory regions, including enhancers, promoters, and silencers. We plan to extend our ChIP-seq results to systematically identify key elements that distinguish (1) active from inactive regions and (2) subgroups of regulatory regions that may have diverse functional roles.\n\n\nIdentifying TF clusters associations with regulatory activity\nGrouping TFs and studying the occupancy of TF clusters have been a key approach for enhancer discovery and characterization. We collaborated with an ENCODE working group applying topic modeling to cluster TFs into modules based on their binding sites. Our analyses identified TF modules that were either positively or negatively correlated with regulatory activity, providing additional results in TF colocalization in gene regulation.\nUsing genome-wide reporter assays, we identified the top positively and negatively correlated TF modules associated with overall regulatory effects. To further investigate the functional relevance of these clusters, we performed enrichment analyses based on protein domain and family annotations. We found bZIP (IPR004827, IPR046347) and ETS (IPR046328, IPR000418) protein domain enriched in top positive correlated TF modules while Rad21 (IPR006909, IPR006910), SMC/SMC3 (IPR010935, IPR041741, IPR036277, IPR024704), homeobox (IPR008422, IPR001356, IPR017970, IPR009057, IPR008422), and histone deacetylase (IPR003084) were enriched in top negative correlated TF modules. These findings were consistent with the enrichment of AP1 motifs identified in our sequence model analyses and aligned with the repressive effects of chromatin organization reported by the ENCODE MPRA working group.\n\n\nChromatin Organization and Looping\nThe detection of CTCF and cohesin binding sites in regions with discordant signals, such as the FADS loci, led us to hypothesize a potential influence of chromatin organization on assay outcomes. To test the hypothesis, we constructed chromatin interaction networks based on accessible regions and loop calls in Hi-C data. We observed the enrichment of physical interactions in regulatory regions identified in each assay. In addition, among the assays, we also noticed that regulatory regions identified in CRISPRi-HCR FlowFISH assay had the highest frequency of looped regions compared to its background. Further aggregate peak analysis (APA) also showed an enrichment of Hi-C signals at the enhancer-promoter pairs identified in CRISPRi-HCR FlowFISH. These observations suggested a potential correlation between chromatin looping and the detection capabilities of different assays, highlighting the importance of chromatin architecture in the functional characterization of regulatory elements. Ongoing effort aim to extend the APA analysis to regulatory regions identified by other functional characterization assays."
  }
]